"use strict";((self||window).webpackChunkterriajs_map=(self||window).webpackChunkterriajs_map||[]).push([[955],{48955:(e,t,i)=>{i.d(t,{default:()=>Se}),i(27495),i(62953);var o=i(9828),r=i(27813),n=i(31370),l=i(96540),s=i(40961),a=i(18492),c=i(8711),d=i(57634),u=i(24378),m=i(93657),h=i(70466),p=i(89179),y=i(15876),f=i(91273),A=i(26339),g=i(13718),x=i(99773),v=i(89697),b=i(6119),D=i(47442),j=i(69503),S=i(83380),k=i(59895),T=i(38398),w=i(31459),I=i(44310),C=i(16675),P=i(42007),_=i(89346),L=i(53381),B=i(15873),M=i(42719),O=i(97179),E=i(62225),R=i(26917),F=i(74848);const N=(0,l.forwardRef)((e,t)=>{const{heading:i,item:o,onDateSet:r}=e,{t:n}=(0,a.B)(),[s,c]=(0,l.useState)(!1),d=(0,l.useMemo)(()=>{const e=o.currentDiscreteJulianDate;return e&&u.A.toDate(e)},[o.currentDiscreteJulianDate]),m=(0,l.useMemo)(()=>{if(void 0!==d)return(0,E.r6)(d)},[d]),h=(0,l.useCallback)(()=>{c(!s)},[s]),p=(0,l.useCallback)(e=>{o.setTrait(b.A.user,"currentTime",e.toISOString()),r()},[o,r]),y=(0,l.useCallback)(()=>{o.moveToPreviousDiscreteTime(b.A.user),r()},[o,r]),f=(0,l.useCallback)(()=>{o.moveToNextDiscreteTime(b.A.user),r()},[o,r]);return(0,l.useImperativeHandle)(t,()=>({open:()=>{c(!0)},close:()=>{c(!1)}}),[]),(0,F.jsxs)(k.Ay,{column:!0,centered:!0,flex:1,children:[(0,F.jsx)(C.Ay,{bottom:4}),(0,F.jsxs)(k.Ay,{centered:!0,children:[(0,F.jsx)(q,{light:!0,styledWidth:"21px",glyph:w.Ay.GLYPHS.calendar2,$_css:"margin-top:-2px;"}),(0,F.jsx)(C.Ay,{right:2}),(0,F.jsx)(P.Ay,{textLight:!0,extraLarge:!0,children:i})]}),(0,F.jsx)(C.Ay,{bottom:2}),(0,F.jsxs)(k.Ay,{children:[(0,F.jsx)(J,{disabled:!1===o.isPreviousDiscreteTimeAvailable,title:n("diffTool.datePicker.previousDateTitle"),onClick:y}),(0,F.jsx)(H,{primary:!0,isOpen:s,onClick:h,title:n("diffTool.datePicker.dateButtonTitle"),children:(0,F.jsx)(P.yF,{extraLarge:!0,children:m||"-"})}),(0,F.jsx)(Y,{disabled:!1===o.isNextDiscreteTimeAvailable,title:n("diffTool.datePicker.nextDateTitle"),onClick:f})]}),(0,F.jsx)("div",{style:{display:s?"block":"none",position:"absolute"},children:(0,F.jsx)(R.A,{currentDate:d,dates:o.objectifiedDates,onChange:p,openDirection:"up",isOpen:s,onClose:()=>c(!1)})}),(0,F.jsx)(C.Ay,{bottom:4})]})});N.displayName="DatePicker";const W=(0,c.Ay)(T.Ay).attrs({iconProps:{css:"margin-right:0;"}}).withConfig({displayName:"DatePicker__PagerButton",componentId:"sc-11kes1x-0"})(["cursor:pointer;background-color:",";width:40px;border:1px solid transparent;"," flex-direction:column;"],e=>e.theme.colorPrimary,e=>{let{theme:t}=e;return t.centerWithFlex()}),J=(0,c.Ay)(W).attrs({renderIcon:()=>(0,F.jsx)(V,{light:!0,styledWidth:"15px",glyph:w.Ay.GLYPHS.arrowDown})}).withConfig({displayName:"DatePicker__PrevButton",componentId:"sc-11kes1x-1"})([""," margin-right:1px;"],e=>{let{theme:t}=e;return t.borderRadiusLeft(t.radius40Button)}),Y=(0,c.Ay)(W).attrs({renderIcon:()=>(0,F.jsx)(Z,{light:!0,styledWidth:"15px",glyph:w.Ay.GLYPHS.arrowDown})}).withConfig({displayName:"DatePicker__NextButton",componentId:"sc-11kes1x-2"})([""," margin-left:1px;"],e=>{let{theme:t}=e;return t.borderRadiusRight(t.radius40Button)}),H=(0,c.Ay)(T.Ay).withConfig({displayName:"DatePicker__DateButton",componentId:"sc-11kes1x-3"})(["z-index:0;",";border-radius:0px;border:1px solid ",";min-width:235px;@media (max-width:","px){min-width:150px;}"],e=>e.isOpen&&"z-index: 1000;",e=>e.theme.colorPrimary,e=>e.theme.lg),z=(0,n.PA)(N);var G,U,Q,X,K,q=(0,c.Ay)(w.vE).withConfig({displayName:"DatePicker___StyledStyledIcon",componentId:"sc-11kes1x-4"})(["",""],e=>e.$_css),V=(0,c.Ay)(w.vE).withConfig({displayName:"DatePicker___StyledStyledIcon2",componentId:"sc-11kes1x-5"})(["transform:rotate(90deg);"]),Z=(0,c.Ay)(w.vE).withConfig({displayName:"DatePicker___StyledStyledIcon3",componentId:"sc-11kes1x-6"})(["transform:rotate(270deg);"]),$=(i(94490),i(41006)),ee=i(37720);function te(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function ie(e,t,i,o,r){var n={};return Object.keys(o).forEach(function(e){n[e]=o[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,o){return o(e,t,i)||i},n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let oe=(0,n.PA)((U=class extends l.Component{constructor(e){super(e),te(this,"pickMode",Q,this),te(this,"currentPick",X,this),te(this,"pickDisposer",K,this),(0,r.Gn)(this)}setupPicker(){const{terria:e,location:t,onPicking:i,onPicked:o}=this.props;this.pickMode=new ee.A({message:"",messageAsNode:(0,F.jsx)("div",{}),uiMode:ee.o.Difference}),function(e,t){e.mapInteractionModeStack.push(t)}(e,this.pickMode),t&&re(e,t),this.pickDisposer=(0,r.mJ)(()=>this.pickMode.pickedFeatures,(0,r.XI)(e=>{var r;if(void 0===e||void 0===e.pickPosition)return;this.pickMode.customUi=()=>(0,F.jsx)(M.A,{message:"Querying ".concat(t?"new":""," position...")});const n=function(e){const t=$.A.WGS84.cartesianToCartographic(e);return{longitude:m.A.toDegrees(t.longitude),latitude:m.A.toDegrees(t.latitude)}}(e.pickPosition);re(this.props.terria,n),this.currentPick=e,i(n),null===(r=e.allFeaturesAvailablePromise)||void 0===r||r.then(()=>{e===this.currentPick&&o(e,n)})}))}destroyPicker(){var e;const{terria:t}=this.props;this.pickMode&&function(e,t){const[i]=e.mapInteractionModeStack.slice(-1);i===t&&e.mapInteractionModeStack.pop()}(t,this.pickMode),(0,S.nq)(t),this.pickMode=void 0,this.currentPick=void 0,null===(e=this.pickDisposer)||void 0===e||e.call(this),this.pickDisposer=void 0}componentDidMount(){this.setupPicker()}componentDidUpdate(){this.destroyPicker(),this.setupPicker()}componentWillUnmount(){this.destroyPicker()}render(){return null}},Q=ie(U.prototype,"pickMode",[r.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=ie(U.prototype,"currentPick",[r.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=ie(U.prototype,"pickDisposer",[r.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie(U.prototype,"setupPicker",[r.XI],Object.getOwnPropertyDescriptor(U.prototype,"setupPicker"),U.prototype),ie(U.prototype,"destroyPicker",[r.XI],Object.getOwnPropertyDescriptor(U.prototype,"destroyPicker"),U.prototype),G=U))||G;function re(e,t){(0,S.Yu)(e,{name:"User selection",location:t,customMarkerIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAA2CAYAAAAyEzKAAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGaADAAQAAAABAAAANgAAAAAbYi+LAAADOUlEQVRYCe1YPWgUQRT+3pEoqEWilSRBjSGNWKhga7DwBwTRKgqChXVM0igKGhRMFCXRQhsbFWOlIAhBm5ythRaCmCBGBAmIwRSx0EjW783tbnb3Zvbn7gqLe7A3M9977/tm3s7OLidIMW8QuyE4ihW2wA5em3it5/WL+A94+IAS3rJ9LhNsHSZJ3POYPoSTxC8xuTfpd44Fs/RdwTgmRZgZsZiIN4QOup/x2huJKdYVvOE0j8s4vgWJoQgFdpJ8ildH4Ky5FQoIDlPovXIYEW8EG7CIdxToqZk4mSj4hDbskhEslYxvETcbKqCkOmHlpQnLtJHAPK81CjTUBH9Yq80tJO3PJSD4wthH3LKz3NK6604xbytbt+nEBf0tDDzkjgo9L1jfE1rfAOF9vIGfeMLxkQCztuTXe9Jlda6CC1iH01EBdZkxcXYXdJxiXSrSmRKgrrKM2ol8vJyR36kieky4TfDd7aQny0/+Eu/Jx1QSYE9dfvLrSqZSSXjEcJsfs8UYPPsImtLnpIdbUg+38IipIhSeusA5dOO+DOC3dwdr8RlniF1nJdLK7XHL91aOlUFMM7ivirwaWCb0ldPZwnh9xrJsWm5jv5ZLj4C7WdG+v5Xt9pwCmnJPfyoi7XjK2c0o0DBTPuWlGRE+WCuc3bWGCSgR+QxvIGLI2zHJds706/+Z4yqUz1ilXOxS9S9LdtnH62vIY/h8llDEjNvwmELmbVaziuYrT8RiIqaGJZyP+It3mW94IpnWB5CfQmXeuH2RuHxdwWt+GvUlg2MriTiHWbaVyDi7W4kftgVaRfwPtYe2BCfm4YHrA88q4hNdYBu+CZ3kFccSV37RFeMU4azmmTjmSozhJYya+Bi4OnCKmJBuftIIz9s0U/823EoLSRXRY50i1psZktJv4kKgumPdwskwbumX3NIHkjgn8IplOliFJ4DUlYSxHgbY13dJ1JYprHim5RLhi2eG5/VEjI1jg8dA+yCXiEltxdUYRXIcc8YHue5JkOKdZYF84ypy5+ZfScBeQ9sUKVS0Zrma5SpUgULBzd3VLFehChQK/g93l/7roxa0OddTbCWe+f9qiS9h8z9WTg38A1O1vXOERmoNAAAAAElFTkSuQmCC"})}function ne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,o)}return i}function le(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(i),!0).forEach(function(t){se(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ne(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function se(e,t,i){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ae=(0,n.PA)(e=>{const[t,i]=(0,l.useState)(),[o,n]=(0,l.useState)(),[s,a]=(0,l.useState)(),c=(0,L.ME)(),d=(0,l.useMemo)(()=>s||e.sourceItem,[e.sourceItem,s]);return(0,l.useEffect)(()=>{const e=c.terria,t={showSplitter:e.showSplitter,isMapFullScreen:c.isMapFullScreen};(0,r.h5)(()=>{e.showSplitter=!0,d.setTrait(b.A.user,"show",!1),e.elements.set("timeline",{visible:!1})});const o=Promise.all([ge(d,p.A.LEFT),ge(d,p.A.RIGHT)]);return o.then(e=>{let[t,o]=e;i(t),n(o)}).catch(),()=>{(0,r.h5)(()=>{e.showSplitter=t.showSplitter,c.setIsMapFullScreen(t.isMapFullScreen),d.setTrait(b.A.user,"show",!0),e.elements.set("timeline",{visible:!0})}),o.then(e=>{let[t,i]=e;t&&ve(t),i&&ve(i)})}},[d,c]),t&&o?(0,F.jsx)(ce,le(le({},e),{},{terria:e.viewState.terria,sourceItem:d,changeSourceItem:e=>{a(e)},leftItem:t,rightItem:o})):null});ae.displayName="DiffTool";const ce=(0,n.PA)(e=>{var t;const{terria:i,viewState:n,sourceItem:d,leftItem:m,rightItem:h}=e,{t:f}=(0,a.B)(),A=(0,c.DP)(),[v,D]=(0,l.useState)(),[,I]=(0,l.useState)(!1),[C,_]=(0,l.useState)(!1),L=(0,l.useRef)(null),B=(0,l.useRef)(null),M=(0,l.useMemo)(()=>m,[m]),E=(0,l.useMemo)(()=>m.currentDiscreteJulianDate,[m.currentDiscreteJulianDate]),R=(0,l.useMemo)(()=>h.currentDiscreteJulianDate,[h.currentDiscreteJulianDate]),N=(0,l.useMemo)(()=>{const e=d.name||"",t="yyyy/mm/dd";if(E&&R){const i=(0,o.Ay)(u.A.toDate(E),t),r=(0,o.Ay)(u.A.toDate(R),t);return"".concat(e," - difference for dates ").concat(i,", ").concat(r)}return e},[E,R,d.name]),W=(0,l.useMemo)(()=>i.workbench.items.filter(e=>g.A.isMixedInto(e)&&e.canDiffImages),[i.workbench.items]),J=(0,l.useMemo)(()=>{var e;return null===(e=M.styleSelectableDimensions)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.selectedId},[M.styleSelectableDimensions]),Y=(0,l.useMemo)(()=>M.diffStyleId,[M.diffStyleId]),H=(0,l.useMemo)(()=>(0,y.A)(M.availableDiffStyles.map(e=>{var t;return null===(t=M.styleSelectableDimensions)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.options)||void 0===t?void 0:t.find(t=>t.id===e)})),[M.availableDiffStyles,M.styleSelectableDimensions]),G=(0,l.useMemo)(()=>Y&&E&&R&&M.getLegendUrlForStyle(Y,E,R),[Y,E,R,M]),U=(0,l.useMemo)(()=>J&&M.getLegendUrlForStyle(J),[J,M]),Q=(0,l.useCallback)(e=>{(0,r.h5)(()=>{je(e)&&e.setTrait(b.A.user,"opacity",.8)})},[]),X=(0,l.useCallback)(e=>{(0,r.h5)(()=>{je(e)&&e.setTrait(b.A.user,"opacity",0)})},[]),K=(0,l.useCallback)(t=>{const i=W.find(e=>e.uniqueId===t.target.value);i&&e.changeSourceItem(i)},[W,e]),q=(0,l.useCallback)(e=>{const t=e.target.value;(0,r.h5)(()=>{var e,i;null===(e=m.styleSelectableDimensions)||void 0===e||null===(e=e[0])||void 0===e||e.setDimensionValue(b.A.user,t),null===(i=h.styleSelectableDimensions)||void 0===i||null===(i=i[0])||void 0===i||i.setDimensionValue(b.A.user,t)})},[m.styleSelectableDimensions,h.styleSelectableDimensions]),V=(0,l.useCallback)(e=>{(0,r.h5)(()=>{M.setTrait(b.A.user,"diffStyleId",e.target.value)})},[M]),Z=(0,l.useCallback)(e=>{_(!0)},[]),$=(0,l.useCallback)((e,t)=>{const i=e.features.find(e=>be(e,m)||be(e,h));(0,r.h5)(()=>{i?(m.setTimeFilterFeature(i,e.providerCoords),h.setTimeFilterFeature(i,e.providerCoords),D(t),I(!1)):I(!0),_(!1)})},[m,h]),ee=(0,l.useCallback)(()=>{(0,r.h5)(()=>{m.setTrait(b.A.user,"currentTime",null),h.setTrait(b.A.user,"currentTime",null)}),X(m),X(h)},[m,h,X]),te=(0,l.useCallback)(()=>{void 0!==E&&void 0!==R&&void 0!==Y&&(0,r.h5)(()=>{i.overlays.remove(m),i.overlays.remove(h),i.workbench.add(M),M.setTrait(b.A.user,"name",N),M.showDiffImage(E,R,Y);const e=M.diffItemProperties;e&&(0,j.A)(M,b.A.user,e),i.showSplitter=!1})},[Y,E,R,M,N,m,h,i]),ie=(0,l.useCallback)(()=>{(0,r.h5)(()=>{M.clearDiffImage(),xe(M),i.overlays.add(m),i.overlays.add(h),i.workbench.remove(M),i.showSplitter=!0,m.setTrait(b.A.user,"splitDirection",p.A.LEFT),h.setTrait(b.A.user,"splitDirection",p.A.RIGHT)})},[M,m,h,i]),re=(0,l.useCallback)(async()=>{const e=(0,S.YG)(i);if(e&&x.Ay.isMixedInto(d)){const t=d.mapItems.find(e=>x.PI.is(e)),o=t&&x.PI.is(t)&&t.imageryProvider;if(o){const t=[De(m,e,o),De(h,e,o)];(await Promise.all(t)).some(e=>e)?(0,r.h5)(()=>D(e)):(0,r.h5)(()=>(0,S.nq)(i))}}},[m,h,d,i]);(0,l.useEffect)(()=>{const{latitude:e,longitude:t,height:o}=M.timeFilterCoordinates;void 0!==e&&void 0!==t?(D({latitude:e,longitude:t,height:o}),(0,S.nq)(i)):re()},[M.timeFilterCoordinates,re,i]);const ne=(0,l.useCallback)(()=>{n.closeTool()},[n]),le=M.isShowingDiff,se=v&&E&&R&&void 0!==Y;return(0,F.jsx)(O.A,{viewState:n,title:f("diffTool.title"),icon:w.SV.difference,onClose:()=>{ie(),ne()},children:(0,F.jsxs)(ke,{children:[le&&(0,F.jsx)(P.Ay,{medium:!0,textLight:!0,children:f("diffTool.differenceResultsTitle")}),(0,F.jsx)(P.Ay,{textLight:!0,children:f("diffTool.instructions.paneDescription")}),(0,F.jsx)(ye,{children:(0,F.jsxs)(fe,{children:[(0,F.jsxs)(k.Ay,{children:[(0,F.jsxs)(P.Ay,{medium:!0,children:[f("diffTool.labels.area"),":"]}),(0,F.jsxs)("div",{children:[(0,F.jsx)(P.Ay,{bold:!0,textLight:!0,children:f(v?"diffTool.locationDisplay.locationSelected.title":"diffTool.locationDisplay.noLocationSelected.title")}),(0,F.jsx)(P.Ay,{light:!0,textLight:!0,small:!0,children:f(v?"diffTool.locationDisplay.locationSelected.description":"diffTool.locationDisplay.noLocationSelected.description")})]})]}),(0,F.jsxs)(k.Ay,{children:[(0,F.jsxs)(P.Ay,{medium:!0,children:[f("diffTool.labels.dates"),":"]}),(0,F.jsxs)(k.Ay,{column:!0,alignItemsFlexStart:!0,children:[E&&(0,F.jsxs)(P.Ay,{large:!0,children:["(A)"," ",(0,o.Ay)(u.A.toDate(E),"dd/mm/yyyy")]}),!E&&(0,F.jsx)(T.Rg,{onClick:()=>{var e;return null===(e=L.current)||void 0===e?void 0:e.open()},children:(0,F.jsx)(P.yF,{isLink:!0,small:!0,bold:!0,children:f("diffTool.instructions.setDateA")})}),R&&(0,F.jsxs)(P.Ay,{large:!0,children:["(B)"," ",(0,o.Ay)(u.A.toDate(R),"dd/mm/yyyy")]}),!R&&(0,F.jsx)(T.Rg,{onClick:()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.open()},children:(0,F.jsx)(P.yF,{isLink:!0,small:!0,bold:!0,children:f("diffTool.instructions.setDateB")})}),!1===le&&E&&R&&(0,F.jsx)(T.Rg,{onClick:ee,children:(0,F.jsx)(P.yF,{isLink:!0,small:!0,children:f("diffTool.instructions.changeDates")})})]})]})]})}),!le&&(0,F.jsx)(ye,{children:(0,F.jsxs)(he,{viewState:n,value:d.uniqueId,onChange:K,label:f("diffTool.labels.sourceDataset"),children:[(0,F.jsx)("option",{disabled:!0,children:"Select source item"}),W.map(e=>(0,F.jsx)("option",{value:e.uniqueId,children:e.name},e.uniqueId))]})}),!le&&(0,F.jsxs)(ye,{children:[(0,F.jsxs)(he,{viewState:n,spacingBottom:!0,value:J,onChange:q,label:f("diffTool.labels.previewStyle"),children:[(0,F.jsx)("option",{disabled:!0,value:"",children:f("diffTool.choosePreview")}),null===(t=M.styleSelectableDimensions)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.options)||void 0===t?void 0:t.map(e=>(0,F.jsx)("option",{value:e.id,children:e.name},e.id))]}),U&&(0,F.jsx)(Ae,{width:"100%",src:U})]}),(0,F.jsxs)(ye,{children:[(0,F.jsxs)(he,{viewState:n,value:Y||"",onChange:V,label:f("diffTool.labels.differenceOutput"),children:[(0,F.jsx)("option",{disabled:!0,value:"",children:f("diffTool.chooseDifference")}),H.map(e=>(0,F.jsx)("option",{value:e.id,children:e.name},e.id))]}),le&&G&&(0,F.jsx)(Ae,{width:"100%",src:G})]}),!le&&(0,F.jsxs)("div",{children:[(0,F.jsx)(me,{onClick:te,disabled:!se,"aria-describedby":"TJSDifferenceDisabledButtonPrompt",children:(0,F.jsx)(P.yF,{large:!0,children:f("diffTool.labels.generateDiffButtonText")})}),!se&&(0,F.jsxs)(Te,{children:[(0,F.jsx)(we,{children:(0,F.jsx)(w.vE,{fillColor:"#ccc",styledWidth:"16px",styledHeight:"16px",glyph:w.SV.info})}),(0,F.jsx)(P.Ay,{small:!0,light:!0,textLight:!0,id:"TJSDifferenceDisabledButtonPrompt",children:f("diffTool.labels.disabledButtonPrompt")})]})]}),le&&(0,F.jsxs)(k.Ay,{centered:!0,left:!0,children:[(0,F.jsx)(ue,{transparentBg:!0,onClick:ie,$_css:A.textLight,$_css2:A.textLight,children:(0,F.jsxs)(k.QA,{centered:!0,children:[(0,F.jsx)(Ie,{light:!0,styledWidth:"16px",glyph:w.SV.arrowDown}),(0,F.jsx)(P.yF,{medium:!0,children:f("general.back")})]})}),(0,F.jsx)(Ce,{primary:!0,onClick:ne,children:(0,F.jsx)(P.yF,{medium:!0,children:f("diffTool.labels.saveToWorkbench")})})]}),!le&&(0,F.jsx)(oe,{terria:i,location:v,onPicking:Z,onPicked:$}),!le&&s.createPortal((0,F.jsxs)(k.Ay,{centered:!0,fullWidth:!0,flexWrap:!0,backgroundColor:A.dark,children:[(0,F.jsx)(z,{ref:L,heading:f("diffTool.labels.dateComparisonA"),item:m,onDateSet:()=>Q(m)}),(0,F.jsx)(pe,{location:v,isPickingNewLocation:C}),(0,F.jsx)(z,{ref:B,heading:f("diffTool.labels.dateComparisonB"),item:h,onDateSet:()=>Q(h)})]}),document.getElementById("TJS-BottomDockLastPortal"))]})})});ce.displayName="Main";const de=(0,c.Ay)(T.Ay).attrs({secondary:!0}).withConfig({displayName:"DiffTool__BackButton",componentId:"sc-3vyhxu-0"})([""]);var ue=(0,c.Ay)(de).withConfig({displayName:"DiffTool___StyledBackButton",componentId:"sc-3vyhxu-1"})(["color:",";border-color:",";"],e=>e.$_css,e=>e.$_css2);const me=(0,c.Ay)(T.Ay).attrs({primary:!0,fullWidth:!0}).withConfig({displayName:"DiffTool__GenerateButton",componentId:"sc-3vyhxu-2"})([""]),he=e=>(0,F.jsx)(k.Ay,{fullWidth:!0,column:!0,children:(0,F.jsxs)("label",{children:[(0,F.jsx)(Pe,{textLight:!0,$_css3:"p {margin: 0;}",children:(0,B._)("".concat(e.label,":"),{injectTermsAsTooltips:!0,tooltipTerms:e.viewState.terria.configParameters.helpContentTerms})}),(0,F.jsx)(C.Ay,{bottom:1}),(0,F.jsx)(I.A,le(le({},e),{},{children:e.children})),e.spacingBottom&&(0,F.jsx)(C.Ay,{bottom:2})]})}),pe=e=>{const{location:t,isPickingNewLocation:i}=e,{t:o}=(0,a.B)();let r="-";if(t){const{longitude:e,latitude:i}=(0,A.A)(t.longitude,t.latitude,{digits:2});r="".concat(e," ").concat(i)}return(0,F.jsxs)(_e,{column:!0,centered:!0,styledMinWidth:"230px",children:[(0,F.jsxs)(k.Ay,{centered:!0,children:[(0,F.jsx)(w.vE,{light:!0,styledWidth:"16px",glyph:w.SV.location2}),(0,F.jsx)(C.Ay,{right:2}),(0,F.jsx)(P.Ay,{textLight:!0,extraLarge:!0,children:o("diffTool.labels.areaFilterSelection")})]}),(0,F.jsx)(C.Ay,{bottom:3}),(0,F.jsx)(k.Ay,{styledMinHeight:"40px",children:i?(0,F.jsx)(Le,{textLight:!0,extraExtraLarge:!0,bold:!0,children:(0,F.jsx)(M.A,{light:!0,message:"Querying ".concat(t?"new":""," position...")})}):(0,F.jsx)(P.Ay,{textLight:!0,bold:!0,heading:!0,textAlignCenter:!0,children:r})})]})},ye=c.Ay.div.withConfig({displayName:"DiffTool__Group",componentId:"sc-3vyhxu-3"})(["background-color:",";padding:15px;border-radius:5px;"],e=>e.theme.darkWithOverlay),fe=(0,c.Ay)(k.Ay).attrs({column:!0}).withConfig({displayName:"DiffTool__LocationAndDatesDisplayBox",componentId:"sc-3vyhxu-4"})(["color:",";padding:15px;> ",":first-child{margin-bottom:13px;}> div > div:first-child{margin-right:5px;min-width:50px;}"],e=>e.theme.textLight,k.Ay),Ae=function(e){return(0,F.jsx)("img",le(le({},e),{},{style:{display:"none",marginTop:"10px"},onLoad:e=>e.currentTarget.style.display="block",onError:e=>e.currentTarget.style.display="none"}))};async function ge(e,t){const i=e.terria,o=new v.A((0,h.A)(),i);return o.setTrait(b.A.user,"splitSourceItemId",e.uniqueId),i.addModel(o),await o.loadReference(),(0,r.h5)(()=>{var e;if(void 0===o.target)throw Error("failed to split item");const r=o.target;r.setTrait(b.A.user,"show",!0),r.setTrait(b.A.user,"splitDirection",t),r.setTrait(b.A.user,"currentTime",null),r.setTrait(b.A.user,"initialTimeSource","none"),je(r)&&r.setTrait(b.A.user,"opacity",0),(0,j.A)(r,b.A.user,{featureInfoTemplate:{template:""}}),xe(r);const n=null===(e=r.styleSelectableDimensions)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.options)||void 0===e?void 0:e.find(e=>(0,f.A)(e.name)&&e.name.search(/true/i)>=0);var l;return null!=n&&n.id&&(null===(l=r.styleSelectableDimensions)||void 0===l||null===(l=l[0])||void 0===l||l.setDimensionValue(b.A.user,n.id)),i.overlays.add(r),r})}function xe(e){if(void 0!==e.diffStyleId)return;const t=(0,y.A)(e.availableDiffStyles.map(t=>{var i;return null===(i=e.styleSelectableDimensions)||void 0===i||null===(i=i[0])||void 0===i||null===(i=i.options)||void 0===i?void 0:i.find(e=>e.id===t)}));1===t.length&&e.setTrait(b.A.user,"diffStyleId",t[0].id)}function ve(e){const t=e.terria;t.overlays.remove(e),e.sourceReference&&!1===t.workbench.contains(e)&&t.removeModelReferences(e.sourceReference)}function be(e,t){var i;if(!x.Ay.isMixedInto(t))return!1;const o=null===(i=e.imageryLayer)||void 0===i?void 0:i.imageryProvider;return void 0!==o&&void 0!==t.mapItems.find(e=>x.PI.is(e)&&e.imageryProvider===o)}function De(e,t,i){const o=new d.A(m.A.toRadians(t.longitude),m.A.toRadians(t.latitude)),r=i.tilingScheme.positionToTileXY(o,30);return e.setTimeFilterFromLocation({position:{latitude:t.latitude,longitude:t.longitude,height:t.height},tileCoords:{x:r.x,y:r.y,level:30}})}function je(e){return(0,D.A)(e,_.A,"opacity")}const Se=ae;var ke=(0,c.Ay)("div").withConfig({displayName:"DiffTool___StyledDiv",componentId:"sc-3vyhxu-5"})(["display:flex;flex-direction:column;height:100%;padding:15px;gap:20px;"]),Te=(0,c.Ay)("div").withConfig({displayName:"DiffTool___StyledDiv2",componentId:"sc-3vyhxu-6"})(["display:flex;flex-direction:row;padding:5px;"]),we=(0,c.Ay)("div").withConfig({displayName:"DiffTool___StyledDiv3",componentId:"sc-3vyhxu-7"})(["margin-right:10px;"]),Ie=(0,c.Ay)(w.vE).withConfig({displayName:"DiffTool___StyledStyledIcon",componentId:"sc-3vyhxu-8"})(["transform:rotate(90deg);"]),Ce=(0,c.Ay)(T.Ay).withConfig({displayName:"DiffTool___StyledButton",componentId:"sc-3vyhxu-9"})(["flex-grow:1;margin-left:10px;"]),Pe=(0,c.Ay)(P.Ay).withConfig({displayName:"DiffTool___StyledText",componentId:"sc-3vyhxu-10"})(["",""],e=>e.$_css3),_e=(0,c.Ay)(k.Ay).withConfig({displayName:"DiffTool___StyledBox",componentId:"sc-3vyhxu-11"})(["@media (max-width:","px){width:100%;}"],e=>e.theme.md),Le=(0,c.Ay)(P.Ay).withConfig({displayName:"DiffTool___StyledText2",componentId:"sc-3vyhxu-12"})(["fill:",";"],e=>{let{theme:t}=e;return t.textLight})}}]);