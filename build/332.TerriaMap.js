"use strict";((self||window).webpackChunkterriajs_map=(self||window).webpackChunkterriajs_map||[]).push([[332],{3332:(e,t,r)=>{r.r(t),r.d(t,{default:()=>we});var n,i=r(8711),s=(r(9391),r(27495),r(62953),r(27813)),a=r(31370),o=r(96540),l=r(16943),c=r(76970),u=r(59895),d=r(41333),h=r(38398),m=r(42007),f=r(31459),p=r(74848);const g=e=>{let{children:t,onClick:r}=e;const n=(0,i.DP)();return(0,p.jsx)(x,{transparentBg:!0,onClick:r,$_css:n.textLight,$_css2:n.textLight,children:(0,p.jsxs)(u.QA,{centered:!0,children:[(0,p.jsx)(b,{light:!0,styledWidth:"16px",glyph:f.SV.arrowDown}),(0,p.jsx)(m.yF,{noFontSize:!0,children:t})]})})};var v,y,x=(0,i.Ay)(h.Ay)(n||(v=["\n        color: ",";\n        border-color: ",";\n        margin: 2em 0 1em 0;\n      "],y||(y=v.slice(0)),n=Object.freeze(Object.defineProperties(v,{raw:{value:Object.freeze(y)}}))),e=>e.$_css,e=>e.$_css2),b=(0,i.Ay)(f.vE).withConfig({displayName:"BackButton___StyledStyledIcon",componentId:"sc-7kx2ba-0"})(["transform:rotate(90deg);"]);const j=e=>{let{children:t}=e;return(0,p.jsx)(m.Ay,{large:!0,textLight:!0,children:t})};var S=r(42719);const w=(0,i.Ay)(S.A).attrs(e=>({light:!0,message:e.children})).withConfig({displayName:"Loading",componentId:"sc-ln0ull-0"})(["align-self:center;"]),A=w;var C=r(66401),_=r(18492),O=r(46005);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){P(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function P(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const R=e=>{const{parameter:t}=e;switch(t.type){case"numeric":return(0,p.jsx)(z,I(I({},e),{},{parameter:t}));case"enum":return(0,p.jsx)(E,I(I({},e),{},{parameter:t}));case"text":return(0,p.jsx)(N,I(I({},e),{},{parameter:t}))}},z=e=>{var t,r;const{parameter:n,value:i,t:s}=e,{min:a,max:o}=n.range,l=t=>r=>{const n=parseFloat(r.target.value),i=I({},e.value);isNaN(n)?delete i[t]:i[t]=n,e.onChange((0,C.A)(i)?void 0:i)};return(0,p.jsxs)(u.Ay,{column:!0,children:[(0,p.jsx)(L,{children:n.name}),(0,p.jsxs)(H,{children:[(0,p.jsx)(q,{children:(0,p.jsxs)(u.Ay,{column:!0,children:[(0,p.jsx)(m.Ay,{small:!0,children:s("itemSearchTool.numericParameter.minimum")}),(0,p.jsx)($,{type:"number",name:"".concat(n.id,"-min"),value:null!==(t=null==i?void 0:i.start)&&void 0!==t?t:"",min:a,max:o,step:"any",placeholder:a.toString(),onChange:l("start")})]})}),(0,p.jsx)(q,{children:(0,p.jsxs)(u.Ay,{column:!0,children:[(0,p.jsx)(m.Ay,{small:!0,children:s("itemSearchTool.numericParameter.maximum")}),(0,p.jsx)($,{type:"number",name:"".concat(n.id,"-max"),value:null!==(r=null==i?void 0:i.end)&&void 0!==r?r:"",min:a,max:o,step:"any",placeholder:o.toString(),onChange:l("end")})]})})]})]})},E=e=>{const{parameter:t,disabled:r}=e,n=t.values.map(e=>{let{id:t}=e;return{value:t,label:t||"<empty>"}}),i=n.filter(t=>{var r;return null===(r=e.value)||void 0===r?void 0:r.includes(t.value)});return(0,p.jsx)(u.Ay,{column:!0,children:(0,p.jsxs)(D,{children:[(0,p.jsx)(L,{children:t.name}),(0,p.jsx)(W,{name:t.id,options:n,isMulti:!0,value:i,menuPosition:"fixed",onChange:t=>{const r=null==t?void 0:t.map(e=>{let{value:t}=e;return t});e.onChange(0===(null==r?void 0:r.length)?void 0:r)},isDisabled:r})]})})},N=e=>{const{parameter:t,value:r,onChange:n}=e;return(0,p.jsx)(u.Ay,{column:!0,children:(0,p.jsxs)(D,{children:[(0,p.jsx)(L,{children:t.name}),(0,p.jsx)($,{type:"text",name:t.id,value:r||"",onChange:e=>n(e.target.value?e.target.value:void 0)})]})})},T=i.Ay.form.withConfig({displayName:"SearchForm__Form",componentId:"sc-1vi7mg7-0"})(["width:100%;"]),F=i.Ay.fieldset.withConfig({displayName:"SearchForm__FieldSet",componentId:"sc-1vi7mg7-1"})(["border:0;margin:0;padding:0;min-width:0;"]),M=(0,i.Ay)(h.Ay).withConfig({displayName:"SearchForm__SearchButton",componentId:"sc-1vi7mg7-2"})(["margin:10px 10px 0 0;"]),B=(0,i.Ay)(u.Ay).attrs({column:!0,paddedVertically:!0}).withConfig({displayName:"SearchForm__Field",componentId:"sc-1vi7mg7-3"})([""]),L=(0,i.Ay)(m.Ay).attrs({semiBold:!0,breakWord:!0}).withConfig({displayName:"SearchForm__ParameterName",componentId:"sc-1vi7mg7-4"})([""]),D=i.Ay.label.withConfig({displayName:"SearchForm__Label",componentId:"sc-1vi7mg7-5"})([""]),q=(0,i.Ay)(D).withConfig({displayName:"SearchForm__HalfWidthLabel",componentId:"sc-1vi7mg7-6"})(["width:45%;&:first-child{margin-right:1em;}"]),$=i.Ay.input.withConfig({displayName:"SearchForm__Input",componentId:"sc-1vi7mg7-7"})(["color:",";box-sizing:border-box;width:100%;height:38px;font-size:1.1em;"],e=>e.theme.dark),W=(0,i.Ay)(O.Ay).attrs({classNamePrefix:"ReactSelect"}).withConfig({displayName:"SearchForm__Select",componentId:"sc-1vi7mg7-8"})(["color:",";width:100%;& .ReactSelect__control{border-radius:0;}"],e=>e.theme.dark),V=(0,l.C)()(e=>{const{parameters:t,itemSearchProvider:r}=e,[n]=(0,_.B)(),[i,s]=(0,o.useState)({is:"initial"}),[a,l]=(0,o.useState)(e.query);(0,o.useEffect)(function(){l(e.query)},[e.query]);const c="searching"===i.is;return(0,p.jsxs)(T,{onSubmit:t=>{try{!function(){const t=new Map(Object.entries(a).map(e=>{let[t,{value:r}]=e;return[t,r]}));s({is:"searching"}),r.search(t).then(t=>{s({is:"results",results:t}),e.onResults(a,t)}).catch(e=>{console.warn(e),s({is:"error",error:e})})}()}finally{t.preventDefault()}},children:[(0,p.jsxs)(u.Ay,{centered:!0,children:["searching"===i.is&&(0,p.jsx)(A,{children:n("itemSearchTool.searching")}),"error"===i.is&&(0,p.jsx)(j,{children:n("itemSearchTool.searchError")})]}),(0,p.jsxs)(F,{disabled:c,children:[t.map(t=>{var r,i,s;return(0,p.jsx)(B,{children:(0,p.jsx)(R,{parameter:t,onChange:(i=t.id,s=t.type,t=>{var r;const n=I(I({},a),{},{[i]:{type:s,value:t}});void 0===n[i].value&&delete n[i],l(n),void 0!==t&&(null===(r=e.onValueChange)||void 0===r||r.call(e,i,t))}),value:null===(r=a[t.id])||void 0===r?void 0:r.value,disabled:c,t:n})},t.id)}),(0,p.jsx)(M,{primary:!0,type:"submit",disabled:c,children:n("itemSearchTool.searchBtnText")}),(0,p.jsx)(h.Ay,{secondary:!0,type:"reset",onClick:()=>l({}),disabled:c,children:n("itemSearchTool.resetBtnText")})]})]})});var H=(0,i.Ay)(u.Ay).withConfig({displayName:"SearchForm___StyledBox",componentId:"sc-1vi7mg7-9"})(["justify-content:space-between;"]),G=r(57965),Q=r.n(G);function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y.apply(this,arguments)}var J,K=["bottom","height","left","right","top","width"],U=new Map,X=function e(){var t=[];U.forEach(function(e,r){var n,i,s=r.getBoundingClientRect();n=s,i=e.rect,void 0===n&&(n={}),void 0===i&&(i={}),K.some(function(e){return n[e]!==i[e]})&&(e.rect=s,t.push(e))}),t.forEach(function(e){e.callbacks.forEach(function(t){return t(e.rect)})}),J=window.requestAnimationFrame(e)},Z="undefined"!=typeof window?o.useLayoutEffect:o.useEffect;function ee(e,t){void 0===t&&(t={width:0,height:0});var r=o.useState(e.current),n=r[0],i=r[1],s=o.useReducer(te,t),a=s[0],l=s[1],c=o.useRef(!1);return Z(function(){e.current!==n&&i(e.current)}),Z(function(){if(n&&!c.current){c.current=!0;var e=n.getBoundingClientRect();l({rect:e})}},[n]),o.useEffect(function(){if(n){var e,t,r=(e=n,t=function(e){l({rect:e})},{observe:function(){var r=0===U.size;U.has(e)?U.get(e).callbacks.push(t):U.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),r&&X()},unobserve:function(){var r=U.get(e);if(r){var n=r.callbacks.indexOf(t);n>=0&&r.callbacks.splice(n,1),r.callbacks.length||U.delete(e),U.size||cancelAnimationFrame(J)}}});return r.observe(),function(){r.unobserve()}}},[n]),a}function te(e,t){var r=t.rect;return e.height!==r.height||e.width!==r.width?r:e}var re=function(){return 50},ne=function(e){return e},ie=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},se=function(e){for(var t=Math.max(e.start-e.overscan,0),r=Math.min(e.end+e.overscan,e.size-1),n=[],i=t;i<=r;i++)n.push(i);return n};var ae=function(e,t,r,n){for(;e<=t;){var i=(e+t)/2|0,s=r(i);if(s<n)e=i+1;else{if(!(s>n))return i;t=i-1}}return e>0?e-1:0},oe=r(15873);const le=e=>{let{item:t,results:r,effect:n}=e;switch(n.is){case"highlightAll":return(0,p.jsx)(ue,{item:t,results:r});case"highlightSingleResult":return(0,p.jsx)(ue,{item:t,results:n.result});case"showMatchingOnly":return(0,p.jsx)(ce,{item:t,results:r});case"none":return null}},ce=e=>{const{item:t,results:r}=e;return(0,o.useEffect)(()=>t.hideFeaturesNotInItemSearchResults(r),[t,r]),null},ue=e=>((0,o.useEffect)(()=>{const t=e.item,r=Array.isArray(e.results)?e.results:[e.results];return 1===r.length&&function(e,t){e.zoomToItemSearchResult(t)}(t,r[0]),t.highlightFeaturesFromItemSearchResults(r)},[e.item,e.results]),null),de=["index"],he=(0,a.PA)(e=>{const{result:t,template:r,isEven:n,isSelected:i,style:s}=e,a=r?(0,oe.A)(Q().render(r,t.properties)):t.id;return(0,p.jsx)(me,{role:"button",isEven:n,isSelected:i,onClick:r=>{try{e.onClick(t)}finally{r.preventDefault()}},style:s,children:a})}),me=i.Ay.a.withConfig({displayName:"SearchResults__ClickableItem",componentId:"sc-mpaxje-0"})(["display:block;box-sizing:border-box;padding:5px 10px;cursor:pointer;",""],e=>"background-color: ".concat(e.isSelected?e.theme.toolPrimaryColor:e.isEven?e.theme.dark:e.theme.darkLighter,";")),fe=i.Ay.div.withConfig({displayName:"SearchResults__List",componentId:"sc-mpaxje-1"})(["",";width:100%;overflow:auto;"],e=>"height: ".concat(e.height)),pe=i.Ay.div.withConfig({displayName:"SearchResults__ListInner",componentId:"sc-mpaxje-2"})(["",";width:100%;position:relative;"],e=>"height: ".concat(e.height)),ge=(0,i.Ay)(u.Ay).attrs({column:!0,flex:1}).withConfig({displayName:"SearchResults__Wrapper",componentId:"sc-mpaxje-3"})(["> :only-child{flex:1;align-self:center;align-items:center;}"]),ve=e=>{let{count:t}=e;const[r]=(0,_.B)();return(0,p.jsx)(je,{$_css:0===t?"align-self: center;":"",children:r("itemSearchTool.resultsCount",{count:t})})},ye=(0,i.Ay)(h.Ay).attrs(e=>({primary:e.selected,secondary:!e.selected,textProps:{medium:!0}})).withConfig({displayName:"SearchResults__ActionButton",componentId:"sc-mpaxje-4"})(["min-height:20px;padding:1em;padding-top:2px;padding-bottom:2px;border:0px;border-radius:5px;"]),xe=i.Ay.div.withConfig({displayName:"SearchResults__ActionMenu",componentId:"sc-mpaxje-5"})(["display:flex;justify-content:flex-end;padding:0.5em;background-color:",";border-top-left-radius:5px;border-top-right-radius:5px;> ",":first-child{margin-right:1em;}"],e=>e.theme.charcoalGrey,ye),be=e=>{const{item:t,results:r}=e,[n,i]=(0,o.useState)({is:"highlightAll"}),s="highlightSingleResult"===n.is?n.result:void 0,a=(0,o.useRef)(null),l=function(e){var t,r=e.size,n=void 0===r?0:r,i=e.estimateSize,s=void 0===i?re:i,a=e.overscan,l=void 0===a?1:a,c=e.paddingStart,u=void 0===c?0:c,d=e.paddingEnd,h=void 0===d?0:d,m=e.parentRef,f=e.horizontal,p=e.scrollToFn,g=e.useObserver,v=e.initialRect,y=e.onScrollElement,x=e.scrollOffsetFn,b=e.keyExtractor,j=void 0===b?ne:b,S=e.measureSize,w=void 0===S?ie:S,A=e.rangeExtractor,C=void 0===A?se:A,_=f?"width":"height",O=f?"scrollLeft":"scrollTop",k=o.useRef({scrollOffset:0,measurements:[]}),I=o.useState(0),P=I[0],R=I[1];k.current.scrollOffset=P;var z=(g||ee)(m,v)[_];k.current.outerSize=z;var E=o.useCallback(function(e){m.current&&(m.current[O]=e)},[m,O]),N=p||E;p=o.useCallback(function(e){N(e,E)},[E,N]);var T=o.useState({}),F=T[0],M=T[1],B=o.useCallback(function(){return M({})},[]),L=o.useRef([]),D=o.useMemo(function(){var e=L.current.length>0?Math.min.apply(Math,L.current):0;L.current=[];for(var t=k.current.measurements.slice(0,e),r=e;r<n;r++){var i=j(r),a=F[i],o=t[r-1]?t[r-1].end:u,l="number"==typeof a?a:s(r),c=o+l;t[r]={index:r,start:o,size:l,end:c,key:i}}return t},[s,F,u,n,j]),q=((null==(t=D[n-1])?void 0:t.end)||u)+h;k.current.measurements=D,k.current.totalSize=q;var $=y?y.current:m.current,W=o.useRef(x);W.current=x,Z(function(){if($){var e=function(e){var t=W.current?W.current(e):$[O];R(t)};return e(),$.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){$.removeEventListener("scroll",e)}}R(0)},[$,O]);var V=function(e){for(var t=e.measurements,r=e.outerSize,n=e.scrollOffset,i=t.length-1,s=ae(0,i,function(e){return t[e].start},n),a=s;a<i&&t[a].end<n+r;)a++;return{start:s,end:a}}(k.current),H=V.start,G=V.end,Q=o.useMemo(function(){return C({start:H,end:G,overscan:l,size:D.length})},[H,G,l,D.length,C]),J=o.useRef(w);J.current=w;var K=o.useMemo(function(){for(var e=[],t=function(t,r){var n=Q[t],i=Y(Y({},D[n]),{},{measureRef:function(e){if(e){var t=J.current(e,f);if(t!==i.size){var r=k.current.scrollOffset;i.start<r&&E(r+(t-i.size)),L.current.push(n),M(function(e){var r;return Y(Y({},e),{},((r={})[i.key]=t,r))})}}}});e.push(i)},r=0,n=Q.length;r<n;r++)t(r);return e},[Q,E,f,D]),U=o.useRef(!1);Z(function(){U.current&&M({}),U.current=!0},[s]);var X=o.useCallback(function(e,t){var r=(void 0===t?{}:t).align,n=void 0===r?"start":r,i=k.current,s=i.scrollOffset,a=i.outerSize;"auto"===n&&(n=e<=s?"start":e>=s+a?"end":"start"),"start"===n?p(e):"end"===n?p(e-a):"center"===n&&p(e-a/2)},[p]),te=o.useCallback(function(e,t){var r=void 0===t?{}:t,i=r.align,s=void 0===i?"auto":i,a=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(r,["align"]),o=k.current,l=o.measurements,c=o.scrollOffset,u=o.outerSize,d=l[Math.max(0,Math.min(e,n-1))];if(d){if("auto"===s)if(d.end>=c+u)s="end";else{if(!(d.start<=c))return;s="start"}var h="center"===s?d.start+d.size/2:"end"===s?d.end:d.start;X(h,Y({align:s},a))}},[X,n]),oe=o.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];te.apply(void 0,t),requestAnimationFrame(function(){te.apply(void 0,t)})},[te]);return{virtualItems:K,totalSize:q,scrollToOffset:X,scrollToIndex:oe,measure:B}}({size:r.length,parentRef:a,estimateSize:(0,o.useCallback)(()=>50,[])}),[c]=(0,_.B)(),u=e=>{n.is===e.is&&n.result===e.result?i({is:"none"}):i(e)};return(0,p.jsxs)(ge,{children:[(0,p.jsx)(ve,{count:r.length}),(0,p.jsxs)(xe,{children:[(0,p.jsx)(ye,{selected:"highlightAll"===n.is,onClick:()=>u({is:"highlightAll"}),children:c("itemSearchTool.actions.highlightAll")}),(0,p.jsx)(ye,{selected:"showMatchingOnly"===n.is,onClick:()=>u({is:"showMatchingOnly"}),children:c("itemSearchTool.actions.showMatchingOnly")})]}),(0,p.jsx)(fe,{ref:a,height:"250px",children:(0,p.jsx)(pe,{height:"".concat(l.totalSize,"px"),children:l.virtualItems.map(t=>{let{index:n}=t,i=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(t,de);return(0,p.jsx)(he,{result:r[n],isSelected:r[n].id===(null==s?void 0:s.id),isEven:n%2==0,onClick:()=>u({is:"highlightSingleResult",result:r[n]}),template:e.template,style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(i.size,"px"),transform:"translateY(".concat(i.start,"px)")}},r[n].id)})})}),(0,p.jsx)(le,{effect:n,item:t,results:r})]})};var je=(0,i.Ay)(u.Ay).withConfig({displayName:"SearchResults___StyledBox",componentId:"sc-mpaxje-6"})(["margin-bottom:1em;",""],e=>e.$_css);const Se=(0,a.PA)(e=>{var t;const{viewState:r,item:n,itemSearchProvider:i,t:a}=e,l=c.A.isMixedInto(n)?n.name:"Item",[u,h]=(0,o.useState)({is:"loadingParameters"}),[m,f]=(0,o.useState)([]),[v,y]=(0,o.useState)({});(0,o.useEffect)(function(){i.initialize().then(()=>i.describeParameters().then(e=>{h({is:"search"}),f(e),y({})})).catch(e=>{console.warn(e),h({is:"error",error:e})}).finally(()=>{var t;return null===(t=e.afterLoad)||void 0===t?void 0:t.call(e)})},[i]),(0,o.useEffect)(function(){const e=function(e){return(0,s.fm)(()=>{!1!==e.show&&!1!==e.terria.workbench.contains(e)||r.closeTool()})}(n);return e},[n]);const x=null===(t=i.loadParameterHint)||void 0===t?void 0:t.bind(i);return(0,p.jsx)(d.w,{viewState:r,title:a("itemSearchTool.title",{itemName:l}),children:(0,p.jsxs)(d.g,{textLight:!0,light:!0,children:[(0,p.jsxs)(Ae,{centered:!0,children:["loadingParameters"===u.is&&(0,p.jsx)(A,{children:a("itemSearchTool.loading")}),"error"===u.is&&(0,p.jsx)(j,{children:a("itemSearchTool.loadError")}),"search"===u.is&&0===m.length&&(0,p.jsx)(j,{children:a("itemSearchTool.noParameters")})]}),"search"===u.is&&m.length>0&&(0,p.jsx)(V,{itemSearchProvider:i,parameters:m,query:v,onResults:(e,t)=>{y(e),h({is:"results",results:t})},onValueChange:x}),"results"===u.is&&(0,p.jsx)(be,{item:n,results:u.results,template:n.search.resultTemplate}),"results"===u.is&&(0,p.jsx)(g,{onClick:()=>h({is:"search"}),children:a("itemSearchTool.backBtnText")})]})})}),we=(0,l.C)()(Se);var Ae=(0,i.Ay)(u.Ay).withConfig({displayName:"ItemSearchTool___StyledBox",componentId:"sc-uahz0f-0"})(["text-align:center;"])}}]);