((self||window).webpackChunkterriajs_map=(self||window).webpackChunkterriajs_map||[]).push([[40],{4767:(e,t,r)=>{"use strict";r.d(t,{A:()=>T}),r(94490),r(27495),r(25440),r(62953);var i=r(89911),o=r(66406),n=r(89997),a=r(56870),s=r(57009),l=r(44646);function c(e,t){this._conditionsExpression=(0,o.A)(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,function(e,t){const r=[],i=e._conditions;if(!(0,a.A)(i))return;const o=i.length;for(let e=0;e<o;++e){const o=i[e],n=String(o[0]),a=String(o[1]);r.push(new u(new l.A(n,t),new l.A(a,t)))}e._runtimeConditions=r}(this,t)}function u(e,t){this.condition=e,this.expression=t}Object.defineProperties(c.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),c.prototype.evaluate=function(e,t){const r=this._runtimeConditions;if(!(0,a.A)(r))return;const i=r.length;for(let o=0;o<i;++o){const i=r[o];if(i.condition.evaluate(e))return i.expression.evaluate(e,t)}},c.prototype.evaluateColor=function(e,t){const r=this._runtimeConditions;if(!(0,a.A)(r))return;const i=r.length;for(let o=0;o<i;++o){const i=r[o];if(i.condition.evaluate(e))return i.expression.evaluateColor(e,t)}},c.prototype.getShaderFunction=function(e,t,r,i){const o=this._runtimeConditions;if(!(0,a.A)(o)||0===o.length)return;let n="";const s=o.length;for(let e=0;e<s;++e){const i=o[e],a=i.condition.getShaderExpression(t,r),s=i.expression.getShaderExpression(t,r);n+="    ".concat(0===e?"if":"else if"," (").concat(a,")\n")+"    {\n"+"        return ".concat(s,";\n")+"    }\n"}return n="".concat(i," ").concat(e,"\n")+"{\n".concat(n,"    return ").concat(i,"(1.0);\n")+"}\n",n},c.prototype.getVariables=function(){let e=[];const t=this._runtimeConditions;if(!(0,a.A)(t)||0===t.length)return e;const r=t.length;for(let o=0;o<r;++o){const r=t[o];(0,i.A)(e,r.condition.getVariables()),(0,i.A)(e,r.expression.getVariables())}return e=e.filter(function(e,t,r){return r.indexOf(e)===t}),e};const p=c;function d(e){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,function(e,t){var r;t=null!==(r=(0,o.A)(t,!0))&&void 0!==r?r:e._style,e._style=t,e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;const i={};if((0,a.A)(t.meta)){var s;const e=t.defines,r=null!==(s=t.meta)&&void 0!==s?s:n.A.EMPTY_OBJECT;for(const t in r)r.hasOwnProperty(t)&&(i[t]=new l.A(r[t],e))}e._meta=i,e._ready=!0}(this,e)}function h(e,t){var r;const i=(null!==(r=e._style)&&void 0!==r?r:n.A.EMPTY_OBJECT).defines;if((0,a.A)(t))return"boolean"==typeof t||"number"==typeof t?new l.A(String(t)):"string"==typeof t?new l.A(t,i):(0,a.A)(t.conditions)?new p(t,i):t}function m(e){if((0,a.A)(e))return(0,a.A)(e.expression)?e.expression:(0,a.A)(e.conditionsExpression)?(0,o.A)(e.conditionsExpression,!0):e}Object.defineProperties(d.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(e){this._show=h(this,e),this._style.show=m(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(e){this._color=h(this,e),this._style.color=m(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=h(this,e),this._style.pointSize=m(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=h(this,e),this._style.pointOutlineColor=m(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=h(this,e),this._style.pointOutlineWidth=m(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(e){this._labelColor=h(this,e),this._style.labelColor=m(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(e){this._labelOutlineColor=h(this,e),this._style.labelOutlineColor=m(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=h(this,e),this._style.labelOutlineWidth=m(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(e){this._font=h(this,e),this._style.font=m(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(e){this._labelStyle=h(this,e),this._style.labelStyle=m(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(e){this._labelText=h(this,e),this._style.labelText=m(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=h(this,e),this._style.backgroundColor=m(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){this._backgroundPadding=h(this,e),this._style.backgroundPadding=m(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(e){this._backgroundEnabled=h(this,e),this._style.backgroundEnabled=m(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){this._scaleByDistance=h(this,e),this._style.scaleByDistance=m(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){this._translucencyByDistance=h(this,e),this._style.translucencyByDistance=m(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=h(this,e),this._style.distanceDisplayCondition=m(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(e){this._heightOffset=h(this,e),this._style.heightOffset=m(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=h(this,e),this._style.anchorLineEnabled=m(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(e){this._anchorLineColor=h(this,e),this._style.anchorLineColor=m(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(e){this._image=h(this,e),this._style.image=m(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=h(this,e),this._style.disableDepthTestDistance=m(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin=h(this,e),this._style.horizontalOrigin=m(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin=h(this,e),this._style.verticalOrigin=m(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=h(this,e),this._style.labelHorizontalOrigin=m(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=h(this,e),this._style.labelVerticalOrigin=m(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(e){this._meta=e}}}),d.fromUrl=function(e){return s.A.createIfNeeded(e).fetchJson(e).then(function(e){return new d(e)})},d.prototype.getColorShaderFunction=function(e,t,r){return this._colorShaderFunctionReady?(r.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,(0,a.A)(this.color)&&(0,a.A)(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(e,t,r,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=r.translucent,this._colorShaderFunction)},d.prototype.getShowShaderFunction=function(e,t,r){return this._showShaderFunctionReady||(this._showShaderFunctionReady=!0,(0,a.A)(this.show)&&(0,a.A)(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(e,t,r,"bool"):this._showShaderFunction=void 0),this._showShaderFunction},d.prototype.getPointSizeShaderFunction=function(e,t,r){return this._pointSizeShaderFunctionReady||(this._pointSizeShaderFunctionReady=!0,(0,a.A)(this.pointSize)&&(0,a.A)(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,r,"float"):this._pointSizeShaderFunction=void 0),this._pointSizeShaderFunction},d.prototype.getVariables=function(){let e=[];return(0,a.A)(this.color)&&(0,a.A)(this.color.getVariables)&&(0,i.A)(e,this.color.getVariables()),(0,a.A)(this.show)&&(0,a.A)(this.show.getVariables)&&(0,i.A)(e,this.show.getVariables()),(0,a.A)(this.pointSize)&&(0,a.A)(this.pointSize.getVariables)&&(0,i.A)(e,this.pointSize.getVariables()),e=e.filter(function(e,t,r){return r.indexOf(e)===t}),e};const f=d;var g,y=r(91273),b=r(49835),v=r(27813),w=r(79764),A=r(63647),S=r(53163);function x(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let O=(g=class e extends((0,A.Ay)(b.Ay)){constructor(){super(...arguments),(0,v.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}get opacity(){return 1}},x(g.prototype,"opacity",[v.EW],Object.getOwnPropertyDescriptor(g.prototype,"opacity"),g.prototype),g);function P(e){var t;let r=(t=class extends e{constructor(){super(...arguments),(0,v.Gn)(this),(0,v.h5)(()=>{this.strata.set(O.name,new O)})}get hasCesium3dTilesStyleMixin(){return!0}get highlightColor(){return super.highlightColor||"#ff3f00"}get showExpressionFromFilters(){if(!(0,y.A)(this.filters))return;const e=this.filters.map(e=>{if(!(0,y.A)(e.property))return"";const t="Number(${feature['"+e.property.replace(/'/g,"\\'")+"']})";return[(0,y.A)(e.minimumValue)&&(0,y.A)(e.minimumShown)&&e.minimumShown>e.minimumValue?t+" >= "+e.minimumShown:"",(0,y.A)(e.maximumValue)&&(0,y.A)(e.maximumShown)&&e.maximumShown<e.maximumValue?t+" <= "+e.maximumShown:""].filter(e=>e.length>0).join(" && ")}).filter(e=>e.length>0).join("&&");return e.length>0?e:void 0}get cesiumTileStyle(){if(!((0,y.A)(this.style)||(0,y.A)(this.opacity)&&1!==this.opacity||(0,y.A)(this.showExpressionFromFilters)))return;const e=(0,o.A)((0,v.HO)(this.style)||{}),t=(0,o.A)((0,v.HO)(this.opacity));if((0,y.A)(e.defines)?e.defines=Object.assign(e.defines,{opacity:t}):e.defines={opacity:t},(0,y.A)(e.color)){if("string"==typeof e.color){const t=w.A.fromCssColorString(e.color);(0,y.A)(t)&&(e.color="color('".concat(e.color,"', ${opacity})"))}}else e.color="(rgba((${COLOR}.r === undefined ? 1 : ${COLOR}.r) * 255,(${COLOR}.g === undefined ? 1 : ${COLOR}.g) * 255,(${COLOR}.b === undefined ? 1 : ${COLOR}.b) * 255,${opacity}))";return(0,y.A)(this.showExpressionFromFilters)&&(e.show=(0,v.HO)(this.showExpressionFromFilters)),new f(e)}},x(t.prototype,"highlightColor",[v.$Z],Object.getOwnPropertyDescriptor(t.prototype,"highlightColor"),t.prototype),x(t.prototype,"showExpressionFromFilters",[v.EW],Object.getOwnPropertyDescriptor(t.prototype,"showExpressionFromFilters"),t.prototype),x(t.prototype,"cesiumTileStyle",[v.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumTileStyle"),t.prototype),t);return r}S.A.instance.addLoadStratum(O.name),(P||(P={})).isMixedInto=function(e){return e&&e.hasCesium3dTilesStyleMixin};const T=P},6160:(e,t,r)=>{"use strict";r.d(t,{A:()=>y}),r(94490),r(62953);var i,o,n,a,s,l,c,u=r(39070),p=r(16001),d=r(13568),h=r(92498),m=r(71222);function f(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function g(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let y=(i=(0,p.A)({type:d.A,name:"Origin",description:"The origin of the model, expressed as a longitude and latitude in degrees and a height in meters. If this property is specified, the model's axes will have X pointing East, Y pointing North, and Z pointing Up. If not specified, the model is located in the Earth-Centered Earth-Fixed frame."}),o=(0,p.A)({type:h.A,name:"Rotation",description:"The rotation of the model expressed as heading, pitch and roll in the local frame of reference. Defaults to zero rotation."}),n=(0,m.A)({type:"number",name:"Scale",description:"The scale factor to apply to the model"}),a=class extends u.A{constructor(){super(...arguments),f(this,"origin",s,this),f(this,"rotation",l,this),f(this,"scale",c,this)}},s=g(a.prototype,"origin",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=g(a.prototype,"rotation",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=g(a.prototype,"scale",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)},6585:e=>{var t=1e3,r=60*t,i=60*r,o=24*i,n=7*o;function a(e,t,r,i){var o=t>=1.5*r;return Math.round(e/r)+" "+i+(o?"s":"")}e.exports=function(e,s){s=s||{};var l,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*n;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return s.long?(l=e,(c=Math.abs(l))>=o?a(l,c,o,"day"):c>=i?a(l,c,i,"hour"):c>=r?a(l,c,r,"minute"):c>=t?a(l,c,t,"second"):l+" ms"):function(e){var n=Math.abs(e);return n>=o?Math.round(e/o)+"d":n>=i?Math.round(e/i)+"h":n>=r?Math.round(e/r)+"m":n>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},15752:(e,t,r)=>{var i=r(44582),o=r(84722),n=(r(56559),r(64466)),a=o.DOMImplementation,s=(i.NAMESPACE,n.ParseError);n.XMLReader;function l(){this.cdata=!1}function c(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function u(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function p(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function d(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}l.prototype={startDocument:function(){this.doc=(new a).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,i){var o=this.doc,n=o.createElementNS(e,r||t),a=i.length;d(this,n),this.currentElement=n,this.locator&&c(this.locator,n);for(var s=0;s<a;s++){e=i.getURI(s);var l=i.getValue(s),u=(r=i.getQName(s),o.createAttributeNS(e,r));this.locator&&c(i.getLocator(s),u),u.value=u.nodeValue=l,n.setAttributeNode(u)}},endElement:function(e,t,r){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&c(this.locator,r),d(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=p.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&c(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=p.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&c(this.locator,i),d(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var i=this.doc.implementation;if(i&&i.createDocumentType){var o=i.createDocumentType(e,t,r);this.locator&&c(this.locator,o),d(this,o),this.doc.doctype=o}},warning:function(e){console.warn("[xmldom warning]\t"+e,u(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,u(this.locator))},fatalError:function(e){throw new s(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){l.prototype[e]=function(){return null}})},20183:(e,t,r)=>{"use strict";r.d(t,{A:()=>U}),r(94490),r(26910),r(62953);var i,o,n=r(54156),a=r(27813),s=r(90172),l=r(39228),c=r(77409),u=r(6497),p=r(35156),d=r(7239),h=r(57009),m=r(75305),f=r(34398),g=r(21529),y=r(99799),b=r(84149),v=r(89616),w=r(59801),A=r(91273),S=r(1087),x=r(33620),O=r(6119),P=r(43104),T=r(92418),I=r(47395),D=r(49835),C=r(76970),E=r(4767),_=r(35453),j=r(99773),z=r(75111);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach(function(t){M(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function R(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function M(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function L(e){var t,r;let i=(t=class extends((0,E.A)((0,_.A)((0,z.A)((0,j.Ay)((0,C.A)(e)))))){constructor(){super(...arguments),M(this,"tileset",void 0),R(this,"originalRootTransform",r,this),(0,a.Gn)(this)}get hasCesium3dTilesMixin(){return!0}clippingPlanesOriginMatrix(){return this.tileset&&this.tileset.clippingPlanesOriginMatrix?this.tileset.clippingPlanesOriginMatrix.clone():p.A.IDENTITY.clone()}async forceLoadMapItems(){try{if(await this.loadTileset(),this.tileset){const e=this.tileset;void 0!==e.extras&&void 0!==e.extras.style&&(0,a.h5)(()=>{this.strata.set(O.A.defaults,(0,P.A)(I.A,{style:e.extras.style}))})}}catch(e){throw w.Ay.from(e,"Failed to load 3d-tiles tileset")}}loadTileset(){if(!(0,A.A)(this.url)&&!(0,A.A)(this.ionAssetId))throw"`url` and `ionAssetId` are not defined for ".concat((0,C.m)(this));let e;if((0,A.A)(this.ionAssetId)?e=this.createResourceFromIonId(this.ionAssetId,this.ionAccessToken,this.ionServer):(0,A.A)(this.url)&&(e=this.createResourceFromUrl((0,x.A)(this,this.url))),(0,A.A)(e))return Promise.resolve(e).then(e=>{if(void 0!==e)return b.A.fromUrl(e,k({},this.optionsObj)).then(e=>{const t=e;t._catalogItem=this,t.destroyed=e.isDestroyed();const r=t.destroy;t.destroy=function(){r.call(this),(0,S.A)(()=>{(0,a.h5)(()=>{this.destroyed=!0})})},(0,a.Gn)(t,{destroyed:a.sH});const i=t;(0,a.h5)(()=>{i._catalogItem=this,i.destroyed||(this.tileset=i,void 0!==i.root&&(this.originalRootTransform=i.root.transform.clone(),i.root.transform=p.A.IDENTITY.clone()))})})})}computeModelMatrixFromTransformationTraits(e){let t=p.A.getScale(e,new s.A);const r=p.A.getTranslation(e,new s.A);let i=d.A.fromRotationMatrix(p.A.getMatrix3(e,new u.A));const{latitude:o,longitude:n,height:a}=this.origin;if(void 0!==o&&void 0!==n){const e=s.A.fromDegrees(n,o,a);r.x=e.x,r.y=e.y,void 0!==a&&(r.z=e.z)}const{heading:c,pitch:h,roll:f}=this.rotation;if(void 0!==c&&void 0!==h&&void 0!==f){const e=l.A.fromDegrees(c,h,f);i=m.A.headingPitchRollQuaternion(r,e)}return void 0!==this.scale&&(t=new s.A(this.scale,this.scale,this.scale)),p.A.fromTranslationQuaternionRotationScale(r,i,t)}get modelMatrix(){return this.computeModelMatrixFromTransformationTraits(this.originalRootTransform)}get mapItems(){if(this.isLoadingMapItems||!(0,A.A)(this.tileset))return[];this.tileset.destroyed&&this.loadMapItems(!0),this.tileset.style=(0,a.HO)(this.cesiumTileStyle),this.tileset.shadows=this.cesiumShadows,this.tileset.show=this.show;const e=this.colorBlendMode,t=f.A[e];void 0!==t&&(this.tileset.colorBlendMode=t),this.tileset.colorBlendAmount=this.colorBlendAmount,this.lightColor&&(this.tileset.lightColor=s.A.fromArray(this.lightColor.slice()));const r=void 0!==this.options.maximumScreenSpaceError?this.options.maximumScreenSpaceError/2:8;return this.tileset.maximumScreenSpaceError=r*this.terria.baseMaximumScreenSpaceError,this.tileset.modelMatrix=this.modelMatrix,this.tileset.clippingPlanes=this.clippingPlaneCollection,this.clippingMapItems.forEach(e=>{e.show=this.show}),[this.tileset,...this.clippingMapItems]}get shortReport(){return"Leaflet"===this.terria.currentViewer.type?n.Ay.t("models.commonModelErrors.3dTypeIn2dMode",this):super.shortReport}get optionsObj(){const e={};return(0,A.A)(this.options)&&Object.keys(D.cz.traits).forEach(t=>{e[t]=this.options[t]}),e}createResourceFromUrl(e){if(!(0,A.A)(e))return;let t;return t=e instanceof h.A?e:new h.A({url:e}),t}async createResourceFromIonId(e,t,r){if((0,A.A)(e))return await c.A.fromAssetId(e,{accessToken:t||this.terria.configParameters.cesiumIonAccessToken,server:r})}buildFeatureFromPickResult(e,t){if(this.allowFeaturePicking&&(t instanceof g.A||t instanceof y.A)){const e={};t.getPropertyIds().forEach(r=>{e[r]=t.getProperty(r)});const r=new T.A({properties:e});return r._cesium3DTileFeature=t,r}}getIdPropertiesForFeature(e){if(this.featureIdProperties)return this.featureIdProperties.slice();const t=e.getPropertyIds().find(e=>"id"===e.toLowerCase());return t?[t]:[]}getSelectorForFeature(e){const t=this.getIdPropertiesForFeature(e).sort();if(0===t.length)return;return t.map(t=>"${".concat(t,"} === ").concat(JSON.stringify(e.getProperty(t)))).join(" && ")||void 0}setVisibilityForMatchingFeature(e,t){if(e){const r=this.style||{},i=G(null==r?void 0:r.show);i.conditions.unshift([e,t]),this.setTrait(O.A.user,"style",k(k({},r),{},{show:i}))}}setFeatureVisibility(e,t){const r=this.getSelectorForFeature(e);r&&this.setVisibilityForMatchingFeature(r,t)}applyShowExpression(e){const t=this.style||{},r=G(null==t?void 0:t.show);r.conditions.unshift([e.condition,e.show]),this.setTrait(O.A.user,"style",k(k({},t),{},{show:r}))}removeShowExpression(e){var t;const r=null===(t=this.style)||void 0===t?void 0:t.show;if(!(0,v.OW)(r))return;if(!(0,a.Fq)(r.conditions))return;const i=r.conditions.slice().filter(t=>t[0]!==e);this.setTrait(O.A.user,"style",k(k({},this.style),{},{show:k(k({},r),{},{conditions:i})}))}applyColorExpression(e){const t=this.style||{},r=function(e){const t={conditions:[]};return"string"==typeof e&&(t.expression=e),(0,v.OW)(e)&&Object.assign(t,e),t}(null==t?void 0:t.color);r.conditions.unshift([e.condition,e.value]),r.conditions.find(e=>"true"===e[0])||r.conditions.push(["true","color('#ffffff')"]),this.setTrait(O.A.user,"style",k(k({},t),{},{color:r}))}removeColorExpression(e){var t;const r=null===(t=this.style)||void 0===t?void 0:t.color;if(!(0,v.OW)(r))return;if(!(0,a.Fq)(r.conditions))return;const i=r.conditions.slice().filter(t=>t[0]!==e);this.setTrait(O.A.user,"style",k(k({},this.style),{},{color:k(k({},r),{},{conditions:i})}))}get selectableDimensions(){return[...super.selectableDimensions,...super.shadowDimensions,...super.clippingDimensions]}},r=F(t.prototype,"originalRootTransform",[a.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.A.IDENTITY.clone()}}),F(t.prototype,"modelMatrix",[a.EW],Object.getOwnPropertyDescriptor(t.prototype,"modelMatrix"),t.prototype),F(t.prototype,"mapItems",[a.EW],Object.getOwnPropertyDescriptor(t.prototype,"mapItems"),t.prototype),F(t.prototype,"shortReport",[a.$Z],Object.getOwnPropertyDescriptor(t.prototype,"shortReport"),t.prototype),F(t.prototype,"optionsObj",[a.EW],Object.getOwnPropertyDescriptor(t.prototype,"optionsObj"),t.prototype),F(t.prototype,"setFeatureVisibility",[a.XI],Object.getOwnPropertyDescriptor(t.prototype,"setFeatureVisibility"),t.prototype),F(t.prototype,"applyShowExpression",[a.XI],Object.getOwnPropertyDescriptor(t.prototype,"applyShowExpression"),t.prototype),F(t.prototype,"removeShowExpression",[a.XI],Object.getOwnPropertyDescriptor(t.prototype,"removeShowExpression"),t.prototype),F(t.prototype,"applyColorExpression",[a.XI],Object.getOwnPropertyDescriptor(t.prototype,"applyColorExpression"),t.prototype),F(t.prototype,"removeColorExpression",[a.XI],Object.getOwnPropertyDescriptor(t.prototype,"removeColorExpression"),t.prototype),F(t.prototype,"selectableDimensions",[a.$Z],Object.getOwnPropertyDescriptor(t.prototype,"selectableDimensions"),t.prototype),t);return i}function G(e){var t;let r;return r=Array.isArray(null==e||null===(t=e.conditions)||void 0===t?void 0:t.slice())?[...e.conditions]:"string"==typeof e?[[e,!0]]:[["true",!0]],k(k({},e),{},{conditions:r})}i=class extends b.A{constructor(){super(...arguments),M(this,"_catalogItem",void 0),R(this,"destroyed",o,this),(0,a.Gn)(this)}destroy(){super.destroy(),(0,S.A)(()=>{(0,a.h5)(()=>{this.destroyed=!0})})}},o=F(i.prototype,"destroyed",[a.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(L||(L={})).isMixedInto=function(e){return e&&e.hasCesium3dTilesMixin};const U=L},28978:(e,t,r)=>{var i=r(84722);i.DOMImplementation,t.e=i.XMLSerializer,r(15752)},35862:(e,t,r)=>{"use strict";r.d(t,{A:()=>ot}),r(84864),r(27495),r(62953);var i=r(27813),o=r(21381),n=(r(26910),r(9391),r(42762),r(57009)),a=r(84193),s=r.n(a),l=r(90430),c=r(76287),u=r(70340);function p(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e){class t extends((0,u.A)(e)){constructor(){super(...arguments),p(this,"featureToSearchResultFunction",void 0),p(this,"transformSearchText",void 0),p(this,"searchResultFilterFunction",void 0),p(this,"searchResultScoreFunction",void 0),p(this,"cancelRequest",void 0),p(this,"_waitingForResults",!1),(0,i.Gn)(this)}getXml(e){const t=new n.A({url:e});this._waitingForResults=!0;const r=t.fetchXML();return this.cancelRequest=t.request.cancelFunction,r.finally(()=>{this._waitingForResults=!1})}doSearch(e,t){t.results.length=0,t.message=void 0,this._waitingForResults&&(void 0!==this.cancelRequest&&(this.cancelRequest(),this.cancelRequest=void 0),this._waitingForResults=!1);const r=e;if(e=e.trim(),void 0!==this.transformSearchText&&(e=this.transformSearchText(e)),e.length<2)return Promise.resolve();const o='<ogc:Filter><ogc:PropertyIsLike wildCard="*" matchCase="false">\n          <ogc:ValueReference>'.concat(this.searchPropertyName,"</ogc:ValueReference>\n          <ogc:Literal>*").concat(e,"*</ogc:Literal></ogc:PropertyIsLike></ogc:Filter>"),n=new(s())(this.url);return n.setSearch({service:"WFS",request:"GetFeature",typeName:this.searchPropertyTypeName,version:"1.1.0",srsName:"urn:ogc:def:crs:EPSG::4326",filter:o}),this.getXml(n.toString()).then(e=>{const o=(0,c.A)(e);let n;if(void 0===o)return void(t.message={content:"translate#viewModels.searchErrorOccurred"});if(void 0!==o.member)n=o.member;else{if(void 0===o.featureMember)return void(t.message={content:"translate#viewModels.searchNoPlaceNames"});n=o.featureMember}Array.isArray(n)||(n=[n]);const a=new Set;(0,i.h5)(()=>{if(void 0!==this.searchResultFilterFunction&&(n=n.filter(this.searchResultFilterFunction)),0===n.length)return void(t.message={content:"translate#viewModels.searchNoPlaceNames"});void 0!==this.searchResultScoreFunction&&(n=n.sort((e,t)=>this.searchResultScoreFunction(t,r)-this.searchResultScoreFunction(e,r)));let e=n.map(this.featureToSearchResultFunction).map(e=>(e.clickAction=function(e,t){const r=function(e,t,r){r=null!=r?r:.2;var i=parseFloat(e)-r/2,o=parseFloat(t)-r/2,n=parseFloat(e)+r/2,a=parseFloat(t)+r/2;return l.A.fromDegrees(o,i,a,n)}(t.latitude,t.longitude,.2),i=e.flightDurationSeconds||e.terria.searchBarModel.flightDurationSeconds;return function(){e.terria.currentViewer.zoomTo(r,i)}}(this,e.location),e));void 0===this.searchResultScoreFunction&&(e=e.sort((e,t)=>e.name.length-t.name.length)),e=e.filter(e=>{var t,r;const i="".concat(e.name,",").concat(null===(t=e.location)||void 0===t?void 0:t.latitude.toFixed(1),",").concat(null===(r=e.location)||void 0===r?void 0:r.longitude.toFixed(1));return!a.has(i)&&(a.add(i),!0)}),t.results.push(...e)})}).catch(e=>{t.isCanceled||(t.message={content:"translate#viewModels.searchErrorOccurred"})})}get isWebFeatureServiceSearchProviderMixin(){return!0}}return t}(d||(d={})).isMixedInto=function(e){return e&&e.isWebFeatureServiceSearchProviderMixin};const h=d;r(94490);var m,f,g,y,b,v=r(71222),w=r(53389),A=r(80920);function S(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function x(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let O=(m=(0,v.A)({type:"string",name:"Search property name",description:"Which property to look for the search text in"}),f=(0,v.A)({type:"string",name:"Search property type name",description:"Type of the properties to search"}),g=class extends((0,w.A)(A.A)){constructor(){super(...arguments),S(this,"searchPropertyName",y,this),S(this,"searchPropertyTypeName",b,this)}},y=x(g.prototype,"searchPropertyName",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=x(g.prototype,"searchPropertyTypeName",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g);var P=r(90147),T=r(85895);function I(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const D=new Map([["AF","Aviation"],["ANCH","Anchorage"],["ARCH","Archipelago"],["BANK","Bank/Sandbar"],["BAY","Bay"],["BCH","Beach"],["BCST","Broadcasting station"],["BEND","Bend/Loop"],["BGHT","Bight"],["BLDG","Building"],["BORE","Bore/Well"],["BRDG","Bridge/Culvert"],["BRK","Breaker"],["BRKW","Breakwater/Groyne/Levee"],["CAPE","Cape"],["CAVE","Cave/Blowhole/Grotto"],["CEM","Cemetery"],["CHAN","Offshore channel"],["CLAY","Claypan/Clay pit"],["CLIF","Cliff"],["CNAL","Canal/Waterway"],["CNTY","County"],["COMM","Community center/Commune"],["CONT","Continent"],["COVE","Cove/Inlet"],["CP","Campsite"],["CRTR","Crater"],["DAM","Dam"],["DPR","Depression/Basin"],["DI","District/Region"],["DOCK","Dock"],["DRN","Drain"],["DSRT","Desert"],["DUNE","Dunes"],["ENTR","Entrance"],["EST","Estuary"],["FARM","Special purpose farm/Research establishment"],["FORD","Ford/Crossing"],["FRNG","Firing range"],["FRST","Forest"],["GASF","Gasfield/Oil well"],["GATE","Gate/City exit"],["GLCR","Glacier"],["GORG","Gorge/Canyon"],["GRDN","Garden/Vineyard"],["GULF","Gulf"],["HBR","Harbour"],["Hill","Hill"],["HMSD","Homestead/Outstation"],["HWY","Highway"],["INTL","Intermittent lake"],["IS","Island"],["ISTH","Isthmus/Neck"],["LAGN","Lagoon"],["LAKE","Lake"],["LDGE","Ledge"],["LH","Lighthouse"],["LOCB","Town"],["LOCK","Lock"],["LOCU","Place"],["MINE","Mine"],["MONU","Monument"],["MT","Mountain"],["NAVB","Beacon/Buoy"],["OCEN","Ocean"],["PASS","Pass"],["PEAK","Peak/Summit"],["PEN","Peninsula"],["PIER","Pier"],["PL","Plateau/Tableland"],["PLAN","Plantation"],["PLN","Plain"],["PORT","Port"],["PRSH","Parish"],["PT","Point"],["QUAR","Quarry"],["RCH","Reach/Arm"],["RDGE","Ridge"],["REEF","Reef"],["RES","Reservoir/Pond"],["RESV","Reserve/Park"],["RH","Rockhole"],["ROAD","Road"],["ROCK","Rock"],["RSTA","Railway station"],["RTRK","Racetrack"],["RUIN","Ruin"],["SCHL","School/College"],["SEA","Sea"],["SHOL","Shoal"],["SITE","Historical site"],["SLP","Slope/Hillside"],["SND","Sound"],["SOAK","Native well/Soak"],["SPAN","Salt pan"],["SPIT","Sandspit"],["SPRG","Spring"],["STAT","State"],["STOK","Stock route"],["STR","Strait"],["STRM","Stream"],["SUB","Suburb"],["SWP","Swamp/Marsh/Wetland"],["TANK","Tank"],["TOWR","Tower"],["TREE","Tree"],["TRIG","Trig station"],["TRK","Track/Trail"],["TUNN","Tunnel"],["URBN","City"],["VAL","Valley"],["WRCK","Wreck"],["WRFL","Waterfall"],["WTRH","Waterhole"],["YD","Yard"]]),C=function(e){let t="";const r=D.get(e.Gazetteer_of_Australia.Feature_code);return void 0!==r&&(t=" â€” "+r),new T.A({name:"".concat(e.Gazetteer_of_Australia.Name,", ").concat(e.Gazetteer_of_Australia.State_ID).concat(t),location:{latitude:parseFloat(e.Gazetteer_of_Australia.Latitude),longitude:parseFloat(e.Gazetteer_of_Australia.Longitude)}})},E=function(e){return"N/A"!==e.Gazetteer_of_Australia.State_ID&&"TRIG"!==e.Gazetteer_of_Australia.Feature_code},_=function(e,t){e=e.Gazetteer_of_Australia;const r=["CONT","STAT","URBN","LOCB","LOCU","SUB","DI","CNTY"];r.push("HBR","CAPE","PEN","PT","BAY","PORT","GULF","BGHT","COVE","MT","HILL","PEAK","OCEN","SEA","RESV","LAKE","RES","STRM"),r.push("PLN","REEF","VAL","PRSH");let i=1e4-100*(r.indexOf(e.Feature_code)+1);return 1e4===i&&(i=0),e.Name.toUpperCase()===t.toUpperCase()?i+=1e3:e.Name.match(new RegExp("^"+t+"\\b","i"))?i+=800:e.Name.match(new RegExp("\\b"+t+"\\b","i"))?i+=400:e.Name.match(new RegExp("^"+t,"i"))&&(i+=200),"N/A"===e.State_ID&&(i-=1e3),"U"===e.Status&&(i-=500),"H"===e.Status&&(i-=1e3),i};class j extends(h((0,P.A)(O))){constructor(){super(...arguments),I(this,"featureToSearchResultFunction",C),I(this,"transformSearchText",e=>e.toUpperCase()),I(this,"searchResultFilterFunction",E),I(this,"searchResultScoreFunction",_),(0,i.Gn)(this)}get type(){return j.type}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(o.b7.search,o.h3.gazetteer,e)}}I(j,"type","australian-gazetteer-search-provider");var z,N,k,R,M,F,L,G,U,W=r(54156),q=r(56870),B=r(22256),V=r(31538);function H(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function $(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let J=(z=(0,v.A)({type:"string",name:"Key",description:"The Bing Maps key."}),N=(0,v.A)({type:"string",name:"Primary country",description:"Name of the country to prioritize the search results."}),k=(0,v.A)({type:"string",name:"Culture",description:"Use the culture parameter to specify a culture for your request.\n    The culture parameter provides the result in the language of the culture.\n    For a list of supported cultures, see [Supported Culture Codes](https://docs.microsoft.com/en-us/bingmaps/rest-services/common-parameters-and-types/supported-culture-codes)"}),R=(0,v.A)({type:"number",name:"Max results",description:"The maximum number of results to return."}),M=class extends((0,w.A)(A.A,A.y)){constructor(){super(...arguments),function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"url","https://dev.virtualearth.net/"),H(this,"key",F,this),H(this,"primaryCountry",L,this),H(this,"culture",G,this),H(this,"maxResults",U,this)}},F=$(M.prototype,"key",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=$(M.prototype,"primaryCountry",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Australia"}}),G=$(M.prototype,"culture",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en-au"}}),U=$(M.prototype,"maxResults",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),M);var X,K,Z=r(6119);let Q=(K=class e extends((0,u.A)((0,P.A)(J))){get type(){return e.type}constructor(e,t){super(e,t),(0,i.Gn)(this),(0,i.h5)(()=>{this.terria.configParameters.bingMapsKey&&this.setTrait(Z.A.defaults,"key",this.terria.configParameters.bingMapsKey)})}showWarning(){this.key&&""!==this.key||console.warn("The ".concat((0,V.V)(this.name,W.Ay),"(").concat(this.type,") geocoder will always return no results because a Bing Maps key has not been provided. Please get a Bing Maps key from bingmapsportal.com and add it to parameters.bingMapsKey in config.json."))}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(o.b7.search,o.h3.bing,e)}doSearch(e,t){t.results.length=0,t.message=void 0;const r=new n.A({url:this.url+"REST/v1/Locations",queryParameters:{culture:this.culture,query:e,key:this.key,maxResults:this.maxResults}});if(this.mapCenter){const e=(0,u.I)(this.terria);r.appendQueryParameters({userLocation:"".concat(e.latitude,", ").concat(e.longitude)})}return(0,B.A)(r).then(e=>{if(t.isCanceled)return;if(0===e.resourceSets.length)return void(t.message={content:"translate#viewModels.searchNoLocations"});const r=e.resourceSets[0];0!==r.resources.length?((0,i.h5)(()=>{const e=this.sortByPriority(r.resources);t.results.push(...e.primaryCountry),t.results.push(...e.other)}),0===t.results.length&&(t.message={content:"translate#viewModels.searchNoLocations"})):t.message={content:"translate#viewModels.searchNoLocations"}}).catch(()=>{t.isCanceled||(t.message={content:"translate#viewModels.searchErrorOccurred"})})}sortByPriority(e){const t=[],r=[];for(let i=0;i<e.length;++i){const o=e[i];let n=o.name;if(!(0,q.A)(n))continue;let a=t,s=!0;const l=o.address?o.address.countryRegion:void 0;(0,q.A)(this.primaryCountry)&&l!==this.primaryCountry&&(a=r,s=!1,(0,q.A)(l)&&n.lastIndexOf(l)!==n.length-l.length&&(n+=", "+l)),a.push(new T.A({name:n,isImportant:s,clickAction:ne(this,o),location:{latitude:o.point.coordinates[0],longitude:o.point.coordinates[1]}}))}return{primaryCountry:t,other:r}}},Y=K,te="bing-maps-search-provider",(ee=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(ee="type"))in Y?Object.defineProperty(Y,ee,{value:te,enumerable:!0,configurable:!0,writable:!0}):Y[ee]=te,function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((X=K).prototype,"showWarning",[i.$Z],Object.getOwnPropertyDescriptor(X.prototype,"showWarning"),X.prototype),X);var Y,ee,te,re,ie,oe;function ne(e,t){const[r,i,o,n]=t.bbox,a=l.A.fromDegrees(i,r,n,o);return function(){e.terria.currentViewer.zoomTo(a,e.flightDurationSeconds)}}let ae=(re=(0,v.A)({type:"string",name:"Key",description:"The Cesium ION key. If not provided, will try to use the global cesium ion key."}),ie=class extends((0,w.A)(A.A,A.y)){constructor(){super(...arguments),function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"url","https://api.cesium.com/v1/geocode/search"),function(e,t,r,i){r&&Object.defineProperty(e,"key",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,oe,this)}},oe=function(e,t,r,i){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(t,r){return r(e,"key",t)||t},o),void 0===o.initializer?(Object.defineProperty(e,"key",o),null):o}(ie.prototype,0,[re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie);var se,le;let ce=(le=class e extends((0,u.A)((0,P.A)(ae))){get type(){return e.type}constructor(e,t){super(e,t),(0,i.Gn)(this),(0,i.h5)(()=>{this.terria.configParameters.cesiumIonAccessToken&&this.setTrait(Z.A.defaults,"key",this.terria.configParameters.cesiumIonAccessToken)})}showWarning(){this.key&&""!==this.key||console.warn("The ".concat((0,V.V)(this.name,W.Ay),"(").concat(this.type,") geocoder will always return no results because a CesiumIon key has not been provided. Please get a CesiumIon key from ion.cesium.com, ensure it has geocoding permission and add it to searchProvider.key or parameters.cesiumIonAccessToken in config.json."))}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(o.b7.search,o.h3.cesium,e)}async doSearch(e,t){let r;t.results.length=0,t.message=void 0;try{r=await(0,B.A)("".concat(this.url,"?text=").concat(e,"&access_token=").concat(this.key))}catch(e){return void(t.message={content:"translate#viewModels.searchErrorOccurred"})}(0,i.h5)(()=>{r.features&&0!==r.features.length?t.results=r.features.map(e=>{const[t,r,i,o]=e.bbox,n=l.A.fromDegrees(t,r,i,o);return new T.A({name:e.properties.label,clickAction:ue(this,n),location:{latitude:(r+o)/2,longitude:(i+t)/2}})}):t.message={content:"translate#viewModels.searchNoLocations"}})}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(le,"type","cesium-ion-search-provider"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((se=le).prototype,"showWarning",[i.$Z],Object.getOwnPropertyDescriptor(se.prototype,"showWarning"),se.prototype),se);function ue(e,t){return function(){e.terria.currentViewer.zoomTo(t,e.flightDurationSeconds)}}r(3296),r(27208),r(48408);var pe,de,he,me,fe,ge,ye,be,ve,we,Ae,Se,xe,Oe,Pe,Te,Ie,De,Ce,Ee=r(91273),_e=r(26339);function je(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function ze(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Ne=(pe=(0,v.A)({type:"string",name:"Access Token",description:"All geocoding requests must include an access token."}),de=(0,v.A)({type:"boolean",name:"partialMatch",description:"Specify whether to return partial match results. \n    When partialMatch is enabled, results will be included that \n    start with the requested string, rather than responses that match it exactly."}),he=(0,v.A)({type:"string",name:"Country",description:"A comma-separated list of ISO 3166 alpha 2 country codes."}),me=(0,v.A)({type:"string",name:"Language",description:"The ISO language code to be returned. If not provided, the default is English."}),fe=(0,v.A)({type:"number",name:"Limit",description:"The number of results to return, up to 10."}),ge=(0,v.A)({type:"string",name:"Types",description:"Limit results to one or more types of features, provided as a comma-separated\n     list. Pass one or more of the type names as a comma separated list. If no types are specified, \n      all possible types may be returned. Available types are: country, region, postcode, district, \n      place, city, locality, neighborhood, street, address, poi, and category. See the \n      [Administrative unit types](https://docs.mapbox.com/api/search/search-box/#administrative-unit-types) \n      section for details about these types."}),ye=(0,v.A)({type:"string",name:"Worldview",description:"Returns features that are defined differently by audiences that belong to various regional,\n     cultural, or political groups. Available worldviews are: ar,cn,in,jp,ma,rs,ru,tr,us. If worldview is not \n     set, the us worldview boundaries are returned by default. For more information about using the worldview \n     parameter, see the [worldviews section](https://docs.mapbox.com/api/search/geocoding/#worldviews)."}),be=(0,v.A)({type:"boolean",name:"latLonSearchOrder",description:"When the user searches using coordinates, should the order be 'latitude, longitude'\n    the default is true, which is familar with most users from other platforms."}),ve=(0,v.A)({type:"boolean",name:"showCoordinatesInReverseGeocodeResult",description:"When the user searches using coordinates, the first result in the list will be the\n    coordinate location. If using in conjunction with another search provider, this behaviour may not\n    be desired. Defaults to true."}),we=class extends((0,w.A)(A.A,A.y)){constructor(){super(...arguments),function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"url","https://api.mapbox.com/search/geocode/v6/"),je(this,"accessToken",Ae,this),je(this,"partialMatch",Se,this),je(this,"country",xe,this),je(this,"language",Oe,this),je(this,"limit",Pe,this),je(this,"types",Te,this),je(this,"worldview",Ie,this),je(this,"latLonSearchOrder",De,this),je(this,"showCoordinatesInReverseGeocodeResult",Ce,this)}},Ae=ze(we.prototype,"accessToken",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se=ze(we.prototype,"partialMatch",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),xe=ze(we.prototype,"country",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=ze(we.prototype,"language",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"en"}}),Pe=ze(we.prototype,"limit",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Te=ze(we.prototype,"types",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=ze(we.prototype,"worldview",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=ze(we.prototype,"latLonSearchOrder",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ce=ze(we.prototype,"showCoordinatesInReverseGeocodeResult",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),we);var ke,Re;function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach(function(t){Le(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Le(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ge=function(e){return e.Forward="forward",e.Reverse="reverse",e}(Ge||{});let Ue=(Re=class e extends((0,u.A)((0,P.A)(Ne))){get type(){return e.type}constructor(e,t){super(e,t),(0,i.Gn)(this)}showWarning(){this.accessToken&&""!==this.accessToken||console.warn("The ".concat((0,V.V)(this.name,W.Ay),"(").concat(this.type,") geocoder will always return no results because a Mapbox token has not been provided. Please get a token from mapbox.com and add it to parameters.mapboxSearchProviderAccessToken in config.json."))}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(o.b7.search,o.h3.mapbox,e)}doSearch(e,t){t.results.length=0,t.message=void 0;const r=RegExp(/^-?([0-9]{1,2}|1[0-7][0-9]|180)(\.[0-9]{1,17})$/);let o=RegExp(/([+-]?\d+\.?\d+)\s*,\s*([+-]?\d+\.?\d+)/).test(e)?Ge.Reverse:Ge.Forward,a={access_token:this.accessToken,autocomplete:this.partialMatch,language:this.language};if(o===Ge.Reverse){let i=e.split(/\s+/).join("").split(",");if(2===i.length&&r.test(i[0])&&r.test(i[1])){this.latLonSearchOrder&&(i=i.reverse());const[e,r]=i.map(parseFloat);if(this.showCoordinatesInReverseGeocodeResult){const i=(0,_e.A)(e,r);t.results.push(new T.A({name:"".concat(i.latitude,", ").concat(i.longitude),clickAction:We(this,{geometry:{coordinates:[e,r]},properties:{}}),location:{longitude:e,latitude:r}}))}a=Fe(Fe({},a),{longitude:i[0],latitude:i[1],limit:1})}else o=Ge.Forward}const s=new n.A({url:new URL(o,this.url).toString(),queryParameters:a});if(o===Ge.Forward&&s.appendQueryParameters({q:e,limit:this.limit}),o===Ge.Forward&&this.mapCenter){const e=(0,u.I)(this.terria);s.appendQueryParameters({proximity:"".concat(e.longitude,", ").concat(e.latitude)})}if(o===Ge.Forward&&this.terria.searchBarModel.boundingBoxLimit){const e=this.terria.searchBarModel.boundingBoxLimit;(0,Ee.A)(e.west)&&(0,Ee.A)(e.north)&&(0,Ee.A)(e.east)&&(0,Ee.A)(e.south)&&s.appendQueryParameters({bbox:[e.west,e.north,e.east,e.south].join(",")})}return this.country&&s.appendQueryParameters({country:this.country}),this.types&&s.appendQueryParameters({types:this.types}),this.worldview&&s.appendQueryParameters({worldview:this.worldview}),(0,B.A)(s).then(e=>{if(t.isCanceled)return;if(0===e.features.length&&o===Ge.Forward||0===e.features.length&&o===Ge.Reverse&&!1===this.showCoordinatesInReverseGeocodeResult)return void(t.message={content:"translate#viewModels.searchNoLocations"});const r=e.features.filter(e=>e.properties&&e.geometry&&e.properties.full_address).map(e=>new T.A({name:e.properties.full_address,clickAction:We(this,e),location:{latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0]}}));(0,i.h5)(()=>{t.results.push(...r)}),0===t.results.length&&(t.message={content:"translate#viewModels.searchNoLocations"});const n=e.attribution;n&&(0,i.h5)(()=>{this.setTrait(Z.A.underride,"attributions",[n])})}).catch(()=>{t.isCanceled||(t.message={content:"translate#viewModels.searchErrorOccurred"})})}},Le(Re,"type","mapbox-search-provider"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((ke=Re).prototype,"showWarning",[i.$Z],Object.getOwnPropertyDescriptor(ke.prototype,"showWarning"),ke.prototype),ke);function We(e,t){var r;const[i,o,n,a]=null!==(r=t.properties.bbox)&&void 0!==r?r:[t.geometry.coordinates[0]-.01,t.geometry.coordinates[1]-.01,t.geometry.coordinates[0]+.01,t.geometry.coordinates[1]+.01],s=l.A.fromDegrees(i,a,n,o);return function(){e.terria.currentViewer.zoomTo(s,e.flightDurationSeconds)}}var qe,Be,Ve,He,$e,Je,Xe,Ke=r(93657);function Ze(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Qe(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let et=(qe=(0,v.A)({type:"string",name:"Key",description:"The Nominatim key."}),Be=(0,v.A)({type:"string",name:"Primary country",description:"Name of the country to prioritize the search results."}),Ve=(0,v.A)({type:"number",name:"Max results",description:"The maximum number of results to return."}),He=class extends((0,w.A)(A.A,A.y)){constructor(){super(...arguments),Qe(this,"url","//nominatim.openstreetmap.org/search"),Ze(this,"key",$e,this),Ze(this,"countryCodes",Je,this),Ze(this,"maxResults",Xe,this),Qe(this,"attributions",["Â© <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap contributors</a>"])}},$e=Ye(He.prototype,"key",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Ye(He.prototype,"countryCodes",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Ye(He.prototype,"maxResults",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),He);class tt extends((0,u.A)((0,P.A)(et))){get type(){return tt.type}constructor(e,t){super(e,t),console.warn("%cThis map is using the Nominatim search provider. It is not recommended for production use, consider using a different search provider instead.","color: white; font-size: 24px; font-weight: bold; font-family: Helvetica, sans-serif;"),(0,i.Gn)(this)}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(o.b7.search,o.h3.nominatim,e)}doSearch(e,t){t.results.length=0,t.message=void 0;const r=this.terria.currentViewer.getCurrentCameraView(),o=Ke.A.toDegrees(r.rectangle.west)+", "+Ke.A.toDegrees(r.rectangle.north)+", "+Ke.A.toDegrees(r.rectangle.east)+", "+Ke.A.toDegrees(r.rectangle.south);return(0,B.A)(new n.A({url:this.url,queryParameters:{q:e,viewbox:o,bounded:0,format:"geojson",countrycodes:this.countryCodes,limit:this.maxResults}})).then(e=>{if(t.isCanceled)return;if(null==e||!e.features||!Array.isArray(e.features)||0===e.features.length)return void(t.message={content:"translate#viewModels.searchNoLocations"});const r=e.features.filter(e=>e.properties&&e.geometry&&e.properties.display_name).sort((e,t)=>t.properties.importance-e.properties.importance).map(e=>new T.A({name:e.properties.display_name,clickAction:rt(this,e),location:{latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0]}}));(0,i.h5)(()=>{t.results.push(...r)}),0===t.results.length&&(t.message={content:"translate#viewModels.searchNoLocations"})}).catch(()=>{t.isCanceled||(t.message={content:"translate#viewModels.searchErrorOccurred"})})}supportsAutocomplete(){return!1}}function rt(e,t){const[r,i,o,n]=t.bbox,a=l.A.fromDegrees(r,i,o,n);return function(){e.terria.currentViewer.zoomTo(a,e.flightDurationSeconds)}}!function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(tt,"type","nominatim-search-provider");var it=r(74556);function ot(){it.A.register(Q.type,Q),it.A.register(ce.type,ce),it.A.register(tt.type,tt),it.A.register(j.type,j),it.A.register(Ue.type,Ue)}},38592:(e,t,r)=>{"use strict";r.d(t,{A:()=>S}),r(94490),r(62953);var i=r(54156),o=r(27813),n=r(90172),a=r(39228),s=r(75305),l=r(2362),c=r(25061),u=r(92562),p=r(73504),d=r(12594),h=r(49003),m=r(11908),f=r(33620),g=r(76970),y=r(99773),b=r(75111);function v(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function A(e){var t;let r=(t=class extends((0,b.A)((0,g.A)((0,y.Ay)(e)))){constructor(){super(...arguments),v(this,"_dataSource",new u.A("glTF Model")),v(this,"_modelEntity",new p.A({name:"glTF Model Entity"})),(0,o.Gn)(this)}get hasGltfMixin(){return!0}get disableZoomTo(){const{latitude:e,longitude:t,height:r}=this.origin;return void 0===e||void 0===t||void 0===r}get cesiumUpAxis(){return void 0===this.upAxis?h.A.Y:h.A.fromName(this.upAxis)}get cesiumForwardAxis(){return void 0===this.forwardAxis?h.A.Z:h.A.fromName(this.forwardAxis)}get cesiumHeightReference(){return m.Ay[this.heightReference]||m.Ay.NONE}get cesiumPosition(){return void 0!==this.origin&&void 0!==this.origin.longitude&&void 0!==this.origin.latitude&&void 0!==this.origin.height?n.A.fromDegrees(this.origin.longitude,this.origin.latitude,this.origin.height):n.A.ZERO}get cesiumRotation(){const{heading:e=0,pitch:t=0,roll:r=0}=this.rotation,i=a.A.fromDegrees(e,t,r);return s.A.headingPitchRollQuaternion(this.cesiumPosition,i)}get transformationJson(){return{origin:{latitude:this.origin.latitude,longitude:this.origin.longitude,height:this.origin.height},rotation:{heading:this.rotation.heading,pitch:this.rotation.pitch,roll:this.rotation.roll},scale:this.scale}}get modelGraphics(){if(void 0===this.gltfModelUrl)return;const e=this.gltfModelUrl,t={uri:new c.A("string"==typeof e?(0,f.A)(this,e):e),upAxis:new c.A(this.cesiumUpAxis),forwardAxis:new c.A(this.cesiumForwardAxis),scale:new c.A(void 0!==this.scale?this.scale:1),shadows:new c.A(this.cesiumShadows),heightReference:new c.A(this.cesiumHeightReference)};return new d.A(t)}forceLoadMetadata(){return Promise.resolve()}forceLoadMapItems(){return Promise.resolve()}get shortReport(){return"Leaflet"===this.terria.currentViewer.type?i.Ay.t("models.commonModelErrors.3dTypeIn2dMode",this):super.shortReport}get modelEntity(){const e=this._modelEntity;return e.position=new l.A(this.cesiumPosition),e.orientation=new c.A(this.cesiumRotation),e.model=this.modelGraphics,e}get mapItems(){const e=this.modelEntity,t=this.modelGraphics,r=this._dataSource;return void 0===t?[]:(r.show=this.show,t&&(t.show=new c.A(this.show)),this.name&&(r.name=this.name,e.name=this.name),r.entities.contains(e)||r.entities.add(e),[r])}get selectableDimensions(){return[...super.selectableDimensions,...super.shadowDimensions]}},w(t.prototype,"disableZoomTo",[o.$Z],Object.getOwnPropertyDescriptor(t.prototype,"disableZoomTo"),t.prototype),w(t.prototype,"cesiumUpAxis",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumUpAxis"),t.prototype),w(t.prototype,"cesiumForwardAxis",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumForwardAxis"),t.prototype),w(t.prototype,"cesiumHeightReference",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumHeightReference"),t.prototype),w(t.prototype,"cesiumPosition",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumPosition"),t.prototype),w(t.prototype,"cesiumRotation",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"cesiumRotation"),t.prototype),w(t.prototype,"transformationJson",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"transformationJson"),t.prototype),w(t.prototype,"modelGraphics",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"modelGraphics"),t.prototype),w(t.prototype,"shortReport",[o.$Z],Object.getOwnPropertyDescriptor(t.prototype,"shortReport"),t.prototype),w(t.prototype,"modelEntity",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"modelEntity"),t.prototype),w(t.prototype,"mapItems",[o.EW],Object.getOwnPropertyDescriptor(t.prototype,"mapItems"),t.prototype),w(t.prototype,"selectableDimensions",[o.$Z],Object.getOwnPropertyDescriptor(t.prototype,"selectableDimensions"),t.prototype),t);return r}(A||(A={})).isMixedInto=function(e){return e&&e.hasGltfMixin};const S=A},40685:(e,t,r)=>{"use strict";r.d(t,{d2:()=>p}),r(76970),r(20183),r(77436),r(38592),r(99773),r(26730),r(97326);var i,o=r(59801),n=(r(77447),r(93264),r(89697),r(61726),r(6119),r(90147),r(69503),r(89774),r(26931),r(52586),r(71660),r(88620),r(35588),r(51101),r(12534)),a=(r(20469),r(94490),r(27813));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function p(e,t){return{viewState:e,terria:e.terria,workbench:e.terria.workbench,overlays:e.terria.overlays,pluginConfig:t}}u((i=class extends n.A{constructor(e,t,r){super(),this.viewState=e,this.toolId=t,this.toolConfig=r,(0,a.Gn)(this)}get glyph(){return this.toolConfig.toolButton.icon}get viewerMode(){return this.toolConfig.viewerMode}get isToolOpen(){var e;return(null===(e=this.viewState.currentTool)||void 0===e?void 0:e.toolName)===this.toolConfig.name}get active(){return super.active&&this.isToolOpen}openTool(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.toolConfig,r=this.toolId;try{this.viewState.openTool({toolName:t.name,getToolComponent:()=>t.toolComponentLoader().then(e=>e.default),params:l(l({},e),{},{toolId:r})})}catch(e){this.viewState.terria.raiseErrorToUser(o.Ay.from(e))}super.activate()}activate(){this.openTool()}deactivate(){this.closeTool()}closeTool(){this.isToolOpen&&this.viewState.closeTool(),super.deactivate()}}).prototype,"isToolOpen",[a.EW],Object.getOwnPropertyDescriptor(i.prototype,"isToolOpen"),i.prototype),u(i.prototype,"active",[a.EW],Object.getOwnPropertyDescriptor(i.prototype,"active"),i.prototype),u(i.prototype,"closeTool",[a.XI],Object.getOwnPropertyDescriptor(i.prototype,"closeTool"),i.prototype),r(76516),r(89544),r(27395),r(35471),r(34520),r(62951),r(27265),r(16001),r(31647),r(71222),r(53389),r(39070),r(21458),r(92498),r(13568),r(17618),r(6160),r(96540);var d=r(8711),h=r(59895);r(82578),r(53381),r(30155),r(74848),(0,d.Ay)(h.Ay).attrs({centered:!0,fullHeight:!0}).withConfig({displayName:"ActionBar__ActionBarInner",componentId:"sc-1wnvrrc-0"})(["margin:auto;background-color:",";border-radius:6px;"],e=>e.theme.dark);var m=r(38398);const f=(0,d.Ay)(m.Ay).withConfig({displayName:"StyledButton",componentId:"sc-1r97p3h-0"})(["background-color:",";color:",";border:1px solid ",";margin-right:8px;&:first-child{margin-left:8px;}",""],e=>e.backgroundColor,e=>e.theme.textLight,e=>e.theme.darkLighter,e=>e.hoverBackgroundColor&&"&:hover { background-color: ".concat(e.hoverBackgroundColor," }"));(0,d.Ay)(h.Ay).withConfig({displayName:"ActionBarGroup",componentId:"sc-bc9xee-0"})(["margin-right:8px;","{margin-right:0;}",":first-child{border-top-right-radius:0;border-bottom-right-radius:0;}",":last-child{border-top-left-radius:0;border-bottom-left-radius:0;}"],f,f,f),r(38565),r(31459),r(97179),r(12328),r(59646),r(51123),r(44310),r(42007),r(64161),r(93936),r(33620),r(74100),r(67909),r(49078)},44582:(e,t)=>{"use strict";function r(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.freeze?t.freeze(e):e}var i=r({HTML:"text/html",isHTML:function(e){return e===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),o=r({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===o.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},t.find=function(e,t,r){if(void 0===r&&(r=Array.prototype),e&&"function"==typeof r.find)return r.find.call(e,t);for(var i=0;i<e.length;i++)if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(t.call(void 0,o,i,e))return o}},t.freeze=r,t.MIME_TYPE=i,t.NAMESPACE=o},47395:(e,t,r)=>{"use strict";r.d(t,{A:()=>V});var i,o,n,a,s,l,c,u,p,d,h,m,f,g,y,b,v,w,A,S,x,O=r(21610),P=r(53389),T=r(21458),I=r(49835),D=r(28525),C=r(17618),E=r(57653),_=(r(94490),r(62953),r(35471)),j=r(39070),z=r(27265),N=r(16001),k=r(71222);function R(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function M(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let F=(i=(0,k.A)({type:"string",name:"id",description:"ID of the search parameter"}),o=(0,k.A)({type:"string",name:"Name",description:"A human readable name for the search parameter"}),n=(0,_.A)({name:"queryOptions",description:"Options used when querying the parameter, these options will be passed to the index used for querying the parameter."}),a=class extends j.A{constructor(){super(...arguments),R(this,"id",s,this),R(this,"name",l,this),R(this,"queryOptions",c,this)}},s=M(a.prototype,"id",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=M(a.prototype,"name",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=M(a.prototype,"queryOptions",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a),L=(u=(0,k.A)({type:"string",name:"providerType",description:"The type of the search provider."}),p=(0,_.A)({name:"providerOptions",description:"Options for the search provider."}),d=(0,k.A)({type:"string",name:"resultTemplate",description:"Template string to format the item result. You can pass a mustache template and refer to variables in {@ItemSearchResult.properties}. The template can also have HTML markup or markdown formatting."}),h=(0,k.A)({type:"string",name:"highlightColor",description:"A color to use for highlighting the selected result. Defaults to {@HighlightColorTraits.highlightColor} or {@Terria.baseMapContrastColor}"}),m=(0,z.Ay)({type:F,name:"Search parameters",description:"Search parameter configurations",idProperty:"id"}),f=class extends j.A{constructor(){super(...arguments),R(this,"providerType",g,this),R(this,"providerOptions",y,this),R(this,"resultTemplate",b,this),R(this,"highlightColor",v,this),R(this,"parameters",w,this)}},g=M(f.prototype,"providerType",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(f.prototype,"providerOptions",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=M(f.prototype,"resultTemplate",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(f.prototype,"highlightColor",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=M(f.prototype,"parameters",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f),G=(A=(0,N.A)({type:L,name:"search",description:"Item search configuration"}),S=class extends j.A{constructor(){super(...arguments),R(this,"search",x,this)}},x=M(S.prototype,"search",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S);var U,W=r(52273),q=r(6160),B=r(85878);let V=(0,O.b)({description:'Creates a 3d tiles item in the catalog from an ION Asset ID.\n  <strong>Note:</strong> <i>Instead of specifying <b>ionAssetId</b> property, you can also provide a URL, for example, <code>"url": "https://storage.googleapis.com/vic-datasets-public/1ce41fe7-aed2-4ad3-be4d-c38b715ce9af/v1/tileset.json"</code>.</i>',example:{type:"3d-tiles",ionAssetId:69380,name:"CoM Melbourne 3D Photo Mesh",id:"some-unique-id"}})(U=class extends((0,P.A)(G,E.A,q.A,D.A,C.Ay,B.A,T.Ay,W.A,I.Ay)){})||U},49648:(e,t,r)=>{"use strict";function i(e,t){t.addEventListener("hashchange",async function(){try{(await e.updateApplicationUrl(t.location.toString())).throwIfError(),(await e.loadInitSources()).throwIfError()}catch(t){e.raiseErrorToUser(t)}},!1)}r.d(t,{A:()=>i})},49835:(e,t,r)=>{"use strict";r.d(t,{cz:()=>Gt,Ay:()=>Ut}),r(94490),r(62953);var i,o,n,a,s,l,c,u,p,d,h,m,f,g,y,b,v,w,A,S,x,O=r(35471),P=r(27265),T=r(16001),I=r(31647),D=r(71222),C=r(53389),E=r(39070),_=r(21458),j=r(13568),z=r(92498);function N(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function k(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let R=(i=(0,D.A)({type:"number",name:"Pixel size",description:"Pixel size of the corner point"}),o=(0,D.A)({type:"string",name:"Color",description:"Corner point color. Can be any valid CSS color string."}),n=class extends E.A{constructor(){super(...arguments),N(this,"pixelSize",a,this),N(this,"color",s,this)}},a=k(n.prototype,"pixelSize",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=k(n.prototype,"color",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n),M=(l=(0,D.A)({type:"string",name:"Length",description:"Length of the box"}),c=(0,D.A)({type:"string",name:"Length",description:"Length of the box"}),u=(0,D.A)({type:"string",name:"Length",description:"Length of the box"}),p=class extends E.A{constructor(){super(...arguments),N(this,"length",d,this),N(this,"width",h,this),N(this,"height",m,this)}},d=k(p.prototype,"length",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=k(p.prototype,"width",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=k(p.prototype,"height",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p),F=(f=(0,T.A)({type:j.A,name:"Box position",description:"Latitude, longitude and height of the box in degrees"}),g=(0,T.A)({type:M,name:"Box dimension",description:"Length, width and height of the box"}),y=(0,T.A)({type:z.A,name:"Rotation",description:"Rotation specified as heading, pitch and roll in degrees."}),b=(0,T.A)({type:R,name:"Corner points styling",description:"Corner points styling"}),v=class extends E.A{constructor(){super(...arguments),N(this,"position",w,this),N(this,"size",A,this),N(this,"rotation",S,this),N(this,"cornerPointsStyle",x,this)}},w=k(v.prototype,"position",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=k(v.prototype,"size",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=k(v.prototype,"rotation",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=k(v.prototype,"cornerPointsStyle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v);var L,G,U,W,q,B,V,H,$,J,X,K,Z,Q,Y,ee,te,re,ie,oe,ne,ae,se,le,ce,ue,pe,de,he,me,fe,ge,ye,be,ve,we,Ae,Se,xe,Oe,Pe,Te,Ie,De,Ce;function Ee(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function _e(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let je=(L=(0,D.A)({name:"Distance",type:"number",description:" The shortest distance from the origin to the plane. The sign of distance determines which side of the plane the origin is on. If distance is positive, the origin is in the half-space in the direction of the normal; if negative, the origin is in the half-space opposite to the normal; if zero, the plane passes through the origin."}),G=(0,I.A)({name:"Normal Cartesian3",type:"number",description:"The plane's normal (normalized)."}),U=class extends E.A{constructor(){super(...arguments),Ee(this,"distance",W,this),Ee(this,"normal",q,this)}},W=_e(U.prototype,"distance",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),q=_e(U.prototype,"normal",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U),ze=(B=(0,D.A)({type:"boolean",name:"Enabled Clipping Plane",description:"Determines whether the clipping planes are active."}),V=(0,D.A)({type:"boolean",name:"UnionClippingRegions",description:"If true, a region will be clipped if it is on the outside of any plane in the collection. Otherwise, a region will only be clipped if it is on the outside of every plane."}),H=(0,D.A)({type:"number",name:"Edge Width",description:"The width, in pixels, of the highlight applied to the edge along which an object is clipped."}),$=(0,D.A)({type:"string",name:"Edge Color",description:"The color applied to highlight the edge along which an object is clipped."}),J=(0,P.Ay)({type:je,name:"Clipping Plane Array",description:"An array of ClippingPlane objects used to selectively disable rendering on the outside of each plane.",idProperty:"index"}),X=(0,I.A)({name:"Model Matrix",type:"number",description:"The 4x4 transformation matrix specifying an additional transform relative to the clipping planes original coordinate system."}),K=class extends E.A{constructor(){super(...arguments),Ee(this,"enabled",Z,this),Ee(this,"unionClippingRegions",Q,this),Ee(this,"edgeWidth",Y,this),Ee(this,"edgeColor",ee,this),Ee(this,"planes",te,this),Ee(this,"modelMatrix",re,this)}},Z=_e(K.prototype,"enabled",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Q=_e(K.prototype,"unionClippingRegions",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y=_e(K.prototype,"edgeWidth",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=_e(K.prototype,"edgeColor",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=_e(K.prototype,"planes",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=_e(K.prototype,"modelMatrix",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K),Ne=(ie=(0,D.A)({type:"number",name:"Length",description:"Length of the clipping box (along the x-axis)."}),oe=(0,D.A)({type:"number",name:"Length",description:"Width of the clipping box (along the y-axis)."}),ne=(0,D.A)({type:"number",name:"Length",description:"Height of the clipping box."}),ae=class extends E.A{constructor(){super(...arguments),Ee(this,"length",se,this),Ee(this,"width",le,this),Ee(this,"height",ce,this)}},se=_e(ae.prototype,"length",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=_e(ae.prototype,"width",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=_e(ae.prototype,"height",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae),ke=(ue=(0,D.A)({type:"boolean",name:"Enable clipping box features",description:"Set false to completely disable clipping box feature for the item."}),pe=(0,D.A)({type:"boolean",name:"Toggle model clipping.",description:"Applies clipping when true."}),de=(0,D.A)({type:"boolean",name:"Show clipping box",description:"Shows a 3D box and associated UI for editing the clip volume."}),he=(0,D.A)({type:"boolean",name:"Keep clipping box above ground",description:"When true, prevents the box from going underground."}),me=(0,T.A)({type:j.A,name:"position",description:"Latitude, longitude and height of the clipping box. When not set, the box is positioned at the center of the screen."}),fe=(0,T.A)({type:Ne,name:"Dimensions",description:"The length, width and height of the clipping box. When not set, the box will be 1/3rd the screen size."}),ge=(0,D.A)({type:"string",name:"Clip direction",description:'Whether to clip the model outside of the box or inside. When this value is "outside", everything outside the box is clipped and when the value is "inside", everything inside the box is clipped. Default value is "inside"'}),ye=class extends((0,C.A)(F)){constructor(){super(...arguments),Ee(this,"enableFeature",be,this),Ee(this,"clipModel",ve,this),Ee(this,"showClippingBox",we,this),Ee(this,"keepBoxAboveGround",Ae,this),Ee(this,"position",Se,this),Ee(this,"dimensions",xe,this),Ee(this,"clipDirection",Oe,this)}},be=_e(ye.prototype,"enableFeature",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ve=_e(ye.prototype,"clipModel",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),we=_e(ye.prototype,"showClippingBox",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ae=_e(ye.prototype,"keepBoxAboveGround",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Se=_e(ye.prototype,"position",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),xe=_e(ye.prototype,"dimensions",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=_e(ye.prototype,"clipDirection",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"inside"}}),ye),Re=(Pe=(0,T.A)({type:ze,name:"ClippingPlanes",description:"The ClippingPlaneCollection used to selectively disable rendering the tileset."}),Te=(0,T.A)({type:ke,name:"Clipping box",description:"Defines a user controllable clipping box used to hide or show sections of a model."}),Ie=class extends E.A{constructor(){super(...arguments),Ee(this,"clippingPlanes",De,this),Ee(this,"clippingBox",Ce,this)}},De=_e(Ie.prototype,"clippingPlanes",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=_e(Ie.prototype,"clippingBox",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie);var Me,Fe,Le,Ge,Ue,We,qe,Be,Ve,He,$e,Je,Xe,Ke,Ze,Qe,Ye,et,tt,rt,it,ot,nt,at,st,lt,ct,ut,pt,dt,ht,mt,ft,gt,yt,bt,vt,wt,At,St,xt,Ot,Pt=r(27294),Tt=r(87531),It=r(17618),Dt=r(93566),Ct=r(57653),Et=r(52273),_t=r(26406),jt=r(6160),zt=r(85878),Nt=r(56480),kt=r(13415);function Rt(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Mt(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Ft=(Me=(0,D.A)({type:"string",name:"Name",description:"A name for the filter"}),Fe=(0,D.A)({type:"string",name:"property",description:"The name of the feature property to filter"}),Le=(0,D.A)({type:"number",name:"minimumValue",description:"Minimum value of the property"}),Ge=(0,D.A)({type:"number",name:"minimumValue",description:"Minimum value of the property"}),Ue=(0,D.A)({type:"number",name:"minimumShown",description:"The lowest value the property can have if it is to be shown"}),We=(0,D.A)({type:"number",name:"minimumValue",description:"The largest value the property can have if it is to be shown"}),qe=class extends E.A{constructor(){super(...arguments),Rt(this,"name",Be,this),Rt(this,"property",Ve,this),Rt(this,"minimumValue",He,this),Rt(this,"maximumValue",$e,this),Rt(this,"minimumShown",Je,this),Rt(this,"maximumShown",Xe,this)}},Be=Mt(qe.prototype,"name",[Me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Mt(qe.prototype,"property",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=Mt(qe.prototype,"minimumValue",[Le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Mt(qe.prototype,"maximumValue",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Mt(qe.prototype,"minimumShown",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Mt(qe.prototype,"maximumShown",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe),Lt=(Ke=(0,D.A)({type:"boolean",name:"Attenuation",description:"Perform point attenuation based on geometric error."}),Ze=(0,D.A)({type:"number",name:"geometricErrorScale",description:"Scale to be applied to each tile's geometric error."}),Qe=class extends E.A{constructor(){super(...arguments),Rt(this,"attenuation",Ye,this),Rt(this,"geometricErrorScale",et,this)}},Ye=Mt(Qe.prototype,"attenuation",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=Mt(Qe.prototype,"geometricErrorScale",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe),Gt=(tt=(0,D.A)({type:"number",name:"Maximum screen space error",description:"The maximum screen space error used to drive level of detail refinement."}),rt=(0,D.A)({type:"number",name:"Maximum number of loaded tiles",description:""}),it=(0,T.A)({type:Lt,name:"Point cloud shading",description:"Point cloud shading parameters"}),ot=(0,D.A)({type:"boolean",name:"Show credits on screen",description:"Whether to display the credits of this tileset on screen."}),nt=class extends E.A{constructor(){super(...arguments),Rt(this,"maximumScreenSpaceError",at,this),Rt(this,"maximumNumberOfLoadedTiles",st,this),Rt(this,"pointCloudShading",lt,this),Rt(this,"showCreditsOnScreen",ct,this)}},at=Mt(nt.prototype,"maximumScreenSpaceError",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st=Mt(nt.prototype,"maximumNumberOfLoadedTiles",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=Mt(nt.prototype,"pointCloudShading",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=Mt(nt.prototype,"showCreditsOnScreen",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nt),Ut=(ut=(0,T.A)({type:Gt,name:"options",description:"Additional options to pass to Cesium's Cesium3DTileset constructor."}),pt=(0,O.A)({name:"style",description:"The style to use, specified according to the [Cesium 3D Tiles Styling Language](https://github.com/AnalyticalGraphicsInc/3d-tiles/tree/master/specification/Styling)."}),dt=(0,P.Ay)({type:Ft,idProperty:"name",name:"filters",description:"The filters to apply to this catalog item."}),ht=(0,D.A)({name:"Color blend mode",type:"string",description:"The color blend mode decides how per-feature color is blended with color defined in the tileset. Acceptable values are HIGHLIGHT, MIX & REPLACE as defined in the cesium documentation - https://cesium.com/docs/cesiumjs-ref-doc/Cesium3DTileColorBlendMode.html"}),mt=(0,D.A)({name:"Color blend amount",type:"number",description:"When the colorBlendMode is MIX this value is used to interpolate between source color and feature color. A value of 0.0 results in the source color while a value of 1.0 results in the feature color, with any value in-between resulting in a mix of the source color and feature color."}),ft=(0,I.A)({name:"Feature ID properties",type:"string",description:"One or many properties of a feature that together identify it uniquely. This is useful for setting properties for individual features. eg: ['lat', 'lon'], ['buildingId'] etc."}),gt=(0,I.A)({name:"lightColor",type:"number",description:"The light color when shading models. When undefined the scene's light color is used instead. eg: [255, 255, 255]."}),yt=class extends((0,C.A)(Pt.A,Ct.A,jt.A,Nt.A,It.Ay,zt.A,_.Ay,Et.A,Dt.A,Tt.A,Et.A,Re,_t.A,kt.A)){constructor(){super(...arguments),Rt(this,"options",bt,this),Rt(this,"style",vt,this),Rt(this,"filters",wt,this),Rt(this,"colorBlendMode",At,this),Rt(this,"colorBlendAmount",St,this),Rt(this,"featureIdProperties",xt,this),Rt(this,"lightColor",Ot,this)}},bt=Mt(yt.prototype,"options",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Mt(yt.prototype,"style",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Mt(yt.prototype,"filters",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Mt(yt.prototype,"colorBlendMode",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"MIX"}}),St=Mt(yt.prototype,"colorBlendAmount",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),xt=Mt(yt.prototype,"featureIdProperties",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Mt(yt.prototype,"lightColor",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt)},51101:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>gt}),r(94490),r(26910),r(62953);var i=r(27813),o=r(56870),n=r(39348),a=r(21381),s=r(94011),l=r(79688),c=r(76970),u=r(45164),p=r(99773),d=r(26730),h=r(6119),m=r(5623),f=r(89568),g=r(25395),y=r(6989),b=(r(27495),r(15876)),v=(r(89463),r(59801)),w=r(86123),A=r(91273),S=r(84553);function x(e){var t;let r=(t=class extends((0,S.A)(e)){constructor(){super(...arguments),(0,i.Gn)(this)}get resultsAreReferences(){var e;return(0,A.A)(null===(e=this.terria.catalogIndex)||void 0===e?void 0:e.loadPromise)&&"fulfilled"===(0,w.Sx)(this.terria.catalogIndex.loadPromise).state}get hasCatalogSearchProviderMixin(){return!0}},o=t.prototype,n="resultsAreReferences",a=[i.EW],s=Object.getOwnPropertyDescriptor(t.prototype,"resultsAreReferences"),l=t.prototype,c={},Object.keys(s).forEach(function(e){c[e]=s[e]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=a.slice().reverse().reduce(function(e,t){return t(o,n,e)||e},c),l&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(l):void 0,c.initializer=void 0),void 0===c.initializer&&Object.defineProperty(o,n,c),t);var o,n,a,s,l,c;return r}(x||(x={})).isMixedInto=function(e){return e&&e.hasCatalogSearchProviderMixin};const O=x;var P,T,I,D=r(71222),C=r(53389),E=r(71547);let _=(P=(0,D.A)({type:"string",name:"Name",description:"Name of the search provider."}),T=class extends((0,C.A)(E.A)){constructor(){var e;super(...arguments),(e=I)&&Object.defineProperty(this,"name",{enumerable:e.enumerable,configurable:e.configurable,writable:e.writable,value:e.initializer?e.initializer.call(this):void 0})}},j=T.prototype,z="name",N=[P],k={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Catalog items"}},R={},Object.keys(k).forEach(function(e){R[e]=k[e]}),R.enumerable=!!R.enumerable,R.configurable=!!R.configurable,("value"in R||R.initializer)&&(R.writable=!0),R=N.slice().reverse().reduce(function(e,t){return t(j,z,e)||e},R),I=void 0===R.initializer?(Object.defineProperty(j,z,R),null):R,T);var j,z,N,k,R,M,F,L,G,U=r(90147),W=r(85895);function q(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function B(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function V(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(n>10)return Promise.resolve();const a=e.filter(e=>{if(void 0===o.get(e.uniqueId)){const n=e.target||e;(0,i.fm)(a=>{const s=-1!=="".concat(n.name," ").concat(n.uniqueId," ").concat(n.description).toLowerCase().indexOf(t);o.set(e.uniqueId,s),s&&(0,i.h5)(()=>{r.results.push(new W.A({name:n.name,catalogItem:n}))}),a.dispose()})}return!(!d.A.isMixedInto(e)&&!u.A.isMixedInto(e))});return 0===a.length?Promise.resolve():new Promise((s,l)=>{(0,i.fm)(i=>{Promise.all(a.map(async e=>{d.A.isMixedInto(e)&&(await e.loadReference()).throwIfError()})).then(()=>{s(V(e,t,r,o,n+1))}).catch(e=>{l(e)}),i.dispose()})})}let H=(G=class e extends(O((0,U.A)(_))){constructor(e,t){super(e,t),q(this,"isSearching",F,this),q(this,"debounceDurationOnceLoaded",L,this),(0,i.Gn)(this),this.setTrait(h.A.defaults,"minCharacters",t.searchBarModel.minCharacters)}get type(){return e.type}logEvent(e){var t;null===(t=this.terria.analytics)||void 0===t||t.logEvent(a.b7.search,a.h3.catalog,e)}async doSearch(e,t){if((0,i.h5)(()=>this.isSearching=!0),t.results.length=0,t.message=void 0,void 0===e||/^\s*$/.test(e))return(0,i.h5)(()=>this.isSearching=!1),Promise.resolve();if(this.terria.catalogIndex&&!this.terria.catalogIndex.loadPromise)try{await this.terria.catalogIndex.load()}catch(e){this.terria.raiseErrorToUser(e,"Failed to load catalog index. Searching may be slow/inaccurate")}const r=new Map;try{var o;if(null!==(o=this.terria.catalogIndex)&&void 0!==o&&o.searchIndex){const r=await this.terria.catalogIndex.search(e);(0,i.h5)(()=>t.results=r)}else await V(this.terria.modelValues,e.toLowerCase(),t,r);if((0,i.h5)(()=>{this.isSearching=!1}),t.isCanceled)return;(0,i.h5)(()=>{this.terria.catalogReferencesLoaded=!0}),0===t.results.length&&(t.message={content:"translate#viewModels.searchNoCatalogueItem"})}catch(e){if(this.terria.raiseErrorToUser(e,{message:"An error occurred while searching",severity:v.FK.Warning}),t.isCanceled)return;t.message={content:"translate#viewModels.searchErrorOccurred"}}}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(G,"type","catalog-search-provider"),F=B((M=G).prototype,"isSearching",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=B(M.prototype,"debounceDurationOnceLoaded",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),M);var $,J,X,K,Z,Q,Y,ee,te,re,ie,oe,ne;function ae(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function se(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function le(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let ce=(J=le(($=class{constructor(e){ae(this,"catalogSearchText",J,this),ae(this,"isWaitingToStartCatalogSearch",X,this),ae(this,"locationSearchText",K,this),ae(this,"isWaitingToStartLocationSearch",Z,this),ae(this,"unifiedSearchText",Q,this),ae(this,"isWaitingToStartUnifiedSearch",Y,this),ae(this,"showLocationSearchResults",ee,this),ae(this,"showMobileLocationSearch",te,this),ae(this,"showMobileCatalogSearch",re,this),ae(this,"locationSearchResults",ie,this),ae(this,"catalogSearchResults",oe,this),ae(this,"unifiedSearchResults",ne,this),se(this,"_catalogSearchDisposer",void 0),se(this,"_locationSearchDisposer",void 0),se(this,"_unifiedSearchDisposer",void 0),se(this,"_workbenchItemsSubscription",void 0),se(this,"terria",void 0),(0,i.Gn)(this),this.terria=e.terria,(0,i.h5)(()=>{this.terria.searchBarModel.catalogSearchProvider=e.catalogSearchProvider||new H("catalog-search-provider",e.terria)});const t=this;this._catalogSearchDisposer=(0,i.mJ)(()=>t.catalogSearchText,()=>{t.isWaitingToStartCatalogSearch=!0,t.catalogSearchProvider&&(t.catalogSearchResults=t.catalogSearchProvider.search(""))}),this._locationSearchDisposer=(0,i.mJ)(()=>t.locationSearchText,()=>{t.isWaitingToStartLocationSearch=!0,t.locationSearchResults=t.locationSearchProviders.map(e=>e.search(""))}),this._unifiedSearchDisposer=(0,i.mJ)(()=>this.unifiedSearchText,()=>{this.isWaitingToStartUnifiedSearch=!0,this.unifiedSearchResults=this.unifiedSearchProviders.map(e=>e.search(""))}),this._workbenchItemsSubscription=(0,i.mJ)(()=>this.terria.workbench.items,()=>{this.showLocationSearchResults=!1})}dispose(){this._catalogSearchDisposer(),this._locationSearchDisposer(),this._unifiedSearchDisposer(),this._workbenchItemsSubscription()}get supportsAutocomplete(){return this.locationSearchProviders.every(e=>e.supportsAutocomplete())}get locationSearchProviders(){return this.terria.searchBarModel.locationSearchProvidersArray}get catalogSearchProvider(){return this.terria.searchBarModel.catalogSearchProvider}get unifiedSearchProviders(){return(0,b.A)([this.catalogSearchProvider,...this.locationSearchProviders])}searchCatalog(){this.isWaitingToStartCatalogSearch&&(this.isWaitingToStartCatalogSearch=!1,this.catalogSearchResults&&(this.catalogSearchResults.isCanceled=!0),this.catalogSearchProvider&&(this.catalogSearchResults=this.catalogSearchProvider.search(this.catalogSearchText)))}setCatalogSearchText(e){this.catalogSearchText=e}searchLocations(){this.isWaitingToStartLocationSearch&&(this.isWaitingToStartLocationSearch=!1,this.locationSearchResults.forEach(e=>{e.isCanceled=!0}),this.locationSearchResults=this.locationSearchProviders.map(e=>e.search(this.locationSearchText)))}searchUnified(){this.isWaitingToStartUnifiedSearch&&(this.isWaitingToStartUnifiedSearch=!1,this.unifiedSearchResults.forEach(e=>{e.isCanceled=!0}),this.unifiedSearchResults=this.unifiedSearchProviders.map(e=>e.search(this.unifiedSearchText)))}}).prototype,"catalogSearchText",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),X=le($.prototype,"isWaitingToStartCatalogSearch",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),K=le($.prototype,"locationSearchText",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Z=le($.prototype,"isWaitingToStartLocationSearch",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q=le($.prototype,"unifiedSearchText",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Y=le($.prototype,"isWaitingToStartUnifiedSearch",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ee=le($.prototype,"showLocationSearchResults",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),te=le($.prototype,"showMobileLocationSearch",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),re=le($.prototype,"showMobileCatalogSearch",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ie=le($.prototype,"locationSearchResults",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),oe=le($.prototype,"catalogSearchResults",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=le($.prototype,"unifiedSearchResults",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),le($.prototype,"supportsAutocomplete",[i.EW],Object.getOwnPropertyDescriptor($.prototype,"supportsAutocomplete"),$.prototype),le($.prototype,"locationSearchProviders",[i.EW],Object.getOwnPropertyDescriptor($.prototype,"locationSearchProviders"),$.prototype),le($.prototype,"catalogSearchProvider",[i.EW],Object.getOwnPropertyDescriptor($.prototype,"catalogSearchProvider"),$.prototype),le($.prototype,"unifiedSearchProviders",[i.EW],Object.getOwnPropertyDescriptor($.prototype,"unifiedSearchProviders"),$.prototype),le($.prototype,"searchCatalog",[i.XI],Object.getOwnPropertyDescriptor($.prototype,"searchCatalog"),$.prototype),le($.prototype,"setCatalogSearchText",[i.XI],Object.getOwnPropertyDescriptor($.prototype,"setCatalogSearchText"),$.prototype),le($.prototype,"searchLocations",[i.XI],Object.getOwnPropertyDescriptor($.prototype,"searchLocations"),$.prototype),le($.prototype,"searchUnified",[i.XI],Object.getOwnPropertyDescriptor($.prototype,"searchUnified"),$.prototype),$);var ue,pe,de,he,me,fe,ge,ye,be,ve,we,Ae,Se,xe,Oe,Pe,Te,Ie,De,Ce,Ee,_e,je,ze,Ne,ke,Re,Me,Fe,Le,Ge,Ue,We,qe,Be,Ve,He,$e,Je,Xe,Ke,Ze,Qe,Ye,et,tt,rt,it,ot,nt,at,st,lt,ct,ut=r(83380);function pt(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function dt(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ht(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const mt="data-catalog",ft="my-data";let gt=(ue=class{get previewedItem(){return this._previewedItem}setSelectedTrainerItem(e){this.selectedTrainerItem=e}setTrainerBarVisible(e){this.trainerBarVisible=e}setTrainerBarShowingAllSteps(e){this.trainerBarShowingAllSteps=e}setTrainerBarExpanded(e){this.trainerBarExpanded=e,e||(this.trainerBarShowingAllSteps=e)}setCurrentTrainerItemIndex(e){this.currentTrainerItemIndex=e,this.currentTrainerStepIndex=0}setCurrentTrainerStepIndex(e){this.currentTrainerStepIndex=e}setActionBarVisible(e){this.isActionBarVisible=e}setBottomDockHeight(e){this.bottomDockHeight!==e&&(this.bottomDockHeight=e)}get tourPointsWithValidRefs(){return this.tourPoints.slice().sort((e,t)=>e.priority-t.priority).filter(e=>{var t;return null===(t=this.appRefs.get(e.appRefName))||void 0===t?void 0:t.current})}setTourIndex(e){this.currentTourIndex=e}setShowTour(e){e?(this.setTrainerBarExpanded(!1),this.setIsMapFullScreen(!1),setTimeout(()=>{(0,i.h5)(()=>{this.showTour=e})},g.H9||1)):this.showTour=e}closeTour(){this.currentTourIndex=-1,this.showTour=!1}previousTourPoint(){const e=this.currentTourIndex;0!==e&&(this.currentTourIndex=e-1)}nextTourPoint(){const e=this.tourPointsWithValidRefs.length,t=this.currentTourIndex;t>=e-1?this.closeTour():this.currentTourIndex=t+1}closeCollapsedNavigation(){this.showCollapsedNavigation=!1}updateAppRef(e,t){this.appRefs.get(e)&&this.appRefs.get(e)===t||this.appRefs.set(e,t)}deleteAppRef(e){this.appRefs.delete(e)}constructor(e){dt(this,"mobileViewOptions",Object.freeze({data:"data",preview:"preview",nowViewing:"nowViewing",locationSearchResults:"locationSearchResults"})),dt(this,"searchState",void 0),dt(this,"terria",void 0),dt(this,"relativePosition",y.QQ),pt(this,"_previewedItem",pe,this),pt(this,"userDataPreviewedItem",de,this),pt(this,"explorerPanelIsVisible",he,this),pt(this,"activeTabCategory",me,this),pt(this,"activeTabIdInCategory",fe,this),pt(this,"isDraggingDroppingFile",ge,this),pt(this,"mobileView",ye,this),pt(this,"isMapFullScreen",be,this),pt(this,"myDataIsUploadView",ve,this),pt(this,"mobileMenuVisible",we,this),pt(this,"explorerPanelAnimating",Ae,this),pt(this,"topElement",Se,this),pt(this,"portals",xe,this),pt(this,"storyBuilderShown",Oe,this),pt(this,"showHelpMenu",Pe,this),pt(this,"showSatelliteGuidance",Te,this),pt(this,"showWelcomeMessage",Ie,this),pt(this,"selectedHelpMenuItem",De,this),pt(this,"helpPanelExpanded",Ce,this),pt(this,"disclaimerSettings",Ee,this),pt(this,"disclaimerVisible",_e,this),pt(this,"videoGuideVisible",je,this),pt(this,"trainerBarVisible",ze,this),pt(this,"trainerBarExpanded",Ne,this),pt(this,"trainerBarShowingAllSteps",ke,this),pt(this,"selectedTrainerItem",Re,this),pt(this,"currentTrainerItemIndex",Me,this),pt(this,"currentTrainerStepIndex",Fe,this),pt(this,"printWindow",Le,this),pt(this,"remoteDataType",Ge,this),pt(this,"currentCesiumIonToken",Ue,this),pt(this,"isActionBarVisible",We,this),pt(this,"globalViewingControlOptions",qe,this),pt(this,"workbenchItemInputGenerators",Be,this),pt(this,"featureInfoPanelButtonGenerators",Ve,this),pt(this,"bottomDockHeight",He,this),dt(this,"errorProvider",null),pt(this,"storyShown",$e,this),pt(this,"currentStoryId",Je,this),pt(this,"featurePrompts",Xe,this),pt(this,"tourPoints",Ke,this),pt(this,"showTour",Ze,this),pt(this,"appRefs",Qe,this),pt(this,"currentTourIndex",Ye,this),pt(this,"showCollapsedNavigation",et,this),pt(this,"useSmallScreenInterface",tt,this),pt(this,"featureInfoPanelIsVisible",rt,this),pt(this,"featureInfoPanelIsCollapsed",it,this),pt(this,"firstTimeAddingData",ot,this),pt(this,"feedbackFormIsVisible",nt,this),pt(this,"shareModalIsVisible",at,this),pt(this,"retainSharePanel",st,this),pt(this,"currentTool",lt,this),pt(this,"panel",ct,this),dt(this,"_pickedFeaturesSubscription",void 0),dt(this,"_disclaimerVisibleSubscription",void 0),dt(this,"_isMapFullScreenSubscription",void 0),dt(this,"_showStoriesSubscription",void 0),dt(this,"_mobileMenuSubscription",void 0),dt(this,"_storyPromptSubscription",void 0),dt(this,"_previewedItemIdSubscription",void 0),dt(this,"_locationMarkerSubscription",void 0),dt(this,"_workbenchHasTimeWMSSubscription",void 0),dt(this,"_storyBeforeUnloadSubscription",void 0),(0,i.Gn)(this);const t=e.terria;this.searchState=new ce({terria:t,catalogSearchProvider:e.catalogSearchProvider}),this.errorProvider=e.errorHandlingProvider?e.errorHandlingProvider:null,this.terria=t,this._pickedFeaturesSubscription=(0,i.mJ)(()=>this.terria.pickedFeatures,e=>{(0,o.A)(e)?(this.featureInfoPanelIsVisible=!0,this.featureInfoPanelIsCollapsed=!1):this.featureInfoPanelIsVisible=!1}),this._disclaimerVisibleSubscription=(0,i.mJ)(()=>this.disclaimerVisible,e=>{this.isMapFullScreen=e||"1"===t.userProperties.get("hideWorkbench")||"1"===t.userProperties.get("hideExplorerPanel")}),this._isMapFullScreenSubscription=(0,i.mJ)(()=>"1"===t.userProperties.get("hideWorkbench")||"1"===t.userProperties.get("hideExplorerPanel"),e=>{this.isMapFullScreen=e,(0,o.A)(this.storyShown)||(this.storyShown=t.configParameters.storyEnabled)}),this._showStoriesSubscription=(0,i.mJ)(()=>Boolean(t.userProperties.get("playStory")),e=>{this.storyShown=t.configParameters.storyEnabled&&e}),this._mobileMenuSubscription=(0,i.mJ)(()=>this.mobileMenuVisible,e=>{e&&(this.explorerPanelIsVisible=!1,this.switchMobileView(null))}),this._workbenchHasTimeWMSSubscription=(0,i.mJ)(()=>this.terria.workbench.hasTimeWMS,e=>{this.terria.configParameters.showInAppGuides&&!0===e&&!this.terria.getLocalProperty("".concat(f.dZ,"Prompted"))&&(this.setShowSatelliteGuidance(!0),this.toggleFeaturePrompt(f.dZ,!0,!0))}),this._storyPromptSubscription=(0,i.mJ)(()=>this.storyShown,e=>{!1===e&&(this.terria.getLocalProperty("storyPrompted")||this.toggleFeaturePrompt("story",!0,!1))}),this._locationMarkerSubscription=(0,i.mJ)(()=>(0,ut.P6)(this.terria),e=>{e&&(t.overlays.add(e),this._locationMarkerSubscription())}),this._previewedItemIdSubscription=(0,i.mJ)(()=>this.terria.previewedItemId,async e=>{if(void 0!==e)try{const t=await this.terria.getModelByIdShareKeyOrCatalogIndex(e);t.throwIfError();const r=t.throwIfUndefined();this.viewCatalogMember(r)}catch(r){t.raiseErrorToUser(r,{message:"Couldn't find model `".concat(e,"` for preview")})}});const r=e=>{e.preventDefault(),e.returnValue=""};this._storyBeforeUnloadSubscription=(0,i.mJ)(()=>this.terria.stories.length>0,e=>{e?window.addEventListener("beforeunload",r):window.removeEventListener("beforeunload",r)})}dispose(){this._pickedFeaturesSubscription(),this._disclaimerVisibleSubscription(),this._mobileMenuSubscription(),this._isMapFullScreenSubscription(),this._showStoriesSubscription(),this._storyPromptSubscription(),this._previewedItemIdSubscription(),this._workbenchHasTimeWMSSubscription(),this._locationMarkerSubscription(),this._storyBeforeUnloadSubscription(),this.searchState.dispose()}triggerResizeEvent(){(0,l.A)()}setIsMapFullScreen(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;this.isMapFullScreen=e,setTimeout(function(){(0,l.A)()},t)}toggleStoryBuilder(){this.storyBuilderShown=!this.storyBuilderShown}setTopElement(e){this.topElement=e}openAddData(){this.explorerPanelIsVisible=!0,this.activeTabCategory=mt,this.switchMobileView(this.mobileViewOptions.data)}openUserData(){this.explorerPanelIsVisible=!0,this.activeTabCategory=ft}closeCatalog(){this.explorerPanelIsVisible=!1,this.switchMobileView(null),this.clearPreviewedItem()}searchInCatalog(e){this.openAddData(),this.searchState.catalogSearchText=e,this.searchState.searchCatalog()}clearPreviewedItem(){this.userDataPreviewedItem=void 0,this._previewedItem=void 0}async viewCatalogMember(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.A.user,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,i.h5)(()=>this._previewedItem=e);try{if(d.A.isMixedInto(e))return(await e.loadReference()).throwIfError(),e.target?this.viewCatalogMember(e.target):s.A.error("Could not view catalog member ".concat((0,c.m)(e)));o&&((0,n.A)(e)?((0,i.h5)(()=>this.userDataPreviewedItem=e),this.openUserData()):(0,i.h5)(()=>{if(this.openAddData(),this.terria.configParameters.tabbedCatalog){const t=(0,m.A)(e);t.length>0&&(this.activeTabIdInCategory=t[0].uniqueId)}}),u.A.isMixedInto(e)||this.switchMobileView(this.mobileViewOptions.preview)),u.A.isMixedInto(e)?(e.setTrait(r,"isOpen",t),e.isOpen&&(await e.loadMembers()).throwIfError()):p.Ay.isMixedInto(e)?(await e.loadMapItems()).throwIfError():c.A.isMixedInto(e)&&(await e.loadMetadata()).throwIfError()}catch(t){return s.A.error(t,"Could not view catalog member ".concat((0,c.m)(e)))}return s.A.none()}switchMobileView(e){this.mobileView=e}showHelpPanel(){var e;null===(e=this.terria.analytics)||void 0===e||e.logEvent(a.b7.help,a.Qv.panelOpened),this.showHelpMenu=!0,this.helpPanelExpanded=!1,this.selectedHelpMenuItem="",this.setTopElement("HelpPanel")}openHelpPanelItemFromSharePanel(e,t){e.preventDefault(),e.stopPropagation(),this.setRetainSharePanel(!0),this.showHelpPanel(),this.selectHelpMenuItem(t)}selectHelpMenuItem(e){this.selectedHelpMenuItem=e,this.helpPanelExpanded=!0}hideHelpPanel(){this.showHelpMenu=!1}setRetainSharePanel(e){this.retainSharePanel=e}changeSearchState(e){this.searchState.catalogSearchText=e}setDisclaimerVisible(e){this.disclaimerVisible=e}hideDisclaimer(){this.setDisclaimerVisible(!1)}setShowSatelliteGuidance(e){this.showSatelliteGuidance=e}setShowWelcomeMessage(e){this.showWelcomeMessage=e}setVideoGuideVisible(e){this.videoGuideVisible=e}removeModelReferences(e){this._previewedItem===e&&(this._previewedItem=void 0),this.userDataPreviewedItem===e&&(this.userDataPreviewedItem=void 0)}toggleFeaturePrompt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.featurePrompts.indexOf(e);t&&i<0&&!this.terria.getLocalProperty("".concat(e,"Prompted"))?this.featurePrompts.push(e):!t&&i>=0&&this.featurePrompts.splice(i,1),r&&this.terria.setLocalProperty("".concat(e,"Prompted"),!0)}viewingUserData(){return this.activeTabCategory===ft}afterTerriaStarted(){this.terria.configParameters.openAddData&&this.openAddData()}openTool(e){this.currentTool=e}closeTool(){this.currentTool=void 0}setPrintWindow(e){this.printWindow&&this.printWindow.close(),this.printWindow=e}toggleMobileMenu(){this.setTopElement("mobileMenu"),this.mobileMenuVisible=!this.mobileMenuVisible}runStories(){var e;this.storyBuilderShown=!1,this.storyShown=!0,setTimeout(function(){(0,l.A)()},g.H9||1),this.terria.currentViewer.notifyRepaintRequired(),null===(e=this.terria.analytics)||void 0===e||e.logEvent(a.b7.story,a.QP.runStory)}get breadcrumbsShown(){return void 0!==this.previewedItem||void 0!==this.userDataPreviewedItem}get isToolOpen(){return void 0!==this.currentTool}get hideMapUi(){return void 0!==this.terria.notificationState.currentNotification&&this.terria.notificationState.currentNotification.hideUi}get isMapZooming(){return this.terria.currentViewer.isMapZooming}get isMapInteractionActive(){return this.terria.mapInteractionModeStack.length>0}},pe=ht(ue.prototype,"_previewedItem",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=ht(ue.prototype,"userDataPreviewedItem",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=ht(ue.prototype,"explorerPanelIsVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),me=ht(ue.prototype,"activeTabCategory",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return mt}}),fe=ht(ue.prototype,"activeTabIdInCategory",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),ge=ht(ue.prototype,"isDraggingDroppingFile",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ye=ht(ue.prototype,"mobileView",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=ht(ue.prototype,"isMapFullScreen",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ve=ht(ue.prototype,"myDataIsUploadView",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),we=ht(ue.prototype,"mobileMenuVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ae=ht(ue.prototype,"explorerPanelAnimating",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Se=ht(ue.prototype,"topElement",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"FeatureInfo"}}),xe=ht(ue.prototype,"portals",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Oe=ht(ue.prototype,"storyBuilderShown",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Pe=ht(ue.prototype,"showHelpMenu",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Te=ht(ue.prototype,"showSatelliteGuidance",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ie=ht(ue.prototype,"showWelcomeMessage",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),De=ht(ue.prototype,"selectedHelpMenuItem",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ce=ht(ue.prototype,"helpPanelExpanded",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ee=ht(ue.prototype,"disclaimerSettings",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),_e=ht(ue.prototype,"disclaimerVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),je=ht(ue.prototype,"videoGuideVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ze=ht(ue.prototype,"trainerBarVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ne=ht(ue.prototype,"trainerBarExpanded",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ke=ht(ue.prototype,"trainerBarShowingAllSteps",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Re=ht(ue.prototype,"selectedTrainerItem",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Me=ht(ue.prototype,"currentTrainerItemIndex",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fe=ht(ue.prototype,"currentTrainerStepIndex",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Le=ht(ue.prototype,"printWindow",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=ht(ue.prototype,"remoteDataType",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Ue=ht(ue.prototype,"currentCesiumIonToken",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),We=ht(ue.prototype,"isActionBarVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qe=ht(ue.prototype,"globalViewingControlOptions",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Be=ht(ue.prototype,"workbenchItemInputGenerators",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ve=ht(ue.prototype,"featureInfoPanelButtonGenerators",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ht(ue.prototype,"setSelectedTrainerItem",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setSelectedTrainerItem"),ue.prototype),ht(ue.prototype,"setTrainerBarVisible",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setTrainerBarVisible"),ue.prototype),ht(ue.prototype,"setTrainerBarShowingAllSteps",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setTrainerBarShowingAllSteps"),ue.prototype),ht(ue.prototype,"setTrainerBarExpanded",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setTrainerBarExpanded"),ue.prototype),ht(ue.prototype,"setCurrentTrainerItemIndex",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setCurrentTrainerItemIndex"),ue.prototype),ht(ue.prototype,"setCurrentTrainerStepIndex",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setCurrentTrainerStepIndex"),ue.prototype),ht(ue.prototype,"setActionBarVisible",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setActionBarVisible"),ue.prototype),He=ht(ue.prototype,"bottomDockHeight",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ht(ue.prototype,"setBottomDockHeight",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setBottomDockHeight"),ue.prototype),$e=ht(ue.prototype,"storyShown",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=ht(ue.prototype,"currentStoryId",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xe=ht(ue.prototype,"featurePrompts",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ke=ht(ue.prototype,"tourPoints",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y.VD}}),Ze=ht(ue.prototype,"showTour",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qe=ht(ue.prototype,"appRefs",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Ye=ht(ue.prototype,"currentTourIndex",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),et=ht(ue.prototype,"showCollapsedNavigation",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ht(ue.prototype,"tourPointsWithValidRefs",[i.EW],Object.getOwnPropertyDescriptor(ue.prototype,"tourPointsWithValidRefs"),ue.prototype),ht(ue.prototype,"setTourIndex",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setTourIndex"),ue.prototype),ht(ue.prototype,"setShowTour",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setShowTour"),ue.prototype),ht(ue.prototype,"closeTour",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"closeTour"),ue.prototype),ht(ue.prototype,"previousTourPoint",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"previousTourPoint"),ue.prototype),ht(ue.prototype,"nextTourPoint",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"nextTourPoint"),ue.prototype),ht(ue.prototype,"closeCollapsedNavigation",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"closeCollapsedNavigation"),ue.prototype),ht(ue.prototype,"updateAppRef",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"updateAppRef"),ue.prototype),ht(ue.prototype,"deleteAppRef",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"deleteAppRef"),ue.prototype),tt=ht(ue.prototype,"useSmallScreenInterface",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rt=ht(ue.prototype,"featureInfoPanelIsVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),it=ht(ue.prototype,"featureInfoPanelIsCollapsed",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ot=ht(ue.prototype,"firstTimeAddingData",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),nt=ht(ue.prototype,"feedbackFormIsVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),at=ht(ue.prototype,"shareModalIsVisible",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),st=ht(ue.prototype,"retainSharePanel",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),lt=ht(ue.prototype,"currentTool",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=ht(ue.prototype,"panel",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht(ue.prototype,"triggerResizeEvent",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"triggerResizeEvent"),ue.prototype),ht(ue.prototype,"setIsMapFullScreen",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setIsMapFullScreen"),ue.prototype),ht(ue.prototype,"toggleStoryBuilder",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"toggleStoryBuilder"),ue.prototype),ht(ue.prototype,"setTopElement",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setTopElement"),ue.prototype),ht(ue.prototype,"openAddData",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"openAddData"),ue.prototype),ht(ue.prototype,"openUserData",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"openUserData"),ue.prototype),ht(ue.prototype,"closeCatalog",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"closeCatalog"),ue.prototype),ht(ue.prototype,"searchInCatalog",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"searchInCatalog"),ue.prototype),ht(ue.prototype,"clearPreviewedItem",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"clearPreviewedItem"),ue.prototype),ht(ue.prototype,"switchMobileView",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"switchMobileView"),ue.prototype),ht(ue.prototype,"showHelpPanel",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"showHelpPanel"),ue.prototype),ht(ue.prototype,"openHelpPanelItemFromSharePanel",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"openHelpPanelItemFromSharePanel"),ue.prototype),ht(ue.prototype,"selectHelpMenuItem",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"selectHelpMenuItem"),ue.prototype),ht(ue.prototype,"hideHelpPanel",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"hideHelpPanel"),ue.prototype),ht(ue.prototype,"setRetainSharePanel",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setRetainSharePanel"),ue.prototype),ht(ue.prototype,"changeSearchState",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"changeSearchState"),ue.prototype),ht(ue.prototype,"setDisclaimerVisible",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setDisclaimerVisible"),ue.prototype),ht(ue.prototype,"hideDisclaimer",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"hideDisclaimer"),ue.prototype),ht(ue.prototype,"setShowSatelliteGuidance",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setShowSatelliteGuidance"),ue.prototype),ht(ue.prototype,"setShowWelcomeMessage",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setShowWelcomeMessage"),ue.prototype),ht(ue.prototype,"setVideoGuideVisible",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setVideoGuideVisible"),ue.prototype),ht(ue.prototype,"removeModelReferences",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"removeModelReferences"),ue.prototype),ht(ue.prototype,"toggleFeaturePrompt",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"toggleFeaturePrompt"),ue.prototype),ht(ue.prototype,"openTool",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"openTool"),ue.prototype),ht(ue.prototype,"closeTool",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"closeTool"),ue.prototype),ht(ue.prototype,"setPrintWindow",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"setPrintWindow"),ue.prototype),ht(ue.prototype,"toggleMobileMenu",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"toggleMobileMenu"),ue.prototype),ht(ue.prototype,"runStories",[i.XI],Object.getOwnPropertyDescriptor(ue.prototype,"runStories"),ue.prototype),ht(ue.prototype,"breadcrumbsShown",[i.EW],Object.getOwnPropertyDescriptor(ue.prototype,"breadcrumbsShown"),ue.prototype),ht(ue.prototype,"isToolOpen",[i.EW],Object.getOwnPropertyDescriptor(ue.prototype,"isToolOpen"),ue.prototype),ht(ue.prototype,"hideMapUi",[i.EW],Object.getOwnPropertyDescriptor(ue.prototype,"hideMapUi"),ue.prototype),ht(ue.prototype,"isMapInteractionActive",[i.EW],Object.getOwnPropertyDescriptor(ue.prototype,"isMapInteractionActive"),ue.prototype),ue)},51980:(e,t,r)=>{"use strict";r.d(t,{R:()=>we}),r(94490),r(46449),r(93514),r(27495),r(62953);var i,o,n,a,s,l,c,u,p,d,h,m,f,g,y,b,v,w,A,S,x,O,P,T,I,D=r(9828),C=r(74722),E=r(77500),_=r(27813),j=r(84193),z=r.n(j),N=r(91273),k=r(22256),R=r(19193),M=r(97326),F=r(34502),L=r(27265),G=r(31647),U=r(71222),W=r(39070),q=r(21610),B=r(53389),V=r(63704),H=r(88963),$=r(21458),J=r(87531),X=r(3236);function K(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Z(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Q=(i=(0,U.A)({name:"Kind",type:"string",description:'Determines how table rows are constructed from this API.\n* PER_ROW: Row major, values are specific to a row in the table eg. [{"col1": 12, "col2": 13}] \n* PER_ID: Values are the same for all objects with the same id.\n* COLUMN_MAJOR: API response is in a column major format, eg. [{"row1": 12, "row2": 13}]. The keys in each list item (eg. "row1") will be used as the row id.\n'}),o=(0,G.A)({name:"Column major column names",type:"string",description:'Used when `kind` is "COLUMN_MAJOR". The name of each column in the order they appear in the API response.'}),n=class extends((0,B.A)(V.A)){constructor(){super(...arguments),K(this,"kind",a,this),K(this,"columnMajorColumnNames",s,this)}},a=Z(n.prototype,"kind",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"PER_ROW"}}),s=Z(n.prototype,"columnMajorColumnNames",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["value"]}}),n),Y=(l=(0,U.A)({name:"Name",type:"string",description:"Column name. This must match name in `columns`."}),c=(0,U.A)({name:"Response data path",type:"string",description:"Path to relevant data in JSON response. eg: `some.user.name`, `some.users[0].name` or `some.users[].name`. For data to be parsed correctly, it must return a primitive value (string, number, boolean)."}),u=class extends W.A{constructor(){super(...arguments),K(this,"name",p,this),K(this,"responseDataPath",d,this)}},p=Z(u.prototype,"name",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Z(u.prototype,"responseDataPath",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u),ee=(h=(0,q.b)({description:"Creates an <b>api-table</b> type dataset in the catalog, typically used for live sensor data.",example:{type:"api-table",name:"City of Melbourne Pedestrian Counter",description:"The City of Melbourne Pedestrian Counting System data has been obtained from the City of Melbourne Open data platform: www.data.melbourne.vic.gov.au to demonstrate the directional movement of pedestrians across the city.\n\nThe counters generate a per minute reading on each of the pedestrian traffic sensors which are then displayed as near-live data.\n\nTo find out more about the City of Melbourne's Pedestrian Counting System or to seek access to their data, please click:\n\nhttp://www.pedestrian.melbourne.vic.gov.au/?_ga=2.244642053.1432520662.1632694466-1456630549.1631675392#date=27-09-2021&time=1",defaultStyle:{time:{spreadFinishTime:!0,timeColumn:"sensing_datetime"}},initialTimeSource:"stop",columns:[{name:"total_of_directions"},{name:"direction_2"},{name:"direction_1"},{name:"sensing_datetime"},{name:"latitude"},{name:"longitude"}],idKey:"location_id",refreshInterval:60,removeDuplicateRows:!0,apis:[{url:"https://melbournetestbed.opendatasoft.com/api/explore/v2.1/catalog/datasets/pedestrian-counting-system-past-hour-counts-per-minute/records?select=location_id%2Csensing_datetime%2Cdirection_1%2Cdirection_2%2Ctotal_of_directions&order_by=sensing_datetime%20DESC&limit=100",responseDataPath:"results",kind:"PER_ROW"},{url:"https://melbournetestbed.opendatasoft.com/api/explore/v2.1/catalog/datasets/pedestrian-counting-system-sensor-locations/exports/json?lang=en&timezone=Australia%2FSydney",kind:"PER_ID"}]}}),m=(0,L.Ay)({name:"APIs",type:Q,description:'The apis to use to retrieve the data of the table. Note: you **must** define which columns to use from API response in the `columns` `TableColumnTraits` - for example `[{name:"some-key-in-api-response", ...}]`',idProperty:"url"}),f=(0,L.Ay)({name:"API Columns",type:Y,description:'ApiTableCatalogItem specific column configuration. Note: you **must** define which columns to use from API response in the `columns` `TableColumnTraits` - for example `[{name:"some-key-in-api-response", ...}]`. This object only adds additional properties',idProperty:"name"}),g=(0,U.A)({name:"Id key",type:"string",description:"The name of the id property shared between all APIs"}),y=(0,U.A)({name:"Should append new data",type:"string",description:"When true, new data received through APIs will be appended to existing data. If false, new data will replace existing data."}),b=(0,L.Ay)({name:"Common query parameters",type:V.V,description:"Common query parameters to supply to all APIs. These are merged into the query parameters for each API.",idProperty:"name"}),v=(0,L.Ay)({name:"Common query parameters for updates",type:V.V,description:"Common query parameters to supply to all APIs on subsequent calls after the first call. These are merged into the update query parameters for each API.",idProperty:"name"}),h((A=class extends((0,B.A)(X.A,$.Ay,J.A,H.A)){constructor(){super(...arguments),K(this,"apis",S,this),K(this,"apiColumns",x,this),K(this,"idKey",O,this),K(this,"shouldAppendNewData",P,this),K(this,"queryParameters",T,this),K(this,"updateQueryParameters",I,this)}},S=Z(A.prototype,"apis",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=Z(A.prototype,"apiColumns",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=Z(A.prototype,"idKey",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Z(A.prototype,"shouldAppendNewData",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),T=Z(A.prototype,"queryParameters",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=Z(A.prototype,"updateQueryParameters",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=A))||w);var te,re,ie,oe,ne,ae,se=r(34236),le=r(55762),ce=r(90147),ue=r(43104),pe=r(63647),de=r(31203),he=r(53163),me=r(33620);function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function ge(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function ye(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function be(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let ve=(re=class e extends((0,pe.Ay)(ee)){duplicateLoadableStratum(t){return new e(t)}constructor(e){super(),this.catalogItem=e,(0,_.Gn)(this)}get defaultStyle(){return(0,ue.A)(se.A,{time:(0,ue.A)(le.A,{idColumns:this.catalogItem.idKey?[this.catalogItem.idKey]:void 0})})}},ye(re,"stratumName","apiTable"),be((te=re).prototype,"defaultStyle",[_.EW],Object.getOwnPropertyDescriptor(te.prototype,"defaultStyle"),te.prototype),te);he.A.addLoadStratum(ve.stratumName);let we=(ae=class e extends((0,R.A)((0,M.A)((0,ce.A)(ee)))){get type(){return e.type}constructor(e,t){super(e,t),ge(this,"apiResponses",oe,this),ge(this,"hasData",ne,this),(0,_.Gn)(this),this.strata.set(F.A.stratumName,new F.A(this)),this.strata.set(ve.stratumName,new ve(this))}get apiDataIsLoaded(){return this.apiResponses.length>0}loadDataFromApis(){const e=this.apis.filter(e=>e.url),t=e.map(e=>(0,me.A)(this,this.addQueryParams(e)));return Promise.all(e.map(async(e,r)=>{let i=await(0,k.A)(t[r],void 0,e.requestData?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t.includeStrata?t.includeStrata:Array.from(e.strata.keys()),i=t.excludeStrata?t.excludeStrata:[],o=r.filter(e=>i.indexOf(e)<0),n={};return o.forEach(t=>{const r=e.strata.get(t);void 0!==r&&(n[t]=(0,de.A)(e.traits,r))}),void 0!==e.uniqueId&&(n.id=e.uniqueId),n.type=e.type,n}(e.requestData):void 0,e.postRequestDataAsFormData);return void 0!==e.responseDataPath&&(i=Ae(i,e.responseDataPath)),Promise.resolve({data:i,api:e})})).then(e=>{(0,_.h5)(()=>{const t=new Map;if(e.filter(e=>"COLUMN_MAJOR"===e.api.kind).map((e,t)=>(e.data.TERRIA_columnName=e.api.columnMajorColumnNames[t],e.data)).flat().map(e=>Object.entries(e)).flat().forEach(e=>{const r=e[0],i=e[1],o={};if(o.value=i,o[this.idKey]=r,t.has(r)){const e=t.get(r);t.set(r,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach(function(t){ye(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({currentRow:e},i))}else t.set(r,o)}),0!==t.size)return void(this.apiResponses=Array.from(t.values()));const r=new Map(e.filter(e=>"PER_ID"===e.api.kind).map(e=>e.data).reduce((e,t)=>e.concat(t),[]).map(e=>[e[this.idKey],e])),i=e.filter(e=>"PER_ROW"===e.api.kind).map(e=>e.data).reduce((e,t)=>e.concat(t),[]).map(e=>Object.assign(e,(0,N.A)(e[this.idKey])?r.get(e[this.idKey]):{}));this.apiResponses=i})})}makeTableColumns(e){return this.columns.map(t=>{var r;return e?[null!==(r=t.name)&&void 0!==r?r:""]:[]})}apiResponseToTable(){const e=this.makeTableColumns(!this.hasData);return this.apiDataIsLoaded?(this.apiResponses.forEach(t=>{this.columns.forEach((r,i)=>{var o;if(!(0,N.A)(r.name))return;const n=null===(o=this.apiColumns.find(e=>e.name===r.name))||void 0===o?void 0:o.responseDataPath;var a,s;n?e[i].push("".concat(null!==(a=Ae(t,n))&&void 0!==a?a:"")):e[i].push("".concat(null!==(s=t[r.name])&&void 0!==s?s:""))})}),e):e}async forceLoadMetadata(){return Promise.resolve()}async forceLoadTableData(){return this.loadDataFromApis().then(()=>{(0,_.h5)(()=>{const e=this.apiResponseToTable();this.shouldAppendNewData?this.append(e):this.dataColumnMajor=e,this.hasData=!0})}).then(()=>{})}refreshData(){this.loadDataFromApis().then(()=>{(0,_.h5)(()=>{const e=this.apiResponseToTable();this.shouldAppendNewData?this.append(e):this.dataColumnMajor=e})})}addQueryParams(e){const t=new(z())(e.url),r=e=>{if(e.startsWith("DATE!")){const t=e.slice(e.indexOf("!")+1),r=new Date;return(0,D.Ay)(r,t)}return e};let i=this.hasData&&this.updateQueryParameters.length>0;return(i?this.updateQueryParameters:this.queryParameters).forEach(e=>{t.addQuery(e.name,r(e.value))}),i=this.hasData&&e.updateQueryParameters.length>0,(i?e.updateQueryParameters:e.queryParameters).forEach(e=>{t.addQuery(e.name,r(e.value))}),t.toString()}},ye(ae,"type","api-table"),oe=be((ie=ae).prototype,"apiResponses",[_.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ne=be(ie.prototype,"hasData",[_.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),be(ie.prototype,"apiDataIsLoaded",[_.EW],Object.getOwnPropertyDescriptor(ie.prototype,"apiDataIsLoaded"),ie.prototype),ie);function Ae(e,t){return t.split(/\[\]\.?/).reduce((e,t)=>((e,t)=>""===t?e:Array.isArray(e)?(0,C.default)(e,t):(0,E.A)(e,t))(e,t),e)}he.A.addLoadStratum(F.A.stratumName)},52273:(e,t,r)=>{"use strict";r.d(t,{A:()=>d}),r(94490),r(62953);var i,o,n,a,s,l=r(39070),c=r(71222);function u(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function p(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let d=(i=(0,c.A)({type:"string",name:"Shadows",description:"Determines whether the tileset casts or receives shadows from each light source."}),o=(0,c.A)({type:"boolean",name:"Show Shadow UI",description:"Determines whether the shadow UI component will be shown on the workbench item"}),n=class extends l.A{constructor(){super(...arguments),u(this,"shadows",a,this),u(this,"showShadowUi",s,this)}},a=p(n.prototype,"shadows",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"NONE"}}),s=p(n.prototype,"showShadowUi",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),n)},53921:(e,t,r)=>{"use strict";var i=r(46518),o=r(72652),n=r(97040);i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return o(e,function(e,r){n(t,e,r)},{AS_ENTRIES:!0}),t}})},56559:(e,t,r)=>{"use strict";var i=r(44582).freeze;t.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=i({Aacute:"Ã",aacute:"Ã¡",Abreve:"Ä‚",abreve:"Äƒ",ac:"âˆ¾",acd:"âˆ¿",acE:"âˆ¾Ì³",Acirc:"Ã‚",acirc:"Ã¢",acute:"Â´",Acy:"Ð",acy:"Ð°",AElig:"Ã†",aelig:"Ã¦",af:"â¡",Afr:"ð”„",afr:"ð”ž",Agrave:"Ã€",agrave:"Ã ",alefsym:"â„µ",aleph:"â„µ",Alpha:"Î‘",alpha:"Î±",Amacr:"Ä€",amacr:"Ä",amalg:"â¨¿",AMP:"&",amp:"&",And:"â©“",and:"âˆ§",andand:"â©•",andd:"â©œ",andslope:"â©˜",andv:"â©š",ang:"âˆ ",ange:"â¦¤",angle:"âˆ ",angmsd:"âˆ¡",angmsdaa:"â¦¨",angmsdab:"â¦©",angmsdac:"â¦ª",angmsdad:"â¦«",angmsdae:"â¦¬",angmsdaf:"â¦­",angmsdag:"â¦®",angmsdah:"â¦¯",angrt:"âˆŸ",angrtvb:"âŠ¾",angrtvbd:"â¦",angsph:"âˆ¢",angst:"Ã…",angzarr:"â¼",Aogon:"Ä„",aogon:"Ä…",Aopf:"ð”¸",aopf:"ð•’",ap:"â‰ˆ",apacir:"â©¯",apE:"â©°",ape:"â‰Š",apid:"â‰‹",apos:"'",ApplyFunction:"â¡",approx:"â‰ˆ",approxeq:"â‰Š",Aring:"Ã…",aring:"Ã¥",Ascr:"ð’œ",ascr:"ð’¶",Assign:"â‰”",ast:"*",asymp:"â‰ˆ",asympeq:"â‰",Atilde:"Ãƒ",atilde:"Ã£",Auml:"Ã„",auml:"Ã¤",awconint:"âˆ³",awint:"â¨‘",backcong:"â‰Œ",backepsilon:"Ï¶",backprime:"â€µ",backsim:"âˆ½",backsimeq:"â‹",Backslash:"âˆ–",Barv:"â«§",barvee:"âŠ½",Barwed:"âŒ†",barwed:"âŒ…",barwedge:"âŒ…",bbrk:"âŽµ",bbrktbrk:"âŽ¶",bcong:"â‰Œ",Bcy:"Ð‘",bcy:"Ð±",bdquo:"â€ž",becaus:"âˆµ",Because:"âˆµ",because:"âˆµ",bemptyv:"â¦°",bepsi:"Ï¶",bernou:"â„¬",Bernoullis:"â„¬",Beta:"Î’",beta:"Î²",beth:"â„¶",between:"â‰¬",Bfr:"ð”…",bfr:"ð”Ÿ",bigcap:"â‹‚",bigcirc:"â—¯",bigcup:"â‹ƒ",bigodot:"â¨€",bigoplus:"â¨",bigotimes:"â¨‚",bigsqcup:"â¨†",bigstar:"â˜…",bigtriangledown:"â–½",bigtriangleup:"â–³",biguplus:"â¨„",bigvee:"â‹",bigwedge:"â‹€",bkarow:"â¤",blacklozenge:"â§«",blacksquare:"â–ª",blacktriangle:"â–´",blacktriangledown:"â–¾",blacktriangleleft:"â—‚",blacktriangleright:"â–¸",blank:"â£",blk12:"â–’",blk14:"â–‘",blk34:"â–“",block:"â–ˆ",bne:"=âƒ¥",bnequiv:"â‰¡âƒ¥",bNot:"â«­",bnot:"âŒ",Bopf:"ð”¹",bopf:"ð•“",bot:"âŠ¥",bottom:"âŠ¥",bowtie:"â‹ˆ",boxbox:"â§‰",boxDL:"â•—",boxDl:"â•–",boxdL:"â••",boxdl:"â”",boxDR:"â•”",boxDr:"â•“",boxdR:"â•’",boxdr:"â”Œ",boxH:"â•",boxh:"â”€",boxHD:"â•¦",boxHd:"â•¤",boxhD:"â•¥",boxhd:"â”¬",boxHU:"â•©",boxHu:"â•§",boxhU:"â•¨",boxhu:"â”´",boxminus:"âŠŸ",boxplus:"âŠž",boxtimes:"âŠ ",boxUL:"â•",boxUl:"â•œ",boxuL:"â•›",boxul:"â”˜",boxUR:"â•š",boxUr:"â•™",boxuR:"â•˜",boxur:"â””",boxV:"â•‘",boxv:"â”‚",boxVH:"â•¬",boxVh:"â•«",boxvH:"â•ª",boxvh:"â”¼",boxVL:"â•£",boxVl:"â•¢",boxvL:"â•¡",boxvl:"â”¤",boxVR:"â• ",boxVr:"â•Ÿ",boxvR:"â•ž",boxvr:"â”œ",bprime:"â€µ",Breve:"Ë˜",breve:"Ë˜",brvbar:"Â¦",Bscr:"â„¬",bscr:"ð’·",bsemi:"â",bsim:"âˆ½",bsime:"â‹",bsol:"\\",bsolb:"â§…",bsolhsub:"âŸˆ",bull:"â€¢",bullet:"â€¢",bump:"â‰Ž",bumpE:"âª®",bumpe:"â‰",Bumpeq:"â‰Ž",bumpeq:"â‰",Cacute:"Ä†",cacute:"Ä‡",Cap:"â‹’",cap:"âˆ©",capand:"â©„",capbrcup:"â©‰",capcap:"â©‹",capcup:"â©‡",capdot:"â©€",CapitalDifferentialD:"â……",caps:"âˆ©ï¸€",caret:"â",caron:"Ë‡",Cayleys:"â„­",ccaps:"â©",Ccaron:"ÄŒ",ccaron:"Ä",Ccedil:"Ã‡",ccedil:"Ã§",Ccirc:"Äˆ",ccirc:"Ä‰",Cconint:"âˆ°",ccups:"â©Œ",ccupssm:"â©",Cdot:"ÄŠ",cdot:"Ä‹",cedil:"Â¸",Cedilla:"Â¸",cemptyv:"â¦²",cent:"Â¢",CenterDot:"Â·",centerdot:"Â·",Cfr:"â„­",cfr:"ð” ",CHcy:"Ð§",chcy:"Ñ‡",check:"âœ“",checkmark:"âœ“",Chi:"Î§",chi:"Ï‡",cir:"â—‹",circ:"Ë†",circeq:"â‰—",circlearrowleft:"â†º",circlearrowright:"â†»",circledast:"âŠ›",circledcirc:"âŠš",circleddash:"âŠ",CircleDot:"âŠ™",circledR:"Â®",circledS:"â“ˆ",CircleMinus:"âŠ–",CirclePlus:"âŠ•",CircleTimes:"âŠ—",cirE:"â§ƒ",cire:"â‰—",cirfnint:"â¨",cirmid:"â«¯",cirscir:"â§‚",ClockwiseContourIntegral:"âˆ²",CloseCurlyDoubleQuote:"â€",CloseCurlyQuote:"â€™",clubs:"â™£",clubsuit:"â™£",Colon:"âˆ·",colon:":",Colone:"â©´",colone:"â‰”",coloneq:"â‰”",comma:",",commat:"@",comp:"âˆ",compfn:"âˆ˜",complement:"âˆ",complexes:"â„‚",cong:"â‰…",congdot:"â©­",Congruent:"â‰¡",Conint:"âˆ¯",conint:"âˆ®",ContourIntegral:"âˆ®",Copf:"â„‚",copf:"ð•”",coprod:"âˆ",Coproduct:"âˆ",COPY:"Â©",copy:"Â©",copysr:"â„—",CounterClockwiseContourIntegral:"âˆ³",crarr:"â†µ",Cross:"â¨¯",cross:"âœ—",Cscr:"ð’ž",cscr:"ð’¸",csub:"â«",csube:"â«‘",csup:"â«",csupe:"â«’",ctdot:"â‹¯",cudarrl:"â¤¸",cudarrr:"â¤µ",cuepr:"â‹ž",cuesc:"â‹Ÿ",cularr:"â†¶",cularrp:"â¤½",Cup:"â‹“",cup:"âˆª",cupbrcap:"â©ˆ",CupCap:"â‰",cupcap:"â©†",cupcup:"â©Š",cupdot:"âŠ",cupor:"â©…",cups:"âˆªï¸€",curarr:"â†·",curarrm:"â¤¼",curlyeqprec:"â‹ž",curlyeqsucc:"â‹Ÿ",curlyvee:"â‹Ž",curlywedge:"â‹",curren:"Â¤",curvearrowleft:"â†¶",curvearrowright:"â†·",cuvee:"â‹Ž",cuwed:"â‹",cwconint:"âˆ²",cwint:"âˆ±",cylcty:"âŒ­",Dagger:"â€¡",dagger:"â€ ",daleth:"â„¸",Darr:"â†¡",dArr:"â‡“",darr:"â†“",dash:"â€",Dashv:"â«¤",dashv:"âŠ£",dbkarow:"â¤",dblac:"Ë",Dcaron:"ÄŽ",dcaron:"Ä",Dcy:"Ð”",dcy:"Ð´",DD:"â……",dd:"â…†",ddagger:"â€¡",ddarr:"â‡Š",DDotrahd:"â¤‘",ddotseq:"â©·",deg:"Â°",Del:"âˆ‡",Delta:"Î”",delta:"Î´",demptyv:"â¦±",dfisht:"â¥¿",Dfr:"ð”‡",dfr:"ð”¡",dHar:"â¥¥",dharl:"â‡ƒ",dharr:"â‡‚",DiacriticalAcute:"Â´",DiacriticalDot:"Ë™",DiacriticalDoubleAcute:"Ë",DiacriticalGrave:"`",DiacriticalTilde:"Ëœ",diam:"â‹„",Diamond:"â‹„",diamond:"â‹„",diamondsuit:"â™¦",diams:"â™¦",die:"Â¨",DifferentialD:"â…†",digamma:"Ï",disin:"â‹²",div:"Ã·",divide:"Ã·",divideontimes:"â‹‡",divonx:"â‹‡",DJcy:"Ð‚",djcy:"Ñ’",dlcorn:"âŒž",dlcrop:"âŒ",dollar:"$",Dopf:"ð”»",dopf:"ð••",Dot:"Â¨",dot:"Ë™",DotDot:"âƒœ",doteq:"â‰",doteqdot:"â‰‘",DotEqual:"â‰",dotminus:"âˆ¸",dotplus:"âˆ”",dotsquare:"âŠ¡",doublebarwedge:"âŒ†",DoubleContourIntegral:"âˆ¯",DoubleDot:"Â¨",DoubleDownArrow:"â‡“",DoubleLeftArrow:"â‡",DoubleLeftRightArrow:"â‡”",DoubleLeftTee:"â«¤",DoubleLongLeftArrow:"âŸ¸",DoubleLongLeftRightArrow:"âŸº",DoubleLongRightArrow:"âŸ¹",DoubleRightArrow:"â‡’",DoubleRightTee:"âŠ¨",DoubleUpArrow:"â‡‘",DoubleUpDownArrow:"â‡•",DoubleVerticalBar:"âˆ¥",DownArrow:"â†“",Downarrow:"â‡“",downarrow:"â†“",DownArrowBar:"â¤“",DownArrowUpArrow:"â‡µ",DownBreve:"Ì‘",downdownarrows:"â‡Š",downharpoonleft:"â‡ƒ",downharpoonright:"â‡‚",DownLeftRightVector:"â¥",DownLeftTeeVector:"â¥ž",DownLeftVector:"â†½",DownLeftVectorBar:"â¥–",DownRightTeeVector:"â¥Ÿ",DownRightVector:"â‡",DownRightVectorBar:"â¥—",DownTee:"âŠ¤",DownTeeArrow:"â†§",drbkarow:"â¤",drcorn:"âŒŸ",drcrop:"âŒŒ",Dscr:"ð’Ÿ",dscr:"ð’¹",DScy:"Ð…",dscy:"Ñ•",dsol:"â§¶",Dstrok:"Ä",dstrok:"Ä‘",dtdot:"â‹±",dtri:"â–¿",dtrif:"â–¾",duarr:"â‡µ",duhar:"â¥¯",dwangle:"â¦¦",DZcy:"Ð",dzcy:"ÑŸ",dzigrarr:"âŸ¿",Eacute:"Ã‰",eacute:"Ã©",easter:"â©®",Ecaron:"Äš",ecaron:"Ä›",ecir:"â‰–",Ecirc:"ÃŠ",ecirc:"Ãª",ecolon:"â‰•",Ecy:"Ð­",ecy:"Ñ",eDDot:"â©·",Edot:"Ä–",eDot:"â‰‘",edot:"Ä—",ee:"â…‡",efDot:"â‰’",Efr:"ð”ˆ",efr:"ð”¢",eg:"âªš",Egrave:"Ãˆ",egrave:"Ã¨",egs:"âª–",egsdot:"âª˜",el:"âª™",Element:"âˆˆ",elinters:"â§",ell:"â„“",els:"âª•",elsdot:"âª—",Emacr:"Ä’",emacr:"Ä“",empty:"âˆ…",emptyset:"âˆ…",EmptySmallSquare:"â—»",emptyv:"âˆ…",EmptyVerySmallSquare:"â–«",emsp:"â€ƒ",emsp13:"â€„",emsp14:"â€…",ENG:"ÅŠ",eng:"Å‹",ensp:"â€‚",Eogon:"Ä˜",eogon:"Ä™",Eopf:"ð”¼",eopf:"ð•–",epar:"â‹•",eparsl:"â§£",eplus:"â©±",epsi:"Îµ",Epsilon:"Î•",epsilon:"Îµ",epsiv:"Ïµ",eqcirc:"â‰–",eqcolon:"â‰•",eqsim:"â‰‚",eqslantgtr:"âª–",eqslantless:"âª•",Equal:"â©µ",equals:"=",EqualTilde:"â‰‚",equest:"â‰Ÿ",Equilibrium:"â‡Œ",equiv:"â‰¡",equivDD:"â©¸",eqvparsl:"â§¥",erarr:"â¥±",erDot:"â‰“",Escr:"â„°",escr:"â„¯",esdot:"â‰",Esim:"â©³",esim:"â‰‚",Eta:"Î—",eta:"Î·",ETH:"Ã",eth:"Ã°",Euml:"Ã‹",euml:"Ã«",euro:"â‚¬",excl:"!",exist:"âˆƒ",Exists:"âˆƒ",expectation:"â„°",ExponentialE:"â…‡",exponentiale:"â…‡",fallingdotseq:"â‰’",Fcy:"Ð¤",fcy:"Ñ„",female:"â™€",ffilig:"ï¬ƒ",fflig:"ï¬€",ffllig:"ï¬„",Ffr:"ð”‰",ffr:"ð”£",filig:"ï¬",FilledSmallSquare:"â—¼",FilledVerySmallSquare:"â–ª",fjlig:"fj",flat:"â™­",fllig:"ï¬‚",fltns:"â–±",fnof:"Æ’",Fopf:"ð”½",fopf:"ð•—",ForAll:"âˆ€",forall:"âˆ€",fork:"â‹”",forkv:"â«™",Fouriertrf:"â„±",fpartint:"â¨",frac12:"Â½",frac13:"â…“",frac14:"Â¼",frac15:"â…•",frac16:"â…™",frac18:"â…›",frac23:"â…”",frac25:"â…–",frac34:"Â¾",frac35:"â…—",frac38:"â…œ",frac45:"â…˜",frac56:"â…š",frac58:"â…",frac78:"â…ž",frasl:"â„",frown:"âŒ¢",Fscr:"â„±",fscr:"ð’»",gacute:"Çµ",Gamma:"Î“",gamma:"Î³",Gammad:"Ïœ",gammad:"Ï",gap:"âª†",Gbreve:"Äž",gbreve:"ÄŸ",Gcedil:"Ä¢",Gcirc:"Äœ",gcirc:"Ä",Gcy:"Ð“",gcy:"Ð³",Gdot:"Ä ",gdot:"Ä¡",gE:"â‰§",ge:"â‰¥",gEl:"âªŒ",gel:"â‹›",geq:"â‰¥",geqq:"â‰§",geqslant:"â©¾",ges:"â©¾",gescc:"âª©",gesdot:"âª€",gesdoto:"âª‚",gesdotol:"âª„",gesl:"â‹›ï¸€",gesles:"âª”",Gfr:"ð”Š",gfr:"ð”¤",Gg:"â‹™",gg:"â‰«",ggg:"â‹™",gimel:"â„·",GJcy:"Ðƒ",gjcy:"Ñ“",gl:"â‰·",gla:"âª¥",glE:"âª’",glj:"âª¤",gnap:"âªŠ",gnapprox:"âªŠ",gnE:"â‰©",gne:"âªˆ",gneq:"âªˆ",gneqq:"â‰©",gnsim:"â‹§",Gopf:"ð”¾",gopf:"ð•˜",grave:"`",GreaterEqual:"â‰¥",GreaterEqualLess:"â‹›",GreaterFullEqual:"â‰§",GreaterGreater:"âª¢",GreaterLess:"â‰·",GreaterSlantEqual:"â©¾",GreaterTilde:"â‰³",Gscr:"ð’¢",gscr:"â„Š",gsim:"â‰³",gsime:"âªŽ",gsiml:"âª",Gt:"â‰«",GT:">",gt:">",gtcc:"âª§",gtcir:"â©º",gtdot:"â‹—",gtlPar:"â¦•",gtquest:"â©¼",gtrapprox:"âª†",gtrarr:"â¥¸",gtrdot:"â‹—",gtreqless:"â‹›",gtreqqless:"âªŒ",gtrless:"â‰·",gtrsim:"â‰³",gvertneqq:"â‰©ï¸€",gvnE:"â‰©ï¸€",Hacek:"Ë‡",hairsp:"â€Š",half:"Â½",hamilt:"â„‹",HARDcy:"Ðª",hardcy:"ÑŠ",hArr:"â‡”",harr:"â†”",harrcir:"â¥ˆ",harrw:"â†­",Hat:"^",hbar:"â„",Hcirc:"Ä¤",hcirc:"Ä¥",hearts:"â™¥",heartsuit:"â™¥",hellip:"â€¦",hercon:"âŠ¹",Hfr:"â„Œ",hfr:"ð”¥",HilbertSpace:"â„‹",hksearow:"â¤¥",hkswarow:"â¤¦",hoarr:"â‡¿",homtht:"âˆ»",hookleftarrow:"â†©",hookrightarrow:"â†ª",Hopf:"â„",hopf:"ð•™",horbar:"â€•",HorizontalLine:"â”€",Hscr:"â„‹",hscr:"ð’½",hslash:"â„",Hstrok:"Ä¦",hstrok:"Ä§",HumpDownHump:"â‰Ž",HumpEqual:"â‰",hybull:"âƒ",hyphen:"â€",Iacute:"Ã",iacute:"Ã­",ic:"â£",Icirc:"ÃŽ",icirc:"Ã®",Icy:"Ð˜",icy:"Ð¸",Idot:"Ä°",IEcy:"Ð•",iecy:"Ðµ",iexcl:"Â¡",iff:"â‡”",Ifr:"â„‘",ifr:"ð”¦",Igrave:"ÃŒ",igrave:"Ã¬",ii:"â…ˆ",iiiint:"â¨Œ",iiint:"âˆ­",iinfin:"â§œ",iiota:"â„©",IJlig:"Ä²",ijlig:"Ä³",Im:"â„‘",Imacr:"Äª",imacr:"Ä«",image:"â„‘",ImaginaryI:"â…ˆ",imagline:"â„",imagpart:"â„‘",imath:"Ä±",imof:"âŠ·",imped:"Æµ",Implies:"â‡’",in:"âˆˆ",incare:"â„…",infin:"âˆž",infintie:"â§",inodot:"Ä±",Int:"âˆ¬",int:"âˆ«",intcal:"âŠº",integers:"â„¤",Integral:"âˆ«",intercal:"âŠº",Intersection:"â‹‚",intlarhk:"â¨—",intprod:"â¨¼",InvisibleComma:"â£",InvisibleTimes:"â¢",IOcy:"Ð",iocy:"Ñ‘",Iogon:"Ä®",iogon:"Ä¯",Iopf:"ð•€",iopf:"ð•š",Iota:"Î™",iota:"Î¹",iprod:"â¨¼",iquest:"Â¿",Iscr:"â„",iscr:"ð’¾",isin:"âˆˆ",isindot:"â‹µ",isinE:"â‹¹",isins:"â‹´",isinsv:"â‹³",isinv:"âˆˆ",it:"â¢",Itilde:"Ä¨",itilde:"Ä©",Iukcy:"Ð†",iukcy:"Ñ–",Iuml:"Ã",iuml:"Ã¯",Jcirc:"Ä´",jcirc:"Äµ",Jcy:"Ð™",jcy:"Ð¹",Jfr:"ð”",jfr:"ð”§",jmath:"È·",Jopf:"ð•",jopf:"ð•›",Jscr:"ð’¥",jscr:"ð’¿",Jsercy:"Ðˆ",jsercy:"Ñ˜",Jukcy:"Ð„",jukcy:"Ñ”",Kappa:"Îš",kappa:"Îº",kappav:"Ï°",Kcedil:"Ä¶",kcedil:"Ä·",Kcy:"Ðš",kcy:"Ðº",Kfr:"ð”Ž",kfr:"ð”¨",kgreen:"Ä¸",KHcy:"Ð¥",khcy:"Ñ…",KJcy:"ÐŒ",kjcy:"Ñœ",Kopf:"ð•‚",kopf:"ð•œ",Kscr:"ð’¦",kscr:"ð“€",lAarr:"â‡š",Lacute:"Ä¹",lacute:"Äº",laemptyv:"â¦´",lagran:"â„’",Lambda:"Î›",lambda:"Î»",Lang:"âŸª",lang:"âŸ¨",langd:"â¦‘",langle:"âŸ¨",lap:"âª…",Laplacetrf:"â„’",laquo:"Â«",Larr:"â†ž",lArr:"â‡",larr:"â†",larrb:"â‡¤",larrbfs:"â¤Ÿ",larrfs:"â¤",larrhk:"â†©",larrlp:"â†«",larrpl:"â¤¹",larrsim:"â¥³",larrtl:"â†¢",lat:"âª«",lAtail:"â¤›",latail:"â¤™",late:"âª­",lates:"âª­ï¸€",lBarr:"â¤Ž",lbarr:"â¤Œ",lbbrk:"â²",lbrace:"{",lbrack:"[",lbrke:"â¦‹",lbrksld:"â¦",lbrkslu:"â¦",Lcaron:"Ä½",lcaron:"Ä¾",Lcedil:"Ä»",lcedil:"Ä¼",lceil:"âŒˆ",lcub:"{",Lcy:"Ð›",lcy:"Ð»",ldca:"â¤¶",ldquo:"â€œ",ldquor:"â€ž",ldrdhar:"â¥§",ldrushar:"â¥‹",ldsh:"â†²",lE:"â‰¦",le:"â‰¤",LeftAngleBracket:"âŸ¨",LeftArrow:"â†",Leftarrow:"â‡",leftarrow:"â†",LeftArrowBar:"â‡¤",LeftArrowRightArrow:"â‡†",leftarrowtail:"â†¢",LeftCeiling:"âŒˆ",LeftDoubleBracket:"âŸ¦",LeftDownTeeVector:"â¥¡",LeftDownVector:"â‡ƒ",LeftDownVectorBar:"â¥™",LeftFloor:"âŒŠ",leftharpoondown:"â†½",leftharpoonup:"â†¼",leftleftarrows:"â‡‡",LeftRightArrow:"â†”",Leftrightarrow:"â‡”",leftrightarrow:"â†”",leftrightarrows:"â‡†",leftrightharpoons:"â‡‹",leftrightsquigarrow:"â†­",LeftRightVector:"â¥Ž",LeftTee:"âŠ£",LeftTeeArrow:"â†¤",LeftTeeVector:"â¥š",leftthreetimes:"â‹‹",LeftTriangle:"âŠ²",LeftTriangleBar:"â§",LeftTriangleEqual:"âŠ´",LeftUpDownVector:"â¥‘",LeftUpTeeVector:"â¥ ",LeftUpVector:"â†¿",LeftUpVectorBar:"â¥˜",LeftVector:"â†¼",LeftVectorBar:"â¥’",lEg:"âª‹",leg:"â‹š",leq:"â‰¤",leqq:"â‰¦",leqslant:"â©½",les:"â©½",lescc:"âª¨",lesdot:"â©¿",lesdoto:"âª",lesdotor:"âªƒ",lesg:"â‹šï¸€",lesges:"âª“",lessapprox:"âª…",lessdot:"â‹–",lesseqgtr:"â‹š",lesseqqgtr:"âª‹",LessEqualGreater:"â‹š",LessFullEqual:"â‰¦",LessGreater:"â‰¶",lessgtr:"â‰¶",LessLess:"âª¡",lesssim:"â‰²",LessSlantEqual:"â©½",LessTilde:"â‰²",lfisht:"â¥¼",lfloor:"âŒŠ",Lfr:"ð”",lfr:"ð”©",lg:"â‰¶",lgE:"âª‘",lHar:"â¥¢",lhard:"â†½",lharu:"â†¼",lharul:"â¥ª",lhblk:"â–„",LJcy:"Ð‰",ljcy:"Ñ™",Ll:"â‹˜",ll:"â‰ª",llarr:"â‡‡",llcorner:"âŒž",Lleftarrow:"â‡š",llhard:"â¥«",lltri:"â—º",Lmidot:"Ä¿",lmidot:"Å€",lmoust:"âŽ°",lmoustache:"âŽ°",lnap:"âª‰",lnapprox:"âª‰",lnE:"â‰¨",lne:"âª‡",lneq:"âª‡",lneqq:"â‰¨",lnsim:"â‹¦",loang:"âŸ¬",loarr:"â‡½",lobrk:"âŸ¦",LongLeftArrow:"âŸµ",Longleftarrow:"âŸ¸",longleftarrow:"âŸµ",LongLeftRightArrow:"âŸ·",Longleftrightarrow:"âŸº",longleftrightarrow:"âŸ·",longmapsto:"âŸ¼",LongRightArrow:"âŸ¶",Longrightarrow:"âŸ¹",longrightarrow:"âŸ¶",looparrowleft:"â†«",looparrowright:"â†¬",lopar:"â¦…",Lopf:"ð•ƒ",lopf:"ð•",loplus:"â¨­",lotimes:"â¨´",lowast:"âˆ—",lowbar:"_",LowerLeftArrow:"â†™",LowerRightArrow:"â†˜",loz:"â—Š",lozenge:"â—Š",lozf:"â§«",lpar:"(",lparlt:"â¦“",lrarr:"â‡†",lrcorner:"âŒŸ",lrhar:"â‡‹",lrhard:"â¥­",lrm:"â€Ž",lrtri:"âŠ¿",lsaquo:"â€¹",Lscr:"â„’",lscr:"ð“",Lsh:"â†°",lsh:"â†°",lsim:"â‰²",lsime:"âª",lsimg:"âª",lsqb:"[",lsquo:"â€˜",lsquor:"â€š",Lstrok:"Å",lstrok:"Å‚",Lt:"â‰ª",LT:"<",lt:"<",ltcc:"âª¦",ltcir:"â©¹",ltdot:"â‹–",lthree:"â‹‹",ltimes:"â‹‰",ltlarr:"â¥¶",ltquest:"â©»",ltri:"â—ƒ",ltrie:"âŠ´",ltrif:"â—‚",ltrPar:"â¦–",lurdshar:"â¥Š",luruhar:"â¥¦",lvertneqq:"â‰¨ï¸€",lvnE:"â‰¨ï¸€",macr:"Â¯",male:"â™‚",malt:"âœ ",maltese:"âœ ",Map:"â¤…",map:"â†¦",mapsto:"â†¦",mapstodown:"â†§",mapstoleft:"â†¤",mapstoup:"â†¥",marker:"â–®",mcomma:"â¨©",Mcy:"Ðœ",mcy:"Ð¼",mdash:"â€”",mDDot:"âˆº",measuredangle:"âˆ¡",MediumSpace:"âŸ",Mellintrf:"â„³",Mfr:"ð”",mfr:"ð”ª",mho:"â„§",micro:"Âµ",mid:"âˆ£",midast:"*",midcir:"â«°",middot:"Â·",minus:"âˆ’",minusb:"âŠŸ",minusd:"âˆ¸",minusdu:"â¨ª",MinusPlus:"âˆ“",mlcp:"â«›",mldr:"â€¦",mnplus:"âˆ“",models:"âŠ§",Mopf:"ð•„",mopf:"ð•ž",mp:"âˆ“",Mscr:"â„³",mscr:"ð“‚",mstpos:"âˆ¾",Mu:"Îœ",mu:"Î¼",multimap:"âŠ¸",mumap:"âŠ¸",nabla:"âˆ‡",Nacute:"Åƒ",nacute:"Å„",nang:"âˆ âƒ’",nap:"â‰‰",napE:"â©°Ì¸",napid:"â‰‹Ì¸",napos:"Å‰",napprox:"â‰‰",natur:"â™®",natural:"â™®",naturals:"â„•",nbsp:"Â ",nbump:"â‰ŽÌ¸",nbumpe:"â‰Ì¸",ncap:"â©ƒ",Ncaron:"Å‡",ncaron:"Åˆ",Ncedil:"Å…",ncedil:"Å†",ncong:"â‰‡",ncongdot:"â©­Ì¸",ncup:"â©‚",Ncy:"Ð",ncy:"Ð½",ndash:"â€“",ne:"â‰ ",nearhk:"â¤¤",neArr:"â‡—",nearr:"â†—",nearrow:"â†—",nedot:"â‰Ì¸",NegativeMediumSpace:"â€‹",NegativeThickSpace:"â€‹",NegativeThinSpace:"â€‹",NegativeVeryThinSpace:"â€‹",nequiv:"â‰¢",nesear:"â¤¨",nesim:"â‰‚Ì¸",NestedGreaterGreater:"â‰«",NestedLessLess:"â‰ª",NewLine:"\n",nexist:"âˆ„",nexists:"âˆ„",Nfr:"ð”‘",nfr:"ð”«",ngE:"â‰§Ì¸",nge:"â‰±",ngeq:"â‰±",ngeqq:"â‰§Ì¸",ngeqslant:"â©¾Ì¸",nges:"â©¾Ì¸",nGg:"â‹™Ì¸",ngsim:"â‰µ",nGt:"â‰«âƒ’",ngt:"â‰¯",ngtr:"â‰¯",nGtv:"â‰«Ì¸",nhArr:"â‡Ž",nharr:"â†®",nhpar:"â«²",ni:"âˆ‹",nis:"â‹¼",nisd:"â‹º",niv:"âˆ‹",NJcy:"ÐŠ",njcy:"Ñš",nlArr:"â‡",nlarr:"â†š",nldr:"â€¥",nlE:"â‰¦Ì¸",nle:"â‰°",nLeftarrow:"â‡",nleftarrow:"â†š",nLeftrightarrow:"â‡Ž",nleftrightarrow:"â†®",nleq:"â‰°",nleqq:"â‰¦Ì¸",nleqslant:"â©½Ì¸",nles:"â©½Ì¸",nless:"â‰®",nLl:"â‹˜Ì¸",nlsim:"â‰´",nLt:"â‰ªâƒ’",nlt:"â‰®",nltri:"â‹ª",nltrie:"â‹¬",nLtv:"â‰ªÌ¸",nmid:"âˆ¤",NoBreak:"â ",NonBreakingSpace:"Â ",Nopf:"â„•",nopf:"ð•Ÿ",Not:"â«¬",not:"Â¬",NotCongruent:"â‰¢",NotCupCap:"â‰­",NotDoubleVerticalBar:"âˆ¦",NotElement:"âˆ‰",NotEqual:"â‰ ",NotEqualTilde:"â‰‚Ì¸",NotExists:"âˆ„",NotGreater:"â‰¯",NotGreaterEqual:"â‰±",NotGreaterFullEqual:"â‰§Ì¸",NotGreaterGreater:"â‰«Ì¸",NotGreaterLess:"â‰¹",NotGreaterSlantEqual:"â©¾Ì¸",NotGreaterTilde:"â‰µ",NotHumpDownHump:"â‰ŽÌ¸",NotHumpEqual:"â‰Ì¸",notin:"âˆ‰",notindot:"â‹µÌ¸",notinE:"â‹¹Ì¸",notinva:"âˆ‰",notinvb:"â‹·",notinvc:"â‹¶",NotLeftTriangle:"â‹ª",NotLeftTriangleBar:"â§Ì¸",NotLeftTriangleEqual:"â‹¬",NotLess:"â‰®",NotLessEqual:"â‰°",NotLessGreater:"â‰¸",NotLessLess:"â‰ªÌ¸",NotLessSlantEqual:"â©½Ì¸",NotLessTilde:"â‰´",NotNestedGreaterGreater:"âª¢Ì¸",NotNestedLessLess:"âª¡Ì¸",notni:"âˆŒ",notniva:"âˆŒ",notnivb:"â‹¾",notnivc:"â‹½",NotPrecedes:"âŠ€",NotPrecedesEqual:"âª¯Ì¸",NotPrecedesSlantEqual:"â‹ ",NotReverseElement:"âˆŒ",NotRightTriangle:"â‹«",NotRightTriangleBar:"â§Ì¸",NotRightTriangleEqual:"â‹­",NotSquareSubset:"âŠÌ¸",NotSquareSubsetEqual:"â‹¢",NotSquareSuperset:"âŠÌ¸",NotSquareSupersetEqual:"â‹£",NotSubset:"âŠ‚âƒ’",NotSubsetEqual:"âŠˆ",NotSucceeds:"âŠ",NotSucceedsEqual:"âª°Ì¸",NotSucceedsSlantEqual:"â‹¡",NotSucceedsTilde:"â‰¿Ì¸",NotSuperset:"âŠƒâƒ’",NotSupersetEqual:"âŠ‰",NotTilde:"â‰",NotTildeEqual:"â‰„",NotTildeFullEqual:"â‰‡",NotTildeTilde:"â‰‰",NotVerticalBar:"âˆ¤",npar:"âˆ¦",nparallel:"âˆ¦",nparsl:"â«½âƒ¥",npart:"âˆ‚Ì¸",npolint:"â¨”",npr:"âŠ€",nprcue:"â‹ ",npre:"âª¯Ì¸",nprec:"âŠ€",npreceq:"âª¯Ì¸",nrArr:"â‡",nrarr:"â†›",nrarrc:"â¤³Ì¸",nrarrw:"â†Ì¸",nRightarrow:"â‡",nrightarrow:"â†›",nrtri:"â‹«",nrtrie:"â‹­",nsc:"âŠ",nsccue:"â‹¡",nsce:"âª°Ì¸",Nscr:"ð’©",nscr:"ð“ƒ",nshortmid:"âˆ¤",nshortparallel:"âˆ¦",nsim:"â‰",nsime:"â‰„",nsimeq:"â‰„",nsmid:"âˆ¤",nspar:"âˆ¦",nsqsube:"â‹¢",nsqsupe:"â‹£",nsub:"âŠ„",nsubE:"â«…Ì¸",nsube:"âŠˆ",nsubset:"âŠ‚âƒ’",nsubseteq:"âŠˆ",nsubseteqq:"â«…Ì¸",nsucc:"âŠ",nsucceq:"âª°Ì¸",nsup:"âŠ…",nsupE:"â«†Ì¸",nsupe:"âŠ‰",nsupset:"âŠƒâƒ’",nsupseteq:"âŠ‰",nsupseteqq:"â«†Ì¸",ntgl:"â‰¹",Ntilde:"Ã‘",ntilde:"Ã±",ntlg:"â‰¸",ntriangleleft:"â‹ª",ntrianglelefteq:"â‹¬",ntriangleright:"â‹«",ntrianglerighteq:"â‹­",Nu:"Î",nu:"Î½",num:"#",numero:"â„–",numsp:"â€‡",nvap:"â‰âƒ’",nVDash:"âŠ¯",nVdash:"âŠ®",nvDash:"âŠ­",nvdash:"âŠ¬",nvge:"â‰¥âƒ’",nvgt:">âƒ’",nvHarr:"â¤„",nvinfin:"â§ž",nvlArr:"â¤‚",nvle:"â‰¤âƒ’",nvlt:"<âƒ’",nvltrie:"âŠ´âƒ’",nvrArr:"â¤ƒ",nvrtrie:"âŠµâƒ’",nvsim:"âˆ¼âƒ’",nwarhk:"â¤£",nwArr:"â‡–",nwarr:"â†–",nwarrow:"â†–",nwnear:"â¤§",Oacute:"Ã“",oacute:"Ã³",oast:"âŠ›",ocir:"âŠš",Ocirc:"Ã”",ocirc:"Ã´",Ocy:"Ðž",ocy:"Ð¾",odash:"âŠ",Odblac:"Å",odblac:"Å‘",odiv:"â¨¸",odot:"âŠ™",odsold:"â¦¼",OElig:"Å’",oelig:"Å“",ofcir:"â¦¿",Ofr:"ð”’",ofr:"ð”¬",ogon:"Ë›",Ograve:"Ã’",ograve:"Ã²",ogt:"â§",ohbar:"â¦µ",ohm:"Î©",oint:"âˆ®",olarr:"â†º",olcir:"â¦¾",olcross:"â¦»",oline:"â€¾",olt:"â§€",Omacr:"ÅŒ",omacr:"Å",Omega:"Î©",omega:"Ï‰",Omicron:"ÎŸ",omicron:"Î¿",omid:"â¦¶",ominus:"âŠ–",Oopf:"ð•†",oopf:"ð• ",opar:"â¦·",OpenCurlyDoubleQuote:"â€œ",OpenCurlyQuote:"â€˜",operp:"â¦¹",oplus:"âŠ•",Or:"â©”",or:"âˆ¨",orarr:"â†»",ord:"â©",order:"â„´",orderof:"â„´",ordf:"Âª",ordm:"Âº",origof:"âŠ¶",oror:"â©–",orslope:"â©—",orv:"â©›",oS:"â“ˆ",Oscr:"ð’ª",oscr:"â„´",Oslash:"Ã˜",oslash:"Ã¸",osol:"âŠ˜",Otilde:"Ã•",otilde:"Ãµ",Otimes:"â¨·",otimes:"âŠ—",otimesas:"â¨¶",Ouml:"Ã–",ouml:"Ã¶",ovbar:"âŒ½",OverBar:"â€¾",OverBrace:"âž",OverBracket:"âŽ´",OverParenthesis:"âœ",par:"âˆ¥",para:"Â¶",parallel:"âˆ¥",parsim:"â«³",parsl:"â«½",part:"âˆ‚",PartialD:"âˆ‚",Pcy:"ÐŸ",pcy:"Ð¿",percnt:"%",period:".",permil:"â€°",perp:"âŠ¥",pertenk:"â€±",Pfr:"ð”“",pfr:"ð”­",Phi:"Î¦",phi:"Ï†",phiv:"Ï•",phmmat:"â„³",phone:"â˜Ž",Pi:"Î ",pi:"Ï€",pitchfork:"â‹”",piv:"Ï–",planck:"â„",planckh:"â„Ž",plankv:"â„",plus:"+",plusacir:"â¨£",plusb:"âŠž",pluscir:"â¨¢",plusdo:"âˆ”",plusdu:"â¨¥",pluse:"â©²",PlusMinus:"Â±",plusmn:"Â±",plussim:"â¨¦",plustwo:"â¨§",pm:"Â±",Poincareplane:"â„Œ",pointint:"â¨•",Popf:"â„™",popf:"ð•¡",pound:"Â£",Pr:"âª»",pr:"â‰º",prap:"âª·",prcue:"â‰¼",prE:"âª³",pre:"âª¯",prec:"â‰º",precapprox:"âª·",preccurlyeq:"â‰¼",Precedes:"â‰º",PrecedesEqual:"âª¯",PrecedesSlantEqual:"â‰¼",PrecedesTilde:"â‰¾",preceq:"âª¯",precnapprox:"âª¹",precneqq:"âªµ",precnsim:"â‹¨",precsim:"â‰¾",Prime:"â€³",prime:"â€²",primes:"â„™",prnap:"âª¹",prnE:"âªµ",prnsim:"â‹¨",prod:"âˆ",Product:"âˆ",profalar:"âŒ®",profline:"âŒ’",profsurf:"âŒ“",prop:"âˆ",Proportion:"âˆ·",Proportional:"âˆ",propto:"âˆ",prsim:"â‰¾",prurel:"âŠ°",Pscr:"ð’«",pscr:"ð“…",Psi:"Î¨",psi:"Ïˆ",puncsp:"â€ˆ",Qfr:"ð””",qfr:"ð”®",qint:"â¨Œ",Qopf:"â„š",qopf:"ð•¢",qprime:"â—",Qscr:"ð’¬",qscr:"ð“†",quaternions:"â„",quatint:"â¨–",quest:"?",questeq:"â‰Ÿ",QUOT:'"',quot:'"',rAarr:"â‡›",race:"âˆ½Ì±",Racute:"Å”",racute:"Å•",radic:"âˆš",raemptyv:"â¦³",Rang:"âŸ«",rang:"âŸ©",rangd:"â¦’",range:"â¦¥",rangle:"âŸ©",raquo:"Â»",Rarr:"â† ",rArr:"â‡’",rarr:"â†’",rarrap:"â¥µ",rarrb:"â‡¥",rarrbfs:"â¤ ",rarrc:"â¤³",rarrfs:"â¤ž",rarrhk:"â†ª",rarrlp:"â†¬",rarrpl:"â¥…",rarrsim:"â¥´",Rarrtl:"â¤–",rarrtl:"â†£",rarrw:"â†",rAtail:"â¤œ",ratail:"â¤š",ratio:"âˆ¶",rationals:"â„š",RBarr:"â¤",rBarr:"â¤",rbarr:"â¤",rbbrk:"â³",rbrace:"}",rbrack:"]",rbrke:"â¦Œ",rbrksld:"â¦Ž",rbrkslu:"â¦",Rcaron:"Å˜",rcaron:"Å™",Rcedil:"Å–",rcedil:"Å—",rceil:"âŒ‰",rcub:"}",Rcy:"Ð ",rcy:"Ñ€",rdca:"â¤·",rdldhar:"â¥©",rdquo:"â€",rdquor:"â€",rdsh:"â†³",Re:"â„œ",real:"â„œ",realine:"â„›",realpart:"â„œ",reals:"â„",rect:"â–­",REG:"Â®",reg:"Â®",ReverseElement:"âˆ‹",ReverseEquilibrium:"â‡‹",ReverseUpEquilibrium:"â¥¯",rfisht:"â¥½",rfloor:"âŒ‹",Rfr:"â„œ",rfr:"ð”¯",rHar:"â¥¤",rhard:"â‡",rharu:"â‡€",rharul:"â¥¬",Rho:"Î¡",rho:"Ï",rhov:"Ï±",RightAngleBracket:"âŸ©",RightArrow:"â†’",Rightarrow:"â‡’",rightarrow:"â†’",RightArrowBar:"â‡¥",RightArrowLeftArrow:"â‡„",rightarrowtail:"â†£",RightCeiling:"âŒ‰",RightDoubleBracket:"âŸ§",RightDownTeeVector:"â¥",RightDownVector:"â‡‚",RightDownVectorBar:"â¥•",RightFloor:"âŒ‹",rightharpoondown:"â‡",rightharpoonup:"â‡€",rightleftarrows:"â‡„",rightleftharpoons:"â‡Œ",rightrightarrows:"â‡‰",rightsquigarrow:"â†",RightTee:"âŠ¢",RightTeeArrow:"â†¦",RightTeeVector:"â¥›",rightthreetimes:"â‹Œ",RightTriangle:"âŠ³",RightTriangleBar:"â§",RightTriangleEqual:"âŠµ",RightUpDownVector:"â¥",RightUpTeeVector:"â¥œ",RightUpVector:"â†¾",RightUpVectorBar:"â¥”",RightVector:"â‡€",RightVectorBar:"â¥“",ring:"Ëš",risingdotseq:"â‰“",rlarr:"â‡„",rlhar:"â‡Œ",rlm:"â€",rmoust:"âŽ±",rmoustache:"âŽ±",rnmid:"â«®",roang:"âŸ­",roarr:"â‡¾",robrk:"âŸ§",ropar:"â¦†",Ropf:"â„",ropf:"ð•£",roplus:"â¨®",rotimes:"â¨µ",RoundImplies:"â¥°",rpar:")",rpargt:"â¦”",rppolint:"â¨’",rrarr:"â‡‰",Rrightarrow:"â‡›",rsaquo:"â€º",Rscr:"â„›",rscr:"ð“‡",Rsh:"â†±",rsh:"â†±",rsqb:"]",rsquo:"â€™",rsquor:"â€™",rthree:"â‹Œ",rtimes:"â‹Š",rtri:"â–¹",rtrie:"âŠµ",rtrif:"â–¸",rtriltri:"â§Ž",RuleDelayed:"â§´",ruluhar:"â¥¨",rx:"â„ž",Sacute:"Åš",sacute:"Å›",sbquo:"â€š",Sc:"âª¼",sc:"â‰»",scap:"âª¸",Scaron:"Å ",scaron:"Å¡",sccue:"â‰½",scE:"âª´",sce:"âª°",Scedil:"Åž",scedil:"ÅŸ",Scirc:"Åœ",scirc:"Å",scnap:"âªº",scnE:"âª¶",scnsim:"â‹©",scpolint:"â¨“",scsim:"â‰¿",Scy:"Ð¡",scy:"Ñ",sdot:"â‹…",sdotb:"âŠ¡",sdote:"â©¦",searhk:"â¤¥",seArr:"â‡˜",searr:"â†˜",searrow:"â†˜",sect:"Â§",semi:";",seswar:"â¤©",setminus:"âˆ–",setmn:"âˆ–",sext:"âœ¶",Sfr:"ð”–",sfr:"ð”°",sfrown:"âŒ¢",sharp:"â™¯",SHCHcy:"Ð©",shchcy:"Ñ‰",SHcy:"Ð¨",shcy:"Ñˆ",ShortDownArrow:"â†“",ShortLeftArrow:"â†",shortmid:"âˆ£",shortparallel:"âˆ¥",ShortRightArrow:"â†’",ShortUpArrow:"â†‘",shy:"Â­",Sigma:"Î£",sigma:"Ïƒ",sigmaf:"Ï‚",sigmav:"Ï‚",sim:"âˆ¼",simdot:"â©ª",sime:"â‰ƒ",simeq:"â‰ƒ",simg:"âªž",simgE:"âª ",siml:"âª",simlE:"âªŸ",simne:"â‰†",simplus:"â¨¤",simrarr:"â¥²",slarr:"â†",SmallCircle:"âˆ˜",smallsetminus:"âˆ–",smashp:"â¨³",smeparsl:"â§¤",smid:"âˆ£",smile:"âŒ£",smt:"âªª",smte:"âª¬",smtes:"âª¬ï¸€",SOFTcy:"Ð¬",softcy:"ÑŒ",sol:"/",solb:"â§„",solbar:"âŒ¿",Sopf:"ð•Š",sopf:"ð•¤",spades:"â™ ",spadesuit:"â™ ",spar:"âˆ¥",sqcap:"âŠ“",sqcaps:"âŠ“ï¸€",sqcup:"âŠ”",sqcups:"âŠ”ï¸€",Sqrt:"âˆš",sqsub:"âŠ",sqsube:"âŠ‘",sqsubset:"âŠ",sqsubseteq:"âŠ‘",sqsup:"âŠ",sqsupe:"âŠ’",sqsupset:"âŠ",sqsupseteq:"âŠ’",squ:"â–¡",Square:"â–¡",square:"â–¡",SquareIntersection:"âŠ“",SquareSubset:"âŠ",SquareSubsetEqual:"âŠ‘",SquareSuperset:"âŠ",SquareSupersetEqual:"âŠ’",SquareUnion:"âŠ”",squarf:"â–ª",squf:"â–ª",srarr:"â†’",Sscr:"ð’®",sscr:"ð“ˆ",ssetmn:"âˆ–",ssmile:"âŒ£",sstarf:"â‹†",Star:"â‹†",star:"â˜†",starf:"â˜…",straightepsilon:"Ïµ",straightphi:"Ï•",strns:"Â¯",Sub:"â‹",sub:"âŠ‚",subdot:"âª½",subE:"â«…",sube:"âŠ†",subedot:"â«ƒ",submult:"â«",subnE:"â«‹",subne:"âŠŠ",subplus:"âª¿",subrarr:"â¥¹",Subset:"â‹",subset:"âŠ‚",subseteq:"âŠ†",subseteqq:"â«…",SubsetEqual:"âŠ†",subsetneq:"âŠŠ",subsetneqq:"â«‹",subsim:"â«‡",subsub:"â«•",subsup:"â«“",succ:"â‰»",succapprox:"âª¸",succcurlyeq:"â‰½",Succeeds:"â‰»",SucceedsEqual:"âª°",SucceedsSlantEqual:"â‰½",SucceedsTilde:"â‰¿",succeq:"âª°",succnapprox:"âªº",succneqq:"âª¶",succnsim:"â‹©",succsim:"â‰¿",SuchThat:"âˆ‹",Sum:"âˆ‘",sum:"âˆ‘",sung:"â™ª",Sup:"â‹‘",sup:"âŠƒ",sup1:"Â¹",sup2:"Â²",sup3:"Â³",supdot:"âª¾",supdsub:"â«˜",supE:"â«†",supe:"âŠ‡",supedot:"â«„",Superset:"âŠƒ",SupersetEqual:"âŠ‡",suphsol:"âŸ‰",suphsub:"â«—",suplarr:"â¥»",supmult:"â«‚",supnE:"â«Œ",supne:"âŠ‹",supplus:"â«€",Supset:"â‹‘",supset:"âŠƒ",supseteq:"âŠ‡",supseteqq:"â«†",supsetneq:"âŠ‹",supsetneqq:"â«Œ",supsim:"â«ˆ",supsub:"â«”",supsup:"â«–",swarhk:"â¤¦",swArr:"â‡™",swarr:"â†™",swarrow:"â†™",swnwar:"â¤ª",szlig:"ÃŸ",Tab:"\t",target:"âŒ–",Tau:"Î¤",tau:"Ï„",tbrk:"âŽ´",Tcaron:"Å¤",tcaron:"Å¥",Tcedil:"Å¢",tcedil:"Å£",Tcy:"Ð¢",tcy:"Ñ‚",tdot:"âƒ›",telrec:"âŒ•",Tfr:"ð”—",tfr:"ð”±",there4:"âˆ´",Therefore:"âˆ´",therefore:"âˆ´",Theta:"Î˜",theta:"Î¸",thetasym:"Ï‘",thetav:"Ï‘",thickapprox:"â‰ˆ",thicksim:"âˆ¼",ThickSpace:"âŸâ€Š",thinsp:"â€‰",ThinSpace:"â€‰",thkap:"â‰ˆ",thksim:"âˆ¼",THORN:"Ãž",thorn:"Ã¾",Tilde:"âˆ¼",tilde:"Ëœ",TildeEqual:"â‰ƒ",TildeFullEqual:"â‰…",TildeTilde:"â‰ˆ",times:"Ã—",timesb:"âŠ ",timesbar:"â¨±",timesd:"â¨°",tint:"âˆ­",toea:"â¤¨",top:"âŠ¤",topbot:"âŒ¶",topcir:"â«±",Topf:"ð•‹",topf:"ð•¥",topfork:"â«š",tosa:"â¤©",tprime:"â€´",TRADE:"â„¢",trade:"â„¢",triangle:"â–µ",triangledown:"â–¿",triangleleft:"â—ƒ",trianglelefteq:"âŠ´",triangleq:"â‰œ",triangleright:"â–¹",trianglerighteq:"âŠµ",tridot:"â—¬",trie:"â‰œ",triminus:"â¨º",TripleDot:"âƒ›",triplus:"â¨¹",trisb:"â§",tritime:"â¨»",trpezium:"â¢",Tscr:"ð’¯",tscr:"ð“‰",TScy:"Ð¦",tscy:"Ñ†",TSHcy:"Ð‹",tshcy:"Ñ›",Tstrok:"Å¦",tstrok:"Å§",twixt:"â‰¬",twoheadleftarrow:"â†ž",twoheadrightarrow:"â† ",Uacute:"Ãš",uacute:"Ãº",Uarr:"â†Ÿ",uArr:"â‡‘",uarr:"â†‘",Uarrocir:"â¥‰",Ubrcy:"ÐŽ",ubrcy:"Ñž",Ubreve:"Å¬",ubreve:"Å­",Ucirc:"Ã›",ucirc:"Ã»",Ucy:"Ð£",ucy:"Ñƒ",udarr:"â‡…",Udblac:"Å°",udblac:"Å±",udhar:"â¥®",ufisht:"â¥¾",Ufr:"ð”˜",ufr:"ð”²",Ugrave:"Ã™",ugrave:"Ã¹",uHar:"â¥£",uharl:"â†¿",uharr:"â†¾",uhblk:"â–€",ulcorn:"âŒœ",ulcorner:"âŒœ",ulcrop:"âŒ",ultri:"â—¸",Umacr:"Åª",umacr:"Å«",uml:"Â¨",UnderBar:"_",UnderBrace:"âŸ",UnderBracket:"âŽµ",UnderParenthesis:"â",Union:"â‹ƒ",UnionPlus:"âŠŽ",Uogon:"Å²",uogon:"Å³",Uopf:"ð•Œ",uopf:"ð•¦",UpArrow:"â†‘",Uparrow:"â‡‘",uparrow:"â†‘",UpArrowBar:"â¤’",UpArrowDownArrow:"â‡…",UpDownArrow:"â†•",Updownarrow:"â‡•",updownarrow:"â†•",UpEquilibrium:"â¥®",upharpoonleft:"â†¿",upharpoonright:"â†¾",uplus:"âŠŽ",UpperLeftArrow:"â†–",UpperRightArrow:"â†—",Upsi:"Ï’",upsi:"Ï…",upsih:"Ï’",Upsilon:"Î¥",upsilon:"Ï…",UpTee:"âŠ¥",UpTeeArrow:"â†¥",upuparrows:"â‡ˆ",urcorn:"âŒ",urcorner:"âŒ",urcrop:"âŒŽ",Uring:"Å®",uring:"Å¯",urtri:"â—¹",Uscr:"ð’°",uscr:"ð“Š",utdot:"â‹°",Utilde:"Å¨",utilde:"Å©",utri:"â–µ",utrif:"â–´",uuarr:"â‡ˆ",Uuml:"Ãœ",uuml:"Ã¼",uwangle:"â¦§",vangrt:"â¦œ",varepsilon:"Ïµ",varkappa:"Ï°",varnothing:"âˆ…",varphi:"Ï•",varpi:"Ï–",varpropto:"âˆ",vArr:"â‡•",varr:"â†•",varrho:"Ï±",varsigma:"Ï‚",varsubsetneq:"âŠŠï¸€",varsubsetneqq:"â«‹ï¸€",varsupsetneq:"âŠ‹ï¸€",varsupsetneqq:"â«Œï¸€",vartheta:"Ï‘",vartriangleleft:"âŠ²",vartriangleright:"âŠ³",Vbar:"â««",vBar:"â«¨",vBarv:"â«©",Vcy:"Ð’",vcy:"Ð²",VDash:"âŠ«",Vdash:"âŠ©",vDash:"âŠ¨",vdash:"âŠ¢",Vdashl:"â«¦",Vee:"â‹",vee:"âˆ¨",veebar:"âŠ»",veeeq:"â‰š",vellip:"â‹®",Verbar:"â€–",verbar:"|",Vert:"â€–",vert:"|",VerticalBar:"âˆ£",VerticalLine:"|",VerticalSeparator:"â˜",VerticalTilde:"â‰€",VeryThinSpace:"â€Š",Vfr:"ð”™",vfr:"ð”³",vltri:"âŠ²",vnsub:"âŠ‚âƒ’",vnsup:"âŠƒâƒ’",Vopf:"ð•",vopf:"ð•§",vprop:"âˆ",vrtri:"âŠ³",Vscr:"ð’±",vscr:"ð“‹",vsubnE:"â«‹ï¸€",vsubne:"âŠŠï¸€",vsupnE:"â«Œï¸€",vsupne:"âŠ‹ï¸€",Vvdash:"âŠª",vzigzag:"â¦š",Wcirc:"Å´",wcirc:"Åµ",wedbar:"â©Ÿ",Wedge:"â‹€",wedge:"âˆ§",wedgeq:"â‰™",weierp:"â„˜",Wfr:"ð”š",wfr:"ð”´",Wopf:"ð•Ž",wopf:"ð•¨",wp:"â„˜",wr:"â‰€",wreath:"â‰€",Wscr:"ð’²",wscr:"ð“Œ",xcap:"â‹‚",xcirc:"â—¯",xcup:"â‹ƒ",xdtri:"â–½",Xfr:"ð”›",xfr:"ð”µ",xhArr:"âŸº",xharr:"âŸ·",Xi:"Îž",xi:"Î¾",xlArr:"âŸ¸",xlarr:"âŸµ",xmap:"âŸ¼",xnis:"â‹»",xodot:"â¨€",Xopf:"ð•",xopf:"ð•©",xoplus:"â¨",xotime:"â¨‚",xrArr:"âŸ¹",xrarr:"âŸ¶",Xscr:"ð’³",xscr:"ð“",xsqcup:"â¨†",xuplus:"â¨„",xutri:"â–³",xvee:"â‹",xwedge:"â‹€",Yacute:"Ã",yacute:"Ã½",YAcy:"Ð¯",yacy:"Ñ",Ycirc:"Å¶",ycirc:"Å·",Ycy:"Ð«",ycy:"Ñ‹",yen:"Â¥",Yfr:"ð”œ",yfr:"ð”¶",YIcy:"Ð‡",yicy:"Ñ—",Yopf:"ð•",yopf:"ð•ª",Yscr:"ð’´",yscr:"ð“Ž",YUcy:"Ð®",yucy:"ÑŽ",Yuml:"Å¸",yuml:"Ã¿",Zacute:"Å¹",zacute:"Åº",Zcaron:"Å½",zcaron:"Å¾",Zcy:"Ð—",zcy:"Ð·",Zdot:"Å»",zdot:"Å¼",zeetrf:"â„¨",ZeroWidthSpace:"â€‹",Zeta:"Î–",zeta:"Î¶",Zfr:"â„¨",zfr:"ð”·",ZHcy:"Ð–",zhcy:"Ð¶",zigrarr:"â‡",Zopf:"â„¤",zopf:"ð•«",Zscr:"ð’µ",zscr:"ð“",zwj:"â€",zwnj:"â€Œ"}),t.entityMap=t.HTML_ENTITIES},57653:(e,t,r)=>{"use strict";r.d(t,{A:()=>y}),r(94490),r(62953);var i,o,n,a,s,l,c,u,p=r(39070),d=r(71222),h=r(16001);function m(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function f(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let g=(i=(0,d.A)({type:"boolean",name:"Is editable?",description:"Indicates whether we can edit some aspect of the model item like its visibility or color"}),o=(0,d.A)({type:"boolean",name:"Is transformable?",description:"Indicates whether we can rotate/translate/scale the model"}),n=class extends p.A{constructor(){super(...arguments),m(this,"isEditable",a,this),m(this,"isTransformable",s,this)}},a=f(n.prototype,"isEditable",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=f(n.prototype,"isTransformable",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n),y=(l=(0,h.A)({type:g,name:"Editor traits",description:"Editor traits"}),c=class extends p.A{constructor(){super(...arguments),m(this,"editing",u,this)}},u=f(c.prototype,"editing",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c)},61864:function(e,t,r){!function(e){"use strict";function t(e,t,r,i,o,n,a){try{var s=e[n](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,r){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&a(o,r.prototype),o}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,n(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,e)})(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e){if(e){if("string"==typeof e)return c(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function p(e,t){return e(t={exports:{}},t.exports),t.exports}var d,h=p(function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,i){var o=Object.create((t&&t.prototype instanceof p?t:p).prototype),n=new x(i||[]);return o._invoke=function(e,t,r){var i="suspendedStart";return function(o,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw n;return{value:void 0,done:!0}}for(r.method=o,r.arg=n;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=c(e,t,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}(e,r,n),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function p(){}function d(){}function h(){}var m={};m[o]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(O([])));g&&g!==t&&r.call(g,o)&&(m=g);var y=h.prototype=p.prototype=Object.create(m);function b(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){var i;this._invoke=function(o,n){function a(){return new t(function(i,a){!function i(o,n,a,s){var l=c(e[o],e,n);if("throw"!==l.type){var u=l.arg,p=u.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then(function(e){i("next",e,a,s)},function(e){i("throw",e,a,s)}):t.resolve(p).then(function(e){u.value=e,a(u)},function(e){return i("throw",e,a,s)})}s(l.arg)}(o,n,i,a)})}return i=i?i.then(a,a):a()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return d.prototype=y.constructor=h,h.constructor=d,d.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(v.prototype),v.prototype[n]=function(){return this},e.AsyncIterator=v,e.async=function(t,r,i,o,n){void 0===n&&(n=Promise);var a=new v(l(t,r,i,o),n);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},b(y),s(y,a,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=O,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],a=n.completion;if("root"===n.tryLoc)return i("end");if(n.tryLoc<=this.prev){var s=r.call(n,"catchLoc"),l=r.call(n,"finallyLoc");if(s&&l){if(this.prev<n.catchLoc)return i(n.catchLoc,!0);if(this.prev<n.finallyLoc)return i(n.finallyLoc)}else if(s){if(this.prev<n.catchLoc)return i(n.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return i(n.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var o=i.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:O(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),m=(d=p(function(e,t){function r(e){return"object"!=typeof e||"toString"in e?e:Object.prototype.toString.call(e).slice(8,-1)}Object.defineProperty(t,"__esModule",{value:!0});var i="object"==typeof process&&!0;function o(e,t){if(!e){if(i)throw new Error("Invariant failed");throw new Error(t())}}t.invariant=o;var n=Object.prototype.hasOwnProperty,a=Array.prototype.splice,s=Object.prototype.toString;function l(e){return s.call(e).slice(8,-1)}var c=Object.assign||function(e,t){return u(t).forEach(function(r){n.call(t,r)&&(e[r]=t[r])}),e},u="function"==typeof Object.getOwnPropertySymbols?function(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.keys(e)};function p(e){return Array.isArray(e)?c(e.constructor(e.length),e):"Map"===l(e)?new Map(e):"Set"===l(e)?new Set(e):e&&"object"==typeof e?c(Object.create(Object.getPrototypeOf(e)),e):e}var d=function(){function e(){this.commands=c({},h),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(e,t){return e===t},this.update.newContext=function(){return(new e).update}}return Object.defineProperty(e.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(e){this.update.isEquals=e},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this.commands[e]=t},e.prototype.update=function(e,t){var r=this,i="function"==typeof t?{$apply:t}:t;Array.isArray(e)&&Array.isArray(i)||o(!Array.isArray(i),function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."}),o("object"==typeof i&&null!==i,function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: "+Object.keys(r.commands).join(", ")+"."});var a=e;return u(i).forEach(function(t){if(n.call(r.commands,t)){var o=e===a;a=r.commands[t](i[t],a,i,e),o&&r.isEquals(a,e)&&(a=e)}else{var s="Map"===l(e)?r.update(e.get(t),i[t]):r.update(e[t],i[t]),c="Map"===l(a)?a.get(t):a[t];r.isEquals(s,c)&&(void 0!==s||n.call(e,t))||(a===e&&(a=p(e)),"Map"===l(a)?a.set(t,s):a[t]=s)}}),a},e}();t.Context=d;var h={$push:function(e,t,r){return f(t,r,"$push"),e.length?t.concat(e):t},$unshift:function(e,t,r){return f(t,r,"$unshift"),e.length?e.concat(t):t},$splice:function(e,t,i,n){return function(e,t){o(Array.isArray(e),function(){return"Expected $splice target to be an array; got "+r(e)}),y(t.$splice)}(t,i),e.forEach(function(e){y(e),t===n&&e.length&&(t=p(n)),a.apply(t,e)}),t},$set:function(e,t,r){return function(e){o(1===Object.keys(e).length,function(){return"Cannot have more than one key in an object with $set"})}(r),e},$toggle:function(e,t){g(e,"$toggle");var r=e.length?p(t):t;return e.forEach(function(e){r[e]=!t[e]}),r},$unset:function(e,t,r,i){return g(e,"$unset"),e.forEach(function(e){Object.hasOwnProperty.call(t,e)&&(t===i&&(t=p(i)),delete t[e])}),t},$add:function(e,t,r,i){return b(t,"$add"),g(e,"$add"),"Map"===l(t)?e.forEach(function(e){var r=e[0],o=e[1];t===i&&t.get(r)!==o&&(t=p(i)),t.set(r,o)}):e.forEach(function(e){t!==i||t.has(e)||(t=p(i)),t.add(e)}),t},$remove:function(e,t,r,i){return b(t,"$remove"),g(e,"$remove"),e.forEach(function(e){t===i&&t.has(e)&&(t=p(i)),t.delete(e)}),t},$merge:function(e,t,i,n){var a,s;return a=t,o((s=e)&&"object"==typeof s,function(){return"update(): $merge expects a spec of type 'object'; got "+r(s)}),o(a&&"object"==typeof a,function(){return"update(): $merge expects a target of type 'object'; got "+r(a)}),u(e).forEach(function(r){e[r]!==t[r]&&(t===n&&(t=p(n)),t[r]=e[r])}),t},$apply:function(e,t){var i;return o("function"==typeof(i=e),function(){return"update(): expected spec of $apply to be a function; got "+r(i)+"."}),e(t)}},m=new d;function f(e,t,i){o(Array.isArray(e),function(){return"update(): expected target of "+r(i)+" to be an array; got "+r(e)+"."}),g(t[i],i)}function g(e,t){o(Array.isArray(e),function(){return"update(): expected spec of "+r(t)+" to be an array; got "+r(e)+". Did you forget to wrap your parameter in an array?"})}function y(e){o(Array.isArray(e),function(){return"update(): expected spec of $splice to be an array of arrays; got "+r(e)+". Did you forget to wrap your parameters in an array?"})}function b(e,t){var i=l(e);o("Map"===i||"Set"===i,function(){return"update(): "+r(t)+" expects a target of type Set or Map; got "+r(i)})}t.isEquals=m.update.isEquals,t.extend=m.extend,t.default=m.update,t.default.default=e.exports=c(t.default,t)}))&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,f=function(e){function t(r,i){var o,n=(this instanceof t?this.constructor:void 0).prototype;return(o=e.call(this,JSON.stringify(i))||this).details=i,o.response=r,Object.setPrototypeOf(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o),n),o}return o(t,e),t}(l(Error)),g=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(f),y=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(g),b=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(g),v=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(f),w=void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},A=function(){function e(e){var t,r=(null==e?void 0:e.fetch)||(null==w?void 0:w.fetch);if(!r)throw new Error("fetch() was not found, try installing a polyfill in the browser or node-fetch in nodejs. You can pass fetch as an option to the api client.");var i=(null==e?void 0:e.domain)||(null==w||null==(t=w.location)?void 0:t.origin);if(!i)throw new Error("Missing domain");this.defaultConfig=S(e,{baseUrl:x(i),fetch:r})}return e.prototype.get=function(){var e=function(e){return function(){var r=this,i=arguments;return new Promise(function(o,n){var a=e.apply(r,i);function s(e){t(a,o,n,s,l,"next",e)}function l(e){t(a,o,n,s,l,"throw",e)}s(void 0)})}}(h.mark(function e(t,r){var i,o,n,a,s,l,c,u,p;return h.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=S(r,this.defaultConfig),(o="string"==typeof t?t:t.toString()).startsWith("/")&&(o=o.slice(1)),(n=new URL(o,i.baseUrl)).searchParams.sort(),(a=new Headers).append("Accept","application/json"),i.apiKey&&a.append("Authorization","ApiKey "+i.apiKey),s=new Request(n.toString(),{method:"GET",headers:a,credentials:"same-origin"}),!i.interceptRequest){e.next=13;break}return e.next=12,i.interceptRequest(s);case 12:s=e.sent;case 13:return l=i.fetch,e.next=16,l(s);case 16:if(c=e.sent,!i.interceptResponse){e.next=21;break}return e.next=20,i.interceptResponse(c);case 20:return e.abrupt("return",e.sent);case 21:if(!c.ok){e.next=28;break}return e.next=24,c.json();case 24:return e.abrupt("return",e.sent);case 28:return u=void 0,e.next=31,c.text();case 31:if(p=e.sent)try{u=JSON.parse(p)}catch(e){}if(u||!p&&!c.statusText||(u={message:p||c.statusText}),401!==c.status){e.next=36;break}throw new y(c,u||"authentication-error");case 36:if(404!==c.status){e.next=38;break}throw new b(c,u||"not-found");case 38:if(!(c.status<500)){e.next=40;break}throw new g(c,u||"user-error");case 40:throw new v(c,u||"server-error");case 41:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),e}();function S(e,t){if(!e)return t;var r=e.domain,i=e.fetch,o=e.apiKey,n=e.interceptRequest,a=e.interceptResponse,s={};return r&&(s.baseUrl=x(r)),o&&(s.apiKey=o),i&&(s.fetch=i),n&&(s.interceptRequest=n),a&&(s.interceptResponse=a),m(t,{$merge:s})}function x(e){var t;return(t=e.startsWith("http://")||e.startsWith("https://")?e:"https://"+e+".opendatasoft.com").endsWith("/")||(t+="/"),t+"api/v2/"}var O=function(){function e(e,t){void 0===e&&(e=""),this.searchParams=void 0,this.params=t?i({},t):{},this.path=e}var t=e.prototype;return t.getPath=function(){return this.path},t.getSearchParams=function(){if(void 0===this.searchParams){for(var e in this.searchParams=new URLSearchParams,this.params){var t=this.params[e];if("string"==typeof t)this.searchParams.set(e,t);else for(var r,i=u([].concat(t).sort());!(r=i()).done;)this.searchParams.append(e,r.value)}this.searchParams.sort()}return this.searchParams},t.toString=function(){var e=this.getSearchParams().toString();return e&&(e="?"+e),""+this.getPath()+e},t.set=function(t,r){var i,o=m(this.params,{$merge:(i={},i[t]=r,i)});return o===this.params?this:new e(this.path,o)},t.update=function(e,t){var r,i=this.params[e];return r="string"==typeof t?t:t("string"==typeof i?i||"":(null==i?void 0:i[0])||""),this.set(e,r)},t.append=function(e,t){var r=this.params[e],i=void 0===r?[t]:"string"==typeof r?[r,t]:[].concat(r,[t]);return this.set(e,i)},t.select=function(e){return this.update("select",e)},t.where=function(e){return this.update("where",e)},t.groupBy=function(e){return this.update("group_by",e)},t.orderBy=function(e){return this.update("order_by",e)},t.limit=function(e){return"number"==typeof e?this.set("limit",e.toString()):this.update("limit",function(t){return e(Number(t)).toString()})},t.offset=function(e){return"number"==typeof e?this.set("offset",e.toString()):this.update("offset",function(t){return e(Number(t)).toString()})},t.facet=function(e){return this.append("facet",e)},t.refine=function(e){return this.append("refine",e)},t.exclude=function(e){return this.append("exclude",e)},t.lang=function(e){return this.set("lang",e)},e}();function P(e){return function(){return{itself:function(){return new O(e+"/")},aggregates:function(){return new O(e+"/aggregates/")},facets:function(){return new O(e+"/facets/")},datasets:function(){return new O(e+"/datasets/")},dataset:function(t){return{itself:function(){return new O(e+"/datasets/"+t+"/")},aggregates:function(){return new O(e+"/datasets/"+t+"/aggregates/")},facets:function(){return new O(e+"/datasets/"+t+"/facets/")},records:function(){return new O(e+"/datasets/"+t+"/records/")}}}}}}var T=P("catalog"),I=P("monitoring"),D=P("opendatasoft");e.ApiClient=A,e.Query=O,e.all=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return"("+e+")"}).join(" AND ")},e.date=function(e){return"date'"+e.toISOString().split("T")[0]+"'"},e.dateTime=function(e){return"date'"+e.toISOString()+"'"},e.field=function(e){return"`"+e.replace(/`/g,"\\`")+"`"},e.fromCatalog=T,e.fromDataNetwork=D,e.fromMonitoring=I,e.one=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return"("+e+")"}).join(" OR ")},e.string=function(e){return JSON.stringify(e)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},64466:(e,t,r)=>{var i=r(44582).NAMESPACE,o=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+o.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),a=new RegExp("^"+o.source+n.source+"*(?::"+o.source+n.source+"*)?$");function s(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,s)}function l(){}function c(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function u(e,t,r,o,n,a){function s(e,t,i){r.attributeNames.hasOwnProperty(e)&&a.fatalError("Attribute "+e+" redefined"),r.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,n),i)}for(var l,c=++t,u=0;;){var p=e.charAt(c);switch(p){case"=":if(1===u)l=e.slice(t,c),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(a.warning('attribute value must after "="'),l=e.slice(t,c)),t=c+1,!((c=e.indexOf(p,t))>0))throw new Error("attribute value no end '"+p+"' match");s(l,d=e.slice(t,c),t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');s(l,d=e.slice(t,c),t),a.warning('attribute "'+l+'" missed start quot('+p+")!!"),t=c+1,u=5}break;case"/":switch(u){case 0:r.setTagName(e.slice(t,c));case 5:case 6:case 7:u=7,r.closed=!0;case 4:case 1:break;case 2:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==u&&r.setTagName(e.slice(t,c)),c;case">":switch(u){case 0:r.setTagName(e.slice(t,c));case 5:case 6:case 7:break;case 4:case 1:"/"===(d=e.slice(t,c)).slice(-1)&&(r.closed=!0,d=d.slice(0,-1));case 2:2===u&&(d=l),4==u?(a.warning('attribute "'+d+'" missed quot(")!'),s(l,d,t)):(i.isHTML(o[""])&&d.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+d+'" missed value!! "'+d+'" instead!!'),s(d,d,t));break;case 3:throw new Error("attribute value missed!!")}return c;case"Â€":p=" ";default:if(p<=" ")switch(u){case 0:r.setTagName(e.slice(t,c)),u=6;break;case 1:l=e.slice(t,c),u=2;break;case 4:var d=e.slice(t,c);a.warning('attribute "'+d+'" missed quot(")!!'),s(l,d,t);case 5:u=6}else switch(u){case 2:r.tagName,i.isHTML(o[""])&&l.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),s(l,l,t),t=c,u=1;break;case 5:a.warning('attribute space is required"'+l+'"!!');case 6:u=1,t=c;break;case 3:u=4,t=c;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function p(e,t,r){for(var o=e.tagName,n=null,a=e.length;a--;){var s=e[a],l=s.qName,c=s.value;if((h=l.indexOf(":"))>0)var u=s.prefix=l.slice(0,h),p=l.slice(h+1),d="xmlns"===u&&p;else p=l,u=null,d="xmlns"===l&&"";s.localName=p,!1!==d&&(null==n&&(n={},m(r,r={})),r[d]=n[d]=c,s.uri=i.XMLNS,t.startPrefixMapping(d,c))}for(a=e.length;a--;)(u=(s=e[a]).prefix)&&("xml"===u&&(s.uri=i.XML),"xmlns"!==u&&(s.uri=r[u||""]));var h;(h=o.indexOf(":"))>0?(u=e.prefix=o.slice(0,h),p=e.localName=o.slice(h+1)):(u=null,p=e.localName=o);var f=e.uri=r[u||""];if(t.startElement(f,p,o,e),!e.closed)return e.currentNSMap=r,e.localNSMap=n,!0;if(t.endElement(f,p,o),n)for(u in n)Object.prototype.hasOwnProperty.call(n,u)&&t.endPrefixMapping(u)}function d(e,t,r,i,o){if(/^(?:script|textarea)$/i.test(r)){var n=e.indexOf("</"+r+">",t),a=e.substring(t+1,n);if(/[&<]/.test(a))return/^script$/i.test(r)?(o.characters(a,0,a.length),n):(a=a.replace(/&#?\w+;/g,i),o.characters(a,0,a.length),n)}return t+1}function h(e,t,r,i){var o=i[r];return null==o&&((o=e.lastIndexOf("</"+r+">"))<t&&(o=e.lastIndexOf("</"+r)),i[r]=o),o<t}function m(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function f(e,t,r,i){if("-"===e.charAt(t+2))return"-"===e.charAt(t+3)?(o=e.indexOf("--\x3e",t+4))>t?(r.comment(e,t+4,o-t-4),o+3):(i.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,o-t-9),r.endCDATA(),o+3}var n=function(e,t){var r,i=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=t,o.exec(e);r=o.exec(e);)if(i.push(r),r[1])return i}(e,t),a=n.length;if(a>1&&/!doctype/i.test(n[0][0])){var s=n[1][0],l=!1,c=!1;a>3&&(/^public$/i.test(n[2][0])?(l=n[3][0],c=a>4&&n[4][0]):/^system$/i.test(n[2][0])&&(c=n[3][0]));var u=n[a-1];return r.startDTD(s,l,c),r.endDTD(),u.index+u[0].length}return-1}function g(e,t,r){var i=e.indexOf("?>",t);if(i){var o=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,r.processingInstruction(o[1],o[2]),i+2):-1}return-1}function y(){this.attributeNames={}}s.prototype=new Error,s.prototype.name=s.name,l.prototype={parse:function(e,t,r){var o=this.domBuilder;o.startDocument(),m(t,t={}),function(e,t,r,o,n){function a(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(r,t)?r[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(n.error("entity not found:"+e),e)}function l(t){if(t>O){var r=e.substring(O,t).replace(/&#?\w+;/g,a);A&&m(O),o.characters(r,0,t-O),O=t}}function m(t,r){for(;t>=v&&(r=w.exec(e));)b=r.index,v=b+r[0].length,A.lineNumber++;A.columnNumber=t-b+1}for(var b=0,v=0,w=/.*(?:\r\n?|\n)|.*$/g,A=o.locator,S=[{currentNSMap:t}],x={},O=0;;){try{var P=e.indexOf("<",O);if(P<0){if(!e.substr(O).match(/^\s*$/)){var T=o.doc,I=T.createTextNode(e.substr(O));T.appendChild(I),o.currentElement=I}return}switch(P>O&&l(P),e.charAt(P+1)){case"/":var D=e.indexOf(">",P+3),C=e.substring(P+2,D).replace(/[ \t\n\r]+$/g,""),E=S.pop();D<0?(C=e.substring(P+2).replace(/[\s<].*/,""),n.error("end tag name: "+C+" is not complete:"+E.tagName),D=P+1+C.length):C.match(/\s</)&&(C=C.replace(/[\s<].*/,""),n.error("end tag name: "+C+" maybe not complete"),D=P+1+C.length);var _=E.localNSMap,j=E.tagName==C;if(j||E.tagName&&E.tagName.toLowerCase()==C.toLowerCase()){if(o.endElement(E.uri,E.localName,C),_)for(var z in _)Object.prototype.hasOwnProperty.call(_,z)&&o.endPrefixMapping(z);j||n.fatalError("end tag name: "+C+" is not match the current start tagName:"+E.tagName)}else S.push(E);D++;break;case"?":A&&m(P),D=g(e,P,o);break;case"!":A&&m(P),D=f(e,P,o,n);break;default:A&&m(P);var N=new y,k=S[S.length-1].currentNSMap,R=(D=u(e,P,N,k,a,n),N.length);if(!N.closed&&h(e,D,N.tagName,x)&&(N.closed=!0,r.nbsp||n.warning("unclosed xml attribute")),A&&R){for(var M=c(A,{}),F=0;F<R;F++){var L=N[F];m(L.offset),L.locator=c(A,{})}o.locator=M,p(N,o,k)&&S.push(N),o.locator=A}else p(N,o,k)&&S.push(N);i.isHTML(N.uri)&&!N.closed?D=d(e,D,N.tagName,a,o):D++}}catch(e){if(e instanceof s)throw e;n.error("element parse error: "+e),D=-1}D>O?O=D:l(Math.max(P,O)+1)}}(e,t,r,o,this.errorHandler),o.endDocument()}},y.prototype={setTagName:function(e){if(!a.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!a.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=l,t.ParseError=s},64995:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var i=r(54156),o=r(89616),n=r(22256),a=r(9084),s=r(59801);function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c{constructor(e){l(this,"terria",void 0),l(this,"url",void 0),l(this,"_serverConfig",void 0),this.terria=e.terria,this.url=e.url}init(e){var t,r;this.url=null!==(t=null!==(r=this.url)&&void 0!==r?r:this.terria.configParameters.shareUrl)&&void 0!==t?t:"share",this._serverConfig=e}get isUsable(){return void 0!==this.url&&"object"==typeof this._serverConfig&&"string"==typeof this._serverConfig.newShareUrlPrefix||"share"!==this.url}get shareMaxRequestSize(){return this._serverConfig.shareMaxRequestSize}get shareMaxRequestSizeBytes(){return this._serverConfig.shareMaxRequestSizeBytes}async getShareToken(e){if(!this.isUsable)throw s.Ay.from("`ShareDataService` is not usable");try{const t=await(0,a.A)({url:this.url,method:"POST",data:JSON.stringify(e),headers:{"Content-Type":"application/json"},responseType:"json"});return("string"==typeof t?JSON.parse(t):t).id}catch(e){throw s.Ay.from(e,{title:i.Ay.t("models.shareData.generateErrorTitle"),message:i.Ay.t("models.shareData.generateErrorMessage"),importance:1})}}async resolveData(e){if(!this.isUsable)throw s.Ay.from("`ShareDataService` is not usable");try{const t=await(0,n.A)(this.url+"/"+e);if(!(0,o.OW)(t,!1))throw s.Ay.from("Invalid server response for share ".concat(this.url+"/"+e,"\n`").concat(JSON.stringify(t),"`"));return t}catch(e){throw s.Ay.from(e,{title:i.Ay.t("models.shareData.expandErrorTitle"),message:i.Ay.t("models.shareData.expandErrorMessage",{appName:this.terria.appName}),importance:1})}}}},69823:(e,t,r)=>{"use strict";r.d(t,{Zc:()=>c,ng:()=>g});var i=r(79764),o=r(91273),n=r(67763),a=r(43376),s=r(47659),l=r(43104);function c(e,t){var r,i,o,c,h,m,f,g,b,v,w;return e?{color:"esriPMS"===e.type?"#FFFFFF":null===(r=d(e.color))||void 0===r?void 0:r.toCssColorString(),pointSize:(0,l.A)(a.A,{}),point:(0,l.A)(s.yy,{marker:"esriPMS"===e.type?"data:".concat(e.contentType,";base64,").concat(e.imageData):u(e.style),height:null!==(i=p(e.size))&&void 0!==i?i:p(e.height),width:null!==(o=p(e.size))&&void 0!==o?o:p(e.width),rotation:e.angle,pixelOffset:[null!==(c=e.xoffset)&&void 0!==c?c:0,null!==(h=e.yoffset)&&void 0!==h?h:0],legendTitle:t||void 0}),outline:"esriSLSNull"!==(null===(m=e.outline)||void 0===m?void 0:m.style)?(0,l.A)(n.gL,{color:"esriSLS"===e.type?null===(f=d(e.color))||void 0===f?void 0:f.toCssColorString():null===(g=d(null===(b=e.outline)||void 0===b?void 0:b.color))||void 0===g?void 0:g.toCssColorString(),width:"esriSLS"===e.type?p(e.width):p(null===(v=e.outline)||void 0===v?void 0:v.width),legendTitle:t||void 0,dash:"esriSLS"===e.type?y(e.style):y(null===(w=e.outline)||void 0===w?void 0:w.style)}):void 0}:{}}function u(e){switch(e){case"esriSMSCross":return"hospital";case"esriSMSDiamond":return"diamond";case"esriSMSSquare":return"square";case"esriSMSTriangle":return"triangle";case"esriSMSX":return"cross";default:return"point"}}function p(e){if((0,o.A)(e))return 4*e/3}function d(e){if(e)return i.A.fromBytes(e[0],e[1],e[2],e[3])}const h=[4,3],m={esriSLSNull:0,esriSLSSolid:255,esriSLSDash:3087,esriSLSDot:7,esriSLSDashDot:2017,esriSLSDashDotDot:16273,esriSLSLongDash:2047,esriSLSLongDashDot:4081,esriSLSShortDash:4095,esriSLSShortDot:13107,esriSLSShortDashDot:8179,esriSLSShortDashDotDot:16281},f={0:[],255:[],3087:[6,6],7:[1,3],2017:[4,3,1,3],16273:[8,3,1,3,1,3],2047:[8,3],4081:[8,3,1,3],4095:[4,1],13107:[1,1],8179:[4,1,1,1],16281:[4,1,1,1,1,1]};function g(e){return f[e]?f[e]:h}function y(e){if(e){const t=function(e){if(e in m)return m[e]}(e);if(void 0!==t)return g(t)}return[]}},72652:(e,t,r)=>{"use strict";var i=r(76080),o=r(69565),n=r(28551),a=r(16823),s=r(44209),l=r(26198),c=r(1625),u=r(70081),p=r(50851),d=r(9539),h=TypeError,m=function(e,t){this.stopped=e,this.result=t},f=m.prototype;e.exports=function(e,t,r){var g,y,b,v,w,A,S,x=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),I=!(!r||!r.INTERRUPTED),D=i(t,x),C=function(e){return g&&d(g,"normal"),new m(!0,e)},E=function(e){return O?(n(e),I?D(e[0],e[1],C):D(e[0],e[1])):I?D(e,C):D(e)};if(P)g=e.iterator;else if(T)g=e;else{if(!(y=p(e)))throw new h(a(e)+" is not iterable");if(s(y)){for(b=0,v=l(e);v>b;b++)if((w=E(e[b]))&&c(f,w))return w;return new m(!1)}g=u(e,y)}for(A=P?e.next:g.next;!(S=o(A,g)).done;){try{w=E(S.value)}catch(e){d(g,"throw",e)}if("object"==typeof w&&w&&c(f,w))return w}return new m(!1)}},75111:(e,t,r)=>{"use strict";r.d(t,{A:()=>s}),r(94490),r(62953);var i=r(54156),o=r(27813),n=r(72209);function a(e){var t;let r=(t=class extends e{constructor(){super(...arguments),(0,o.Gn)(this)}get hasShadows(){return!0}get cesiumShadows(){switch(this.shadows.toLowerCase()){case"none":default:return n.A.DISABLED;case"both":return n.A.ENABLED;case"cast":return n.A.CAST_ONLY;case"receive":return n.A.RECEIVE_ONLY}}get shadowDimensions(){return[{id:"shadows",name:i.Ay.t("models.shadow.name"),options:[{id:"NONE",name:i.Ay.t("models.shadow.options.none")},{id:"CAST",name:i.Ay.t("models.shadow.options.cast")},{id:"RECEIVE",name:i.Ay.t("models.shadow.options.receive")},{id:"BOTH",name:i.Ay.t("models.shadow.options.both")}],selectedId:this.shadows,disable:!this.showShadowUi,setDimensionValue:(e,t)=>"CAST"===t||"RECEIVE"===t||"BOTH"===t||"NONE"===t?(0,o.h5)(()=>this.setTrait(e,"shadows",t)):null}]}},a=t.prototype,s="cesiumShadows",l=[o.EW],c=Object.getOwnPropertyDescriptor(t.prototype,"cesiumShadows"),u=t.prototype,p={},Object.keys(c).forEach(function(e){p[e]=c[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(a,s,e)||e},p),u&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(u):void 0,p.initializer=void 0),void 0===p.initializer&&Object.defineProperty(a,s,p),t);var a,s,l,c,u,p;return r}(a||(a={})).isMixedInto=function(e){return e&&e.hasShadows};const s=a},79327:(e,t,r)=>{"use strict";r.d(t,{A:()=>wt});var i=r(27813),o=r(76516),n=(r(89463),r(54743),r(11745),r(27495),r(25440),r(21489),r(75044),r(28845),r(373),r(62953),r(96540)),a=r(31370),s=r(84193),l=r.n(s),c=r(5556),u=r(18492),p=r(33969),d=r(96043);const h="tjs-cesium-ion-connector__connect-button tjs-_buttons__btn tjs-_buttons__btn-transparent tjs-_buttons__btn-primary",m="tjs-cesium-ion-connector__token-warning-hidden";var f=r(31479),g=r(93264),y=r(6119),b=r(52256),v=r(43473),w=r(31459),A=r(46942),S=r.n(A),x=r(38398),O=r(8711),P=r(53381),T=r(65949),I=r(91273),D=r(74848);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function E(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _=(0,O.Ay)(x.Rg).withConfig({displayName:"CesiumIonConnector__ActionButton",componentId:"sc-xada3v-0"})(["svg{height:20px;width:20px;margin:5px;fill:",";}&:hover,&:focus{svg{fill:",";}}"],e=>e.theme.charcoalGrey,e=>e.theme.modalHighlight),j={page:new class{constructor(){E(this,"loginToken",null)}get(){return this.loginToken}set(e){this.loginToken=e}clear(){this.loginToken=null}},sessionStorage:new class{constructor(){E(this,"storageName","cesium-ion-login-token")}get(){var e;return null!==(e=sessionStorage.getItem(this.storageName))&&void 0!==e?e:""}set(e){sessionStorage.setItem(this.storageName,e)}clear(){sessionStorage.removeItem(this.storageName)}},localStorage:new class{constructor(){E(this,"storageName","cesium-ion-login-token")}get(){var e;return null!==(e=localStorage.getItem(this.storageName))&&void 0!==e?e:""}set(e){localStorage.setItem(this.storageName,e)}clear(){localStorage.removeItem(this.storageName)}}},z=j,N={id:0,scopes:[],username:"",email:"",emailVerified:!1,avatar:c.string,storage:{}},k=(0,a.PA)(function(){var e,t,r;const i=(0,P.ME)(),{t:o}=(0,u.B)(),a=null!==(e=z[null!==(t=i.terria.configParameters.cesiumIonLoginTokenPersistence)&&void 0!==t?t:""])&&void 0!==e?e:j.page,[s,c]=(0,n.useState)({value:"",hash:""}),[A,x]=(0,n.useState)([]),[O,k]=(0,n.useState)(!1),[R,M]=(0,n.useState)([]),[F,L]=(0,n.useState)(!1),[G,U]=(0,n.useState)(null!==(r=a.get())&&void 0!==r?r:""),[W,q]=(0,n.useState)(N),[B,V]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!crypto||!crypto.subtle)return;const e=[...crypto.getRandomValues(new Uint8Array(32))].map(e=>e.toString(16).padStart(2,"0")).join("");crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)).then(t=>{c({value:e,hash:btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]/g,"")})})},[]),(0,n.useEffect)(()=>{0!==G.length&&(V(!0),fetch("https://api.cesium.com/v1/me",{headers:{Authorization:"Bearer ".concat(G)}}).then(e=>e.json()).then(e=>{e&&e.username?q(e):q(N),V(!1)}))},[G]),(0,n.useEffect)(()=>{0!==G.length&&(L(!0),fetch("https://api.cesium.com/v1/assets",{headers:{Authorization:"Bearer ".concat(G)}}).then(e=>e.json()).then(e=>{e.items&&(e.items.forEach(e=>{e.uniqueName="".concat(e.name," (").concat(e.id,")")}),M(e.items)),L(!1)}))},[G]),(0,n.useEffect)(()=>{i.terria.configParameters.cesiumIonAllowSharingAddedAssets&&0!==G.length&&(k(!0),fetch("https://api.cesium.com/v2/tokens",{headers:{Authorization:"Bearer ".concat(G)}}).then(e=>e.json()).then(e=>{e.items&&(e.items.forEach(e=>{e.uniqueName="".concat(e.name," (").concat(e.id,")")}),x(e.items)),k(!1)}))},[G,i.terria.configParameters.cesiumIonAllowSharingAddedAssets]);let H=i.currentCesiumIonToken?A.find(e=>e.id===i.currentCesiumIonToken):void 0;void 0===H&&A.length>0&&(H=A[0]);const $=e=>{i.currentCesiumIonToken=e.id};if(!crypto||!crypto.subtle)return(0,D.jsx)("label",{className:d.Ay.label,children:"This service is not currently available. The most likely cause is that this web page is being accessed with `http` instead of `https`."});const J={list:d.Ay.dropdownList,icon:(0,D.jsx)(w.Ay,{glyph:w.Ay.GLYPHS.opened}),dropdown:"tjs-cesium-ion-connector__drop-down",button:"tjs-cesium-ion-connector__drop-down-button"};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("label",{className:d.Ay.label,children:(0,D.jsx)(p.x,{i18nKey:"addData.cesiumIon",children:(0,D.jsx)("strong",{children:"Step 2:"})})}),G.length>0?(0,D.jsxs)(D.Fragment,{children:[B?(0,D.jsx)("label",{className:d.Ay.label,children:"Loading user profile information..."}):(0,D.jsxs)("label",{className:d.Ay.label,children:["Connected to Cesium ion as ",W.username]}),(0,D.jsx)("button",{className:h,onClick:function(){a.clear(),U(""),q(N)},children:"Disconnect"}),W.username.length>0&&(0,D.jsxs)(D.Fragment,{children:[X(),F?(0,D.jsx)("label",{className:d.Ay.label,children:"Loading asset list..."}):(0,D.jsx)("table",{className:"tjs-cesium-ion-connector__assets-list",children:(0,D.jsxs)("tbody",{children:[(0,D.jsxs)("tr",{children:[(0,D.jsx)("th",{}),(0,D.jsx)("th",{children:"Name"}),(0,D.jsx)("th",{children:"Type"})]}),R.filter(e=>H?void 0===e.id||void 0===H.assetIds||H.assetIds.indexOf(e.id)>=0:!i.terria.configParameters.cesiumIonAllowSharingAddedAssets).map(Z)]})})]})]}):(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{children:["Access globe high-resolution 3D content, including photogrammetry, terrain, imagery and buildings. Bring your own data for tiling, hosting and streaming to ",i.terria.appName,"."]}),(0,D.jsx)("div",{children:(0,D.jsx)("button",{className:h,onClick:function(){const e=i.terria.configParameters.cesiumIonOAuth2ApplicationID,t=l()("build/TerriaJS/cesium-ion-oauth2.html").absoluteTo(window.location.href).fragment("").query("").toString(),r=s.value,o=s.hash,n=[...crypto.getRandomValues(new Uint8Array(16))].map(e=>e.toString(16).padStart(2,"0")).join(""),c=new(l())("https://ion.cesium.com/oauth").addQuery({response_type:"code",client_id:e,scope:"assets:read assets:list tokens:read profile:read",redirect_uri:t,state:n,code_challenge:o,code_challenge_method:"S256"});window["cesiumIonOAuth2_"+n]=function(i){fetch("https://api.cesium.com/oauth/token",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({grant_type:"authorization_code",client_id:e,code:i,redirect_uri:t,code_verifier:r})}).then(e=>e.json()).then(e=>{var t;a.set(e.access_token),U(null!==(t=e.access_token)&&void 0!==t?t:"")})},window.open(c.toString(),"_blank","popup=yes,width=600,height=600")},disabled:""===s.hash,children:"Connect to Cesium ion"})})]})]});function X(){if(i.terria.configParameters.cesiumIonAllowSharingAddedAssets)return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("label",{className:d.Ay.label,children:(0,D.jsx)(p.x,{i18nKey:"addData.cesiumIonToken",children:"Cesium ion Token:"})}),O?(0,D.jsx)("label",{className:d.Ay.label,children:"Loading token list..."}):(0,D.jsx)(v.A,{options:A,textProperty:"uniqueName",selected:H,selectOption:$,matchWidth:!0,theme:J}),(0,D.jsx)("div",{className:S()("tjs-cesium-ion-connector__token-warning",{[m]:!H}),children:K()})]})}function K(){if(!H)return;const e=[];for(const r of null!==(t=H.scopes)&&void 0!==t?t:[]){var t;"assets:read"!==r&&"geocode"!==r&&e.push(r)}if(e.length>0)return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("strong",{children:"DO NOT USE THIS TOKEN!"})," It allows access to your"," ",(0,D.jsx)("a",{href:"https://ion.cesium.com/tokens",target:"_blank",rel:"noreferrer",children:"Cesium ion account"})," ","using the following scopes that provide potentially sensitive information or allow changes to be made to your account:"," ",e.join(", ")]});if(!function(e){if(!(0,I.A)(e.allowedUrls))return!0;const t=new(l())(window.location.href);for(const r of e.allowedUrls){let e;try{e=new(l())(r)}catch(e){continue}const i=t.hostname(),o=e.hostname();if((i===o||i.endsWith(o)&&"."===i[i.length-o.length-1])&&!(t.port().length>0&&t.port()!==e.port())&&t.path().startsWith(e.path()))return!0}return!1}(H))return(0,D.jsxs)(D.Fragment,{children:["This token cannot be used with this map because the map is not in the token's list of allowed URLs in your"," ",(0,D.jsx)("a",{href:"https://ion.cesium.com/tokens",target:"_blank",rel:"noreferrer",children:"Cesium ion account"}),"."]});let r=-1;return H.assetIds&&(r=H.assetIds.length),(0,D.jsxs)(D.Fragment,{children:["This token allows access to"," ",(0,D.jsx)("strong",{children:r<0?"every":r})," ",r<=1?"asset":"assets"," in your"," ",(0,D.jsx)("a",{href:"https://ion.cesium.com/tokens",target:"_blank",rel:"noreferrer",children:"Cesium ion account"}),"."]})}function Z(e){return(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{children:(0,D.jsx)(_,{type:"button",onClick:Q.bind(void 0,i.terria,e),title:o("catalogItem.add"),children:(0,D.jsx)(w.Ay,{glyph:w.Ay.GLYPHS.add,className:"tjs-cesium-ion-connector__add-asset-button"})})}),(0,D.jsx)("td",{children:e.name}),(0,D.jsx)("td",{children:e.type})]},e.id)}function Q(e,t,r){const o=i.terria.configParameters.cesiumIonAllowSharingAddedAssets?H:{token:G,name:"".concat(W.username,"'s login token"),uniqueName:"".concat(W.username,"'s login token")};if(!o)return;const n=function(e,t,r){var i,o,n,a,s;let l="";const c={};switch(t.type){case"3DTILES":l="3d-tiles";break;case"GLTF":l="gltf",c.origin={longitude:0,latitude:0,height:0};break;case"IMAGERY":l="ion-imagery";break;case"TERRAIN":l="cesium-terrain";break;case"CZML":l="czml";break;case"KML":l="kml";break;case"GEOJSON":l="geojson"}return""===l?void 0:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){E(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({name:null!==(i=t.name)&&void 0!==i?i:"Unnamed",type:l,shareable:null!==(o=e.configParameters.cesiumIonAllowSharingAddedAssets)&&void 0!==o&&o,description:null!==(n=t.description)&&void 0!==n?n:"",ionAssetId:null!==(a=t.id)&&void 0!==a?a:0,ionAccessToken:r.token,info:[{name:"Cesium ion Account",content:W.username},{name:"Cesium ion Token",content:null!==(s=r.name)&&void 0!==s?s:r.id}]},c)}(e,t,o);if(!n)return;const a=(0,f.A)(g.A,i.terria,"",e.configParameters.cesiumIonAllowSharingAddedAssets?y.A.user:y.A.definition,n,{}).throwIfUndefined({message:"An error occurred trying to add asset: ".concat(t.name)}),s=r.shiftKey||r.ctrlKey;(0,b.A)(i.terria,Promise.resolve(a)).then(e=>{e&&T.A.is(e)&&i.terria.timelineStack.addToTop(e),s||i.closeCatalog()})}});var R=r(51980),M=r(69503),F=r(70466),L=r(99651),G=r(41006),U=r(24378),W=r(93657),q=r(15876),B=r(76970),V=r(89697),H=r(43104),$=r(47442),J=r(2520),X=r(9193),K=r(13568);r(94490);var Z=r(16943),Q=r(85878);var Y,ee,te,re,ie;function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach(function(t){ae(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ae(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let le=(Y=i.XI.bound,ee=i.XI.bound,(0,a.PA)((re=class extends n.Component{constructor(e){var t;super(e),(t=ie)&&Object.defineProperty(this,"sourceItems",{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(this):void 0}),(0,i.Gn)(this)}expandButton(){this.expandItem(this.sourceItems.length-1)}expandDropdown(e,t){this.expandItem(t)}expandItem(e){const t=this.props.terria;(0,i.h5)(async()=>{const r=this.sourceItems,i=r[e],o=t.workbench;if(i){r.forEach(e=>{o.items.forEach(t=>{e.uniqueId===t.uniqueId&&o.remove(t)})});try{t.addModel(i)}catch(e){}(await o.add(i)).raiseError(t,void 0,!0)}})}resolveSourceItems(){Promise.all(this.props.sourceItems.map(e=>Promise.resolve(e))).then((0,i.XI)(e=>{this.sourceItems=(0,q.A)(e)}))}componentDidMount(){this.resolveSourceItems()}componentDidUpdate(e){this.props.sourceItems!==e.sourceItems&&this.resolveSourceItems()}render(){if(0===this.sourceItems.length)return null;const e=(0,q.A)(this.props.downloads||this.sourceItems.map(e=>(0,$.A)(e,Q.A,"url")?e.url:void 0)),{sourceNames:t,canDownload:r,raiseToTitle:i,t:o}=this.props;if(t&&t.length>0){const n=this.props.downloadNames||t;return(0,D.jsx)(ce,{sourceNames:t,canDownload:r,downloads:n.map((t,r)=>({name:t,href:e[r]})),onExpand:this.expandDropdown,raiseToTitle:i,t:o})}return(0,D.jsx)(ue,{onExpand:this.expandButton,downloadUrl:r&&e.length>0?e[0]:void 0,t:o})}},ie=se(re.prototype,"sourceItems",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),se(re.prototype,"expandButton",[Y],Object.getOwnPropertyDescriptor(re.prototype,"expandButton"),re.prototype),se(re.prototype,"expandDropdown",[ee],Object.getOwnPropertyDescriptor(re.prototype,"expandDropdown"),re.prototype),te=re))||te);const ce=function(e){const t={dropdown:"tjs-chart-expand-and-download-buttons__dropdown",list:"tjs-chart-expand-and-download-buttons__dropdown__list",button:"tjs-chart-expand-and-download-buttons__dropdown__btn tjs-_buttons__btn--small",btnOption:"tjs-chart-expand-and-download-buttons__dropdown__btn--option"},r=ne(ne({},t),{},{button:S()("tjs-chart-expand-and-download-buttons__btn-small tjs-_buttons__btn--small","tjs-chart-expand-and-download-buttons__btn-download tjs-_buttons__btn")});return(0,D.jsxs)(pe,{raiseToTitle:e.raiseToTitle,children:[(0,D.jsx)(v.A,{selectOption:e.onExpand,options:e.sourceNames.map(e=>({name:e})),theme:t,children:e.t("chart.expand")+" â–¾"}),e.canDownload&&(0,D.jsx)(v.A,{options:e.downloads,theme:r,children:e.t("chart.download")+" â–¾"})]})},ue=function(e){const t=(0,O.DP)();return(0,D.jsxs)(pe,{children:[(0,D.jsx)(de,{type:"button",onClick:e.onExpand,children:e.t("chart.expand")}),e.downloadUrl&&(0,D.jsx)(he,{download:!0,href:e.downloadUrl,children:(0,D.jsx)(w.vE,{fillColor:t.textLight,glyph:w.Ay.GLYPHS.download})})]})},pe=O.Ay.div.withConfig({displayName:"ChartExpandAndDownloadButtons__ExpandAndDownloadContainer",componentId:"sc-1voa47t-0"})(["display:flex;flex-direction:row;justify-content:flex-end;",""],e=>e.raiseToTitle&&"margin-top: -21px;"),de=(0,O.Ay)(x.$n).attrs({primary:!0}).withConfig({displayName:"ChartExpandAndDownloadButtons__ButtonChartExpand",componentId:"sc-1voa47t-1"})(["border-radius:3px;padding:1px 8px;min-height:unset;margin-right:5px;"]),he=(0,O.Ay)(x.OV).attrs(()=>({as:"a",primary:!0})).withConfig({displayName:"ChartExpandAndDownloadButtons__DownloadLink",componentId:"sc-1voa47t-2"})(["text-decoration:none;border-radius:2px;padding:1px 8px;min-height:unset;svg{height:20px;width:20px;}"]),me=(0,Z.C)()(le);r(26910);var fe=r(40767),ge=r(89065),ye=r(33434),be=r(34604);function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ve.apply(this,arguments)}var we=[],Ae={width:0,height:0,top:0,left:0},Se=r(26856),xe=r(17979),Oe=r(22397),Pe=r(99773),Te=r(15226);function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach(function(t){Ce(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ce(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ee={top:5,left:5,right:5,bottom:5},_e=(0,a.PA)(e=>{var t;const[r,i]=(0,n.useState)(!1),{t:o}=(0,u.B)(),a=(c=void 0===(l=(s={}).initialSize)?Ae:l,d=void 0===(p=s.debounceTime)?300:p,m=void 0===(h=s.ignoreDimensions)?we:h,g=void 0===(f=s.enableDebounceLeadingCall)||f,y=s.resizeObserverPolyfill,b=(0,n.useRef)(null),v=(0,n.useRef)(0),A=(w=(0,n.useState)(ve({},Ae,c)))[0],S=w[1],x=(0,n.useMemo)(function(){var e=Array.isArray(m)?m:[m];return(0,be.A)(function(t){S(function(r){return Object.keys(r).filter(function(e){return r[e]!==t[e]}).every(function(t){return e.includes(t)})?r:t})},d,{leading:g})},[d,g,m]),(0,n.useEffect)(function(){var e=new(y||window.ResizeObserver)(function(e){e.forEach(function(e){var t,r=null!=(t=null==e?void 0:e.contentRect)?t:{},i=r.left,o=r.top,n=r.width,a=r.height;v.current=window.requestAnimationFrame(function(){x({width:n,height:a,top:o,left:i})})})});return b.current&&e.observe(b.current),function(){window.cancelAnimationFrame(v.current),e.disconnect(),x.cancel()}},[x,y]),ve({parentRef:b,resize:x},A));var s,l,c,p,d,h,m,f,g,y,b,v,w,A,S,x;const O=e.width||Math.max(a.width,300)||0,P=e.height||Math.max(a.height,200)||0,T=e.item;let I=e.yColumn?T.chartItems.find(t=>t.id===e.yColumn):T.chartItems.find(je);I=I&&je(I)?I:void 0;const C=!Oe.Ay.isMixedInto(T),E=!I&&Pe.Ay.isMixedInto(T)&&T.isLoadingMapItems,_=!I||0===I.points.length,j=C?"chart.noData":E?"chart.loading":r||_?"chart.noData":void 0,z=void 0===j,N=De(De({},Ee),e.margin),k=null!==(t=e.baseColor)&&void 0!==t?t:"#efefef";return(0,n.useEffect)(()=>{Pe.Ay.isMixedInto(T)?T.loadMapItems().then(e=>{i(void 0!==e.error),e.logError()}):i(!1)},[T]),(0,D.jsxs)("div",{className:"tjs-chart-preview__preview-chart",ref:a.parentRef,children:[!z&&(0,D.jsx)(Ne,{width:O,height:P,children:o(j)}),z&&I&&(0,D.jsx)(ze,{width:O,height:P,margin:N,chartItem:I,baseColor:k,xAxisLabel:e.xAxisLabel})]})}),je=e=>"line"===e.type||"lineAndPoint"===e.type,ze=(0,a.PA)(e=>{let{width:t,height:r,margin:i,chartItem:o,baseColor:a,xAxisLabel:s}=e;const l=(0,n.useMemo)(()=>({width:t-i.left-i.right,height:r-i.top-i.bottom-30}),[t,r,i]),c=(0,n.useMemo)(()=>{const e={domain:o.domain.x,range:[i.left+10,l.width]},t={domain:o.domain.y,range:[l.height,0]};return{x:"linear"===o.xAxis.scale?(0,Se.A)(e):(0,xe.A)(e),y:(0,Se.A)(t)}},[o.domain.x,o.domain.y,o.xAxis.scale,i.left,l.height,l.width]),u={fill:a,fontSize:10,textAnchor:"middle",fontFamily:"Arial"},p=null!=s?s:ke({xName:o.xAxis.name,xUnits:o.xAxis.units,yName:o.name,yUnits:o.units});return(0,n.useEffect)(()=>{o.points=o.points.sort((e,t)=>c.x(e.x)-c.x(t.x))}),(0,D.jsx)("svg",{width:t,height:r,children:(0,D.jsxs)(ye.A,{top:i.top,left:i.left,children:[(0,D.jsx)(fe.A,{top:l.height,scale:c.x.nice(),numTicks:4,stroke:"#a0a0a0",tickStroke:"#a0a0a0",tickLabelProps:(e,t,r)=>{const i=0===t?"start":t===r.length-1?"end":"middle";return De(De({},u),{},{textAnchor:i})},label:p,labelOffset:3,labelProps:{fill:a,fontSize:10,textAnchor:"middle",fontFamily:"Arial"}}),(0,D.jsx)(ge.A,{scale:c.y,numTicks:4,stroke:"none",tickStroke:"none",tickLabelProps:()=>De(De({},u),{},{textAnchor:"start",dx:"1em",dy:"0"})}),(0,D.jsx)(Te.A,{id:"featureInfoPanelChart-".concat(o.name),chartItem:o,scales:c,color:a})]})})});ze.displayName="Chart";const Ne=O.Ay.div.withConfig({displayName:"FeatureInfoPanelChart__ChartStatusText",componentId:"sc-dg2zcr-0"})(["display:flex;align-items:center;justify-content:center;width:","px;height:","px;"],e=>e.width,e=>e.height),ke=e=>"".concat(Re(e.yName,e.yUnits)," x ").concat(Re(e.xName,e.xUnits)),Re=(e,t)=>t?"".concat(e," (").concat(t,")"):e,Me=_e;var Fe=r(31624);function Le(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ge=["src","src-preview","sources","source-names","downloads","download-names","preview-x-label","data","identifier","x-column","y-column","y-columns","column-titles","column-units","styling","highlight-x","title","can-download","hide-buttons"];class Ue extends Fe.A{constructor(){super(...arguments),Le(this,"chartItemId",void 0),Le(this,"constructShareableCatalogItem",void 0),Le(this,"constructDownloadUrlFromBody",void 0),Le(this,"setTraitsFromBody",void 0)}get attributes(){return Ge}shouldProcessNode(e,t){return this.isChart(t)||this.isFirstColumnOfChartRow(t)||this.isSecondColumnOfChartRow(t)}processNode(e,t,r,i){if(this.isChart(t))return this.processChart(e,t,r,i);if(this.isFirstColumnOfChartRow(t))return this.processFirstColumn(e,t,r,i);if(this.isSecondColumnOfChartRow(t))return this.processSecondColumn(e,t,r,i);throw new L.A("processNode called unexpectedly.")}isChart(e){return e.name===this.name}processChart(e,t,r,o){var a;if(void 0===t.attribs||!e.terria||!e.feature||!e.catalogItem)return;!function(e,t){for(const r in e)Object.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&console.log("Unknown attribute "+r)}(t.attribs,this.attributes);const s=function(e){var t;const r=null==e||null===(t=e.position)||void 0===t?void 0:t.getValue(U.A.now());if(r){const e=G.A.WGS84.cartesianToCartographic(r);return{longitude:W.A.toDegrees(e.longitude),latitude:W.A.toDegrees(e.latitude)}}}(e.feature),l=this.parseNodeAttrs(t.attribs),c=r[0],u="string"==typeof c?c:void 0,p=[];var d;if(this.chartItemId=null!==(a=this.chartItemId)&&void 0!==a?a:(0,F.A)(),void 0===l.downloads&&u&&void 0!==this.constructDownloadUrlFromBody&&(l.downloads=[null===(d=this.constructDownloadUrlFromBody)||void 0===d?void 0:d.call(this,u)]),!l.hideButtons){const r=(l.downloads||l.sources||[""]).map((t,r)=>{const o="".concat(e.catalogItem.uniqueId,":").concat(l.title,":").concat(t),n=this.constructShareableCatalogItem?this.constructShareableCatalogItem(o,e,void 0):this.constructCatalogItem(o,e,void 0);return Promise.resolve(n).then((0,i.XI)(t=>{var i;t&&(this.setTraitsFromParent(t,e.catalogItem),this.setTraitsFromAttrs(t,l,r),u&&(null===(i=this.setTraitsFromBody)||void 0===i||i.call(this,t,u)),s&&(0,$.A)(t,J.A,"chartPointOnMap")&&t.setTrait(y.A.user,"chartPointOnMap",(0,H.A)(K.A,s)));return t}))});p.push((0,n.createElement)(me,{key:"button",terria:e.terria,sourceItems:r,sourceNames:l.sourceNames,canDownload:!0===l.canDownload,downloads:l.downloads,downloadNames:l.downloadNames,raiseToTitle:!!Be(t)}))}const h=this.constructCatalogItem(this.chartItemId,e,void 0);var m;return h&&((0,i.h5)(()=>{var t;this.setTraitsFromParent(h,e.catalogItem),this.setTraitsFromAttrs(h,l,0),u&&(null===(t=this.setTraitsFromBody)||void 0===t||t.call(this,h,u))}),p.push((0,n.createElement)(Me,{key:"chart",item:h,xAxisLabel:l.previewXLabel,yColumn:null===(m=l.yColumns)||void 0===m?void 0:m[0],height:110}))),(0,n.createElement)("div",{key:"chart-wrapper",className:"tjs-chart-preview__preview-chart-wrapper"},p)}setTraitsFromParent(e,t){(0,$.A)(e,X.A,"chartDisclaimer")&&(0,$.A)(t,X.A,"chartDisclaimer")&&void 0!==t.chartDisclaimer&&e.setTrait(y.A.user,"chartDisclaimer",t.chartDisclaimer)}isFirstColumnOfChartRow(e){return"td"===e.name&&void 0!==e.children&&1===e.children.length&&void 0!==e.parent&&"tr"===e.parent.name&&void 0!==e.parent.children&&2===e.parent.children.length&&e===e.parent.children[0]&&"td"===e.parent.children[1].name&&void 0!==e.parent.children[1].children&&1===e.parent.children[1].children.length&&"chart"===e.parent.children[1].children[0].name}processFirstColumn(e,t,r,i){}isSecondColumnOfChartRow(e){return"td"===e.name&&void 0!==e.children&&1===e.children.length&&"chart"===e.children[0].name&&void 0!==e.parent&&"tr"===e.parent.name&&void 0!==e.parent.children&&2===e.parent.children.length}processSecondColumn(e,t,r,i){const o=t.parent.children[0].children[0].data,a=[(0,n.createElement)("div",{key:"title",className:"tjs-chart-preview__chart-title-from-table"},o)].concat(r);return(0,n.createElement)("td",{key:"chart",colSpan:2,className:"tjs-chart-preview__chart-td"},t.data,a)}parseNodeAttrs(e){let t=We(e.sources);if(void 0===t&&void 0!==e.src){t=[e.src];const r=e["src-preview"];void 0!==r&&t.unshift(r)}const r=We(e["source-names"]),i=We(e.downloads)||t,o=We(e["download-names"])||r,n=(0,q.A)((e["column-titles"]||"").split(",").map(e=>{const[t,r]=qe(e,":");return t&&r?{name:t,title:r}:t})),a=(0,q.A)((e["column-units"]||"").split(",").map(e=>{const[t,r]=qe(e,":");return t&&r?{name:t,units:r}:t})),s=We(e["y-columns"]||e["y-column"]);return{title:e.title,identifier:e.identifier,hideButtons:"true"===e["hide-buttons"],sources:t,sourceNames:r,canDownload:!("false"===e["can-download"]),downloads:i,downloadNames:o,styling:e.styling||"feature-info",highlightX:e["highlight-x"],columnTitles:n,columnUnits:a,xColumn:e["x-column"],previewXLabel:e["preview-x-label"],yColumns:s}}async createItemReference(e){const t=e.terria,r=new V.A((0,F.A)(),t);if(r.setTrait(y.A.user,"splitSourceItemId",e.uniqueId),(await r.loadReference()).raiseError(t,"Failed to create SplitItemReference for ".concat((0,B.m)(e))),r.target)return t.addModel(r),r.target}}function We(e){return void 0!==e?e.split(","):void 0}function qe(e,t){const r=e.split(t);return 1===r.length?r:[r.slice(0,r.length-1).join(t),r[r.length-1]]}function Be(e){if(void 0!==e.parent&&"td"===e.parent.name&&void 0!==e.parent.parent&&"tr"===e.parent.parent.name&&void 0!==e.parent.parent.children&&void 0!==e.parent.parent.children[0]&&void 0!==e.parent.parent.children[0].children&&void 0!==e.parent.parent.children[0].children[0])return e.parent.parent.children[0].children[0].data}class Ve extends Ue{get name(){return"api-chart"}get attributes(){return["api-table-catalog-item-json"]}constructCatalogItem(e,t,r){var i;const o=t.terria,n=e?null===(i=t.terria)||void 0===i?void 0:i.getModelById(R.R,e):void 0;return o&&void 0===n?new R.R(e,o):n}setTraitsFromAttrs(e,t,r){const i=t.apiTableCatalogItemJson;void 0!==i&&(i.id=e.uniqueId,(0,M.A)(e,y.A.definition,i,!0).logError("Error ocurred while updating ApiTableChartCustomComponent model from JSON"))}parseNodeAttrs(e){const t=super.parseNodeAttrs(e),r=e["api-table-catalog-item-json"];if(void 0===r)return t;try{t.apiTableCatalogItemJson=JSON.parse(r)}catch(e){console.error("Couldn't parse json for ApiTableChartCustomComponent")}return t}}var He=r(9179);class $e extends Fe.A{get name(){return"collapsible"}get attributes(){return["title","open","rightbtn","btnstyle"]}processNode(e,t,r){var i,o;const a=t.attribs&&t.attribs.title?t.attribs.title:"Collapsible",s=!!t.attribs&&Boolean(t.attribs.open),l=Boolean(null===(i=t.attribs)||void 0===i?void 0:i.rightbtn),c=null===(o=t.attribs)||void 0===o?void 0:o.btnstyle;return(0,n.createElement)(He.A,{key:a,title:a,isOpen:s,btnRight:l,btnStyle:"plus"===c?"plus":void 0},r)}}r(3296),r(27208),r(48408);var Je=r(81526);function Xe(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ke=["line","lineAndPoint"];class Ze extends Ue{constructor(){super(...arguments),Xe(this,"setTraitsFromBody",(e,t)=>{e.setTrait(y.A.user,"csvString",t)}),Xe(this,"constructDownloadUrlFromBody",e=>{const t=new Blob([e],{type:"text/csv;charset=utf-8"});return URL.createObjectURL(t)})}get name(){return"chart"}get attributes(){return super.attributes.concat(["poll-seconds","poll-sources","poll-replace","chart-disclaimer","chart-type","chart-glyph-style"])}constructCatalogItem(e,t,r){return t.terria?new Je.A(e,t.terria,r):void 0}setTraitsFromAttrs(e,t,r){e.setTrait(y.A.user,"url",t.sources&&t.sources[r]);let i=t.title;if(t.sourceNames&&t.sourceNames[r]&&(i="".concat(i," - ").concat(t.sourceNames[r])),e.setTrait(y.A.user,"name",i),t.pollSeconds){const i=t.pollSources&&t.pollSources[r];e.polling.setTrait(y.A.user,"seconds",t.pollSeconds),e.polling.setTrait(y.A.user,"url",i),e.polling.setTrait(y.A.user,"shouldReplaceData",t.pollReplace)}t.chartDisclaimer&&e.setTrait(y.A.user,"chartDisclaimer",t.chartDisclaimer),void 0!==t.columnTitles&&t.columnTitles.forEach((t,r)=>{if("string"==typeof t){const i=e.columnTitles.slice();i[r]=t,e.setTrait(y.A.user,"columnTitles",i)}else{const{name:r,title:i}=t;e.addObject(y.A.user,"columns",r).setTrait(y.A.user,"title",i)}}),void 0!==t.columnUnits&&t.columnUnits.forEach((t,r)=>{if("string"==typeof t){const i=e.columnUnits.slice();i[r]=t,e.setTrait(y.A.user,"columnUnits",i)}else{const{name:r,units:i}=t;e.addObject(y.A.user,"columns",r).setTrait(y.A.user,"units",i)}});const o=e.addObject(y.A.user,"styles","chart");void 0!==t.chartType&&Ke.some(e=>e===t.chartType)&&e.setTrait(y.A.user,"chartType",t.chartType),void 0!==t.chartGlyphStyle&&e.setTrait(y.A.user,"chartGlyphStyle",t.chartGlyphStyle),(t.xColumn||t.yColumns)&&(o.chart.setTrait(y.A.user,"xAxisColumn",t.xColumn),(t.yColumns||[]).forEach(e=>{o.chart.addObject(y.A.user,"lines",e).setTrait(y.A.user,"isSelectedInWorkbench",!0)}),e.setTrait(y.A.user,"activeStyle","chart"))}parseNodeAttrs(e){const t=super.parseNodeAttrs(e);return t.pollSeconds=function(e){const t=parseInt(e||"",10);return isNaN(t)?void 0:t}(e["poll-seconds"]),t.pollSources=We(e["poll-sources"]),t.pollReplace="true"===e["poll-replace"],t.chartDisclaimer=e["chart-disclaimer"]||void 0,t.chartType=e["chart-type"],t.chartGlyphStyle=e["chart-glyph-style"],t}}var Qe=r(80811);class Ye extends Ue{constructor(){var e,t,r;super(...arguments),e=this,r=async(e,t,r)=>this.createItemReference(t.catalogItem),(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="constructShareableCatalogItem"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}get name(){return"sos-chart"}get attributes(){const e=super.attributes;return e.push("name"),e}constructCatalogItem(e,t,r){var i;return null===(i=t.catalogItem)||void 0===i?void 0:i.duplicateModel((0,F.A)())}setTraitsFromAttrs(e,t,r){var i,o;const n=t.identifier,a=t.name,s=null===(i=e.selectedObservable)||void 0===i?void 0:i.units;e.setTrait(y.A.user,"showAsChart",!0),e.setTrait(y.A.user,"name",a||e.name),e.setTrait(y.A.user,"chartFeatureOfInterestIdentifier",n),null===(o=e.addObject(y.A.user,"columns","values"))||void 0===o||o.setTrait(y.A.user,"units",s)}parseNodeAttrs(e){const t=super.parseNodeAttrs(e);return t.name=e.name,t}}var et,tt,rt,it=r(40961),ot=r(99747),nt=r(59895),at=r(42007);const st=["launcherComponent","children","dismissOnLeave","orientation"];function lt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach(function(t){pt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function pt(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class dt extends n.Component{constructor(){var e;super(...arguments),e=this,pt(this,"rootRef",(0,n.createRef)()),pt(this,"tooltipTextElementRef",(0,n.createRef)()),pt(this,"state",{offset:0,open:!!this.props.startOpen}),pt(this,"dismiss",()=>{this.props.onDismiss&&this.props.onDismiss(),this.setState({open:!1})}),pt(this,"getTooltipCoords",()=>{const e=this.tooltipTextElementRef.current;if(!e)return{x:0,y:0};const{x:t,y:r,width:i,height:o}=e.getBoundingClientRect(),n=document.documentElement.clientWidth-i,a=document.documentElement.clientHeight-o;return{x:t<10?10:t>n?n-10:t,y:r<10?10:r>a?a-10:r}}),pt(this,"forceSetState",function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.setState({open:t})})}componentDidMount(){this.props.disableEventListeners||(document.addEventListener("mousedown",this.dismiss),document.addEventListener("touchstart",this.dismiss)),this.adjustOffset()}componentDidUpdate(){this.adjustOffset()}componentWillUnmount(){this.props.disableEventListeners||(document.removeEventListener("mousedown",this.dismiss),document.removeEventListener("touchstart",this.dismiss))}adjustOffset(){const e=this.tooltipTextElementRef.current,t=this.rootRef.current,r=null==t?void 0:t.firstChild;if(!r||!e)return;const i=r.currentStyle||window.getComputedStyle(r),o=(e.offsetWidth+parseFloat(i.marginLeft)+parseFloat(i.marginRight)-parseFloat(i.paddingRight)-parseFloat(i.paddingLeft))/2;Math.abs(this.state.offset-o)>5&&this.setState({offset:o})}render(){const{orientation:e,theme:t,innerElementStyles:r}=this.props,i="below"===e,o="above"===e||void 0===e;return(0,D.jsxs)(ft,{ref:this.rootRef,children:[this.props.launcher&&this.props.launcher({state:this.state,launch:()=>this.forceSetState(!0),forceSetState:this.forceSetState}),this.state.open&&it.createPortal((0,D.jsx)(gt,{paddedRatio:3,position:"absolute",rounded:!0,style:ut({},r),$_css:t.frontComponentZIndex+999999+2,$_css2:t.textDark,$_css3:t.textLight,$_css4:this.getTooltipCoords().y,$_css5:this.getTooltipCoords().x,children:this.props.children(!0,this.dismiss)}),document.body),(0,D.jsx)(yt,{paddedRatio:3,position:"absolute",ref:this.tooltipTextElementRef,style:ut({marginLeft:"-"+this.state.offset+"px"},r),$_css6:o&&"bottom: calc(100% + 10px);",$_css7:i&&"top: calc(100% + 10px);",children:this.props.children(!1,this.dismiss)})]})}}const ht=(0,O.SL)(dt),mt=e=>{const{launcherComponent:t,children:r,dismissOnLeave:i,orientation:o}=e,n=function(e,t){if(null==e)return{};var r,i,o=function(e,t){if(null==e)return{};var r={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;r[i]=e[i]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)r=n[i],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,st),a="ButtonLauncher-".concat((0,ot.G)()),s="ButtonLauncher-child-".concat((0,ot.G)());return(0,D.jsx)(ht,ut(ut({innerElementStyles:{width:"350px"},orientation:o||"below"},n),{},{disableEventListeners:!0,launcher:e=>{const r=()=>{e.state.open&&e.forceSetState(!1)},o=i?{onMouseLeave:()=>r(),onBlur:()=>r()}:{};return(0,D.jsx)(bt,ut(ut({"aria-expanded":e.state.open,"aria-describedby":"".concat(a," ").concat(s),onClick:()=>e.forceSetState(!e.state.open),onFocus:e.launch,onMouseOver:()=>{e.state.open||e.launch()}},o),{},{$_css8:"text-decoration: underline dashed;",children:t()}))},children:e=>(0,D.jsx)(at.yF,{large:!0,semiBold:!0,id:e&&a||void 0,children:r(e&&s||"")})}))};var ft=(0,O.Ay)("span")(et||(et=lt(["\n          position: relative;\n          display: inline-block;\n        "]))),gt=(0,O.Ay)(nt.QA)(tt||(tt=lt(["\n                // TODO: find offending z-index - likely still in scss\n                z-index: ",";\n                background-color: ",";\n                color: ",";\n                text-align: left;\n                top: ","px;\n                left: ","px;\n              "])),e=>e.$_css,e=>e.$_css2,e=>e.$_css3,e=>e.$_css4,e=>e.$_css5),yt=(0,O.Ay)(nt.QA)(rt||(rt=lt(["\n            visibility: hidden;\n            left: 50%;\n\n            ","\n            ","\n          "])),e=>e.$_css6,e=>e.$_css7),bt=(0,O.Ay)(x.Rg).withConfig({displayName:"TooltipWrapper___StyledRawButton",componentId:"sc-10qgwlf-0"})(["",""],e=>e.$_css8);class vt extends Fe.A{get name(){return"terriatooltip"}get attributes(){return["title"]}processNode(e,t,r){return(0,n.createElement)(mt,{dismissOnLeave:!0,launcherComponent:()=>{var e;return null===(e=t.attribs)||void 0===e?void 0:e.title},children:()=>r})}}function wt(e){Fe.A.register(new Ze),Fe.A.register(new Ye),Fe.A.register(new Ve),Fe.A.register(new $e),Fe.A.register(new Qe.h),Fe.A.register(new vt),e&&(0,i.z7)(()=>void 0!==e.configParameters.cesiumIonOAuth2ApplicationID,()=>{(0,o.EU)("cesium-ion",{value:"cesium-ion",name:"core.dataType.cesium-ion",customComponent:k})})}},79399:(e,t,r)=>{var i=function(){"use strict";var e,t=/\s*/g,i=/^\s*|\s*$/g,o=/\s+/;function n(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function a(e,t){return e.getElementsByTagName(t)}function s(e,t){return e.getAttribute(t)}function l(e,t){return parseFloat(s(e,t))}function c(e,t){var r=a(e,t);return r.length?r[0]:null}function u(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function p(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function d(e,t){var r,i,o={};for(i=0;i<t.length;i++)(r=c(e,t[i]))&&(o[t[i]]=p(r));return o}function h(e,t){for(var r in t)e[r]=t[r]}function m(e){return u(e.replace(t,"").split(","))}function f(e){for(var t=e.replace(i,"").split(o),r=[],n=0;n<t.length;n++)r.push(m(t[n]));return r}function g(e){var t,r=[l(e,"lon"),l(e,"lat")],i=c(e,"ele"),o=c(e,"gpxtpx:hr")||c(e,"hr"),n=c(e,"time");return i&&(t=parseFloat(p(i)),isNaN(t)||r.push(t)),{coordinates:r,time:n?p(n):null,heartRate:o?parseFloat(p(o)):null}}if("undefined"!=typeof XMLSerializer)e=new XMLSerializer;else{var y="object"==typeof process&&!process.browser,b="object"==typeof Titanium;if(!y&&!b)throw new Error("Unable to initialize serializer");e=new(r(28978).e)}function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},i={},o={},l=["Polygon","LineString","Point","Track","gx:Track"],d=a(e,"Placemark"),h=a(e,"Style"),g=a(e,"StyleMap"),y=0;y<h.length;y++){var b=n(v(h[y])).toString(16);r["#"+s(h[y],"id")]=b,i[b]=h[y]}for(var w=0;w<g.length;w++){r["#"+s(g[w],"id")]=n(v(g[w])).toString(16);for(var A=a(g[w],"Pair"),S={},x=0;x<A.length;x++)S[p(c(A[x],"key"))]=p(c(A[x],"styleUrl"));o["#"+s(g[w],"id")]=S}for(var O=0;O<d.length;O++)t.features=t.features.concat(C(d[O]));function P(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function T(e){return u(e.split(" "))}function I(e){var t=a(e,"coord"),r=[],i=[];0===t.length&&(t=a(e,"gx:coord"));for(var o=0;o<t.length;o++)r.push(T(p(t[o])));for(var n=a(e,"when"),s=0;s<n.length;s++)i.push(p(n[s]));return{coords:r,times:i}}function D(e){var t,r,i,o,n,s=[],u=[];if(c(e,"MultiGeometry"))return D(c(e,"MultiGeometry"));if(c(e,"MultiTrack"))return D(c(e,"MultiTrack"));if(c(e,"gx:MultiTrack"))return D(c(e,"gx:MultiTrack"));for(i=0;i<l.length;i++)if(r=a(e,l[i]))for(o=0;o<r.length;o++)if(t=r[o],"Point"===l[i])s.push({type:"Point",coordinates:m(p(c(t,"coordinates")))});else if("LineString"===l[i])s.push({type:"LineString",coordinates:f(p(c(t,"coordinates")))});else if("Polygon"===l[i]){var d=a(t,"LinearRing"),h=[];for(n=0;n<d.length;n++)h.push(f(p(c(d[n],"coordinates"))));s.push({type:"Polygon",coordinates:h})}else if("Track"===l[i]||"gx:Track"===l[i]){var g=I(t);s.push({type:"LineString",coordinates:g.coords}),g.times.length&&u.push(g.times)}return{geoms:s,coordTimes:u}}function C(e){var t,n=D(e),l={},u=p(c(e,"name")),d=p(c(e,"address")),h=p(c(e,"styleUrl")),m=p(c(e,"description")),f=c(e,"TimeSpan"),g=c(e,"TimeStamp"),y=c(e,"ExtendedData"),b=c(e,"LineStyle"),v=c(e,"PolyStyle"),w=c(e,"visibility");if(!n.geoms.length)return[];if(u&&(l.name=u),d&&(l.address=d),h){"#"!==h[0]&&(h="#"+h),l.styleUrl=h,r[h]&&(l.styleHash=r[h]),o[h]&&(l.styleMapHash=o[h],l.styleHash=r[o[h].normal]);var A=i[l.styleHash];if(A){b||(b=c(A,"LineStyle")),v||(v=c(A,"PolyStyle"));var S=c(A,"IconStyle");if(S){var x=c(S,"Icon");if(x){var O=p(c(x,"href"));O&&(l.icon=O)}}}}if(m&&(l.description=m),f){var T=p(c(f,"begin")),I=p(c(f,"end"));l.timespan={begin:T,end:I}}if(g&&(l.timestamp=p(c(g,"when"))),b){var C=P(p(c(b,"color"))),E=C[0],_=C[1],j=parseFloat(p(c(b,"width")));E&&(l.stroke=E),isNaN(_)||(l["stroke-opacity"]=_),isNaN(j)||(l["stroke-width"]=j)}if(v){var z=P(p(c(v,"color"))),N=z[0],k=z[1],R=p(c(v,"fill")),M=p(c(v,"outline"));N&&(l.fill=N),isNaN(k)||(l["fill-opacity"]=k),R&&(l["fill-opacity"]="1"===R?l["fill-opacity"]||1:0),M&&(l["stroke-opacity"]="1"===M?l["stroke-opacity"]||1:0)}if(y){var F=a(y,"Data"),L=a(y,"SimpleData");for(t=0;t<F.length;t++)l[F[t].getAttribute("name")]=p(c(F[t],"value"));for(t=0;t<L.length;t++)l[L[t].getAttribute("name")]=p(L[t])}w&&(l.visibility=p(w)),n.coordTimes.length&&(l.coordTimes=1===n.coordTimes.length?n.coordTimes[0]:n.coordTimes);var G={type:"Feature",geometry:1===n.geoms.length?n.geoms[0]:{type:"GeometryCollection",geometries:n.geoms},properties:l};return s(e,"id")&&(G.id=s(e,"id")),[G]}return t},gpx:function(e){var t,r,i=a(e,"trk"),o=a(e,"rte"),n=a(e,"wpt"),l={type:"FeatureCollection",features:[]};for(t=0;t<i.length;t++)(r=f(i[t]))&&l.features.push(r);for(t=0;t<o.length;t++)(r=y(o[t]))&&l.features.push(r);for(t=0;t<n.length;t++)l.features.push(b(n[t]));function u(e,t){for(var r=0;r<t;r++)e.push(null);return e}function m(e,t){var r=a(e,t),i=[],o=[],n=[],s=r.length;if(s<2)return{};for(var l=0;l<s;l++){var c=g(r[l]);i.push(c.coordinates),c.time&&o.push(c.time),(c.heartRate||n.length)&&(n.length||u(n,l),n.push(c.heartRate||null))}return{line:i,times:o,heartRates:n}}function f(e){for(var t,r=a(e,"trkseg"),i=[],o=[],n=[],s=0;s<r.length;s++)if((t=m(r[s],"trkpt"))&&(t.line&&i.push(t.line),t.times&&t.times.length&&o.push(t.times),n.length||t.heartRates&&t.heartRates.length)){if(!n.length)for(var l=0;l<s;l++)n.push(u([],i[l].length));t.heartRates&&t.heartRates.length?n.push(t.heartRates):n.push(u([],t.line.length||0))}if(0!==i.length){var p=w(e);return h(p,v(c(e,"extensions"))),o.length&&(p.coordTimes=1===i.length?o[0]:o),n.length&&(p.heartRates=1===i.length?n[0]:n),{type:"Feature",properties:p,geometry:{type:1===i.length?"LineString":"MultiLineString",coordinates:1===i.length?i[0]:i}}}}function y(e){var t=m(e,"rtept");if(t.line){var r=w(e);return h(r,v(c(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function b(e){var t=w(e);return h(t,d(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function v(e){var t={};if(e){var r=c(e,"line");if(r){var i=p(c(r,"color")),o=parseFloat(p(c(r,"opacity"))),n=parseFloat(p(c(r,"width")));i&&(t.stroke=i),isNaN(o)||(t["stroke-opacity"]=o),isNaN(n)||(t["stroke-width"]=96*n/25.4)}}return t}function w(e){var t=d(e,["name","cmt","desc","type","time","keywords"]),r=a(e,"link");r.length&&(t.links=[]);for(var i,o=0;o<r.length;o++)h(i={href:s(r[o],"href")},d(r[o],["text","type"])),t.links.push(i);return t}return l}}}();e.exports=i},79483:(e,t,r)=>{"use strict";r.d(t,{A:()=>n}),r(27495);var i=r(59801),o=r(56870);const n=function(e,t){var r;t.addEventListener("message",async function(n){var a=n.origin;!(0,o.A)(a)&&(0,o.A)(n.originalEvent)&&(a=n.originalEvent.origin),((0,o.A)(r)&&a===r||n.source===t.parent||n.source===t.opener)&&(n.source!==t.opener&&n.source!==t.parent||!n.data.allowOrigin||(r=n.data.allowOrigin,delete n.data.allowOrigin),/^react-devtools/gi.test(n.data.source)||(await e.updateFromStartData(n.data,"Start data from message from parent window",i.FK.Error)).raiseError(e))},!1),t.parent!==t&&t.parent.postMessage("ready","*"),t.opener&&t.opener.postMessage("ready","*")}},81526:(e,t,r)=>{"use strict";r.d(t,{A:()=>$}),r(94490);var i,o,n,a,s,l,c,u,p,d,h,m,f,g,y,b,v,w,A=r(54156),S=r(27813),x=r(91273),O=r(59801),P=r(19193),T=r(97326),I=r(43670),D=r(92065),C=r(34502),E=(r(62953),r(16001)),_=r(71222),j=r(53389),z=r(39070),N=r(21610),k=r(88963),R=r(3236),M=r(85878);function F(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function L(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let G=(i=(0,_.A)({name:"Seconds",description:"Time in seconds to wait before polling for new data.",type:"number"}),o=(0,_.A)({name:"url",description:"The URL to poll for new data. If undefined, uses the catalog item `url` if there is one.",type:"string"}),n=(0,_.A)({name:"shouldReplaceData",description:"If true, the new data replaces the existing data, otherwise the new data will be appended to the old data.",type:"boolean"}),a=class extends z.A{constructor(){super(...arguments),F(this,"seconds",s,this),F(this,"url",l,this),F(this,"shouldReplaceData",c,this)}},s=L(a.prototype,"seconds",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=L(a.prototype,"url",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=L(a.prototype,"shouldReplaceData",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),a),U=(u=(0,N.b)({description:"Creates one catalog item from url that points to a CSV file that contains geospatial data.",example:{type:"csv",url:"https://tiles.terria.io/static/auspost-locations.csv",name:"Australia Post Locations",id:"some unique ID"}}),p=(0,_.A)({name:"Character Set",description:"The character set of the CSV data, overriding the information provided by the server, if any.",type:"string"}),d=(0,_.A)({name:"CSV Data",description:"The actual CSV data, represented as a string.",type:"string"}),h=(0,_.A)({name:"Ignore rows starting with comment",description:"Any rows of a CSV starting with '#' or '//' will be ignored. A value of `undefined` will be treated the same as `false`.",type:"boolean"}),m=(0,E.A)({name:"Polling",description:"Polling configuration",type:G}),u((g=class extends((0,j.A)(k.A,M.A,R.A)){constructor(){super(...arguments),F(this,"characterSet",y,this),F(this,"csvString",b,this),F(this,"ignoreRowsStartingWithComment",v,this),F(this,"polling",w,this)}},y=L(g.prototype,"characterSet",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=L(g.prototype,"csvString",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=L(g.prototype,"ignoreRowsStartingWithComment",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=L(g.prototype,"polling",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=g))||f);var W,q=r(90147),B=r(53163),V=r(33620);function H(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let $=(W=class e extends((0,P.A)((0,T.A)((0,I.A)((0,q.A)(U))))){static get type(){return"csv"}constructor(e,t,r){var i,o,n;super(e,t,r),i=this,n=void 0,(o=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(o="_csvFile"))in i?Object.defineProperty(i,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[o]=n,(0,S.Gn)(this),this.strata.set(C.A.stratumName,new C.A(this))}get type(){return e.type}setFileInput(e){this._csvFile=e}get hasLocalData(){return(0,x.A)(this._csvFile)}get _canExportData(){return(0,x.A)(this._csvFile)||(0,x.A)(this.csvString)||(0,x.A)(this.url)}get cacheDuration(){return super.cacheDuration||"1d"}async _exportData(){if((0,x.A)(this._csvFile))return{name:this.name||this.uniqueId,file:this._csvFile};if((0,x.A)(this.csvString))return{name:this.name||this.uniqueId,file:new Blob([this.csvString])};if((0,x.A)(this.url))return this.url;throw new O.Ay({sender:this,message:"No data available to download."})}get refreshUrl(){return this.polling.url||this.url}get refreshInterval(){if(this.refreshUrl)return this.polling.seconds}refreshData(){this.refreshUrl&&D.A.parseUrl((0,V.A)(this,this.refreshUrl),!0,this.ignoreRowsStartingWithComment).then(e=>{(0,S.h5)(()=>{this.polling.shouldReplaceData?this.dataColumnMajor=e:this.append(e)})})}forceLoadTableData(){return void 0!==this.csvString?D.A.parseString(this.csvString,!0,this.ignoreRowsStartingWithComment):void 0!==this._csvFile?D.A.parseFile(this._csvFile,!0,this.ignoreRowsStartingWithComment):void 0!==this.url?D.A.parseUrl((0,V.A)(this,this.url),!0,this.ignoreRowsStartingWithComment):Promise.reject(new O.Ay({sender:this,title:A.Ay.t("models.csv.unableToLoadItemTitle"),message:A.Ay.t("models.csv.unableToLoadItemMessage")}))}},H(W.prototype,"hasLocalData",[S.EW],Object.getOwnPropertyDescriptor(W.prototype,"hasLocalData"),W.prototype),H(W.prototype,"_canExportData",[S.$Z],Object.getOwnPropertyDescriptor(W.prototype,"_canExportData"),W.prototype),H(W.prototype,"cacheDuration",[S.$Z],Object.getOwnPropertyDescriptor(W.prototype,"cacheDuration"),W.prototype),H(W.prototype,"refreshUrl",[S.EW],Object.getOwnPropertyDescriptor(W.prototype,"refreshUrl"),W.prototype),H(W.prototype,"refreshInterval",[S.$Z],Object.getOwnPropertyDescriptor(W.prototype,"refreshInterval"),W.prototype),W);B.A.addLoadStratum(C.A.stratumName)},84722:(e,t,r)=>{var i=r(44582),o=i.find,n=i.NAMESPACE;function a(e){return""!==e}function s(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function l(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(a):[]}(e);return Object.keys(t.reduce(s,{}))}function c(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function u(e,t){var r=e.prototype;if(!(r instanceof t)){function i(){}i.prototype=t.prototype,c(r,i=new i),e.prototype=r=i}r.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),r.constructor=e)}var p={},d=p.ELEMENT_NODE=1,h=p.ATTRIBUTE_NODE=2,m=p.TEXT_NODE=3,f=p.CDATA_SECTION_NODE=4,g=p.ENTITY_REFERENCE_NODE=5,y=p.ENTITY_NODE=6,b=p.PROCESSING_INSTRUCTION_NODE=7,v=p.COMMENT_NODE=8,w=p.DOCUMENT_NODE=9,A=p.DOCUMENT_TYPE_NODE=10,S=p.DOCUMENT_FRAGMENT_NODE=11,x=p.NOTATION_NODE=12,O={},P={},T=(O.INDEX_SIZE_ERR=(P[1]="Index size error",1),O.DOMSTRING_SIZE_ERR=(P[2]="DOMString size error",2),O.HIERARCHY_REQUEST_ERR=(P[3]="Hierarchy request error",3)),I=(O.WRONG_DOCUMENT_ERR=(P[4]="Wrong document",4),O.INVALID_CHARACTER_ERR=(P[5]="Invalid character",5),O.NO_DATA_ALLOWED_ERR=(P[6]="No data allowed",6),O.NO_MODIFICATION_ALLOWED_ERR=(P[7]="No modification allowed",7),O.NOT_FOUND_ERR=(P[8]="Not found",8)),D=(O.NOT_SUPPORTED_ERR=(P[9]="Not supported",9),O.INUSE_ATTRIBUTE_ERR=(P[10]="Attribute in use",10));function C(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,P[e]),this.message=P[e],Error.captureStackTrace&&Error.captureStackTrace(this,C);return r.code=e,t&&(this.message=this.message+": "+t),r}function E(){}function _(e,t){this._node=e,this._refresh=t,j(this)}function j(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(ve(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var i=r.length;i in e;i++)Object.prototype.hasOwnProperty.call(e,i)&&delete e[i];c(r,e),e._inc=t}}function z(){}function N(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function k(e,t,r,i){if(i?t[N(t,i)]=r:t[t.length++]=r,e){r.ownerElement=e;var o=e.ownerDocument;o&&(i&&W(o,e,i),function(e,t,r){e&&e._inc++,r.namespaceURI===n.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}(o,e,r))}}function R(e,t,r){var i=N(t,r);if(!(i>=0))throw new C(I,new Error(e.tagName+"@"+r));for(var o=t.length-1;i<o;)t[i]=t[++i];if(t.length=o,e){var n=e.ownerDocument;n&&(W(n,e,r),r.ownerElement=null)}}function M(){}function F(){}function L(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function G(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(G(e,t))return!0}while(e=e.nextSibling)}function U(){this.ownerDocument=this}function W(e,t,r,i){e&&e._inc++,r.namespaceURI===n.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function q(e,t,r){if(e&&e._inc){e._inc++;var i=t.childNodes;if(r)i[i.length++]=r;else{for(var o=t.firstChild,n=0;o;)i[n++]=o,o=o.nextSibling;i.length=n,delete i[i.length]}}}function B(e,t){var r=t.previousSibling,i=t.nextSibling;return r?r.nextSibling=i:e.firstChild=i,i?i.previousSibling=r:e.lastChild=r,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,q(e.ownerDocument,e),t}function V(e){return e&&e.nodeType===F.DOCUMENT_TYPE_NODE}function H(e){return e&&e.nodeType===F.ELEMENT_NODE}function $(e){return e&&e.nodeType===F.TEXT_NODE}function J(e,t){var r=e.childNodes||[];if(o(r,H)||V(t))return!1;var i=o(r,V);return!(t&&i&&r.indexOf(i)>r.indexOf(t))}function X(e,t){var r=e.childNodes||[];if(o(r,function(e){return H(e)&&e!==t}))return!1;var i=o(r,V);return!(t&&i&&r.indexOf(i)>r.indexOf(t))}function K(e,t,r){var i=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===F.DOCUMENT_FRAGMENT_NODE){var a=n.filter(H);if(a.length>1||o(n,$))throw new C(T,"More than one element or text in fragment");if(1===a.length&&!J(e,r))throw new C(T,"Element in fragment can not be inserted before doctype")}if(H(t)&&!J(e,r))throw new C(T,"Only one element can be added and only after doctype");if(V(t)){if(o(i,V))throw new C(T,"Only one doctype is allowed");var s=o(i,H);if(r&&i.indexOf(s)<i.indexOf(r))throw new C(T,"Doctype can only be inserted before an element");if(!r&&s)throw new C(T,"Doctype can not be appended since element is present")}}function Z(e,t,r){var i=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===F.DOCUMENT_FRAGMENT_NODE){var a=n.filter(H);if(a.length>1||o(n,$))throw new C(T,"More than one element or text in fragment");if(1===a.length&&!X(e,r))throw new C(T,"Element in fragment can not be inserted before doctype")}if(H(t)&&!X(e,r))throw new C(T,"Only one element can be added and only after doctype");if(V(t)){if(o(i,function(e){return V(e)&&e!==r}))throw new C(T,"Only one doctype is allowed");var s=o(i,H);if(r&&i.indexOf(s)<i.indexOf(r))throw new C(T,"Doctype can only be inserted before an element")}}function Q(e,t,r,i){(function(e,t,r){if(!function(e){return e&&(e.nodeType===F.DOCUMENT_NODE||e.nodeType===F.DOCUMENT_FRAGMENT_NODE||e.nodeType===F.ELEMENT_NODE)}(e))throw new C(T,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new C(I,"child not in parent");if(!function(e){return e&&(H(e)||$(e)||V(e)||e.nodeType===F.DOCUMENT_FRAGMENT_NODE||e.nodeType===F.COMMENT_NODE||e.nodeType===F.PROCESSING_INSTRUCTION_NODE)}(t)||V(t)&&e.nodeType!==F.DOCUMENT_NODE)throw new C(T,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,r),e.nodeType===F.DOCUMENT_NODE&&(i||K)(e,t,r);var o=t.parentNode;if(o&&o.removeChild(t),t.nodeType===S){var n=t.firstChild;if(null==n)return t;var a=t.lastChild}else n=a=t;var s=r?r.previousSibling:e.lastChild;n.previousSibling=s,a.nextSibling=r,s?s.nextSibling=n:e.firstChild=n,null==r?e.lastChild=a:r.previousSibling=a;do{n.parentNode=e,Y(n,e.ownerDocument||e)}while(n!==a&&(n=n.nextSibling));return q(e.ownerDocument||e,e),t.nodeType==S&&(t.firstChild=t.lastChild=null),t}function Y(e,t){if(e.ownerDocument!==t){if(e.ownerDocument=t,e.nodeType===d&&e.attributes)for(var r=0;r<e.attributes.length;r++){var i=e.attributes.item(r);i&&(i.ownerDocument=t)}for(var o=e.firstChild;o;)Y(o,t),o=o.nextSibling}}function ee(){this._nsMap={}}function te(){}function re(){}function ie(){}function oe(){}function ne(){}function ae(){}function se(){}function le(){}function ce(){}function ue(){}function pe(){}function de(){}function he(e,t){var r=[],i=9==this.nodeType&&this.documentElement||this,o=i.prefix,n=i.namespaceURI;if(n&&null==o&&null==(o=i.lookupPrefix(n)))var a=[{namespace:n,prefix:null}];return ge(this,r,e,t,a),r.join("")}function me(e,t,r){var i=e.prefix||"",o=e.namespaceURI;if(!o)return!1;if("xml"===i&&o===n.XML||o===n.XMLNS)return!1;for(var a=r.length;a--;){var s=r[a];if(s.prefix===i)return s.namespace!==o}return!0}function fe(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,L),'"')}function ge(e,t,r,i,o){if(o||(o=[]),i){if(!(e=i(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case d:var a=e.attributes,s=a.length,l=e.firstChild,c=e.tagName,u=c;if(!(r=n.isHTML(e.namespaceURI)||r)&&!e.prefix&&e.namespaceURI){for(var p,y=0;y<a.length;y++)if("xmlns"===a.item(y).name){p=a.item(y).value;break}if(!p)for(var x=o.length-1;x>=0;x--)if(""===(O=o[x]).prefix&&O.namespace===e.namespaceURI){p=O.namespace;break}if(p!==e.namespaceURI)for(x=o.length-1;x>=0;x--){var O;if((O=o[x]).namespace===e.namespaceURI){O.prefix&&(u=O.prefix+":"+c);break}}}t.push("<",u);for(var P=0;P<s;P++)"xmlns"==(T=a.item(P)).prefix?o.push({prefix:T.localName,namespace:T.value}):"xmlns"==T.nodeName&&o.push({prefix:"",namespace:T.value});for(P=0;P<s;P++){var T,I,D;me(T=a.item(P),0,o)&&(fe(t,(I=T.prefix||"")?"xmlns:"+I:"xmlns",D=T.namespaceURI),o.push({prefix:I,namespace:D})),ge(T,t,r,i,o)}if(c===u&&me(e,0,o)&&(fe(t,(I=e.prefix||"")?"xmlns:"+I:"xmlns",D=e.namespaceURI),o.push({prefix:I,namespace:D})),l||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),r&&/^script$/i.test(c))for(;l;)l.data?t.push(l.data):ge(l,t,r,i,o.slice()),l=l.nextSibling;else for(;l;)ge(l,t,r,i,o.slice()),l=l.nextSibling;t.push("</",u,">")}else t.push("/>");return;case w:case S:for(l=e.firstChild;l;)ge(l,t,r,i,o.slice()),l=l.nextSibling;return;case h:return fe(t,e.name,e.value);case m:return t.push(e.data.replace(/[<&>]/g,L));case f:return t.push("<![CDATA[",e.data,"]]>");case v:return t.push("\x3c!--",e.data,"--\x3e");case A:var C=e.publicId,E=e.systemId;if(t.push("<!DOCTYPE ",e.name),C)t.push(" PUBLIC ",C),E&&"."!=E&&t.push(" ",E),t.push(">");else if(E&&"."!=E)t.push(" SYSTEM ",E,">");else{var _=e.internalSubset;_&&t.push(" [",_,"]"),t.push(">")}return;case b:return t.push("<?",e.target," ",e.data,"?>");case g:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ye(e,t,r){var i;switch(t.nodeType){case d:(i=t.cloneNode(!1)).ownerDocument=e;case S:break;case h:r=!0}if(i||(i=t.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,r)for(var o=t.firstChild;o;)i.appendChild(ye(e,o,r)),o=o.nextSibling;return i}function be(e,t,r){var i=new t.constructor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var n=t[o];"object"!=typeof n&&n!=i[o]&&(i[o]=n)}switch(t.childNodes&&(i.childNodes=new E),i.ownerDocument=e,i.nodeType){case d:var a=t.attributes,s=i.attributes=new z,l=a.length;s._ownerElement=i;for(var c=0;c<l;c++)i.setAttributeNode(be(e,a.item(c),!0));break;case h:r=!0}if(r)for(var u=t.firstChild;u;)i.appendChild(be(e,u,r)),u=u.nextSibling;return i}function ve(e,t,r){e[t]=r}O.INVALID_STATE_ERR=(P[11]="Invalid state",11),O.SYNTAX_ERR=(P[12]="Syntax error",12),O.INVALID_MODIFICATION_ERR=(P[13]="Invalid modification",13),O.NAMESPACE_ERR=(P[14]="Invalid namespace",14),O.INVALID_ACCESS_ERR=(P[15]="Invalid access",15),C.prototype=Error.prototype,c(O,C),E.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var r=[],i=0;i<this.length;i++)ge(this[i],r,e,t);return r.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},_.prototype.item=function(e){return j(this),this[e]||null},u(_,E),z.prototype={length:0,item:E.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new C(D);var r=this.getNamedItem(e.nodeName);return k(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t,r=e.ownerElement;if(r&&r!=this._ownerElement)throw new C(D);return t=this.getNamedItemNS(e.namespaceURI,e.localName),k(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return R(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return R(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var i=this[r];if(i.localName==t&&i.namespaceURI==e)return i}return null}},M.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var i=new U;if(i.implementation=this,i.childNodes=new E,i.doctype=r||null,r&&i.appendChild(r),t){var o=i.createElementNS(e,t);i.appendChild(o)}return i},createDocumentType:function(e,t,r){var i=new ae;return i.name=e,i.nodeName=e,i.publicId=t||"",i.systemId=r||"",i}},F.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Q(this,e,t)},replaceChild:function(e,t){Q(this,e,t,Z),t&&this.removeChild(t)},removeChild:function(e){return B(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return be(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==m&&e.nodeType==m?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&r[i]===e)return i;t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},c(p,F),c(p,F.prototype),U.prototype={nodeName:"#document",nodeType:w,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==S){for(var r=e.firstChild;r;){var i=r.nextSibling;this.insertBefore(r,t),r=i}return e}return Q(this,e,t),Y(e,this),null===this.documentElement&&e.nodeType===d&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),B(this,e)},replaceChild:function(e,t){Q(this,e,t,Z),Y(e,this),t&&this.removeChild(t),H(e)&&(this.documentElement=e)},importNode:function(e,t){return ye(this,e,t)},getElementById:function(e){var t=null;return G(this.documentElement,function(r){if(r.nodeType==d&&r.getAttribute("id")==e)return t=r,!0}),t},getElementsByClassName:function(e){var t=l(e);return new _(this,function(r){var i=[];return t.length>0&&G(r.documentElement,function(o){if(o!==r&&o.nodeType===d){var n=o.getAttribute("class");if(n){var a=e===n;if(!a){var s=l(n);a=t.every((c=s,function(e){return c&&-1!==c.indexOf(e)}))}a&&i.push(o)}}var c}),i})},createElement:function(e){var t=new ee;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new E,(t.attributes=new z)._ownerElement=t,t},createDocumentFragment:function(){var e=new ue;return e.ownerDocument=this,e.childNodes=new E,e},createTextNode:function(e){var t=new ie;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new oe;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new ne;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new pe;return r.ownerDocument=this,r.tagName=r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new te;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ce;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new ee,i=t.split(":"),o=r.attributes=new z;return r.childNodes=new E,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==i.length?(r.prefix=i[0],r.localName=i[1]):r.localName=t,o._ownerElement=r,r},createAttributeNS:function(e,t){var r=new te,i=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==i.length?(r.prefix=i[0],r.localName=i[1]):r.localName=t,r}},u(U,F),ee.prototype={nodeType:d,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===S?this.insertBefore(e,null):function(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,q(e.ownerDocument,e,t),Y(t,e.ownerDocument||e),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+r,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new _(this,function(t){var r=[];return G(t,function(i){i===t||i.nodeType!=d||"*"!==e&&i.tagName!=e||r.push(i)}),r})},getElementsByTagNameNS:function(e,t){return new _(this,function(r){var i=[];return G(r,function(o){o===r||o.nodeType!==d||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||i.push(o)}),i})}},U.prototype.getElementsByTagName=ee.prototype.getElementsByTagName,U.prototype.getElementsByTagNameNS=ee.prototype.getElementsByTagNameNS,u(ee,F),te.prototype.nodeType=h,u(te,F),re.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(P[T])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},u(re,F),ie.prototype={nodeName:"#text",nodeType:m,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},u(ie,re),oe.prototype={nodeName:"#comment",nodeType:v},u(oe,re),ne.prototype={nodeName:"#cdata-section",nodeType:f},u(ne,re),ae.prototype.nodeType=A,u(ae,F),se.prototype.nodeType=x,u(se,F),le.prototype.nodeType=y,u(le,F),ce.prototype.nodeType=g,u(ce,F),ue.prototype.nodeName="#document-fragment",ue.prototype.nodeType=S,u(ue,F),pe.prototype.nodeType=b,u(pe,F),de.prototype.serializeToString=function(e,t,r){return he.call(e,t,r)},F.prototype.toString=he;try{if(Object.defineProperty){function we(e){switch(e.nodeType){case d:case S:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(we(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(_.prototype,"length",{get:function(){return j(this),this.$$length}}),Object.defineProperty(F.prototype,"textContent",{get:function(){return we(this)},set:function(e){switch(this.nodeType){case d:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ve=function(e,t,r){e["$$"+t]=r}}}catch(Ae){}t.DocumentType=ae,t.DOMException=C,t.DOMImplementation=M,t.Element=ee,t.Node=F,t.NodeList=E,t.XMLSerializer=de},92065:(e,t,r)=>{"use strict";r.d(t,{A:()=>u}),r(42762);var i=r(44809),o=r.n(i),n=r(9084);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){l(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=!1;class u{static parseString(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((n,a)=>{o().parse(e,s(s({},p(t,r,n,a)),i))})}static parseFile(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((n,a)=>{o().parse(e,s(s({},p(t,r,n,a)),i))})}static parseUrl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,n.A)({url:e}).then(e=>{if("string"==typeof e)return u.parseString(e,t,r,i);throw"Request failed"})}}function p(e,t,r,i){return e?function(e,t,r){const i=[];let o=null;return{comments:e,skipEmptyLines:!0,worker:c,chunk:function(e,t){o=t;const r=e.data;for(let e=0;e<r.length;++e){const t=r[e];0===e&&d(t);for(let e=0;e<t.length;++e){let r=i[e];void 0===r&&(r=[],i.push(r)),r.push(t[e])}}},complete:function(){t(i)},error:function(e){i.length>0?o.abort():r(e)}}}(t,r,i):function(e,t,r){const i=[];let o=null;return{comments:e,skipEmptyLines:!0,worker:c,chunk:function(e,t){o=t;const r=e.data;for(let e=0;e<r.length;++e)i.push(r[e])},complete:function(){t(i)},error:function(e){i.length>0?o.abort():r(e)}}}(t,r,i)}function d(e){for(let t=0;t<e.length;++t)"string"==typeof e[t]&&(e[t]=e[t].trim())}},92580:(e,t,r)=>{"use strict";r.d(t,{A:()=>mz}),r(84864),r(27495),r(94490),r(89463),r(62953);var i=r(27813),o=r(15876),n=r(91273),a=r(87944),s=r(76970),l=r(97326),c=r(36631),u=r(53389),p=r(62280),d=r(85878);class h extends((0,u.A)(d.A,p.A)){}var m,f,g=r(90147),y=r(69437);function b(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let v=(f=class extends y.A{get hasNamedStates(){return"string"==typeof this.trueName&&"string"==typeof this.falseName}constructor(e,t){super(e,t),b(this,"type","boolean"),b(this,"trueName",void 0),b(this,"trueDescription",void 0),b(this,"falseName",void 0),b(this,"falseDescription",void 0),(0,i.Gn)(this),this.trueName=t.trueName,this.trueDescription=t.trueDescription,this.falseName=t.falseName,this.falseDescription=t.falseDescription}},b(f,"type","boolean"),w=(m=f).prototype,A="hasNamedStates",S=[i.EW],x=Object.getOwnPropertyDescriptor(m.prototype,"hasNamedStates"),O=m.prototype,P={},Object.keys(x).forEach(function(e){P[e]=x[e]}),P.enumerable=!!P.enumerable,P.configurable=!!P.configurable,("value"in P||P.initializer)&&(P.writable=!0),P=S.slice().reverse().reduce(function(e,t){return t(w,A,e)||e},P),O&&void 0!==P.initializer&&(P.value=P.initializer?P.initializer.call(O):void 0,P.initializer=void 0),void 0===P.initializer&&Object.defineProperty(w,A,P),m);var w,A,S,x,O,P,T,I,D,C=r(6119);function E(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let j=(D=class extends y.A{constructor(e,t){super(e,t),E(this,"type","enumeration"),function(e,t,r,i){r&&Object.defineProperty(e,"options",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,I,this),(0,i.Gn)(this),this.options=t.options,(0,i.mJ)(()=>this.value,()=>{var e;!(0,n.A)(this.value)&&this.isRequired&&null!==(e=this.options)&&void 0!==e&&null!==(e=e[0])&&void 0!==e&&e.id&&this.setValue(C.A.user,this.options[0].id)},{fireImmediately:!0})}get isValid(){return(0,n.A)(this.value)?(0,n.A)(this.options.find(e=>e.id===this.value)):!this.isRequired}},E(D,"type","enumeration"),I=_((T=D).prototype,"options",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_(T.prototype,"isValid",[i.$Z],Object.getOwnPropertyDescriptor(T.prototype,"isValid"),T.prototype),T);var z,N,k;function R(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let F=(k=class extends y.A{constructor(e,t){super(e,t),R(this,"type","info"),function(e,t,r,i){r&&Object.defineProperty(e,"_value",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,N,this),R(this,"_errorMessage",!1),(0,i.Gn)(this),(0,n.A)(t.value)&&(this._value=t.value),(0,n.A)(t.errorMessage)&&(this._errorMessage=t.errorMessage)}get isValid(){return!this._errorMessage}get value(){return this._value}setValue(e,t){this._value=t}clearValue(e){this._value=void 0}},R(k,"type","info"),N=M((z=k).prototype,"_value",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M(z.prototype,"isValid",[i.$Z],Object.getOwnPropertyDescriptor(z.prototype,"isValid"),z.prototype),M(z.prototype,"value",[i.$Z],Object.getOwnPropertyDescriptor(z.prototype,"value"),z.prototype),z);function L(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class G extends y.A{constructor(){super(...arguments),L(this,"type","string")}}L(G,"type","string");var U,W,q,B,V,H=r(22256),$=r(9084),J=r(82409),X=r(90267),K=r(71222);function Z(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Q(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Y=(U=(0,K.A)({type:"string",name:"Job ID",description:"Job ID for YDYR API."}),W=(0,K.A)({type:"string",name:"Result ID",description:"Result ID for YDYR API."}),q=class extends((0,u.A)(d.A,X.A)){constructor(){super(...arguments),Z(this,"jobId",B,this),Z(this,"resultId",V,this)}},B=Q(q.prototype,"jobId",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Q(q.prototype,"resultId",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q);var ee,te,re=r(81526),ie=r(33620);let oe=(te=class e extends((0,J.A)((0,g.A)(Y))){constructor(){super(...arguments),(0,i.Gn)(this)}get typeName(){return"YourDataYourRegions Job"}get type(){return e.type}async _invoke(){var e,t,r,i,a,s;if(!(0,n.A)(this.parameters))throw"Parameters have not been set";if(!(0,n.A)(this.parameters.apiUrl))throw"The apiUrl parameter must be defined.";if(!(0,n.A)(this.parameters["Input Layer"]))throw"The input layer must be defined";const c=this.terria.workbench.items.filter(l.A.isMixedInto).filter(e=>e.uniqueId===this.parameters["Input Layer"])[0];if(!(0,n.A)(c))throw"Layer ".concat(this.parameters["Input Layer"]," is not a valid layer in the workbench");if(!(0,n.A)(this.parameters["Region Column"])||!(0,n.A)(this.parameters["Data Column"])||!(0,n.A)(this.parameters["Output Geography"]))throw"The region column, data column and output geography must be defined";const u=this.parameters["Region Column"],p=this.parameters["Data Column"],d=this.parameters["Output Geography"],h=null==c?void 0:c.findColumnByName(u),m=null==c?void 0:c.findColumnByName(p);this.setTrait(C.A.user,"name","YDYR ".concat(c.name,": ").concat(p));const f=this.addObject(C.A.user,"shortReportSections","Job Details");null==f||f.setTrait(C.A.user,"content","".concat(p,': "').concat(null===(e=le.find(e=>{var t;return e.geographyName===(null==h||null===(t=h.regionType)||void 0===t?void 0:t.regionType)}))||void 0===e?void 0:e.title,'" to "').concat(d,'"'));const g={ids:null==h?void 0:h.values,values:null==m?void 0:m.valuesAsNumbers.values};if(null===(t=g.ids)||void 0===t||!t.length||null===(r=g.values)||void 0===r||!r.length)throw"The column selected has no valid data values";const y=(0,o.A)(g.values.map((e,t)=>null===e?t:void 0));g.ids=g.ids.filter((e,t)=>!y.includes(t)),g.values=g.values.filter((e,t)=>!y.includes(t));const b={data:g,data_column:p,geom_column:u,side_data:null===(i=le.find(e=>e.title===d))||void 0===i?void 0:i.sideData,dst_geom:null===(a=le.find(e=>e.title===d))||void 0===a?void 0:a.geographyName,src_geom:null==c||null===(s=c.activeTableStyle.regionColumn)||void 0===s||null===(s=s.regionType)||void 0===s?void 0:s.regionType,averaged_counts:!1,algorithms:ce.filter(e=>this.parameters[e[0]]).map(e=>e[0])},v=await(0,$.A)({url:(0,ie.A)(this,"".concat(this.parameters.apiUrl,"disaggregate.json")),method:"POST",data:JSON.stringify(b),headers:{"Content-Type":"application/json"},responseType:"json"});if("string"!=typeof v)throw"The YDYR server didn't provide a valid job id.";return this.setTrait(C.A.user,"jobId",v),!1}async pollForResults(){if(!(0,n.A)(this.jobId))return console.log("NO JOB ID"),!0;if(!(0,n.A)(this.parameters.apiUrl))return console.log("apiUrl parameter is not defined"),!0;const e=await(0,H.A)((0,ie.A)(this,"".concat(this.parameters.apiUrl,"status/").concat(this.jobId)),{"Cache-Control":"no-cache"});return"string"!=typeof e?((0,i.h5)(()=>this.setTrait(C.A.user,"logs",[...this.logs,JSON.stringify(e)])),this.setTrait(C.A.user,"resultId",e.key),!0):((0,i.h5)(()=>this.setTrait(C.A.user,"logs",[...this.logs,e])),!1)}async downloadResults(){if(!(0,n.A)(this.resultId))return[];if(!(0,n.A)(this.parameters.apiUrl))return console.log("apiUrl parameter is not defined"),[];const e=new re.A("".concat(this.uniqueId,"-result"),this.terria,void 0);return(0,i.h5)(()=>{e.setTrait(C.A.user,"name","".concat(this.name," Results")),e.setTrait(C.A.user,"url",(0,ie.A)(this,"".concat(this.parameters.apiUrl,"download/").concat(this.resultId,"?format=csv"))),e.setTrait(C.A.user,"enableManualRegionMapping",!0)}),[e]}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(te,"type","ydyr-job"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((ee=te).prototype,"_invoke",[i.XI],Object.getOwnPropertyDescriptor(ee.prototype,"_invoke"),ee.prototype),ee);var ne,ae;function se(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const le=[{title:"ABS - 2011 Statistical Areas Level 1",filename:"SA1_2011_AUST",dataCol:"SA1_MAIN11",geographyName:"SA1_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Statistical Areas Level 2",filename:"SA2_2011_AUST",dataCol:"SA2_MAIN11",geographyName:"SA2_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Statistical Areas Level 3",filename:"SA3_2011_AUST",dataCol:"SA3_CODE11",geographyName:"SA3_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Statistical Areas Level 4",filename:"SA4_2011_AUST",dataCol:"SA4_CODE11",geographyName:"SA4_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Local Government Areas",filename:"LGA_2011_AUST",dataCol:"LGA_CODE11",geographyName:"LGA_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Commonwealth Electoral Divisions",filename:"CED_2011_AUST",dataCol:"CED_CODE11",geographyName:"CED_2011",sideData:"BCP_2011"},{title:"ABS - 2011 State Electoral Divisions",filename:"SED_2011_AUST",dataCol:"SED_CODE11",geographyName:"SED_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Remoteness Areas 2011",filename:"RA_2011_AUST",dataCol:"RA_CODE11",geographyName:"RA_2011",sideData:"BCP_2011"},{title:"ABS - 2011 State Suburbs",filename:"SSC_2011_AUST",dataCol:"SSC_CODE11",geographyName:"SSC_2011",sideData:"BCP_2011"},{title:"ABS - 2011 Postal Areas",filename:"POA_2011_AUST",dataCol:"POA_CODE",geographyName:"POA_2011",sideData:"BCP_2011"},{title:"ABS - 2016 Statistical Areas Level 1",filename:"SA1_2016_AUST",dataCol:"SA1_MAIN16",geographyName:"SA1_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Statistical Areas Level 2",filename:"SA2_2016_AUST",dataCol:"SA2_MAIN16",geographyName:"SA2_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Statistical Areas Level 3",filename:"SA3_2016_AUST",dataCol:"SA3_CODE16",geographyName:"SA3_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Statistical Areas Level 4",filename:"SA4_2016_AUST",dataCol:"SA4_CODE16",geographyName:"SA4_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Local Government Areas",filename:"LGA_2016_AUST",dataCol:"LGA_CODE16",geographyName:"LGA_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Commonwealth Electoral Divisions",filename:"CED_2016_AUST",dataCol:"CED_CODE16",geographyName:"CED_2016",sideData:"BCP_2016"},{title:"ABS - 2016 State Electoral Divisions",filename:"SED_2016_AUST",dataCol:"SED_CODE16",geographyName:"SED_2016",sideData:"BCP_2016"},{title:"ABS - Remoteness Areas 2016",filename:"RA_2016_AUST",dataCol:"RA_CODE16",geographyName:"RA_2016",sideData:"BCP_2016"},{title:"ABS - 2016 State Suburbs",filename:"SSC_2016_AUST",dataCol:"SSC_CODE16",geographyName:"SSC_2016",sideData:"BCP_2016"},{title:"ABS - 2016 Postal Areas",filename:"POA_2016_AUST",dataCol:"POA_CODE16",geographyName:"POA_2016",sideData:"BCP_2016"}],ce=[["Negative Binomial",!0],["Population Weighted",!1]];let ue=(ae=class e extends((0,a.A)((0,g.A)(h))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return"YourDataYourRegions"}async createJob(e){return new oe(e,this.terria)}async forceLoadMetadata(){return super.forceLoadMetadata()}get description(){var e;return null!==(e=super.description)&&void 0!==e?e:'Your Data Your Regions (YDYR) is an API for the conversion of data between different Australian geographic boundaries. See <a href="https://ydyr.info">ydyr.info</a> for more information'}get selectedTableCatalogMember(){var e;if((0,n.A)(null===(e=this.inputLayers)||void 0===e?void 0:e.value))return this.terria.workbench.items.filter(l.A.isMixedInto).filter(e=>e.uniqueId===this.inputLayers.value)[0]}get apiUrl(){return new G(this,{id:"apiUrl",name:"YDYR API Endpoint",isRequired:!0})}get inputLayers(){const e=this.terria.workbench.items.filter(e=>l.A.isMixedInto(e)&&e.activeTableStyle.isRegions()).filter(e=>e.uniqueId).map(e=>({id:e.uniqueId,name:s.A.isMixedInto(e)?e.name:void 0}));return new j(this,{id:"Input Layer",description:"Select a layer which contains the tabular data you want to convert to another geography, It should contain at least two columns:\n- A geography column containing unique codes (eg postcodes)\n- A data column containing the values you want to convert (eg number of households by postcode)",options:e,isRequired:!0})}get inputLayersInfo(){let e="";if((0,n.A)(this.inputLayers.value)&&!this.inputLayers.isValid&&(e='The selected layer "'.concat(this.inputLayers.value,' does not exist in the map". ')),0===this.inputLayers.options.length&&(e="No supported input layers available, please add a region-mapped data layer to the map."),""!==e)return new F(this,{id:"inputLayersError",name:"Input Layer Error",errorMessage:!0,value:e})}get regionColumn(){var e;if(!this.inputLayers.isValid)return;const t=(null===(e=this.selectedTableCatalogMember)||void 0===e?void 0:e.tableColumns.filter(e=>e.type===c.A.region&&(0,n.A)(le.find(t=>{var r;return t.dataCol===(null===(r=e.regionType)||void 0===r?void 0:r.regionProp)}))).map(e=>({id:e.name})))||[];return new j(this,{id:"Region Column",description:"The data source field which contains unique codes for the input geography.",options:t,isRequired:!0})}get regionColumnInfo(){var e;if(this.inputLayers.isValid&&0===(null===(e=this.regionColumn)||void 0===e?void 0:e.options.length))return new F(this,{id:"regionColumnError",name:"Region Column Error",errorMessage:!0,value:'No region columns available, the selected layer "'.concat(this.inputLayers.value,"\" doesn't have any supported region columns.\nThe region mapping can be set in the Workbench.\n\n**Supported regions:**\n").concat(le.map(e=>"\n- ".concat(e.title)))})}get dataColumn(){var e;if(!this.inputLayers.isValid)return;const t=(null===(e=this.selectedTableCatalogMember)||void 0===e?void 0:e.tableColumns.filter(e=>e.type===c.A.scalar).map(e=>({id:e.name})))||[];return new j(this,{id:"Data Column",description:"The data source field which contains the values for the data to be converted.",options:t,isRequired:!0})}get dataColumnInfo(){var e;if(this.inputLayers.isValid&&0===(null===(e=this.dataColumn)||void 0===e?void 0:e.options.length))return new F(this,{id:"dataColumnError",name:"Data Column Error",errorMessage:!0,value:'No data columns available, the selected layer "'.concat(this.inputLayers.value,"\" doesn't have any numerical columns.")})}get availableRegions(){var e;if(null!==(e=this.regionColumn)&&void 0!==e&&e.isValid)return new j(this,{id:"Output Geography",description:"The output geography to be converted to.",options:le.map(e=>({id:e.title})),isRequired:!0})}get algorithmParametersInfo(){if(this.algorithmParameters.length>0)return new F(this,{id:"algorithmsInfo",name:"Select Algorithms",value:"Predictive models used to convert data between the input and output geographies:"})}get algorithmParameters(){var e,t,r;return null!==(e=this.regionColumn)&&void 0!==e&&e.isValid&&null!==(t=this.dataColumn)&&void 0!==t&&t.isValid&&null!==(r=this.availableRegions)&&void 0!==r&&r.isValid?ce.map(e=>new v(this,{id:e[0]})):[]}get submitWarning(){var e,t,r;if(this.inputLayers.isValid&&null!==(e=this.regionColumn)&&void 0!==e&&e.isValid&&null!==(t=this.dataColumn)&&void 0!==t&&t.isValid&&null!==(r=this.availableRegions)&&void 0!==r&&r.isValid)return new F(this,{id:"dataWarning",name:"Warning",errorMessage:!1,value:"By submitting this form your tabular data will be sent to ".concat(this.apiUrl.value," for processing.")})}get functionParameters(){return(0,o.A)([this.apiUrl,this.inputLayers,this.inputLayersInfo,this.regionColumnInfo||this.regionColumn,this.dataColumnInfo||this.dataColumn,this.availableRegions,this.algorithmParametersInfo,...this.algorithmParameters,this.submitWarning])}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ae,"type","ydyr"),se((ne=ae).prototype,"description",[i.$Z],Object.getOwnPropertyDescriptor(ne.prototype,"description"),ne.prototype),se(ne.prototype,"selectedTableCatalogMember",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"selectedTableCatalogMember"),ne.prototype),se(ne.prototype,"apiUrl",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"apiUrl"),ne.prototype),se(ne.prototype,"inputLayers",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"inputLayers"),ne.prototype),se(ne.prototype,"inputLayersInfo",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"inputLayersInfo"),ne.prototype),se(ne.prototype,"regionColumn",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"regionColumn"),ne.prototype),se(ne.prototype,"regionColumnInfo",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"regionColumnInfo"),ne.prototype),se(ne.prototype,"dataColumn",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"dataColumn"),ne.prototype),se(ne.prototype,"dataColumnInfo",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"dataColumnInfo"),ne.prototype),se(ne.prototype,"availableRegions",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"availableRegions"),ne.prototype),se(ne.prototype,"algorithmParametersInfo",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"algorithmParametersInfo"),ne.prototype),se(ne.prototype,"algorithmParameters",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"algorithmParameters"),ne.prototype),se(ne.prototype,"submitWarning",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"submitWarning"),ne.prototype),se(ne.prototype,"functionParameters",[i.EW],Object.getOwnPropertyDescriptor(ne.prototype,"functionParameters"),ne.prototype),ne);var pe,de,he,me,fe,ge,ye,be,ve,we,Ae,Se,xe=r(14711),Oe=r(61864),Pe=r(54156),Te=r(84193),Ie=r.n(Te),De=r(1087),Ce=r(45164),Ee=r(43670),_e=r(21458),je=r(75404),ze=r(39070),Ne=r(27265),ke=r(87531),Re=r(21610);function Me(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Fe(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Le=(pe=(0,K.A)({name:"Facet name",type:"string",description:"Name of facet"}),de=(0,K.A)({name:"Facet value",type:"string",description:"Value of facet to use as filter"}),he=class extends ze.A{constructor(){super(...arguments),Me(this,"name",me,this),Me(this,"value",fe,this)}},me=Fe(he.prototype,"name",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=Fe(he.prototype,"value",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he),Ge=(ge=(0,Re.b)({description:"Creates one catalog group from url that points to an opendatasoft service.",example:{name:"opendatasoft-group example",type:"opendatasoft-group",url:"https://data.bmcc.nsw.gov.au",facetFilters:[{name:"features",value:"geo"}],id:"some unique id"}}),ye=(0,K.A)({type:"boolean",name:"Flatten",description:"True to flatten the layers into a single list; false to use the layer hierarchy."}),be=(0,Ne.Ay)({name:"Facets filter",type:Le,description:"Facets (key/value pairs) to use to filter datasets.",idProperty:"name"}),ge((we=class extends((0,u.A)(d.A,_e.Ay,ke.A,je.A)){constructor(){super(...arguments),Me(this,"flatten",Ae,this),Me(this,"facetFilters",Se,this)}},Ae=Fe(we.prototype,"flatten",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Se=Fe(we.prototype,"facetFilters",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=we))||ve);var Ue,We,qe,Be,Ve,He,$e,Je,Xe,Ke,Ze,Qe,Ye,et,tt,rt,it,ot,nt,at,st,lt,ct,ut=r(43104),pt=r(63647),dt=r(53163),ht=r(6585),mt=r.n(ht),ft=r(57965),gt=r.n(ft),yt=r(24378),bt=r(74251),vt=r(78098),wt=r(89616),At=r(59801),St=r(19193),xt=r(34502),Ot=r(80795),Pt=r(16001),Tt=r(88963),It=r(28525),Dt=r(3236);function Ct(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Et(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let _t=(Ue=(0,Re.b)({description:"Creates one catalog item from url that points to an opendatasoft service.",example:{url:"https://data.bmcc.nsw.gov.au",type:"opendatasoft-item",datasetId:"bicycle-network-blue-mountains",name:"opendatasoft-item example",id:"some unique id"}}),We=(0,K.A)({type:"string",name:"Dataset ID",description:"OpenDataSoft Dataset id (`dataset_id`)."}),qe=(0,K.A)({type:"string",name:"Geo point 2d field name",description:"Field to use as geo point 2d (i.e. lat long)."}),Be=(0,K.A)({type:"string",name:"Datetime field name",description:"Field to use as datetime."}),Ve=(0,K.A)({type:"string",name:"Color field name",description:"Field to use as color."}),He=(0,K.A)({type:"string",name:"Region field name",description:"Field to use as region mapping."}),$e=(0,K.A)({type:"string",name:"Select field",description:"Names of fields to 'select' when downloading data"}),Je=(0,K.A)({type:"string",name:"Group by field",description:"Names of fields to 'groupBy' when downloading data"}),Xe=(0,Pt.A)({type:Ot.A,name:"Available fields",description:"Names of fields which can be 'selected'"}),Ke=(0,K.A)({type:"string",name:"Aggregate time values",description:"Aggregate time values (eg 1 day). See https://help.opendatasoft.com/apis/ods-search-v2/#group-by-clause"}),Ze=(0,K.A)({type:"string",name:"Refresh interval template",description:'Template used to calculate refresh interval based on Opendatasoft dataset object. This template is rendered using dataset JSON object as view. For example `"{{metas.custom.update-frequency}}"` will use `"update-frequency"` custom metadata property. This supports "human readable" time strings - for example "15 minutes" and "60 sec".'}),Ue((Ye=class extends((0,u.A)(Tt.A,Dt.A,It.A,d.A,_e.Ay,ke.A)){constructor(){super(...arguments),Ct(this,"datasetId",et,this),Ct(this,"geoPoint2dFieldName",tt,this),Ct(this,"timeFieldName",rt,this),Ct(this,"colorFieldName",it,this),Ct(this,"regionFieldName",ot,this),Ct(this,"selectFields",nt,this),Ct(this,"groupByFields",at,this),Ct(this,"availableFields",st,this),Ct(this,"aggregateTime",lt,this),Ct(this,"refreshIntervalTemplate",ct,this)}},et=Et(Ye.prototype,"datasetId",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=Et(Ye.prototype,"geoPoint2dFieldName",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt=Et(Ye.prototype,"timeFieldName",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=Et(Ye.prototype,"colorFieldName",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=Et(Ye.prototype,"regionFieldName",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nt=Et(Ye.prototype,"selectFields",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=Et(Ye.prototype,"groupByFields",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st=Et(Ye.prototype,"availableFields",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=Et(Ye.prototype,"aggregateTime",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=Et(Ye.prototype,"refreshIntervalTemplate",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe=Ye))||Qe);var jt,zt,Nt,kt,Rt=r(86706),Mt=r(34236),Ft=r(55762);function Lt(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gt(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const Ut="record_id";let Wt=(zt=class e extends((0,pt.Ay)(_t)){static async load(t){var r,i;if(!t.url)throw"`url` must be set";if(!t.datasetId)throw"`datasetId` must be set";const o=new Oe.ApiClient({domain:t.url}),n=(await o.get((0,Oe.fromCatalog)().dataset(t.datasetId).itself())).dataset;if(!Yt(n))throw"Could not find dataset `".concat(t.datasetId,"`");let a;const s=null!==(r=t.timeFieldName)&&void 0!==r?r:Vt(n),l=null!==(i=t.geoPoint2dFieldName)&&void 0!==i?i:Bt(n);if(s&&l){const e=(await o.get((0,Oe.fromCatalog)().dataset(t.datasetId).records().select("min(".concat(s,") as min_time, max(").concat(s,") as max_time, count(").concat(s,") as num")).groupBy(l).limit(100))).records;e&&(a=null==e?void 0:e.reduce((e,t)=>{var r,i,o,n,a;const s=null==t||null===(r=t.record)||void 0===r||null===(r=r.fields)||void 0===r?void 0:r.num,l=null!=t&&null!==(i=t.record)&&void 0!==i&&null!==(i=i.fields)&&void 0!==i&&i.min_time?new Date(null==t||null===(o=t.record)||void 0===o||null===(o=o.fields)||void 0===o?void 0:o.min_time):void 0,c=null!=t&&null!==(n=t.record)&&void 0!==n&&null!==(n=n.fields)&&void 0!==n&&n.max_time?new Date(null==t||null===(a=t.record)||void 0===a||null===(a=a.fields)||void 0===a?void 0:a.max_time):void 0;let u;return l&&c&&s&&(u=(c.getTime()-l.getTime())/(1e3*s)),e.push({samples:s,minTime:l,maxTime:c,intervalSec:u}),e},[]))}return new e(t,n,a)}duplicateLoadableStratum(t){return new e(t,this.dataset,this.pointTimeSeries)}constructor(e,t,r){super(),this.catalogItem=e,this.dataset=t,this.pointTimeSeries=r,(0,i.Gn)(this)}get name(){var e,t;return null!==(e=null===(t=this.dataset.metas)||void 0===t||null===(t=t.default)||void 0===t?void 0:t.title)&&void 0!==e?e:this.dataset.dataset_id}get description(){var e;return null===(e=this.dataset.metas)||void 0===e||null===(e=e.default)||void 0===e?void 0:e.description}get metadataUrls(){return[(0,ut.A)(_e.Ku,{title:Pe.Ay.t("models.openDataSoft.viewDatasetPage"),url:"".concat(this.catalogItem.url,"/explore/dataset/").concat(this.dataset.dataset_id,"/information/")})]}get colorFieldName(){var e,t,r;return null===(e=null!==(t=null!==(r=this.usefulFields.find(e=>"double"===e.type))&&void 0!==r?r:this.usefulFields.find(e=>"int"===e.type))&&void 0!==t?t:this.usefulFields.find(e=>"text"===e.type))||void 0===e?void 0:e.name}get geoPoint2dFieldName(){return Bt(this.dataset)}get timeFieldName(){return Vt(this.dataset)}get regionFieldName(){var e;return null===(e=this.dataset.fields)||void 0===e||null===(e=e.find(e=>{var t,r;return(null===(t=this.catalogItem.matchRegionProvider(e.name))||void 0===t?void 0:t.regionType)||(null===(r=this.catalogItem.matchRegionProvider(e.label))||void 0===r?void 0:r.regionType)}))||void 0===e?void 0:e.name}get recordsCount(){var e;return null===(e=this.dataset.metas)||void 0===e||null===(e=e.default)||void 0===e?void 0:e.records_count}get pointsCount(){var e;return null===(e=this.pointTimeSeries)||void 0===e?void 0:e.length}get maxPointSamples(){if(this.pointTimeSeries)return Math.max(...this.pointTimeSeries.map(e=>{var t;return null!==(t=e.samples)&&void 0!==t?t:0}))}get selectAllFields(){var e,t;return(null!==(e=null===(t=this.dataset.fields)||void 0===t?void 0:t.length)&&void 0!==e?e:0)<=10||(0,n.A)(this.recordsCount)&&this.recordsCount<1e4||!this.catalogItem.colorFieldName||!(this.catalogItem.geoPoint2dFieldName||this.catalogItem.timeFieldName)}get selectFields(){var e,t;return this.selectAllFields?(0,o.A)(null!==(e=null===(t=this.dataset.fields)||void 0===t?void 0:t.filter(e=>{var t,r;return"geo_shape"!==e.type&&!["lat","lon","long","latitude","longitude"].includes(null!==(t=null===(r=e.name)||void 0===r?void 0:r.toLowerCase())&&void 0!==t?t:"")}).map(e=>e.name))&&void 0!==e?e:[]).join(", "):(0,o.A)([this.catalogItem.timeFieldName,this.aggregateTime?"avg(".concat(this.catalogItem.colorFieldName,") as ").concat(this.catalogItem.colorFieldName):this.catalogItem.colorFieldName,this.catalogItem.geoPoint2dFieldName,this.catalogItem.regionFieldName]).join(", ")}get groupByFields(){if(this.aggregateTime&&this.timeFieldName&&this.geoPoint2dFieldName)return"".concat(this.geoPoint2dFieldName,",RANGE(").concat(this.timeFieldName,", ").concat(this.aggregateTime,") as ").concat(this.timeFieldName)}get geoPoint2dColumn(){if(this.catalogItem.geoPoint2dFieldName)return(0,ut.A)(Rt.Ay,{name:this.catalogItem.geoPoint2dFieldName,type:"hidden"})}get regionColumn(){if(this.catalogItem.regionFieldName)return(0,ut.A)(Rt.Ay,{name:this.catalogItem.regionFieldName,type:"region"})}get colorColumn(){var e;if(!this.catalogItem.colorFieldName)return;const t=null===(e=this.dataset.fields)||void 0===e?void 0:e.find(e=>e.name===this.catalogItem.colorFieldName);return t?(0,ut.A)(Rt.Ay,{name:t.name,title:t.label,type:"double"===t.type||"int"===t.type?"scalar":void 0}):void 0}get timeColumn(){var e;if(!this.catalogItem.timeFieldName)return;const t=null===(e=this.dataset.fields)||void 0===e?void 0:e.find(e=>e.name===this.catalogItem.timeFieldName);return t?(0,ut.A)(Rt.Ay,{name:t.name,title:t.label,type:"time"}):void 0}get otherColumns(){var e,t;return null!==(e=null===(t=this.dataset.fields)||void 0===t||null===(t=t.filter(e=>e.name!==this.catalogItem.timeFieldName&&e.name!==this.catalogItem.colorFieldName&&e.name!==this.catalogItem.regionFieldName))||void 0===t?void 0:t.map(e=>(0,ut.A)(Rt.Ay,{name:e.name,title:e.label,type:qt(e.name)?"hidden":void 0})))&&void 0!==e?e:[]}get columns(){return(0,o.A)([this.timeColumn,this.colorColumn,this.regionColumn,this.geoPoint2dColumn,...this.selectAllFields?this.otherColumns:[]])}get defaultStyle(){var e;return(0,ut.A)(Mt.A,{regionColumn:this.regionFieldName,latitudeColumn:this.catalogItem.geoPoint2dFieldName&&!this.catalogItem.regionFieldName?"lat":void 0,longitudeColumn:this.catalogItem.geoPoint2dFieldName&&!this.catalogItem.regionFieldName?"lon":void 0,time:(0,ut.A)(Ft.A,{spreadStartTime:(0,n.A)(this.maxPointSamples)&&1===this.maxPointSamples,spreadFinishTime:(0,n.A)(this.maxPointSamples)&&1===this.maxPointSamples,timeColumn:null===(e=this.timeColumn)||void 0===e?void 0:e.name,idColumns:this.catalogItem.geoPoint2dFieldName?["lat","lon"]:void 0})})}get currentTime(){var e;if(!this.pointTimeSeries&&this.catalogItem.geoPoint2dFieldName)return;const t=null===(e=this.catalogItem.activeTableStyle)||void 0===e||null===(e=e.timeColumn)||void 0===e?void 0:e.valuesAsJulianDates.maximum;if(!this.catalogItem.activeTableStyle.timeIntervals||!this.catalogItem.activeTableStyle.rowGroups||!t)return;const r=this.catalogItem.activeTableStyle.rowGroups.map(e=>{let t,r,[i,o]=e;return o.forEach(e=>{var i;const o=null!==(i=this.catalogItem.activeTableStyle.timeIntervals[e])&&void 0!==i?i:void 0;null!=o&&o.start&&(t=!t||yt.A.lessThan(o.start,t)?o.start:t),null!=o&&o.stop&&(r=!r||yt.A.lessThan(r,o.stop)?o.stop:r)}),new bt.A({start:t,stop:r})});if(r.length>0){const e=r.reduce((e,t)=>e?bt.A.intersect(e,t):t,void 0);if(e&&!e.isEmpty&&!yt.A.lessThan(t,e.stop))return e.stop.toString()}return t.toString()}get refreshInterval(){if(this.catalogItem.refreshIntervalTemplate)try{const e=gt().render(this.catalogItem.refreshIntervalTemplate,this.dataset);if((0,wt.Eo)(e)){const t=(mt()(e)||0)/1e3;if(t<3600)return t}}catch(e){At.Ay.from(e,"Failed to parse refreshInterval from template ".concat(this.catalogItem.refreshIntervalTemplate)).log()}}get usefulFields(){var e,t;return null!==(e=null===(t=this.dataset.fields)||void 0===t?void 0:t.filter(e=>{var t,r,i,o,n;return["double","int","text"].includes(null!==(t=e.type)&&void 0!==t?t:"")&&!["lat","lon","long","latitude","longitude"].includes(null!==(r=null===(i=e.name)||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"")&&!qt(e.name)&&!qt(e.label)&&e.name!==this.catalogItem.regionFieldName&&!(null!==(o=this.catalogItem.matchRegionProvider(e.name))&&void 0!==o&&o.regionType)&&!(null!==(n=this.catalogItem.matchRegionProvider(e.label))&&void 0!==n&&n.regionType)}))&&void 0!==e?e:[]}get availableFields(){if(!this.selectAllFields)return(0,ut.A)(Ot.A,{id:"available-fields",name:"Fields",selectedId:this.catalogItem.colorFieldName,options:this.usefulFields.map(e=>({id:e.name,name:e.label,value:void 0}))})}get activeStyle(){return this.catalogItem.colorFieldName}},Lt(zt,"stratumName","openDataSoftDataset"),Gt((jt=zt).prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"name"),jt.prototype),Gt(jt.prototype,"description",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"description"),jt.prototype),Gt(jt.prototype,"metadataUrls",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"metadataUrls"),jt.prototype),Gt(jt.prototype,"colorFieldName",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"colorFieldName"),jt.prototype),Gt(jt.prototype,"geoPoint2dFieldName",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"geoPoint2dFieldName"),jt.prototype),Gt(jt.prototype,"timeFieldName",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"timeFieldName"),jt.prototype),Gt(jt.prototype,"regionFieldName",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"regionFieldName"),jt.prototype),Gt(jt.prototype,"recordsCount",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"recordsCount"),jt.prototype),Gt(jt.prototype,"pointsCount",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"pointsCount"),jt.prototype),Gt(jt.prototype,"maxPointSamples",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"maxPointSamples"),jt.prototype),Gt(jt.prototype,"selectAllFields",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"selectAllFields"),jt.prototype),Gt(jt.prototype,"selectFields",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"selectFields"),jt.prototype),Gt(jt.prototype,"groupByFields",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"groupByFields"),jt.prototype),Gt(jt.prototype,"geoPoint2dColumn",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"geoPoint2dColumn"),jt.prototype),Gt(jt.prototype,"regionColumn",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"regionColumn"),jt.prototype),Gt(jt.prototype,"colorColumn",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"colorColumn"),jt.prototype),Gt(jt.prototype,"timeColumn",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"timeColumn"),jt.prototype),Gt(jt.prototype,"otherColumns",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"otherColumns"),jt.prototype),Gt(jt.prototype,"columns",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"columns"),jt.prototype),Gt(jt.prototype,"defaultStyle",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"defaultStyle"),jt.prototype),Gt(jt.prototype,"currentTime",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"currentTime"),jt.prototype),Gt(jt.prototype,"refreshInterval",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"refreshInterval"),jt.prototype),Gt(jt.prototype,"usefulFields",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"usefulFields"),jt.prototype),Gt(jt.prototype,"availableFields",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"availableFields"),jt.prototype),Gt(jt.prototype,"activeStyle",[i.EW],Object.getOwnPropertyDescriptor(jt.prototype,"activeStyle"),jt.prototype),jt);function qt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(n.A).reduce((e,t)=>e||t.toLowerCase().startsWith("id")||t.toLowerCase().endsWith("id"),!1)}function Bt(e){var t;return null===(t=e.fields)||void 0===t||null===(t=t.find(e=>"geo_point_2d"===e.type))||void 0===t?void 0:t.name}function Vt(e){var t;return null===(t=e.fields)||void 0===t||null===(t=t.find(e=>"datetime"===e.type))||void 0===t?void 0:t.name}dt.A.addLoadStratum(Wt.stratumName);let Ht=(kt=class e extends((0,St.A)((0,l.A)((0,Ee.A)((0,g.A)(_t))))){constructor(e,t,r){super(e,t,r),(0,i.Gn)(this),this.strata.set(xt.A.stratumName,new xt.A(this))}get type(){return e.type}async forceLoadMetadata(){if(!this.strata.has(Wt.stratumName)){const e=await Wt.load(this);(0,i.h5)(()=>{this.strata.set(Wt.stratumName,e)})}}get apiClient(){return new Oe.ApiClient({domain:this.url})}async forceLoadTableData(){var e;if(!this.datasetId||!this.url)return[];let t=[],r=(0,Oe.fromCatalog)().dataset(this.datasetId).records().limit(100);this.timeFieldName&&(r=r.orderBy("".concat(this.timeFieldName," DESC"))),this.selectFields&&(r=r.select(this.selectFields)),this.groupByFields&&(r=r.groupBy(this.groupByFields));const i=this.strata.get(Wt.stratumName),o=Math.min(1e3,null!==(e=null==i?void 0:i.recordsCount)&&void 0!==e?e:1e3),n=(0,vt.A)(await Promise.all(new Array(Math.ceil(o/100)).fill(0).map(async(e,t)=>{var i;return null!==(i=(await this.apiClient.get(r.offset(100*t))).records)&&void 0!==i?i:[]})));if(n&&n.length>0){const e={};e[Ut]=new Array(n.length).fill(""),this.geoPoint2dFieldName&&(e.lat=new Array(n.length).fill(""),e.lon=new Array(n.length).fill("")),this.timeFieldName&&(e[this.timeFieldName]=new Array(n.length).fill("")),n.forEach((t,r)=>{var i,o,a,s;null!==(i=t.record)&&void 0!==i&&i.id&&(e[Ut][r]=null===(o=t.record)||void 0===o?void 0:o.id,Object.entries(null!==(a=null===(s=t.record)||void 0===s?void 0:s.fields)&&void 0!==a?a:{}).forEach(t=>{let[i,o]=t;i===this.geoPoint2dFieldName&&(0,wt.OW)(o)?(e.lat[r]="".concat(o.lat),e.lon[r]="".concat(o.lon)):(Array.isArray(e[i])||(e[i]=new Array(n.length).fill("")),e[i][r]="".concat(o))}))}),t=Object.entries(e).map(e=>{let[t,r]=e;return[t,...r]})}return t}refreshData(){this.forceLoadMapItems()}get availableFieldsDimension(){var e,t;if(null!==(e=null===(t=this.availableFields)||void 0===t||null===(t=t.options)||void 0===t?void 0:t.length)&&void 0!==e&&e)return{id:this.availableFields.id,name:this.availableFields.name,selectedId:this.availableFields.selectedId,options:this.availableFields.options,setDimensionValue:async(e,t)=>{this.setTrait(e,"colorFieldName",t),(await this.loadMapItems()).throwIfError()}}}get selectableDimensions(){return(0,o.A)([this.availableFieldsDimension,...super.selectableDimensions.filter(e=>!this.availableFieldsDimension||"activeStyle"!==e.id)])}},Lt(kt,"type","opendatasoft-item"),Gt((Nt=kt).prototype,"apiClient",[i.EW],Object.getOwnPropertyDescriptor(Nt.prototype,"apiClient"),Nt.prototype),Gt(Nt.prototype,"availableFieldsDimension",[i.EW],Object.getOwnPropertyDescriptor(Nt.prototype,"availableFieldsDimension"),Nt.prototype),Gt(Nt.prototype,"selectableDimensions",[i.$Z],Object.getOwnPropertyDescriptor(Nt.prototype,"selectableDimensions"),Nt.prototype),Nt);var $t,Jt;function Xt(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}dt.A.addLoadStratum(xt.A.stratumName);let Zt=(Jt=class e extends((0,pt.Ay)(Ge)){static async load(t){if(!t.url)throw"`url` must be set";const r=new Oe.ApiClient({domain:t.url}),i=[];let o;var a;if(t.facetFilters&&0===t.facetFilters.length&&!t.flatten&&(o=null===(a=(await r.get((0,Oe.fromCatalog)().facets())).facets)||void 0===a?void 0:a.filter(e=>er(e))),!o||0===o.length){let e,o=0;const a=100;let c=(0,Oe.fromCatalog)().datasets().limit(a).orderBy("title asc").where('features = "geo" OR features = "timeserie"');for(t.facetFilters&&t.facetFilters.length>0&&(c=c.refine(t.facetFilters.map(e=>"".concat(e.name,":").concat(e.value)).join(",")));!(0,n.A)(e)||o<e;){var s,l;c=c.offset(o);const t=await r.get(c);e=null!==(s=t.total_count)&&void 0!==s?s:0,null===(l=t.datasets)||void 0===l||l.forEach(e=>{Yt(e.dataset)&&i.push(e.dataset)}),o+=a}}return new e(t,void 0,null!=o?o:[],null!=i?i:[])}duplicateLoadableStratum(t){return new e(t,this.facetName,this.facets,this.datasets)}constructor(e,t,r,o){super(),this.catalogGroup=e,this.facetName=t,this.facets=r,this.datasets=o,(0,i.Gn)(this)}get members(){return[...this.facets.map(e=>this.getFacetId(e)),...this.datasets.map(e=>this.getDatasetId(e))]}createMembers(){this.facets.forEach(e=>this.createGroupFromFacet(e)),this.datasets.forEach(e=>this.createMemberFromDataset(e))}createGroupFromFacet(t){var r;const i=this.getFacetId(t);if(!i)return;const o=this.catalogGroup.terria.getModelById(Qt,i);let n;void 0===o?(n=new Qt(i,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(n)):n=o,n.strata.delete(C.A.definition),n.setTrait(C.A.definition,"name","".concat(t.name).concat(t.count?" (".concat(null!==(r=t.count)&&void 0!==r?r:0,")"):"")),n.setTrait(C.A.definition,"url",this.catalogGroup.url),n.strata.delete(e.stratumName),t.facets&&Array.isArray(t.facets)&&0!==t.facets.length?n.strata.set(e.stratumName,new e(n,t.name,t.facets,[])):n.setTrait(C.A.definition,"facetFilters",[(0,ut.A)(Le,{name:this.facetName,value:t.name})])}createMemberFromDataset(e){var t,r,i,o;const n=this.getDatasetId(e);if(!n)return;const a=this.catalogGroup.terria.getModelById(Ht,n);let s;void 0===a?(s=new Ht(n,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(s),this.catalogGroup.terria.addShareKey(n,"".concat(this.catalogGroup.uniqueId,"/").concat(e.dataset_id))):s=a,s.strata.delete(C.A.definition),s.setTrait(C.A.definition,"datasetId",e.dataset_id),s.setTrait(C.A.definition,"url",this.catalogGroup.url),s.setTrait(C.A.definition,"name",null!==(t=null===(r=e.metas)||void 0===r||null===(r=r.default)||void 0===r?void 0:r.title)&&void 0!==t?t:e.dataset_id),s.setTrait(C.A.definition,"description",null!==(i=null===(o=e.metas)||void 0===o||null===(o=o.default)||void 0===o?void 0:o.description)&&void 0!==i?i:void 0),s.setTrait(C.A.definition,"metadataUrls",[(0,ut.A)(_e.Ku,{title:Pe.Ay.t("models.openDataSoft.viewDatasetPage"),url:"".concat(this.catalogGroup.url,"/explore/dataset/").concat(e.dataset_id,"/information/")})])}getDatasetId(e){return"".concat(this.catalogGroup.url?Ie()(this.catalogGroup.url).hostname():this.catalogGroup.uniqueId,"/").concat(e.dataset_id)}getFacetId(e){return"".concat(this.catalogGroup.uniqueId,"/").concat(e.name)}},Xt(Jt,"stratumName","openDataSoftCatalog"),Kt(($t=Jt).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor($t.prototype,"members"),$t.prototype),Kt($t.prototype,"createGroupFromFacet",[i.XI],Object.getOwnPropertyDescriptor($t.prototype,"createGroupFromFacet"),$t.prototype),Kt($t.prototype,"createMemberFromDataset",[i.XI],Object.getOwnPropertyDescriptor($t.prototype,"createMemberFromDataset"),$t.prototype),$t);dt.A.addLoadStratum(Zt.stratumName);class Qt extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Ge))))){get type(){return Qt.type}async forceLoadMetadata(){if(!this.strata.has(Zt.stratumName)){const e=await Zt.load(this);(0,i.h5)(()=>{this.strata.set(Zt.stratumName,e)})}}async forceLoadMembers(){const e=this.strata.get(Zt.stratumName);e&&await(0,De.A)(()=>e.createMembers())}}function Yt(e){return(0,n.A)(e)&&(0,n.A)(e.dataset_id)}function er(e){var t;return(0,n.A)(e)&&(0,n.A)(e.name)&&(null!==(t=e.facets)&&void 0!==t?t:[]).reduce((e,t)=>e&&er(t),!0)}Xt(Qt,"type","opendatasoft-group");var tr,rr,ir,or,nr,ar,sr,lr,cr,ur,pr,dr,hr=r(35471),mr=r(31647);function fr(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function gr(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let yr=(tr=(0,K.A)({name:"Facet name",type:"string",description:"Name of facet"}),rr=(0,K.A)({name:"Facet value",type:"string",description:"Value of facet to use as filter"}),ir=class extends ze.A{constructor(){super(...arguments),fr(this,"name",or,this),fr(this,"value",nr,this)}},or=gr(ir.prototype,"name",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=gr(ir.prototype,"value",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ir),br=(ar=(0,mr.A)({name:"Facet groups",description:"Facets to include in group structure. By default, `tags` and `categories` will be used,",type:"string"}),sr=(0,Ne.Ay)({name:"Facets filter",type:yr,description:"Facets (key/value pairs) to use to filter datasets.",idProperty:"name"}),lr=(0,hr.A)({name:"Filter Query",description:"Gets or sets the filter query to pass to Socrata when querying the available data sources and their groups."}),cr=class extends((0,u.A)(d.A,_e.Ay,ke.A,je.A)){constructor(){super(...arguments),fr(this,"facetGroups",ur,this),fr(this,"facetFilters",pr,this),fr(this,"filterQuery",dr,this)}},ur=gr(cr.prototype,"facetGroups",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["tags","categories"]}}),pr=gr(cr.prototype,"facetFilters",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr=gr(cr.prototype,"filterQuery",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),cr);var vr,wr,Ar,Sr,xr,Or=r(18648),Pr=r(4271),Tr=r(77436),Ir=r(72988);function Dr(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Cr(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Er=(vr=(0,K.A)({type:"string",name:"GeoJSON URL",description:"The URL to use to download geoJSON."}),wr=(0,K.A)({type:"string",name:"Resource ID",description:"Resource ID to use when querying views. For example `https://data.melbourne.vic.gov.au/views/${resourceId}`"}),Ar=class extends((0,u.A)(Ir.h,_e.Ay)){constructor(){super(...arguments),Dr(this,"geojsonUrl",Sr,this),Dr(this,"resourceId",xr,this)}},Sr=Cr(Ar.prototype,"geojsonUrl",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xr=Cr(Ar.prototype,"resourceId",[wr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar);var _r,jr;function zr(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let Nr=(jr=class e extends((0,pt.Ay)(Er)){static async load(t){if(!t.url)throw"`url` must be set";if(!t.resourceId)throw"`resourceId` must be set";const r=await(0,H.A)((0,ie.A)(t,"".concat(t.url,"/views/").concat(t.resourceId)));var i;if(r.error)throw null!==(i=r.message)&&void 0!==i?i:r.error;return new e(t,r)}get geojsonUrl(){var e;if(null!==(e=this.view)&&void 0!==e&&null!==(e=e.childViews)&&void 0!==e&&e[0])return"".concat(this.catalogItem.url,"/resource/").concat(this.view.childViews[0],".geojson?$limit=10000")}duplicateLoadableStratum(t){return new e(t,this.view)}constructor(e,t){super(),this.catalogItem=e,this.view=t,(0,i.Gn)(this)}},zr(jr,"stratumName","socrataMapView"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((_r=jr).prototype,"geojsonUrl",[i.EW],Object.getOwnPropertyDescriptor(_r.prototype,"geojsonUrl"),_r.prototype),_r);dt.A.addLoadStratum(Nr.stratumName);class kr extends((0,Tr.Ay)((0,g.A)(Er))){get type(){return kr.type}async forceLoadMetadata(){if(!this.strata.has(Nr.stratumName)){const e=await Nr.load(this);(0,i.h5)(()=>{this.strata.set(Nr.stratumName,e)})}}async forceLoadGeojsonData(){if(this.geojsonUrl){const e=await(0,H.A)((0,ie.A)(this,this.geojsonUrl)),t=(0,Pr.qX)(e);if(t)return t;throw At.Ay.from("Failed to parse geoJSON")}throw At.Ay.from("Failed to fetch geoJSON - no URL was provided")}}var Rr,Mr;function Fr(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lr(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}zr(kr,"type","socrata-map-item");let Gr=(Mr=class e extends((0,pt.Ay)(br)){static async load(t){if(!t.url)throw"`url` must be set";const r=Object.assign({},t.filterQuery,{only:"dataset,map"}),i=Ie()(t.url).hostname();let o=[],a=[];if((0,n.A)(t.facetFilters)&&0!==t.facetFilters.length){const e=Ie()("".concat(t.url,"/api/catalog/v1?search_context=").concat(i)).addQuery(r);t.facetFilters.forEach(t=>{let{name:r,value:i}=t;return r&&(0,n.A)(i)?e.addQuery(r,i):null});const o=await(0,H.A)((0,ie.A)(t,e.toString()));var s;if(o.error)throw null!==(s=o.message)&&void 0!==s?s:o.error;if(a=o.results,!Array.isArray(a)||0===a.length)throw"Could not find any results for domain ".concat(i," and facets: ").concat(t.facetFilters.map(e=>{let{name:t,value:r}=e;return"".concat(t," = ").concat(r)}).join(", "))}else{const e=t.facetGroups,n=Ie()("".concat(t.url,"/api/catalog/v1/domains/").concat(i,"/facets")).addQuery(r),a=await(0,H.A)((0,ie.A)(t,n.toString()));var l;if(a.error)throw null!==(l=a.message)&&void 0!==l?l:a.error;if(o=a,!Array.isArray(o))throw"Could not fetch facets for domain ".concat(i);if(o=o.filter(t=>e.includes(t.facet)),0===o.length)throw"Could not find any facets for domain ".concat(i)}return new e(t,o,a)}duplicateLoadableStratum(t){return new e(t,this.facets,this.results)}constructor(e,t,r){super(),this.catalogGroup=e,this.facets=t,this.results=r,(0,i.Gn)(this)}get members(){return 1===this.facets.length?this.facets[0].values.map(e=>"".concat(this.getFacetId(this.facets[0]),"/").concat(e.value)):[...this.facets.map(e=>this.getFacetId(e)),...this.results.map(e=>this.getResultId(e))]}createMembers(){this.facets.forEach(e=>this.createGroupFromFacet(e)),this.results.forEach(e=>this.createItemFromResult(e))}createGroupFromFacet(e){const t=this.getFacetId(e);let r=this.catalogGroup.terria.getModelById(xe.A,t);void 0===r&&(r=new xe.A(t,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(r)),r.strata.delete(C.A.definition),r.setTrait(C.A.definition,"name",e.facet),e.values.forEach(i=>{var o;const n="".concat(t,"/").concat(i.value);let a=this.catalogGroup.terria.getModelById(Ur,n);void 0===a&&(a=new Ur(n,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(a)),a.strata.delete(C.A.definition),a.setTrait(C.A.definition,"name","".concat(i.value).concat(i.count?" (".concat(null!==(o=i.count)&&void 0!==o?o:0,")"):"")),a.setTrait(C.A.definition,"url",this.catalogGroup.url),a.setTrait(C.A.definition,"facetFilters",[(0,ut.A)(yr,{name:e.facet,value:i.value})]),r.add(C.A.definition,a)})}createItemFromResult(e){const t=this.getResultId(e);let r;this.catalogGroup.terria.addShareKey(t,"".concat(this.catalogGroup.uniqueId,"/").concat(e.resource.id)),"dataset"===e.resource.type?e.resource.columns_datatype.find(e=>["Point","Line","Polygon","MultiLine","MultiPoint","MultiPolygon","Location"].includes(e))?(r=this.catalogGroup.terria.getModelById(Or.default,t),void 0===r&&(r=new Or.default(t,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(r)),r.strata.delete(C.A.definition),r.setTrait(C.A.definition,"url","".concat(this.catalogGroup.url,"/resource/").concat(e.resource.id,".geojson?$limit=10000"))):(r=this.catalogGroup.terria.getModelById(re.A,t),void 0===r&&(r=new re.A(t,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(r)),r.strata.delete(C.A.definition),r.setTrait(C.A.definition,"url","".concat(this.catalogGroup.url,"/resource/").concat(e.resource.id,".csv?$limit=10000"))):"map"===e.resource.type&&(r=this.catalogGroup.terria.getModelById(kr,t),void 0===r&&(r=new kr(t,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(r)),r.strata.delete(C.A.definition),r.setTrait(C.A.definition,"url",this.catalogGroup.url),r.setTrait(C.A.definition,"resourceId",e.resource.id)),r&&(r.setTrait(C.A.definition,"name",e.resource.name),r.setTrait(C.A.definition,"description",e.resource.description),r.setTrait(C.A.definition,"attribution",e.resource.attribution),r.setTrait(C.A.definition,"info",[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.socrataServer.licence"),content:e.metadata.license}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.socrataServer.tags"),content:e.classification.tags.join(", ")}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.socrataServer.attributes"),content:e.resource.columns_name.join(", ")})]),r.setTrait(C.A.definition,"metadataUrls",[(0,ut.A)(_e.Ku,{title:Pe.Ay.t("models.openDataSoft.viewDatasetPage"),url:e.permalink})]))}getFacetId(e){return"".concat(this.catalogGroup.uniqueId,"/").concat(e.facet)}getResultId(e){var t;return"".concat(this.catalogGroup.url?Ie()(null!==(t=this.catalogGroup.url)&&void 0!==t?t:"").hostname():this.catalogGroup.uniqueId,"/").concat(e.resource.id)}},Fr(Mr,"stratumName","socrataCatalog"),Lr((Rr=Mr).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(Rr.prototype,"members"),Rr.prototype),Lr(Rr.prototype,"createGroupFromFacet",[i.XI],Object.getOwnPropertyDescriptor(Rr.prototype,"createGroupFromFacet"),Rr.prototype),Lr(Rr.prototype,"createItemFromResult",[i.XI],Object.getOwnPropertyDescriptor(Rr.prototype,"createItemFromResult"),Rr.prototype),Rr);dt.A.addLoadStratum(Gr.stratumName);class Ur extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(br))))){get type(){return Ur.type}async forceLoadMetadata(){try{if(!this.strata.has(Gr.stratumName)){const e=await Gr.load(this);(0,i.h5)(()=>{this.strata.set(Gr.stratumName,e)})}}catch(e){(0,At.mG)(At.Ay.from(e,{message:{key:"models.socrataServer.retrieveErrorMessage"}}))}}async forceLoadMembers(){const e=this.strata.get(Gr.stratumName);e&&await(0,De.A)(()=>e.createMembers())}}Fr(Ur,"type","socrata-group");class Wr{constructor(e,t,r){this.parseUrl=e,this.proxy=t.proxy?t.proxy:null,this.DOMParser=r}async getData(e){e=this.proxy?`${this.proxy}${e}`:e;const t=await fetch(e),r=await t.text();return this.parseStringSync(r)}parseStringSync(e){return function(e,t,r){if(!e)return{};var i=function(e){return String(e||"").replace(/-/g,"_")},o=function(e){return Array.isArray(e)||(e=[e]),e.length=e.length,e};if("string"==typeof e&&(e=(new r).parseFromString(e,"text/xml")),e.nodeType){if(3===e.nodeType||4===e.nodeType)return e.nodeValue;var n=9===e.nodeType?e.documentElement:e,a=function e(t,r){if(!t)return null;let n="",a=null,s=null;if(t.childNodes&&t.childNodes.length>0)for(var l=0;l<t.childNodes.length;++l){const r=t.childNodes[l],s=r.nodeType,c=i(r.localName||r.nodeName),u=r.text||r.nodeValue||"";if(8!==s)if(3!==s&&4!==s&&c)a=a||{},a[c]?(a[c].length||(a[c]=o(a[c])),a[c]=o(a[c]),a[c][a[c].length]=e(r,!0),a[c].length=a[c].length):a[c]=e(r);else{if(u.match(/^\s+$/))continue;n+=u.replace(/^\s+/,"").replace(/\s+$/,"")}}if(t.attributes&&t.attributes.length>0){s={},a=a||{};for(var c=0;c<t.attributes.length;++c){let e=t.attributes[c],r=i(e.name),n=e.value;s[r]=n,a[r]?(a[cnn]=o(a[cnn]),a[r][a[r].length]=n,a[r].length=a[r].length):a[r]=n}}if(a){var u=""!==n?new String(n):{};for(var p in a)a.hasOwnProperty(p)&&(u[p]=a[p]);a=u,n=a.text?[a.text||""].concat([n]):n,n&&(a.text=n),n=""}var d=a||n;return d}(n);return e=null,n=null,a}}(e,0,this.DOMParser)}}function qr(e){return new URL(e)}class Br{constructor(e,t){this.parent=t,this.id=e.ID,this.name=e.name,this.urlPath=e.urlPath?e.urlPath:null,this.dataType=e.dataType?e.dataType:null,this.dataFormat=e.dataFormat?e.dataFormat:null,e.dataSize?this.dataSize={size:e.dataSize["#text"],unit:e.dataSize.$units}:this.dataSize=null,e.date?this.date={size:e.date["#text"],type:e.date.$type}:this.date=null,this.metadata=e.metadata?e.metadata:null,this.isParentDataset=null===this.dataSize,this.datasets=[],this._datasetJson=e,this.catalogsAreLoaded=!1,this.catalogs=[]}async getNestedDatasets(){const e=this._datasetJson;if(e.dataset){Array.isArray(e.dataset)||(e.dataset=[e.dataset]);for(let t=0;t<e.dataset.length;t++){const r=new Br(e.dataset[t],this);await r.getNestedDatasets(),this.datasets.push(r)}}}async loadAllNestedCatalogs(){const e=this._datasetJson;if(e.catalogRef){Array.isArray(e.catalogRef)||(e.catalogRef=[e.catalogRef]);for(let t=0;t<e.catalogRef.length;t++){const r=this._cleanUrl(e.catalogRef[t]["xlink:href"]);try{const i=new Hr(r,e.catalogRef[t],this,this.parent._requestor);await i._loadCatalog(),this.catalogs.push(i)}catch(e){console.error(`Couldn't create catalog within dataset:\n                        Dataset URL: ${r}\n                        ${e}`)}}}this.catalogsAreLoaded=!0}_cleanUrl(e){return e.indexOf("://")>=0?e:`${this.parentCatalog._catalogBaseUrl}${e}`}get wmsUrl(){return this.supportsWms?`${this.parentCatalog.wmsBase}${this.urlPath}?service=WMS&version=1.3.0&request=GetCapabilities`:null}get parentCatalog(){const e=this.parent;return e.isParentDataset?e.parent:e}get supportsWms(){return!this.isParentDataset&&this.parentCatalog.supportsWms}}class Vr{constructor(e){this.name=e.name,this.type=e.serviceType,this.baseUrl=e.base}}class Hr{constructor(e,t,r,i){this.url=e,this.name=null!==t?t.name:null,this.title=null!==t?t["xlink:title"]:null,this.id=null!==t?t.ID:null,this.isLoaded=!1,this.datasets=[],this.catalogs=[],this.services={},this.parentCatalog=r,this.metadata={},this._catalogJson=t,this._requestor=i,this._urlObj=i.parseUrl(this.url),this._catalogBaseUrl=this.url.replace("catalog.xml",""),this._rootUrl=`${this._urlObj.protocol}//${this._urlObj.host}`}get hasDatasets(){return"dataset"in this._catalogJson}get hasNestedCatalogs(){return"catalogRef"in this._catalogJson}get supportsWms(){return"wms"in this.services}get wmsBase(){return this.supportsWms?`${this._rootUrl}${this.services.wms.baseUrl}`:null}async _loadCatalog(){this._catalogJson=await this._requestor.getData(this.url),this.isLoaded=!0,await this._processCatalog()}async _processCatalog(){const e=this._catalogJson;if(null!==this.name&&""!==this.name||(this.name=e.name),null!==this.title&&""!==this.title||(this.title=e["xlink:title"]),null===this.id&&(this.id=e.ID),0===Object.keys(this.metadata).length&&void 0!==e.metadata&&(this.metadata=e.metadata),e.dataset){Array.isArray(e.dataset)||(e.dataset=[e.dataset]);for(var t=0;t<e.dataset.length;t++){const r=new Br(e.dataset[t],this);await r.getNestedDatasets(),this.datasets.push(r)}}if(e.service&&this._getServicesRecursively(e.service),e.catalogRef){Array.isArray(e.catalogRef)||(e.catalogRef=[e.catalogRef]);for(let t=0;t<e.catalogRef.length;t++){const r=this._cleanUrl(e.catalogRef[t]["xlink:href"]);try{const i=new Hr(r,e.catalogRef[t],this,this._requestor);this.catalogs.push(i)}catch(e){console.error(`\n                        Couldn't create catalog in catalog: ${r}\n                        Parent was: ${this.url}\n                        ${e}`)}}}}async loadAllNestedCatalogs(){for(let e=0;e<this.catalogs.length;e++){const t=this.catalogs[e];try{await t._loadCatalog(),await t.loadAllNestedCatalogs()}catch(e){console.error(`\n                    Couldn't create catalog in catalog: ${t.url}\n                    Parent was: ${this.url}\n                    ${e}`)}}}async loadNestedCatalogById(e){let t=!1;for(let r=0;r<this.catalogs.length;r++){const i=this.catalogs[r];if(i.id===e){t=!0;try{return await i._loadCatalog(),i}catch(e){console.error(`\n                    Couldn't create catalog in catalog: ${i.url}\n                    Parent was: ${this.url}\n                    ${e}`)}}}if(!t)throw new Error(`Could not find catalog using id: ${e}`)}_getServicesRecursively(e){Array.isArray(e)&&(e=e[0]);for(let t=0;t<e.service.length;t++){const r=e.service[t];if("service"in r)this._getServicesRecursively(r);else{const e=new Vr(r);this.services[e.name]=e}}}_cleanUrl(e){return e.indexOf("://")>=0?e:-1===e.indexOf("thredds")?`${this._catalogBaseUrl}/${e}`:`${this._rootUrl}${e}`}getAllChildDatasets(){let e=[];for(var t=0;t<this.catalogs.length;t++)e=e.concat(this.catalogs[t].getAllChildDatasets());for(let t=0;t<this.datasets.length;t++)if(this.datasets[t].isParentDataset)for(var r=0;r<this.datasets[t].datasets.length;r++)e.push(this.datasets[t].datasets[r]);else e.push(this.datasets[t]);return e}}var $r;let Jr=(0,Re.b)({description:"Creates one catalog group from url that points to a thredds service.",example:{type:"thredds-group",url:"http://dapds00.nci.org.au/thredds/catalog/rr9/ASCAT/ASCAT_v1-0_soil-moisture_daily_0-05deg_2007-2011/00000000/catalog.xml",name:"thredds example",id:"some unique id"}})($r=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A)){})||$r;var Xr=r(26730),Kr=r(87919);class Zr extends((0,u.A)(d.A,Kr.A)){}var Qr=r(93264),Yr=r(2757),ei=r(3047);r(25440);const ti=function(e){return"string"==typeof e||e instanceof String?e.replace(/_/g," "):e};var ri,ii,oi,ni,ai,si,li,ci=r(45563),ui=r(8916),pi=r(3437);function di(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function hi(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let mi=(ri=(0,Re.b)({description:"Creates a group of all layers (or subgroups) in the catalog from a url that points to a wms service.",example:{type:"wms-group",name:"wms-group example",url:"https://ows.services.dea.ga.gov.au",id:"a unique id for wms-group example"}}),ii=(0,K.A)({type:"boolean",name:"Flatten",description:"True to flatten the layers into a single list; false to use the layer hierarchy."}),oi=(0,Pt.A)({name:"Per layer WebCoverageService",description:"To enable Export/WebCoverageService for **all** WMS layers in this group, set `perLayerLinkedWcs.linkedWcsUrl`. `linkedWcsCoverage` will be set to the WMS layer `Name` if it is defined, layer `Title` otherwise.",type:ui.Ay}),ri((ai=class extends((0,u.A)(pi.A,je.A,d.A,_e.Ay,ke.A)){constructor(){super(...arguments),di(this,"flatten",si,this),di(this,"perLayerLinkedWcs",li,this)}},si=hi(ai.prototype,"flatten",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),li=hi(ai.prototype,"perLayerLinkedWcs",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=ai))||ni);var fi,gi=r(69503),yi=r(16276),bi=r(16005);function vi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function wi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vi(Object(r),!0).forEach(function(t){Ai(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vi(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ai(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Si(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let xi=(fi=class e extends((0,pt.Ay)(mi)){static async load(t){if(void 0===t.getCapabilitiesUrl)throw new At.Ay({title:Pe.Ay.t("models.webMapServiceCatalogGroup.missingUrlTitle"),message:Pe.Ay.t("models.webMapServiceCatalogGroup.missingUrlMessage")});const r=await yi.A.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration));return new e(t,r)}constructor(e,t){super(),this.catalogGroup=e,this.capabilities=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}get name(){if(this.capabilities&&this.capabilities.Service&&this.capabilities.Service.Title)return ti(this.capabilities.Service.Title)}get info(){const e=[],t=this.capabilities&&this.capabilities.Service;return t&&(t&&t.Abstract&&!(0,Yr.A)(t.Abstract,bi.Ay.abstractsToIgnore)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapServiceCatalogGroup.abstract"),content:this.capabilities.Service.Abstract})),t&&t.AccessConstraints&&!/^none$/i.test(t.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapServiceCatalogGroup.accessConstraints"),content:this.capabilities.Service.AccessConstraints})),t&&t.Fees&&!/^none$/i.test(t.Fees)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapServiceCatalogGroup.fees"),content:this.capabilities.Service.Fees}))),e}get members(){return(0,o.A)(this.topLevelLayers.map(e=>this.getLayerId(e)))}get topLevelLayers(){if(this.catalogGroup.flatten)return this.capabilities.allLayers;{let e=this.capabilities.rootLayers;for(;e&&1===e.length&&void 0===e[0].Name;){const t=e[0].Layer;if(t&&(0,ei.A)(t))e=t;else{if(!t)break;e=[t]}}return e}}createMembersFromLayers(){this.topLevelLayers.forEach(e=>this.createMemberFromLayer(e))}createMemberFromLayer(e,t){var r;const i=this.getLayerId(e,t);if(!i)return;if(e.Layer){let t;t=Array.isArray(e.Layer)?e.Layer:[e.Layer],t.forEach(e=>this.createMemberFromLayer(e,i));const r=this.catalogGroup.terria.getModelById(xe.A,i);let n;if(void 0===r){n=new xe.A(i,this.catalogGroup.terria);try{this.catalogGroup.terria.addModel(n,this.getLayerShareKeys(e,i))}catch(e){return void At.Ay.from(e,"Failed to add CatalogGroup").log()}}else n=r;return n.setTrait(C.A.definition,"name",e.Title),n.setTrait(C.A.definition,"members",(0,o.A)(t.map(e=>this.getLayerId(e,i)))),void(e&&e.Abstract&&!(0,Yr.A)(e.Abstract,bi.Ay.abstractsToIgnore)&&n.setTrait(C.A.definition,"info",[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapServiceCatalogGroup.abstract"),content:e.Abstract})]))}if(!(0,n.A)(e.Name))return;const a=this.catalogGroup.terria.getModelById(bi.Ay,i);let s;if(void 0===a){s=new bi.Ay(i,this.catalogGroup.terria);try{this.catalogGroup.terria.addModel(s,this.getLayerShareKeys(e,i))}catch(e){return void At.Ay.from(e,"Failed to add WebMapServiceCatalogItem").log()}}else s=a;s.strata.delete(C.A.definition),s.setTrait(C.A.definition,"name",e.Title),s.setTrait(C.A.definition,"url",this.catalogGroup.url),s._webMapServiceCatalogGroup=this.catalogGroup,s.setTrait(C.A.definition,"getCapabilitiesUrl",this.catalogGroup.getCapabilitiesUrl),s.setTrait(C.A.definition,"getCapabilitiesCacheDuration",this.catalogGroup.getCapabilitiesCacheDuration),s.setTrait(C.A.definition,"layers",e.Name),s.setTrait(C.A.definition,"hideSource",this.catalogGroup.hideSource),s.setTrait(C.A.definition,"isOpenInWorkbench",this.catalogGroup.isOpenInWorkbench),s.setTrait(C.A.definition,"isExperiencingIssues",this.catalogGroup.isExperiencingIssues),s.setTrait(C.A.definition,"hideLegendInWorkbench",this.catalogGroup.hideLegendInWorkbench),null!==(r=this.catalogGroup.perLayerLinkedWcs)&&void 0!==r&&r.linkedWcsUrl&&(0,gi.A)(s,C.A.definition,wi(wi({},this.catalogGroup.traits.perLayerLinkedWcs.toJson(this.catalogGroup.perLayerLinkedWcs)),{},{linkedWcsCoverage:e.Name})).logError("Failed to set `perLayerLinkedWcs` for WMS layer ".concat(e.Title)),s.createGetCapabilitiesStratumFromParent(this.capabilities)}getLayerId(e,t){var r;if((0,n.A)(this.catalogGroup.uniqueId)||(0,n.A)(t))return"".concat(null!=t?t:this.catalogGroup.uniqueId,"/").concat(null!==(r=e.Name)&&void 0!==r?r:e.Title)}getLayerShareKeys(e,t){const r=[];return t!=="".concat(this.catalogGroup.uniqueId,"/").concat(e.Name)&&r.push("".concat(this.catalogGroup.uniqueId,"/").concat(e.Name)),(0,n.A)(e.Name)&&e.Title!==e.Name&&r.push("".concat(this.catalogGroup.uniqueId,"/").concat(e.Title)),r}},Si(fi.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(fi.prototype,"name"),fi.prototype),Si(fi.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(fi.prototype,"info"),fi.prototype),Si(fi.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(fi.prototype,"members"),fi.prototype),Si(fi.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(fi.prototype,"createMembersFromLayers"),fi.prototype),Si(fi.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(fi.prototype,"createMemberFromLayer"),fi.prototype),fi);class Oi extends((0,ci.A)((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(mi)))))){get type(){return Oi.type}async forceLoadMetadata(){let e=this.strata.get(ci.A.getCapabilitiesStratumName);void 0===e&&(e=await xi.load(this),(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)}))}async forceLoadMembers(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);void 0!==e&&await(0,De.A)(()=>e.createMembersFromLayers())}get defaultGetCapabilitiesUrl(){return this.uri?this.uri.clone().setSearch({service:"WMS",version:"1.3.0",request:"GetCapabilities"}).toString():void 0}}function Pi(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ai(Oi,"type","wms-group");class Ti extends((0,pt.Ay)(Zr)){constructor(e,t){super(),this.threddsItemReference=e,this.threddsDataset=t}duplicateLoadableStratum(e){return new Ti(this.threddsItemReference,this.threddsDataset)}static load(e,t){return new Ti(e,t)}get name(){if(void 0!==this.threddsDataset)return this.threddsDataset.name}get url(){if(void 0!==this.threddsDataset)return this.threddsDataset.wmsUrl}}Pi(Ti,"stratumName","threddsDataset"),dt.A.addLoadStratum(Ti.stratumName);class Ii extends((0,Ee.A)((0,Xr.A)((0,g.A)(Zr)))){constructor(){super(...arguments),Pi(this,"_threddsDataset",void 0),Pi(this,"_threddsCatalogGroup",void 0)}get type(){return Ii.type}get typeName(){return Pe.Ay.t("models.threddsItem.name")}setDataset(e){this._threddsDataset=e}setThreddsCatalogGroup(e){this._threddsCatalogGroup=e}setThreddsStrata(e){if(void 0===this._threddsDataset)return;if(void 0!==e.strata.get(Ti.stratumName))return;const t=Ti.load(this,this._threddsDataset);void 0!==t&&(0,i.h5)(()=>{e.strata.set(Ti.stratumName,t)})}passThreddsStrata(e){const t=this.strata.get(Ti.stratumName);void 0!==t&&(0,i.h5)(()=>{e.strata.set(Ti.stratumName,t)})}async forceLoadReference(e){this.setThreddsStrata(this);const t=Qr.A.create(Oi.type,this.uniqueId,this.terria,this);if(void 0!==t)return this.setThreddsStrata(t),t}}var Di,Ci,Ei,_i;function ji(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zi(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}Pi(Ii,"type","thredds-item");let Ni=(Ci=class e extends((0,pt.Ay)(Jr)){constructor(e){super(),this._catalogGroup=e,ji(this,"threddsCatalog",void 0),(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}static async load(t){return new e(t)}get members(){if(void 0===this.threddsCatalog)return[];const e=[];return this.threddsCatalog.catalogs.forEach(t=>{e.push("".concat(this._catalogGroup.uniqueId,"/").concat(t.id))}),this.threddsCatalog.datasets.forEach(t=>{t.catalogs.forEach(t=>{e.push("".concat(this._catalogGroup.uniqueId,"/").concat(t.id))}),e.push("".concat(this._catalogGroup.uniqueId,"/").concat(t.id))}),e}createThreddsCatalog(e){const t="".concat(this._catalogGroup.uniqueId,"/").concat(e.id);let r=this._catalogGroup.terria.getModelById(ki,t);(0,n.A)(r)||(r=new ki(t,this._catalogGroup.terria),this._catalogGroup.terria.addModel(r)),r.setTrait(C.A.definition,"name",e.title),r.setTrait(C.A.definition,"url",e.url)}async createMembers(){if(!(0,n.A)(this._catalogGroup.url))return;const e=(0,ie.Z)(this._catalogGroup,this._catalogGroup.url);if(this.threddsCatalog=await async function(e,t){"proxy"in(t=null==t?{}:t)&&(t.proxy="/"===t.proxy.slice(-1)?t.proxy:t.proxy+"/");const r=new Wr(qr,t,DOMParser);return await async function(e,t){const r=new Hr(e,null,null,t);return await r._loadCatalog(),r}(e,r)}(this._catalogGroup.url,e?{proxy:e}:void 0),void 0!==this.threddsCatalog){for(let e=0;e<this.threddsCatalog.catalogs.length;e++)this.createThreddsCatalog(this.threddsCatalog.catalogs[e]);for(let e=0;e<this.threddsCatalog.datasets.length;e++){const t=this.threddsCatalog.datasets[e];await t.loadAllNestedCatalogs();for(let e=0;e<t.catalogs.length;e++)this.createThreddsCatalog(t.catalogs[e]);if(t.isParentDataset){let e=this._catalogGroup;if(this.threddsCatalog.datasets.length>1){const r="".concat(this._catalogGroup.uniqueId,"/").concat(t.id);let i=this._catalogGroup.terria.getModelById(xe.A,r);(0,n.A)(i)||(i=new xe.A(r,this._catalogGroup.terria),this._catalogGroup.terria.addModel(i)),i.setTrait(C.A.definition,"name",t.name),e=i}t.datasets.forEach(t=>{const r=this.createMemberFromDataset(t);void 0!==r&&e.add(C.A.definition,r)})}else t.supportsWms&&this.createMemberFromDataset(t)}}}createMemberFromDataset(e){if(!(0,n.A)(e.id))return;const t=this._catalogGroup.uniqueId+"/"+e.id;let r=this._catalogGroup.terria.getModelById(Ii,t);return void 0===r&&(r=new Ii(t,this._catalogGroup.terria),r.setTrait(C.A.definition,"isGroup",!0),r.setDataset(e),r.setThreddsStrata(r),r.terria.addModel(r)),r}},ji(Ci,"stratumName","thredds"),zi((Di=Ci).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(Di.prototype,"members"),Di.prototype),zi(Di.prototype,"createThreddsCatalog",[i.XI],Object.getOwnPropertyDescriptor(Di.prototype,"createThreddsCatalog"),Di.prototype),zi(Di.prototype,"createMembers",[i.XI],Object.getOwnPropertyDescriptor(Di.prototype,"createMembers"),Di.prototype),zi(Di.prototype,"createMemberFromDataset",[i.XI],Object.getOwnPropertyDescriptor(Di.prototype,"createMemberFromDataset"),Di.prototype),Di);dt.A.addLoadStratum(Ni.stratumName);let ki=(_i=class e extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Jr))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.thredds.nameGroup")}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}async forceLoadMetadata(){if(!this.strata.get(Ni.stratumName)){const e=await Ni.load(this);if(void 0===e)return;await e.createMembers(),(0,i.h5)(()=>{this.strata.set(Ni.stratumName,e)})}}async forceLoadMembers(){const e=this.strata.get(Ni.stratumName);e&&await e.createMembers()}},ji(_i,"type","thredds-group"),zi((Ei=_i).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(Ei.prototype,"cacheDuration"),Ei.prototype),Ei);var Ri,Mi,Fi,Li,Gi,Ui,Wi,qi=r(51980),Bi=r(77207),Vi=r(57009),Hi=r(86474),$i=r(99773),Ji=r(89346),Xi=r(89170),Ki=r(17618);function Zi(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Qi(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Yi=(Ri=(0,Re.b)({description:"The Carto Map V1 API is soon to be deprecated in favor or Carto Map V3 API (See `CartoMapV3CatalogItem`). The V1 API generates a XYZ-based URL to fetch Web Mercator projected tiles."}),Mi=(0,hr.A)({name:"Config",description:"The configuration information to pass to the Carto Maps API"}),Fi=(0,K.A)({type:"string",name:"Authorization token",description:"The authorization token to pass to the Carto Maps API"}),Ri((Gi=class extends((0,u.A)(Ji.A,Xi.A,d.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),Zi(this,"config",Ui,this),Zi(this,"auth_token",Wi,this)}},Ui=Qi(Gi.prototype,"config",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wi=Qi(Gi.prototype,"auth_token",[Fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=Gi))||Li);var eo,to;function ro(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function io(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class oo extends((0,pt.Ay)(Yi)){constructor(e,t,r){super(),this.catalogItem=e,this.tileUrl=t,this.tileSubdomains=r}duplicateLoadableStratum(e){return new oo(e,this.tileUrl,this.tileSubdomains)}static load(e){const t={};if(e.auth_token&&(t.auth_token=e.auth_token),void 0===e.url)return Promise.reject(new At.Ay({title:"Unable to load Carto Map layer",message:"The Carto Map layer cannot be loaded the catalog item does not have a `url`."}));const r=new Vi.A({url:e.url,headers:{"Content-Type":"application/json"},queryParameters:t});return Promise.resolve().then(()=>r.post(JSON.stringify(e.config||{}))).then(t=>{if(void 0===t)throw new At.Ay({sender:this,title:"Could not load Carto Map layer",message:"There was an error loading the data for this catalog item."});const r=JSON.parse(t);let i,o;const n=r.metadata&&r.metadata.url&&r.metadata.url.raster;if(!n)throw new At.Ay({sender:this,title:"No URL",message:"Unable to find a usable URL for the Carto Map layer."});return i=n.urlTemplate,o=n.subdomains,new oo(e,i,o)})}}io(oo,"stratumName","cartoLoadable"),dt.A.addLoadStratum(oo.stratumName);let no=(to=class e extends((0,$i.Ay)((0,Ee.A)((0,s.A)((0,g.A)(Yi))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get mapItems(){return(0,n.A)(this.imageryProvider)?[{alpha:this.opacity,show:this.show,imageryProvider:this.imageryProvider,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}forceLoadMapItems(){return oo.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(oo.stratumName,e)})})}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}get imageryProvider(){var e,t;const r=this.strata.get(oo.stratumName);if(!(0,n.A)(r)||!(0,n.A)(r.tileUrl))return;let i;return(0,n.A)(r.tileSubdomains)&&(i=r.tileSubdomains.slice()),new Hi.A({url:(0,ie.A)(this,r.tileUrl),maximumLevel:null!==(e=this.maximumLevel)&&void 0!==e?e:25,minimumLevel:null!==(t=this.minimumLevel)&&void 0!==t?t:0,credit:this.attribution,subdomains:i,tileHeight:this.tileHeight,tileWidth:this.tileWidth})}},io(to,"type","carto"),ro((eo=to).prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(eo.prototype,"mapItems"),eo.prototype),ro(eo.prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(eo.prototype,"cacheDuration"),eo.prototype),ro(eo.prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(eo.prototype,"imageryProvider"),eo.prototype),eo);var ao,so,lo,co,uo,po,ho,mo,fo,go,yo,bo,vo,wo,Ao,So,xo,Oo=r(80278),Po=r(86780),To=r(94011);function Io(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Do(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Co=(ao=(0,Re.b)({description:"Calls Carto V3 API to return GeoJSON. It supports the Query API and the Table API.\n\nTo use the Query API - see traits:\n- `cartoQuery`\n- `cartoGeoColumn`\n\nTo use the Table API - see traits:\n- `cartoTableName`\n- `cartoColumns`\n- `cartoGeoColumn`"}),so=(0,K.A)({type:"string",name:"Access token",description:"The access token to pass to the Carto Maps API"}),lo=(0,K.A)({type:"string",name:"Authorization token",description:"The authorization token to pass to the Carto Maps API"}),co=(0,K.A)({type:"string",name:"Base URL",description:'Base URL for Carto API (eg "https://gcp-australia-southeast1.api.carto.com/")'}),uo=(0,K.A)({type:"string",name:"Geo column name",description:"Column name of the geom at the table (used for Table and Query API)"}),po=(0,K.A)({type:"string",name:"Carto SQL Query",description:"Carto SQL Query (used for Query API). If this is defined, then the Query API will be used instead of Table API."}),ho=(0,K.A)({type:"string",name:"Table name",description:'Table fully qualified name - eg "carto-demo-data.demo_tables.airports". (used for Table API). Note if `cartoQuery` defined, then the Query API will be used instead of Table API.'}),mo=(0,mr.A)({type:"string",name:"Column",description:"Columns to retrieve from the layer, by default all are returned. (used for Table API)"}),ao((go=class extends((0,u.A)(Ir.h)){constructor(){super(...arguments),Io(this,"accessToken",yo,this),Io(this,"connectionName",bo,this),Io(this,"baseUrl",vo,this),Io(this,"cartoGeoColumn",wo,this),Io(this,"cartoQuery",Ao,this),Io(this,"cartoTableName",So,this),Io(this,"cartoColumns",xo,this)}},yo=Do(go.prototype,"accessToken",[so],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bo=Do(go.prototype,"connectionName",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"carto_dw"}}),vo=Do(go.prototype,"baseUrl",[co],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://gcp-australia-southeast1.api.carto.com/"}}),wo=Do(go.prototype,"cartoGeoColumn",[uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"geom"}}),Ao=Do(go.prototype,"cartoQuery",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),So=Do(go.prototype,"cartoTableName",[ho],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xo=Do(go.prototype,"cartoColumns",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fo=go))||fo);var Eo,_o,jo,zo,No,ko;function Ro(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Mo(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fo(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Lo=(_o=class e extends((0,pt.Ay)(Ir.h)){constructor(e){super(),this.catalogItem=e,(0,i.Gn)(this)}static load(t){return new e(t)}duplicateLoadableStratum(t){return new e(t)}get styles(){return[(0,ut.A)(Mt.A,{id:"cartodb_id",hidden:!0})]}},Mo(_o,"stratumName","cartoMapV3Stratum"),Fo((Eo=_o).prototype,"styles",[i.EW],Object.getOwnPropertyDescriptor(Eo.prototype,"styles"),Eo.prototype),Eo);dt.A.addLoadStratum(Lo.stratumName);let Go=(ko=class e extends((0,Tr.Ay)((0,g.A)(Co))){constructor(e,t,r){super(e,t,r),Ro(this,"geoJsonUrls",zo,this),Ro(this,"geoJsonSize",No,this),(0,i.Gn)(this),void 0===this.strata.get(Lo.stratumName)&&(0,i.h5)(()=>{this.strata.set(Lo.stratumName,new Lo(this))})}get type(){return e.type}get typeName(){return Pe.Ay.t("models.carto-v3.name")}async forceLoadMetadata(){let e;if(this.cartoQuery){var t;const r=new(Ie())(this.baseUrl).path("").path("v3/maps/".concat(this.connectionName,"/query"));e=null===(t=await Uo(r.toString(),this.accessToken,{q:this.cartoQuery,geo_column:this.cartoGeoColumn}))||void 0===t?void 0:t.throwIfError()}else{if(!this.cartoTableName)throw new At.Ay({title:"Invalid Carto V3 config",message:"`cartoQuery` or `cartoTableName` must be defined"});{var r,o;const t=new(Ie())(this.baseUrl).path("").path("v3/maps/".concat(this.connectionName,"/table")).query({name:this.cartoTableName,columns:null===(r=this.cartoColumns)||void 0===r?void 0:r.join(","),geo_column:this.cartoGeoColumn});e=null===(o=await Uo(t.toString(),this.accessToken))||void 0===o?void 0:o.throwIfError()}}let n=[];if(e&&(0,wt.OW)(e.geojson)&&(0,wt.DG)(e.geojson.url)&&(n=e.geojson.url),0===n.length)throw At.Ay.from("No GeoJSON found.");(0,i.h5)(()=>{var t;e&&(0,wt.OD)(null===(t=e)||void 0===t?void 0:t.size)&&(this.geoJsonSize=e.size),this.geoJsonUrls=n})}async forceLoadGeojsonData(){if(0===this.geoJsonUrls.length)throw At.Ay.from("No GeoJSON URL found for Carto table");let e;const t=await Promise.all(this.geoJsonUrls.map(async t=>{var r;if(e=null===(r=await Uo(t,this.accessToken))||void 0===r?void 0:r.throwIfError(),void 0===e)throw new At.Ay({title:"Failed to load GeoJSON",message:"Failed to load GeoJSON URL ".concat(t)});if((0,wt.OW)(e,!1)&&"string"==typeof e.type){const t=(0,Pr.qX)(e);if(t)return t}throw new At.Ay({title:"Failed to load GeoJSON",message:"Invalid response from GeoJSON URL ".concat(t,":\n\n\n          ```\n          ").concat(JSON.stringify(e),"\n          ```")})})),r=(0,Oo.Lr)([]);return t.forEach(e=>{for(let t=0;t<e.features.length;t++)r.features.push(e.features[t])}),r}},Mo(ko,"type","carto-v3"),zo=Fo((jo=ko).prototype,"geoJsonUrls",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),No=Fo(jo.prototype,"geoJsonSize",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jo);async function Uo(e,t,r){try{return new To.A(await(0,H.A)(e,t?{Authorization:"Bearer ".concat(t)}:{},r))}catch(e){if(e instanceof Po.A)try{const t=(0,wt.Eo)(e.response)?JSON.parse(e.response):e.response;if((0,wt.OW)(t)&&(0,wt.Eo)(t.error)){var i;const r=t;return To.A.error((0,At.mG)(At.Ay.from(e,{title:"Error from Carto API",message:null!==(i=r.message)&&void 0!==i?i:r.error,importance:-1})))}}catch(e){}return To.A.error(e)}}var Wo,qo,Bo=r(2278),Vo=r(88163),Ho=r(57634),$o=r(3991),Jo=r(41104),Xo=r(20183),Ko=r(54016),Zo=r(76826),Qo=r(47395);function Yo(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function en(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const tn="terriajs_search_result";let rn=(qo=class e extends((0,Zo.A)((0,Ko.A)((0,Xo.A)((0,g.A)(Qo.A))))){constructor(){super(...arguments),Yo(this,"type",e.type),Yo(this,"zoomToItemSearchResult",(0,i.XI)(async e=>{if(void 0===this.terria.cesium)return;const t=this.terria.cesium.scene,r=t.camera,{latitudeDegrees:i,longitudeDegrees:o,featureHeight:n}=e.featureCoordinate,a=Ho.A.fromDegrees(o,i),[s]=await(0,$o.A)(t.terrainProvider,[a]).catch(()=>[a]);if(n<20){const e=50;s.height+=n+e;const t=Ho.A.toCartesian(a);r.flyTo({destination:t,orientation:void 0})}else{const e=Ho.A.toCartesian(s),t=new Bo.A(e,2*n);r.flyToBoundingSphere(t)}})),(0,i.Gn)(this)}get typeName(){return Pe.Ay.t("models.cesiumTerrain.name3D")}highlightFeaturesFromItemSearchResults(e){const t=this.tileset;if(void 0===t||0===e.length)return()=>{};const r=new Set(e.map(e=>e.id)),o=e[0].idPropertyName,n=new Set;let a;const s=this._watchForNewTileFeatures(t,async t=>{const i=t.getProperty(o);r.has(i)&&(t.setProperty(tn,!0),n.add(t),1===e.length&&(a=await on(this,t,tn)))}),l="color('".concat(this.highlightColor,"')"),c="${".concat(tn,"} === true");return this.applyColorExpression({condition:c,value:l}),(0,i.XI)(()=>{var e;s(),null===(e=a)||void 0===e||e(),this.removeColorExpression(c),n.forEach(e=>{try{e.setProperty(tn,void 0)}catch(e){}})})}hideFeaturesNotInItemSearchResults(e){const t=this.tileset;if(void 0===t||0===e.length)return()=>{};const r=new Set(e.map(e=>e.id)),o=e[0].idPropertyName,n=new Set,a=this._watchForNewTileFeatures(t,e=>{const t=e.getProperty(o);!1===r.has(t)&&(e.setProperty(tn,!0),n.add(e))}),s="${".concat(tn,"} === true");return this.applyShowExpression({condition:s,show:!1}),(0,i.XI)(()=>{a(),this.removeShowExpression(s),n.forEach(e=>{try{e.setProperty(tn,void 0)}catch(e){}})})}_watchForNewTileFeatures(e,t){const r=new Set,i=e=>{if(r.has(e))return;const i=e.content;for(let e=0;e<i.featuresLength;e++){const r=i.getFeature(e);t(r)}r.add(e)},o=e=>r.delete(e);return e.tileLoad.addEventListener(i),e.tileVisible.addEventListener(i),e.tileUnload.addEventListener(o),()=>{e.tileLoad.removeEventListener(i),e.tileVisible.removeEventListener(i),e.tileUnload.removeEventListener(o)}}},Yo(qo,"type","3d-tiles"),en((Wo=qo).prototype,"highlightFeaturesFromItemSearchResults",[i.XI],Object.getOwnPropertyDescriptor(Wo.prototype,"highlightFeaturesFromItemSearchResults"),Wo.prototype),en(Wo.prototype,"hideFeaturesNotInItemSearchResults",[i.XI],Object.getOwnPropertyDescriptor(Wo.prototype,"hideFeaturesNotInItemSearchResults"),Wo.prototype),Wo);const on=(0,i.XI)(async(e,t,r)=>{var i;const o=new Jo.Ay,n=await e.getFeaturesFromPickResult(new Vo.A,t);if(void 0===n)return()=>{};const a=e.terria;return null===(i=n.properties)||void 0===i||i.removeProperty(r),o.features.push(n),o.isLoading=!1,o.allFeaturesAvailablePromise=Promise.resolve(),a.pickedFeatures=o,()=>{a.pickedFeatures===o&&(a.pickedFeatures=void 0)}});var nn,an=r(42597),sn=r(77409),ln=r(13415);let cn=(0,Re.b)({description:"Creates a Cesium terrain item in the catalog from url.",example:{type:"cesium-terrain",description:"This product is a terrain, it provides a representation of the earth's surface with which to apply data in Digital Twin Victoria. The terrain has been generated by transforming Vicmap Elevation digital elevation models (DEMs) into a quantized-mesh terrain tileset. The combined Vicmap elevation extent is embedded in â€˜Cesium World Terrainâ€™. These DEMs include â€˜Vicmap Elevation DEM 10mâ€™ which provides a base for state-wide coverage. Where available 1m DEMs have been embedded over the â€˜Vicmap Elevation DEM 10mâ€™ product.",url:"https://storage.googleapis.com/vic-datasets-public/85b71982-f5fe-4093-b4e4-fd2e50198fba/v2",name:"A Vic Terrain",id:"some-unique-id"}})(nn=class extends((0,u.A)(d.A,Ki.Ay,_e.Ay,ln.A)){})||nn;var un,pn,dn;function hn(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let mn=(dn=class e extends((0,Ee.A)((0,$i.Ay)((0,s.A)((0,g.A)(cn))))){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"terrainProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,pn,this),(0,i.Gn)(this)}get type(){return e.type}get disableZoomTo(){return!0}get isTerrainActive(){return this.terria.terrainProvider===this.terrainProvider}get shortReport(){if(void 0===super.shortReport){const e=this.isTerrainActive?"In use":"Not in use";return"Terrain status: ".concat(e)}return super.shortReport}loadTerrainProvider(){const e=void 0!==this.ionAssetId?sn.A.fromAssetId(this.ionAssetId,{accessToken:this.ionAccessToken||this.terria.configParameters.cesiumIonAccessToken,server:this.ionServer}):this.url;return void 0===e?Promise.resolve(void 0):an.A.fromUrl(e,{credit:this.attribution})}async forceLoadMapItems(){const e=await this.loadTerrainProvider();(0,i.h5)(()=>{this.terrainProvider=e})}get mapItems(){return this.show&&this.terrainProvider?[this.terrainProvider]:[]}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(dn,"type","cesium-terrain"),pn=hn((un=dn).prototype,"terrainProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),hn(un.prototype,"disableZoomTo",[i.$Z],Object.getOwnPropertyDescriptor(un.prototype,"disableZoomTo"),un.prototype),hn(un.prototype,"isTerrainActive",[i.EW],Object.getOwnPropertyDescriptor(un.prototype,"isTerrainActive"),un.prototype),hn(un.prototype,"shortReport",[i.$Z],Object.getOwnPropertyDescriptor(un.prototype,"shortReport"),un.prototype),hn(un.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(un.prototype,"mapItems"),un.prototype),un);r(53921);var fn,gn,yn,bn,vn,wn,An,Sn,xn,On,Pn,Tn,In,Dn,Cn,En,_n,jn,zn,Nn,kn=r(78588),Rn=r(93657),Mn=r(65572);function Fn(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Ln(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Gn=(fn=(0,K.A)({type:"number",name:"No Data Value",description:"No data value, default read from tiff meta"}),gn=(0,K.A)({type:"boolean",name:"Convert to RGB",description:"Try to render multi band cog to RGB, priority 1"}),yn=(0,K.A)({type:"string",name:"Resample Method",description:"Geotiff resample method. Defaults to `bilinear`."}),bn=class extends ze.A{constructor(){super(...arguments),Fn(this,"nodata",vn,this),Fn(this,"convertToRGB",wn,this),Fn(this,"resampleMethod",An,this)}},vn=Ln(bn.prototype,"nodata",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wn=Ln(bn.prototype,"convertToRGB",[gn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Ln(bn.prototype,"resampleMethod",[yn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"nearest"}}),bn),Un=(Sn=(0,Re.b)({description:"Creates a Cloud Optimised Geotiff item in the catalog from a url pointing to a TIFF that is a valid COG.",example:{name:"COG Test Uluru",description:"This is a COG from Sentinel-2 L2A, in EPSG:32752. Does it display in correct location? Does it display correctly?",type:"cog",url:"https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/52/J/FS/2023/5/S2A_52JFS_20230501_0_L2A/TCI.tif"}}),xn=(0,Pt.A)({type:Gn,name:"Render Options",description:"Render options for COGs"}),On=(0,K.A)({type:"string",name:"Credit",description:"Credit for the imagery provider."}),Pn=(0,K.A)({type:"number",name:"Tile Size",description:"The size of the tile."}),Tn=(0,K.A)({type:"boolean",name:"Has Alpha Channel",description:"Whether the imagery has an alpha channel."}),In=(0,K.A)({type:"number",name:"Cache",description:"Cache survival time in milliseconds."}),Sn((Cn=class extends((0,u.A)(Ji.A,Xi.A,d.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),Fn(this,"renderOptions",En,this),Fn(this,"credit",_n,this),Fn(this,"tileSize",jn,this),Fn(this,"hasAlphaChannel",zn,this),Fn(this,"cache",Nn,this)}},En=Ln(Cn.prototype,"renderOptions",[xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Ln(Cn.prototype,"credit",[On],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=Ln(Cn.prototype,"tileSize",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Ln(Cn.prototype,"hasAlphaChannel",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=Ln(Cn.prototype,"cache",[In],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Cn))||Dn);var Wn,qn,Bn,Vn,Hn;function $n(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jn(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Xn=(qn=class e extends((0,pt.Ay)(Un)){constructor(e){super(),this.model=e,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}get shortReport(){var e,t,r;return"Leaflet"===this.model.terria.currentViewer.type?Pe.Ay.t("models.commonModelErrors.3dTypeIn2dMode",this):null!==(e=this.model._imageryProvider)&&void 0!==e&&e.tilingScheme&&(r=null===(t=this.model._imageryProvider)||void 0===t?void 0:t.tilingScheme).constructor!==Mn.A&&r.constructor!==kn.A?Pe.Ay.t("models.cogCatalogItem.experimentalReprojectionWarning",this):void 0}get rectangle(){var e;const t=null===(e=this.model._imageryProvider)||void 0===e?void 0:e.rectangle;if(!t)return;const{west:r,south:i,east:o,north:n}=t;return{west:Rn.A.toDegrees(r),south:Rn.A.toDegrees(i),east:Rn.A.toDegrees(o),north:Rn.A.toDegrees(n)}}},$n(qn,"stratumName","cog-loadable-stratum"),Jn((Wn=qn).prototype,"shortReport",[i.EW],Object.getOwnPropertyDescriptor(Wn.prototype,"shortReport"),Wn.prototype),Jn(Wn.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(Wn.prototype,"rectangle"),Wn.prototype),Wn);dt.A.addLoadStratum(Xn.stratumName);let Kn=(Hn=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(Un)))){get type(){return e.type}constructor(e,t,r){super(e,t,r),function(e,t,r,i){r&&Object.defineProperty(e,"_imageryProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,Vn,this),$n(this,"reprojector",Zn),(0,i.Gn)(this),this.strata.set(Xn.stratumName,new Xn(this)),(0,i.q$)(this,"mapItems",()=>{this._imageryProvider&&(this._imageryProvider.destroy(),this._imageryProvider=void 0)}),(0,i.tC)(this,"mapItems",()=>{this._imageryProvider||this.isLoadingMapItems||this.loadMapItems(!0)})}async forceLoadMapItems(){if(!this.url)return;const e=(0,ie.A)(this,this.url),t=await this.createImageryProvider(e);(0,i.h5)(()=>{this._imageryProvider=t})}get mapItems(){const e=this._imageryProvider;return e?[{show:this.show,alpha:this.opacity,imageryProvider:e,clippingRectangle:this.cesiumRectangle}]:[]}async createImageryProvider(e){const[{default:t},{default:o}]=await Promise.all([Promise.all([r.e(662),r.e(283)]).then(r.bind(r,41281)),r.e(873).then(r.t.bind(r,85873,23))]);return(0,i.h5)(()=>{return t.fromUrl(e,{credit:this.credit,tileSize:this.tileSize,maximumLevel:this.maximumLevel,minimumLevel:this.minimumLevel,enablePickFeatures:this.allowFeaturePicking,hasAlphaChannel:this.hasAlphaChannel,projFunc:this.reprojector(o),renderOptions:(r={nodata:this.renderOptions.nodata,convertToRGB:this.renderOptions.convertToRGB,resampleMethod:this.renderOptions.resampleMethod},Object.fromEntries(Object.entries(r).filter(e=>{let[t,r]=e;return void 0!==r})))});var r})}},$n(Hn,"type","cog"),Vn=Jn((Bn=Hn).prototype,"_imageryProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jn(Bn.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Bn.prototype,"mapItems"),Bn.prototype),Bn);function Zn(e){return t=>{if(![4326,3857,900913].includes(t))try{const r=e("EPSG:4326","EPSG:".concat(t));if(r)return{project:r.forward,unproject:r.inverse}}catch(e){console.error(e)}}}var Qn=r(87137),Yn=r(26170),ea=r(23618),ta=r(71645),ra=r(93041),ia=r(29001);let oa;const na=function(e){return(0,ia.A)(e).then(function(e){if(oa||(oa=new DOMParser),!e)return;const t=oa.parseFromString(e,"application/xml");if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length>0)throw new ta.A(Pe.Ay.t("core.readXml.xmlError"));return t})};var aa=r(56870),sa=(r(42762),{point:function(e){return{type:"Point",coordinates:ca(e.textContent.trim())[0]}},line:function(e){return{type:"LineString",coordinates:ca(e.textContent)}},polygon:function(e){return{type:"Polygon",coordinates:[ca(e.textContent.trim())]}},box:function(e){var t=e.textContent.trim().split(/\s+/).filter(la);if(4!==t.length)throw new ta.A("geometry not valid");var r=parseFloat(t[0]),i=parseFloat(t[1]),o=parseFloat(t[2]),n=parseFloat(t[3]);return{type:"Polygon",coordinates:[[[i,r],[i,o],[n,o],[n,r],[i,r]]]}}});function la(e){return 0!==e.length}function ca(e){for(var t=e.split(/\s+/).filter(la),r=[],i=0;i<t.length;i+=2)r.push([parseFloat(t[i+1]),parseFloat(t[i])]);return r}const ua="http://www.opengis.net/gml";function pa(e){for(var t=[],r=e.getElementsByTagNameNS(ua,"posList"),i=0;i<r.length;++i)for(var o=fa(r[i].textContent.trim()),n=0;n<o.length;++n)t.push(o[n]);return{type:"LineString",coordinates:t}}function da(e){var t=[],r=e.getElementsByTagNameNS(ua,"exterior");if(r.length<1)throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.missingExteriorRing"));var i=r[0].getElementsByTagNameNS(ua,"posList");if(i.length<1)throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.missingPosList"));t.push(fa(i[0].textContent));for(var o=e.getElementsByTagNameNS(ua,"interior"),n=0;n<o.length;++n){var a=o[n].getElementsByTagNameNS(ua,"posList");a.length<1||t.push(fa(a[0].textContent))}return{type:"Polygon",coordinates:t}}var ha={Curve:pa,LineString:pa,Point:function(e){var t=e.getElementsByTagNameNS(ua,"pos");if(t.length<1)throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.missingPos"));return{type:"Point",coordinates:fa(t[0].textContent)[0]}},Polygon:da,MultiCurve:function(e){for(var t=e.getElementsByTagNameNS(ua,"posList"),r=[],i=0;i<t.length;++i)r.push(fa(t[i].textContent));return{type:"MultiLineString",coordinates:r}},MultiPoint:function(e){for(var t=e.getElementsByTagNameNS(ua,"pos"),r=[],i=0;i<t.length;++i)r.push(fa(t[i].textContent)[0]);return{type:"MultiPoint",coordinates:r}},MultiSurface:function(e){for(var t=[],r=e.getElementsByTagNameNS(ua,"Polygon"),i=0;i<r.length;++i){var o=r[i],n=o.getElementsByTagNameNS(ua,"exterior");if(n.length<1)throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.missingExteriorRing"));var a=[],s=n[0].getElementsByTagNameNS(ua,"posList");if(s.length<1)throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.missingPosList"));a.push(fa(s[0].textContent));for(var l=o.getElementsByTagNameNS(ua,"interior"),c=0;c<l.length;++c){var u=l[c].getElementsByTagNameNS(ua,"posList");u.length<1||a.push(fa(u[0].textContent))}t.push(a)}return{type:"MultiPolygon",coordinates:t}},Surface:da,Envelope:function(e){const t=e.getElementsByTagNameNS(ua,"lowerCorner"),r=e.getElementsByTagNameNS(ua,"upperCorner"),i=fa(t[0].textContent)[0],o=fa(r[0].textContent)[0],n=i[0],a=i[1],s=o[0],l=o[1];return{type:"Polygon",coordinates:[[[n,a],[n,l],[s,l],[s,a],[n,a]]]}}};function ma(e){return 0!==e.length}function fa(e){for(var t=e.split(/[ ,]+/).filter(ma),r=[],i=0;i<t.length;i+=2)r.push([parseFloat(t[i+1]),parseFloat(t[i])]);return r}const ga=function(e){var t=e.localName,r=ha[t];if(!(0,aa.A)(r))throw new ta.A(Pe.Ay.t("map.gmlToGeoJson.containsUnsupportedFeatureType",{type:t}));return r(e)};var ya={Point:function(e){var t=e.getElementsByTagNameNS("*","lat")[0].textContent,r=e.getElementsByTagNameNS("*","long")[0].textContent;return{type:"Point",coordinates:[parseFloat(r),parseFloat(t)]}}};var ba,va,wa,Aa,Sa,xa=["Curve","LineString","Point","Polygon","MultiCurve","MultiPoint","MultiSurface","Surface","Envelope"],Oa=["where"],Pa=["Point"],Ta=["point","line","polygon","box"];function Ia(e,t){for(var r=!1,i=0;i<e.childNodes.length;++i){var o=e.childNodes[i];Oa.indexOf(o.localName)>=0||Ta.indexOf(o.localName)>=0||Pa.indexOf(o.localName)>=0?r=!0:o.hasChildNodes()&&o.nodeType===Node.ELEMENT_NODE&&(t[o.localName]=o.textContent)}return r}function Da(e){for(var t,r=0;!(0,aa.A)(t)&&r<e.childNodes.length;++r){var i=e.childNodes[r];if(Oa.indexOf(i.localName)>=0)return Ca(i);if(Ta.indexOf(i.localName)>=0)return _a(i);if(Pa.indexOf(i.localName)>=0)return ja(i);t=Da(i)}return t}function Ca(e){for(var t,r=0;!(0,aa.A)(t)&&r<e.childNodes.length;++r){var i=e.childNodes[r];if(xa.indexOf(i.localName)>=0)return Ea(i);if(Ta.indexOf(i.localName)>=0)return _a(i);t=Ca(i)}}function Ea(e){return ga(e)}function _a(e){return function(e){var t=e.localName,r=sa[t];if(!(0,aa.A)(r))throw new ta.A(Pe.Ay.t("map.geoRssToGeoJson.containsUnsupportedFeatureType",{type:t}));return r(e)}(e)}function ja(e){return function(e){var t="Point",r=ya[t];if(!(0,aa.A)(r))throw new ta.A(Pe.Ay.t("map.w3cToGeoJson.containsUnsupportedFeatureType",{type:t}));return r(e)}(e)}function za(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Na(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let ka=(ba=(0,K.A)({type:"boolean",name:"Clamp to Ground",description:"Whether the features in this service should be clamped to the terrain surface."}),va=(0,K.A)({type:"string",name:"geoRssString",description:"A GeoRSSstring"}),wa=class extends((0,u.A)(d.A,Ki.Ay,_e.Ay,Ir.h,ke.A)){constructor(){super(...arguments),za(this,"clampToGround",Aa,this),za(this,"geoRssString",Sa,this)}},Aa=Na(wa.prototype,"clampToGround",[ba],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sa=Na(wa.prototype,"geoRssString",[va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wa);var Ra,Ma,Fa,La;function Ga(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ua(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}var Wa=function(e){return e.RSS="rss",e.ATOM="feed",e}(Wa||{});let qa=(Ma=class e extends((0,pt.Ay)(ka)){constructor(e,t){super(),this._item=e,this._feed=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._feed)}get name(){return this._feed&&this._feed.title&&this._feed.title.length>0?ti(this._feed.title):super.name}get dataCustodian(){if(this._feed&&this._feed.author&&this._feed.author.name&&this._feed.author.name.length>0)return this._feed.author.name}get info(){var e,t,r,i;return this._feed?[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.subtitle"),content:this._feed.subtitle}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.updated"),content:null===(e=this._feed.updated)||void 0===e?void 0:e.toString()}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.category"),content:null===(t=this._feed.category)||void 0===t?void 0:t.join(", ")}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.description"),content:this._feed.description}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.copyrightText"),content:this._feed.copyright}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.author"),content:null===(r=this._feed.author)||void 0===r?void 0:r.name}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.georss.link"),content:"string"==typeof this._feed.link?this._feed.link:null===(i=this._feed.link)||void 0===i?void 0:i.join(", ")})]:[]}},Ga(Ma,"stratumName","georss"),Ua((Ra=Ma).prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(Ra.prototype,"name"),Ra.prototype),Ua(Ra.prototype,"dataCustodian",[i.EW],Object.getOwnPropertyDescriptor(Ra.prototype,"dataCustodian"),Ra.prototype),Ua(Ra.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(Ra.prototype,"info"),Ra.prototype),Ra);dt.A.addLoadStratum(qa.stratumName);let Ba=(La=class e extends((0,Tr.Ay)((0,g.A)(ka))){constructor(){super(...arguments),Ga(this,"_georssFile",void 0),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.georss.name")}setFileInput(e){this._georssFile=e}get hasLocalData(){return(0,n.A)(this._georssFile)}parseGeorss(e){const t=e.documentElement;let r,o;if(t.localName.includes(Wa.ATOM))o=Va(t.childNodes,this),r=function(e){"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=[];const r=e.documentElement.getElementsByTagName("entry");for(var i=0;i<r.length;++i){var o=r[i],n={};if(Ia(o,n)){var a={type:"Feature",properties:n,geometry:Da(o)};t.push(a)}}return{type:"FeatureCollection",crs:{type:"EPSG",properties:{code:"4326"}},features:t}}(e);else{if(t.localName!==Wa.RSS)throw new ta.A("document is not valid");{const i=t.getElementsByTagName("channel")[0];o=Va(i.childNodes,this),r=function(e){"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=[];const r=e.documentElement.getElementsByTagName("channel")[0].getElementsByTagName("item");for(var i=0;i<r.length;++i){var o=r[i],n={};if(Ia(o,n)){var a={type:"Feature",properties:n,geometry:Da(o)};t.push(a)}}return{type:"FeatureCollection",crs:{type:"EPSG",properties:{code:"4326"}},features:t}}(e)}}return(0,i.h5)(()=>{this.strata.set(qa.stratumName,new qa(this,o))}),r}async forceLoadGeojsonData(){let e;if((0,n.A)(this.geoRssString)?e=(new DOMParser).parseFromString(this.geoRssString,"text/xml"):(0,n.A)(this._georssFile)?e=await na(this._georssFile):(0,n.A)(this.url)&&(e=await(0,ra.A)((0,ie.A)(this,this.url))),!e)throw(0,At.mG)({sender:this,title:Pe.Ay.t("models.georss.errorLoadingTitle"),message:Pe.Ay.t("models.georss.errorLoadingMessage",{appName:this.terria.appName})});return this.parseGeorss(e)}forceLoadMetadata(){return Promise.resolve()}},Ga(La,"type","georss"),Ua((Fa=La).prototype,"hasLocalData",[i.EW],Object.getOwnPropertyDescriptor(Fa.prototype,"hasLocalData"),Fa.prototype),Fa);function Va(e,t){const r={link:[],category:[]};for(let t=0;t<e.length;++t){const i=e[t];if(1===i.nodeType&&"item"!==i.localName&&"entry"!==i.localName)if("id"===i.localName)r.id=i.textContent||void 0;else if("title"===i.localName)r.title=i.textContent||void 0;else if("subtitle"===i.localName)r.subtitle=i.textContent||void 0;else if("description"===i.localName)r.description=i.textContent||void 0;else if("category"===i.localName)i.textContent&&r.category.push(i.textContent);else if("link"===i.localName)if(i.textContent)r.link.push(i.textContent);else{const e=i.getAttribute("href");e&&r.link.push(e)}else if("updated"===i.localName)r.updated=i.textContent||void 0;else if("rights"===i.localName||"copyright"===i.localName)r.copyright=i.textContent||void 0;else if("author"===i.localName){const e=i.childNodes;if(0===e.length)r.author={name:i.textContent||void 0};else{let t,i,o;for(let r=0;r<e.length;++r){const n=e[r];1===n.nodeType&&("name"===n.localName?t=n.textContent||void 0:"email"===n.localName&&(i=n.textContent||void 0),"link"===n.localName&&(o=n.textContent||void 0))}r.author={name:t,email:i,link:o}}}}return!t.url||(0,n.A)(r.title)&&r.title!==t.url||(r.title=(0,ea.A)(t.url)),r}var Ha,$a,Ja,Xa=r(79399),Ka=r.n(Xa),Za=r(38429);let Qa=(Ha=(0,K.A)({type:"string",name:"GPX String",description:"A GPX string."}),$a=class extends((0,u.A)(Ir.h,_e.Ay,ke.A)){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"gpxString",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,Ja,this)}},Ja=function(e,t,r,i){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}($a.prototype,"gpxString",[Ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$a);var Ya,es;function ts(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rs(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const is=(es=class e extends((0,Tr.Ay)((0,g.A)(Qa))){constructor(){super(...arguments),ts(this,"_gpxFile",void 0),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.gpx.name")}setFileInput(e){this._gpxFile=e}get hasLocalData(){return(0,n.A)(this._gpxFile)}loadGpxText(e){const t=(new DOMParser).parseFromString(e,"text/xml");return Ka().gpx(t)}async forceLoadGeojsonData(){let e;if((0,n.A)(this.gpxString)?e=this.gpxString:(0,n.A)(this._gpxFile)?e=await(0,ia.A)(this._gpxFile):(0,n.A)(this.url)&&(e=await(0,Za.A)((0,ie.A)(this,this.url))),!e)throw(0,At.mG)({sender:this,title:Pe.Ay.t("models.gpx.errorLoadingTitle"),message:Pe.Ay.t("models.gpx.errorLoadingMessage",{appName:this.terria.appName})});return this.loadGpxText(e)}forceLoadMetadata(){return Promise.resolve()}get name(){return this.url&&super.name===this.url?(0,ea.A)(this.url):super.name}},ts(es,"type","gpx"),rs((Ya=es).prototype,"hasLocalData",[i.EW],Object.getOwnPropertyDescriptor(Ya.prototype,"hasLocalData"),Ya.prototype),rs(Ya.prototype,"name",[i.$Z],Object.getOwnPropertyDescriptor(Ya.prototype,"name"),Ya.prototype),Ya);var os,ns,as,ss,ls;function cs(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function us(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let ps=(os=(0,K.A)({type:"string",name:"Terrain URL",description:"URL to construct ArcGISTiledElevationTerrainProvider for I3S geometry."}),ns=(0,mr.A)({type:"number",name:"Image based lighting factor",description:"Cartesian2 of lighting factor for imageBasedLightingFactor"}),as=class extends ze.A{constructor(){super(...arguments),cs(this,"terrainURL",ss,this),cs(this,"lightingFactor",ls,this)}},ss=us(as.prototype,"terrainURL",[os],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls=us(as.prototype,"lightingFactor",[ns],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as);var ds;let hs=(0,Re.b)({description:"Creates an I3S item in the catalog from an slpk.",example:{type:"I3S",name:"CoM Melbourne 3D Photo Mesh",id:"some-unique-id"}})(ds=class extends((0,u.A)(Qo.A,ps)){})||ds;var ms=r(17179),fs=(r(9391),r(93246)),gs=r(89997),ys=r(41006),bs=r(15639),vs=r(30197),ws=r(10640),As=r(90430),Ss=r(76770),xs=r(81501),Os=r(80266),Ps=r(1783),Ts=r(5820),Is=r(60198);function Ds(e){var t;this.ellipsoid=null!==(t=e.ellipsoid)&&void 0!==t?t:ys.A.default,this.credit=void 0,this.tilingScheme=void 0,this.height=void 0,this.width=void 0,this.encoding=void 0,this.lodCount=void 0,this.hasAvailability=!1,this.tilesAvailable=void 0,this.tilesAvailabilityLoaded=void 0,this.levelZeroMaximumGeometricError=void 0,this.terrainDataStructure=void 0}function Cs(e){e=null!=e?e:gs.A.EMPTY_OBJECT,this._resource=void 0,this._credit=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._maxLevel=void 0,this._terrainDataStructure=void 0,this._width=void 0,this._height=void 0,this._encoding=void 0,this._lodCount=void 0,this._hasAvailability=!1,this._tilesAvailable=void 0,this._tilesAvailabilityLoaded=void 0,this._availableCache={},this._errorEvent=new bs.A}function Es(e,t,r,i){if(!e._hasAvailability)return;const o=e._tilesAvailabilityLoaded,n=e._tilesAvailable;return!(t>e._lodCount)&&(!!n.isTileAvailable(t,r,i)||!o.isTileAvailable(t,r,i)&&void 0)}function _s(e,t,r,i){const o=t-1,n=r-1,a=i[e.y*t+e.x],s=[],l={startX:e.x,startY:e.y,endX:0,endY:0},c=new Vo.A(e.x+1,e.y+1);let u=!1,p=!1;for(;!u||!p;){let r=c.x;const d=p?c.y+1:c.y;if(!u){for(let r=e.y;r<d;++r)if(i[r*t+c.x]!==a){u=!0;break}u?(s.push(new Vo.A(c.x,e.y)),--c.x,--r,l.endX=c.x):c.x===o?(l.endX=c.x,u=!0):++c.x}if(!p){const o=c.y*t;for(let t=e.x;t<=r;++t)if(i[o+t]!==a){p=!0;break}p?(s.push(new Vo.A(e.x,c.y)),--c.y,l.endY=c.y):c.y===n?(l.endY=c.y,p=!0):++c.y}}return{endingIndices:s,range:l,value:a}}function js(e,t,r,i){if(!e._hasAvailability)return{};const o=128*Math.floor(r/128),n=128*Math.floor(i/128),a=Math.min(1<<t,128),s="tilemap/".concat(t,"/").concat(n,"/").concat(o,"/").concat(a,"/").concat(a),l=e._availableCache;if((0,aa.A)(l[s]))return l[s];const c=new Ss.A({throttle:!1,throttleByServer:!0,type:Os.A.TERRAIN});let u=e._resource.getDerivedResource({url:s,request:c}).fetchJson();return(0,aa.A)(u)?(u=u.then(function(s){const l=function(e,t,r,i,o){const n=[];if(o.every(function(e){return e===o[0]}))return 1===o[0]&&n.push({startX:e,startY:t,endX:e+r-1,endY:t+i-1}),n;let a=[new Vo.A(0,0)];for(;a.length>0;){const s=_s(a.pop(),r,i,o);if(1===s.value){const r=s.range;r.startX+=e,r.endX+=e,r.startY+=t,r.endY+=t,n.push(r)}const l=s.endingIndices;l.length>0&&(a=a.concat(l))}return n}(o,n,a,a,s.data);e._tilesAvailabilityLoaded.addAvailableTileRange(t,o,n,o+a,n+a);const c=e._tilesAvailable;for(let e=0;e<l.length;++e){const r=l[e];c.addAvailableTileRange(t,r.startX,r.startY,r.endX,r.endY)}return Es(e,t,r,i)}),l[s]={promise:u,request:c},u=u.finally(function(e){return delete l[s],e}),{promise:u,request:c}):{}}Ds.prototype.build=function(e){e._credit=this.credit,e._tilingScheme=this.tilingScheme,e._height=this.height,e._width=this.width,e._encoding=this.encoding,e._lodCount=this.lodCount,e._hasAvailability=this.hasAvailability,e._tilesAvailable=this.tilesAvailable,e._tilesAvailabilityLoaded=this.tilesAvailabilityLoaded,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._terrainDataStructure=this.terrainDataStructure},Object.defineProperties(Cs.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){return this._tilesAvailable}}}),Cs.fromUrl=async function(e,t){t=null!=t?t:gs.A.EMPTY_OBJECT,e=await Promise.resolve(e);let r=Vi.A.createIfNeeded(e);r.appendForwardSlash(),(0,aa.A)(t.token)&&(r=r.getDerivedResource({queryParameters:{token:t.token}}));const i=r.getDerivedResource({queryParameters:{f:"pjson"}}),o=new Ds(t);await async function(e,t,r){try{!function(e,t){var r;const i=t.copyrightText;(0,aa.A)(i)&&(e.credit=new fs.A(i));const o=t.spatialReference,n=null!==(r=o.latestWkid)&&void 0!==r?r:o.wkid,a=t.extent,s={ellipsoid:e.ellipsoid};if(4326===n)s.rectangle=As.A.fromDegrees(a.xmin,a.ymin,a.xmax,a.ymax),e.tilingScheme=new kn.A(s);else{if(3857!==n)throw new ta.A("Invalid spatial reference");{const r=Math.PI*e.ellipsoid.maximumRadius;t.extent.xmax>r&&(t.extent.xmax=r),t.extent.ymax>r&&(t.extent.ymax=r),t.extent.xmin<-r&&(t.extent.xmin=-r),t.extent.ymin<-r&&(t.extent.ymin=-r),s.rectangleSouthwestInMeters=new Vo.A(a.xmin,a.ymin),s.rectangleNortheastInMeters=new Vo.A(a.xmax,a.ymax),e.tilingScheme=new Mn.A(s)}}const l=t.tileInfo;if(!(0,aa.A)(l))throw new ta.A("tileInfo is required");e.width=l.rows+1,e.height=l.cols+1,e.encoding="LERC"===l.format?vs.A.LERC:vs.A.NONE,e.lodCount=l.lods.length-1,(e.hasAvailability=-1!==t.capabilities.indexOf("Tilemap"))&&(e.tilesAvailable=new Ts.A(e.tilingScheme,e.lodCount),e.tilesAvailable.addAvailableTileRange(0,0,0,e.tilingScheme.getNumberOfXTilesAtLevel(0),e.tilingScheme.getNumberOfYTilesAtLevel(0)),e.tilesAvailabilityLoaded=new Ts.A(e.tilingScheme,e.lodCount)),e.levelZeroMaximumGeometricError=Ps.A.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.width,e.tilingScheme.getNumberOfXTilesAtLevel(0)),t.bandCount>1&&console.log("ArcGISTiledElevationTerrainProvider: Terrain data has more than 1 band. Using the first one."),(0,aa.A)(t.minValues)&&(0,aa.A)(t.maxValues)?e.terrainDataStructure={elementMultiplier:1,lowestEncodedHeight:t.minValues[0],highestEncodedHeight:t.maxValues[0]}:e.terrainDataStructure={elementMultiplier:1}}(e,await t.fetchJson())}catch(e){const i="An error occurred while accessing ".concat(t,".");throw Is.A.reportError(void 0,r,(0,aa.A)(r)?r._errorEvent:void 0,i),e}}(o,i);const n=new Cs(t);return o.build(n),n._resource=r,n},Cs.prototype.requestTileGeometry=function(e,t,r,i){const o=this._resource.getDerivedResource({url:"tile/".concat(r,"/").concat(t,"/").concat(e),request:i}),n=this._hasAvailability;let a,s=Promise.resolve(!0);if(n&&!(0,aa.A)(Es(this,r+1,2*e,2*t))){const i=js(this,r+1,2*e,2*t);s=i.promise,a=i.request}const l=o.fetchArrayBuffer();if(!(0,aa.A)(l)||!(0,aa.A)(s))return;const c=this,u=this._tilesAvailable;return Promise.all([l,s]).then(function(i){return new ws.A({buffer:i[0],width:c._width,height:c._height,childTileMask:n?u.computeChildMaskForTile(r,e,t):15,structure:c._terrainDataStructure,encoding:c._encoding})}).catch(async function(e){if((0,aa.A)(a)&&a.state===xs.A.CANCELLED){i.cancel();try{var t;await(null===(t=i.deferred)||void 0===t?void 0:t.promise)}catch(e){}return i.state=xs.A.CANCELLED,Promise.reject(e)}return Promise.reject(e)})},Cs.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},Cs.prototype.getTileDataAvailable=function(e,t,r){if(!this._hasAvailability)return;const i=Es(this,r,e,t);if((0,aa.A)(i))return i;js(this,r,e,t)},Cs.prototype.loadTileDataAvailability=function(e,t,r){};const zs=Cs;var Ns,ks,Rs,Ms=r(4767),Fs=r(75111),Ls=r(34398),Gs=r(92418);function Us(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ws(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let qs=(Rs=class e extends((0,Ms.A)((0,Ko.A)((0,Fs.A)((0,$i.Ay)((0,Ee.A)((0,s.A)((0,g.A)(hs)))))))){constructor(){super(...arguments),Us(this,"type",e.type),function(e,t,r,i){r&&Object.defineProperty(e,"dataProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,ks,this),(0,i.Gn)(this)}get boundingSphere(){var e;if(null!==(e=this.dataProvider)&&void 0!==e&&e.layers)return Bo.A.fromBoundingSpheres(this.dataProvider.layers.map(e=>{var t;return null===(t=e.tileset)||void 0===t?void 0:t.boundingSphere}).filter(n.A))}async forceLoadMapItems(){if(!(0,n.A)(this.url))throw"`url` is not defined for ".concat((0,s.m)(this));const e=await ms.A.fromUrl(this.url,{showFeatures:this.allowFeaturePicking,geoidTiledTerrainProvider:this.terrainURL?await zs.fromUrl(this.terrainURL):void 0});(0,i.h5)(()=>{this.dataProvider=e})}buildFeatureFromPickResult(e,t){if(this.allowFeaturePicking&&(0,n.A)(t.content)&&(0,n.A)(t.content.tile.i3sNode)&&(0,n.A)(t.featureId)&&e){const e=t.content.tile.i3sNode;return e.loadFields().then(()=>{const r=e.getFieldsForFeature(t.featureId),i=new Gs.A({properties:r});return i._cesium3DTileFeature=t,i})}}get mapItems(){return this.isLoadingMapItems||!(0,n.A)(this.dataProvider)?[]:(this.dataProvider.isDestroyed()&&this.forceLoadMapItems(),this.dataProvider&&(this.dataProvider.show=this.show,this.dataProvider.layers.forEach(e=>{const t=e.tileset;if(t){t.style=(0,i.HO)(this.cesiumTileStyle),t.shadows=this.cesiumShadows,t._catalogItem=this,this.lightingFactor&&t.imageBasedLighting&&(t.imageBasedLighting.imageBasedLightingFactor=new Vo.A(...this.lightingFactor));const e=this.colorBlendMode,r=Ls.A[e];void 0!==r&&(t.colorBlendMode=r),t.colorBlendAmount=this.colorBlendAmount}})),[this.dataProvider])}get shortReport(){return"Leaflet"===this.terria.currentViewer.type?Pe.Ay.t("models.commonModelErrors.3dTypeIn2dMode",this):super.shortReport}get typeName(){return Pe.Ay.t("core.dataType.i3s")}},Us(Rs,"type","i3s"),ks=Ws((Ns=Rs).prototype,"dataProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ws(Ns.prototype,"boundingSphere",[i.EW],Object.getOwnPropertyDescriptor(Ns.prototype,"boundingSphere"),Ns.prototype),Ws(Ns.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Ns.prototype,"mapItems"),Ns.prototype),Ws(Ns.prototype,"shortReport",[i.$Z],Object.getOwnPropertyDescriptor(Ns.prototype,"shortReport"),Ns.prototype),Ns);var Bs,Vs,Hs,$s,Js,Xs,Ks,Zs=r(80938);function Qs(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Ys(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let el=(Bs=(0,K.A)({name:"Ion Asset ID",description:"ID of the Cesium Ion asset to access.",type:"number"}),Vs=(0,K.A)({name:"Ion Access Token",description:"Cesium Ion access token to use to access the imagery.",type:"string"}),Hs=(0,K.A)({name:"Ion Server",description:"URL of the Cesium Ion API server.",type:"string"}),$s=class extends((0,u.A)(Ji.A,Xi.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),Qs(this,"ionAssetId",Js,this),Qs(this,"ionAccessToken",Xs,this),Qs(this,"ionServer",Ks,this)}},Js=Ys($s.prototype,"ionAssetId",[Bs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xs=Ys($s.prototype,"ionAccessToken",[Vs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ks=Ys($s.prototype,"ionServer",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$s);var tl,rl,il;function ol(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let nl=(il=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(el)))){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"_imageryProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,rl,this),(0,i.Gn)(this)}get type(){return e.type}forceLoadMapItems(){if(!(0,n.A)(this.ionAssetId))return Promise.resolve();const e=this.attribution;return Zs.A.fromAssetId(this.ionAssetId,{accessToken:this.ionAccessToken||this.terria.configParameters.cesiumIonAccessToken,server:this.ionServer}).then(t=>{e&&(t._credit=e),(0,i.h5)(()=>{this._imageryProvider=t})}).catch(e=>{throw this._imageryProvider=void 0,e})}get mapItems(){return(0,n.A)(this._imageryProvider)?[{show:this.show,alpha:this.opacity,imageryProvider:this._imageryProvider,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(il,"type","ion-imagery"),rl=ol((tl=il).prototype,"_imageryProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol(tl.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(tl.prototype,"mapItems"),tl.prototype),tl);r(54743),r(11745);var al=r(81775),sl=r(26211),ll=r(70894),cl=r(72554),ul=r(90172),pl=r(9280),dl=r(96419),hl=r(66406),ml=r(79764),fl=r(70466),gl=r(70571),yl=r(48506),bl=r(93731),vl=r(55746),wl=r(39228),Al=r(94783),Sl=r(29616),xl=r(79113),Ol=r(52828),Pl=r(50377),Tl=r(46274),Il=r(24629),Dl=r(6143),Cl=r(11908),El=r(40784),_l=r(92793),jl=r(91443),zl=function(e,t){return zl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},zl(e,t)};function Nl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}zl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var kl=function(){return kl=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},kl.apply(this,arguments)};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Rl=Object.prototype.hasOwnProperty;function Ml(e){return"boolean"==typeof e}function Fl(e,t){for(var r=e.length-1;r>=0;r--)!0===t(e[r])&&e.splice(r,1)}function Ll(e){throw new Error("Unhandled case for value: '".concat(e,"'"))}var Gl=/\s+/,Ul=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,r=this.getClass(),i=r?r.split(Gl):[],o=e.split(Gl);t=o.shift();)-1===i.indexOf(t)&&i.push(t);return this.getAttrs().class=i.join(" "),this},e.prototype.removeClass=function(e){for(var t,r=this.getClass(),i=r?r.split(Gl):[],o=e.split(Gl);i.length&&(t=o.shift());){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}return this.getAttrs().class=i.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){var e=this.getAttrs(),t=[];for(var r in e)Rl.call(e,r)&&t.push(r+'="'+e[r]+'"');return t.join(" ")},e}();function Wl(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function ql(e,t,r){var i=t/2,o=Math.ceil(i),n=-1*Math.floor(i),a="";return n<0&&(a=e.substr(n)),e.substr(0,o)+r+a}var Bl=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new Ul({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},r=this.createCssClass(e);return r&&(t.class=r),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var r=[t],i=e.getCssClassSuffixes(),o=0,n=i.length;o<n;o++)r.push(t+"-"+i[o]);return r.join(" ")}return""},e.prototype.processAnchorText=function(e){return this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t.length)return e;var r=t.length,i=t.location;return"smart"===i?function(e,t,r){var i,o;if(null==r?(r="&hellip;",o=3,i=8):(o=r.length,i=r.length),e.length<=t)return e;var n=t-o,a=function(e){var t={},r=e,i=r.match(/^([a-z]+):\/\//i);return i&&(t.scheme=i[1],r=r.slice(i[0].length)),(i=r.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=i[1],r=r.slice(i[0].length)),(i=r.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=i[1],r=r.slice(i[0].length)),(i=r.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=i[1],r=r.slice(i[0].length)),(i=r.match(/^#(.*?)$/i))&&(t.fragment=i[1]),t}(e);if(a.query){var s=a.query.match(/^(.*?)(?=(\?|#))(.*?)$/i);s&&(a.query=a.query.substr(0,s[1].length),e=Wl(a))}if(e.length<=t)return e;if(a.host&&(a.host=a.host.replace(/^www\./,""),e=Wl(a)),e.length<=t)return e;var l="";if(a.host&&(l+=a.host),l.length>=n)return a.host.length===t?(a.host.substr(0,t-o)+r).substr(0,n+i):ql(l,n,r).substr(0,n+i);var c="";if(a.path&&(c+="/"+a.path),a.query&&(c+="?"+a.query),c){if((l+c).length>=n)return(l+c).length==t?(l+c).substr(0,t):(l+ql(c,n-l.length,r)).substr(0,n+i);l+=c}if(a.fragment){var u="#"+a.fragment;if((l+u).length>=n)return(l+u).length==t?(l+u).substr(0,t):(l+ql(u,n-l.length,r)).substr(0,n+i);l+=u}if(a.scheme&&a.host){var p=a.scheme+"://";if((l+p).length<n)return(p+l).substr(0,t)}if(l.length<=t)return l;var d="";return n>0&&(d=l.substr(-1*Math.floor(n/2))),(l.substr(0,Math.ceil(n/2))+r+d).substr(0,n+i)}(e,r):"middle"===i?function(e,t,r){if(e.length<=t)return e;var i,o;null==r?(r="&hellip;",i=8,o=3):(i=r.length,o=r.length);var n=t-o,a="";return n>0&&(a=e.substr(-1*Math.floor(n/2))),(e.substr(0,Math.ceil(n/2))+r+a).substr(0,n+i)}(e,r):function(e,t){return function(e,t,r){var i;return e.length>t&&(null==r?(r="&hellip;",i=3):i=r.length,e=e.substring(0,t-i)+r),e}(e,t,void 0)}(e,r)},e}(),Vl=function(){function e(e){this._=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.type]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}();function Hl(e){return e>=65&&e<=90||e>=97&&e<=122}function $l(e){return e>=48&&e<=57}function Jl(e){return 34==e||39==e}function Xl(e){return e<8232?e<160?e>=9&&e<=13||32==e:e<5760?160==e:5760==e||e>=8192&&e<=8202:e<8287?e>=8232&&e<=8233||8239==e:e<12288?8287==e:12288==e||65279==e}function Kl(e){return e<4800?e<2949?e<2451?e<1425?e<768?e<192?e<169?e<65?e>=48&&e<=57:e>=65&&e<=90||e>=97&&e<=122:e<181?e>=169&&e<=170||174==e:181==e||186==e:e<710?e<216?e>=192&&e<=214:e>=216&&e<=246||e>=248&&e<=705:e<748?e>=710&&e<=721||e>=736&&e<=740:748==e||750==e:e<910?e<895?e<886?e>=768&&e<=884:e>=886&&e<=887||e>=890&&e<=893:e<904?895==e||902==e:e>=904&&e<=906||908==e:e<1155?e<931?e>=910&&e<=929:e>=931&&e<=1013||e>=1015&&e<=1153:e<1369?e>=1155&&e<=1327||e>=1329&&e<=1366:1369==e||e>=1377&&e<=1415:e<1808?e<1552?e<1476?e<1471?e>=1425&&e<=1469:1471==e||e>=1473&&e<=1474:e<1488?e>=1476&&e<=1477||1479==e:e>=1488&&e<=1514||e>=1520&&e<=1522:e<1749?e<1568?e>=1552&&e<=1562:e>=1568&&e<=1641||e>=1646&&e<=1747:e<1770?e>=1749&&e<=1756||e>=1759&&e<=1768:e>=1770&&e<=1788||1791==e:e<2230?e<2042?e<1869?e>=1808&&e<=1866:e>=1869&&e<=1969||e>=1984&&e<=2037:e<2112?2042==e||e>=2048&&e<=2093:e>=2112&&e<=2139||e>=2208&&e<=2228:e<2406?e<2260?e>=2230&&e<=2237:e>=2260&&e<=2273||e>=2275&&e<=2403:e<2437?e>=2406&&e<=2415||e>=2417&&e<=2435:e>=2437&&e<=2444||e>=2447&&e<=2448:e<2693?e<2579?e<2519?e<2486?e<2474?e>=2451&&e<=2472:e>=2474&&e<=2480||2482==e:e<2503?e>=2486&&e<=2489||e>=2492&&e<=2500:e>=2503&&e<=2504||e>=2507&&e<=2510:e<2534?e<2524?2519==e:e>=2524&&e<=2525||e>=2527&&e<=2531:e<2565?e>=2534&&e<=2545||e>=2561&&e<=2563:e>=2565&&e<=2570||e>=2575&&e<=2576:e<2631?e<2613?e<2602?e>=2579&&e<=2600:e>=2602&&e<=2608||e>=2610&&e<=2611:e<2620?e>=2613&&e<=2614||e>=2616&&e<=2617:2620==e||e>=2622&&e<=2626:e<2649?e<2635?e>=2631&&e<=2632:e>=2635&&e<=2637||2641==e:e<2662?e>=2649&&e<=2652||2654==e:e>=2662&&e<=2677||e>=2689&&e<=2691:e<2821?e<2759?e<2730?e<2703?e>=2693&&e<=2701:e>=2703&&e<=2705||e>=2707&&e<=2728:e<2741?e>=2730&&e<=2736||e>=2738&&e<=2739:e>=2741&&e<=2745||e>=2748&&e<=2757:e<2784?e<2763?e>=2759&&e<=2761:e>=2763&&e<=2765||2768==e:e<2809?e>=2784&&e<=2787||e>=2790&&e<=2799:2809==e||e>=2817&&e<=2819:e<2887?e<2858?e<2831?e>=2821&&e<=2828:e>=2831&&e<=2832||e>=2835&&e<=2856:e<2869?e>=2858&&e<=2864||e>=2866&&e<=2867:e>=2869&&e<=2873||e>=2876&&e<=2884:e<2911?e<2902?e>=2887&&e<=2888||e>=2891&&e<=2893:e>=2902&&e<=2903||e>=2908&&e<=2909:e<2929?e>=2911&&e<=2915||e>=2918&&e<=2927:2929==e||e>=2946&&e<=2947:e<3517?e<3205?e<3046?e<2984?e<2969?e<2958?e>=2949&&e<=2954:e>=2958&&e<=2960||e>=2962&&e<=2965:e<2974?e>=2969&&e<=2970||2972==e:e>=2974&&e<=2975||e>=2979&&e<=2980:e<3014?e<2990?e>=2984&&e<=2986:e>=2990&&e<=3001||e>=3006&&e<=3010:e<3024?e>=3014&&e<=3016||e>=3018&&e<=3021:3024==e||3031==e:e<3142?e<3086?e<3072?e>=3046&&e<=3055:e>=3072&&e<=3075||e>=3077&&e<=3084:e<3114?e>=3086&&e<=3088||e>=3090&&e<=3112:e>=3114&&e<=3129||e>=3133&&e<=3140:e<3160?e<3146?e>=3142&&e<=3144:e>=3146&&e<=3149||e>=3157&&e<=3158:e<3174?e>=3160&&e<=3162||e>=3168&&e<=3171:e>=3174&&e<=3183||e>=3200&&e<=3203:e<3333?e<3274?e<3242?e<3214?e>=3205&&e<=3212:e>=3214&&e<=3216||e>=3218&&e<=3240:e<3260?e>=3242&&e<=3251||e>=3253&&e<=3257:e>=3260&&e<=3268||e>=3270&&e<=3272:e<3296?e<3285?e>=3274&&e<=3277:e>=3285&&e<=3286||3294==e:e<3313?e>=3296&&e<=3299||e>=3302&&e<=3311:e>=3313&&e<=3314||e>=3329&&e<=3331:e<3423?e<3389?e<3342?e>=3333&&e<=3340:e>=3342&&e<=3344||e>=3346&&e<=3386:e<3402?e>=3389&&e<=3396||e>=3398&&e<=3400:e>=3402&&e<=3406||e>=3412&&e<=3415:e<3458?e<3430?e>=3423&&e<=3427:e>=3430&&e<=3439||e>=3450&&e<=3455:e<3482?e>=3458&&e<=3459||e>=3461&&e<=3478:e>=3482&&e<=3505||e>=3507&&e<=3515:e<3804?e<3722?e<3570?e<3535?e<3520?3517==e:e>=3520&&e<=3526||3530==e:e<3544?e>=3535&&e<=3540||3542==e:e>=3544&&e<=3551||e>=3558&&e<=3567:e<3664?e<3585?e>=3570&&e<=3571:e>=3585&&e<=3642||e>=3648&&e<=3662:e<3716?e>=3664&&e<=3673||e>=3713&&e<=3714:3716==e||e>=3719&&e<=3720:e<3754?e<3737?e<3725?3722==e:3725==e||e>=3732&&e<=3735:e<3749?e>=3737&&e<=3743||e>=3745&&e<=3747:3749==e||3751==e:e<3776?e<3757?e>=3754&&e<=3755:e>=3757&&e<=3769||e>=3771&&e<=3773:e<3784?e>=3776&&e<=3780||3782==e:e>=3784&&e<=3789||e>=3792&&e<=3801:e<4176?e<3902?e<3872?e<3840?e>=3804&&e<=3807:3840==e||e>=3864&&e<=3865:e<3895?e>=3872&&e<=3881||3893==e:3895==e||3897==e:e<3974?e<3913?e>=3902&&e<=3911:e>=3913&&e<=3948||e>=3953&&e<=3972:e<4038?e>=3974&&e<=3991||e>=3993&&e<=4028:4038==e||e>=4096&&e<=4169:e<4688?e<4301?e<4256?e>=4176&&e<=4253:e>=4256&&e<=4293||4295==e:e<4348?4301==e||e>=4304&&e<=4346:e>=4348&&e<=4680||e>=4682&&e<=4685:e<4746?e<4698?e>=4688&&e<=4694||4696==e:e>=4698&&e<=4701||e>=4704&&e<=4744:e<4786?e>=4746&&e<=4749||e>=4752&&e<=4784:e>=4786&&e<=4789||e>=4792&&e<=4798:e<11035?e<7416?e<6176?e<5873?e<4992?e<4824?e<4802?4800==e:e>=4802&&e<=4805||e>=4808&&e<=4822:e<4888?e>=4824&&e<=4880||e>=4882&&e<=4885:e>=4888&&e<=4954||e>=4957&&e<=4959:e<5121?e<5024?e>=4992&&e<=5007:e>=5024&&e<=5109||e>=5112&&e<=5117:e<5761?e>=5121&&e<=5740||e>=5743&&e<=5759:e>=5761&&e<=5786||e>=5792&&e<=5866:e<6002?e<5920?e<5888?e>=5873&&e<=5880:e>=5888&&e<=5900||e>=5902&&e<=5908:e<5984?e>=5920&&e<=5940||e>=5952&&e<=5971:e>=5984&&e<=5996||e>=5998&&e<=6e3:e<6108?e<6016?e>=6002&&e<=6003:e>=6016&&e<=6099||6103==e:e<6155?e>=6108&&e<=6109||e>=6112&&e<=6121:e>=6155&&e<=6157||e>=6160&&e<=6169:e<6783?e<6512?e<6400?e<6272?e>=6176&&e<=6263:e>=6272&&e<=6314||e>=6320&&e<=6389:e<6448?e>=6400&&e<=6430||e>=6432&&e<=6443:e>=6448&&e<=6459||e>=6470&&e<=6509:e<6608?e<6528?e>=6512&&e<=6516:e>=6528&&e<=6571||e>=6576&&e<=6601:e<6688?e>=6608&&e<=6617||e>=6656&&e<=6683:e>=6688&&e<=6750||e>=6752&&e<=6780:e<7040?e<6832?e<6800?e>=6783&&e<=6793:e>=6800&&e<=6809||6823==e:e<6992?e>=6832&&e<=6846||e>=6912&&e<=6987:e>=6992&&e<=7001||e>=7019&&e<=7027:e<7245?e<7168?e>=7040&&e<=7155:e>=7168&&e<=7223||e>=7232&&e<=7241:e<7376?e>=7245&&e<=7293||e>=7296&&e<=7304:e>=7376&&e<=7378||e>=7380&&e<=7414:e<8450?e<8130?e<8025?e<7960?e<7424?e>=7416&&e<=7417:e>=7424&&e<=7669||e>=7675&&e<=7957:e<8008?e>=7960&&e<=7965||e>=7968&&e<=8005:e>=8008&&e<=8013||e>=8016&&e<=8023:e<8031?e<8027?8025==e:8027==e||8029==e:e<8118?e>=8031&&e<=8061||e>=8064&&e<=8116:e>=8118&&e<=8124||8126==e:e<8205?e<8150?e<8134?e>=8130&&e<=8132:e>=8134&&e<=8140||e>=8144&&e<=8147:e<8178?e>=8150&&e<=8155||e>=8160&&e<=8172:e>=8178&&e<=8180||e>=8182&&e<=8188:e<8305?e<8252?8205==e:8252==e||8265==e:e<8336?8305==e||8319==e:e>=8336&&e<=8348||e>=8400&&e<=8432:e<8579?e<8486?e<8469?e<8455?8450==e:8455==e||e>=8458&&e<=8467:e<8482?8469==e||e>=8473&&e<=8477:8482==e||8484==e:e<8495?e<8488?8486==e:8488==e||e>=8490&&e<=8493:e<8517?e>=8495&&e<=8505||e>=8508&&e<=8511:e>=8517&&e<=8521||8526==e:e<9410?e<9e3?e<8592?e>=8579&&e<=8580:e>=8592&&e<=8703||e>=8986&&e<=8987:e<9193?9e3==e||9167==e:e>=9193&&e<=9203||e>=9208&&e<=9210:e<9723?e<9654?9410==e||e>=9642&&e<=9643:9654==e||9664==e:e<10548?e>=9723&&e<=9726||e>=9728&&e<=10175:e>=10548&&e<=10549||e>=11013&&e<=11015:e<43259?e<12445?e<11688?e<11520?e<11264?e<11088?e>=11035&&e<=11036:11088==e||11093==e:e<11360?e>=11264&&e<=11310||e>=11312&&e<=11358:e>=11360&&e<=11492||e>=11499&&e<=11507:e<11568?e<11559?e>=11520&&e<=11557:11559==e||11565==e:e<11647?e>=11568&&e<=11623||11631==e:e>=11647&&e<=11670||e>=11680&&e<=11686:e<11744?e<11712?e<11696?e>=11688&&e<=11694:e>=11696&&e<=11702||e>=11704&&e<=11710:e<11728?e>=11712&&e<=11718||e>=11720&&e<=11726:e>=11728&&e<=11734||e>=11736&&e<=11742:e<12330?e<11823?e>=11744&&e<=11775:11823==e||e>=12293&&e<=12294:e<12353?e>=12330&&e<=12341||e>=12347&&e<=12349:e>=12353&&e<=12438||e>=12441&&e<=12442:e<42512?e<12951?e<12549?e<12449?e>=12445&&e<=12447:e>=12449&&e<=12538||e>=12540&&e<=12543:e<12704?e>=12549&&e<=12589||e>=12593&&e<=12686:e>=12704&&e<=12730||e>=12784&&e<=12799:e<19968?e<12953?12951==e:12953==e||e>=13312&&e<=19893:e<42192?e>=19968&&e<=40917||e>=40960&&e<=42124:e>=42192&&e<=42237||e>=42240&&e<=42508:e<42891?e<42623?e<42560?e>=42512&&e<=42539:e>=42560&&e<=42610||e>=42612&&e<=42621:e<42775?e>=42623&&e<=42725||e>=42736&&e<=42737:e>=42775&&e<=42783||e>=42786&&e<=42888:e<43072?e<42928?e>=42891&&e<=42926:e>=42928&&e<=42935||e>=42999&&e<=43047:e<43216?e>=43072&&e<=43123||e>=43136&&e<=43205:e>=43216&&e<=43225||e>=43232&&e<=43255:e<55243?e<43744?e<43488?e<43312?e<43261?43259==e:43261==e||e>=43264&&e<=43309:e<43392?e>=43312&&e<=43347||e>=43360&&e<=43388:e>=43392&&e<=43456||e>=43471&&e<=43481:e<43600?e<43520?e>=43488&&e<=43518:e>=43520&&e<=43574||e>=43584&&e<=43597:e<43642?e>=43600&&e<=43609||e>=43616&&e<=43638:e>=43642&&e<=43714||e>=43739&&e<=43741:e<43824?e<43785?e<43762?e>=43744&&e<=43759:e>=43762&&e<=43766||e>=43777&&e<=43782:e<43808?e>=43785&&e<=43790||e>=43793&&e<=43798:e>=43808&&e<=43814||e>=43816&&e<=43822:e<44012?e<43868?e>=43824&&e<=43866:e>=43868&&e<=43877||e>=43888&&e<=44010:e<44032?e>=44012&&e<=44013||e>=44016&&e<=44025:e>=44032&&e<=55203||e>=55216&&e<=55238:e<64848?e<64298?e<64112?e<55296?e>=55243&&e<=55291:e>=55296&&e<=57343||e>=63744&&e<=64109:e<64275?e>=64112&&e<=64217||e>=64256&&e<=64262:e>=64275&&e<=64279||e>=64285&&e<=64296:e<64320?e<64312?e>=64298&&e<=64310:e>=64312&&e<=64316||64318==e:e<64326?e>=64320&&e<=64321||e>=64323&&e<=64324:e>=64326&&e<=64433||e>=64467&&e<=64829:e<65296?e<65024?e<64914?e>=64848&&e<=64911:e>=64914&&e<=64967||e>=65008&&e<=65019:e<65136?e>=65024&&e<=65039||e>=65056&&e<=65071:e>=65136&&e<=65140||e>=65142&&e<=65276:e<65474?e<65345?e>=65296&&e<=65305||e>=65313&&e<=65338:e>=65345&&e<=65370||e>=65382&&e<=65470:e<65490?e>=65474&&e<=65479||e>=65482&&e<=65487:e>=65490&&e<=65495||e>=65498&&e<=65500}function Zl(e){return e<58?e<44?33==e:44==e||46==e:e<63?e>=58&&e<=59:63==e||94==e}function Ql(e){return e<91?40==e:91==e||123==e}function Yl(e){return e<93?41==e:93==e||125==e}var ec=/^(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|travelersinsurance|vermÃ¶gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermÃ¶gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|à®šà®¿à®™à¯à®•à®ªà¯à®ªà¯‚à®°à¯|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|banamex|bauhaus|bestbuy|booking|brother|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|yamaxun|youtube|zuerich|ÐºÐ°Ñ‚Ð¾Ð»Ð¸Ðº|Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†|Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±|Ø§Ù„Ø¹Ù„ÙŠØ§Ù†|Ù¾Ø§Ú©Ø³ØªØ§Ù†|ÙƒØ§Ø«ÙˆÙ„ÙŠÙƒ|à®‡à®¨à¯à®¤à®¿à®¯à®¾|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kindle|kosher|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|nagoya|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|walter|webcam|xihuan|yachts|yandex|zappos|Ð¼Ð¾ÑÐºÐ²Ð°|Ð¾Ð½Ð»Ð°Ð¹Ð½|Ø§Ø¨ÙˆØ¸Ø¨ÙŠ|Ø§Ø±Ø§Ù…ÙƒÙˆ|Ø§Ù„Ø§Ø±Ø¯Ù†|Ø§Ù„Ù…ØºØ±Ø¨|Ø§Ù…Ø§Ø±Ø§Øª|ÙÙ„Ø³Ø·ÙŠÙ†|Ù…Ù„ÙŠØ³ÙŠØ§|à¤­à¤¾à¤°à¤¤à¤®à¥|à®‡à®²à®™à¯à®•à¯ˆ|ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|loans|locus|lotte|lotto|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|×™×©×¨××œ|Ø§ÛŒØ±Ø§Ù†|Ø¨Ø§Ø²Ø§Ø±|Ø¨Ú¾Ø§Ø±Øª|Ø³ÙˆØ¯Ø§Ù†|Ø³ÙˆØ±ÙŠØ©|Ù‡Ù…Ø±Ø§Ù‡|à¤­à¤¾à¤°à¥‹à¤¤|à¤¸à¤‚à¤—à¤ à¤¨|à¦¬à¦¾à¦‚à¦²à¦¾|à°­à°¾à°°à°¤à±|à´­à´¾à´°à´¤à´‚|å˜‰é‡Œå¤§é…’åº—|aarp|able|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|Ð´ÐµÑ‚Ð¸|ÑÐ°Ð¹Ñ‚|Ø¨Ø§Ø±Øª|Ø¨ÙŠØªÙƒ|Ú€Ø§Ø±Øª|ØªÙˆÙ†Ø³|Ø´Ø¨ÙƒØ©|Ø¹Ø±Ø§Ù‚|Ø¹Ù…Ø§Ù†|Ù…ÙˆÙ‚Ø¹|à¤­à¤¾à¤°à¤¤|à¦­à¦¾à¦°à¦¤|à¦­à¦¾à§°à¦¤|à¨­à¨¾à¨°à¨¤|àª­àª¾àª°àª¤|à¬­à¬¾à¬°à¬¤|à²­à²¾à²°à²¤|à¶½à¶‚à¶šà·|ã‚¢ãƒžã‚¾ãƒ³|ã‚°ãƒ¼ã‚°ãƒ«|ã‚¯ãƒ©ã‚¦ãƒ‰|ãƒã‚¤ãƒ³ãƒˆ|ç»„ç»‡æœºæž„|é›»è¨Šç›ˆç§‘|é¦™æ ¼é‡Œæ‹‰|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|scb|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|Ð±ÐµÐ»|ÐºÐ¾Ð¼|Ò›Ð°Ð·|Ð¼ÐºÐ´|Ð¼Ð¾Ð½|Ð¾Ñ€Ð³|Ñ€ÑƒÑ|ÑÑ€Ð±|ÑƒÐºÑ€|Õ°Õ¡Õµ|×§×•×|Ø¹Ø±Ø¨|Ù‚Ø·Ø±|ÙƒÙˆÙ…|Ù…ØµØ±|à¤•à¥‰à¤®|à¤¨à¥‡à¤Ÿ|à¸„à¸­à¸¡|à¹„à¸—à¸¢|àº¥àº²àº§|ã‚¹ãƒˆã‚¢|ã‚»ãƒ¼ãƒ«|ã¿ã‚“ãª|ä¸­æ–‡ç½‘|äºšé©¬é€Š|å¤©ä¸»æ•™|æˆ‘çˆ±ä½ |æ–°åŠ å¡|æ·¡é©¬é”¡|é£žåˆ©æµ¦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ÎµÎ»|ÎµÏ…|Ð±Ð³|ÐµÑŽ|Ñ€Ñ„|áƒ’áƒ”|ë‹·ë„·|ë‹·ì»´|ì‚¼ì„±|í•œêµ­|ã‚³ãƒ |ä¸–ç•Œ|ä¸­ä¿¡|ä¸­å›½|ä¸­åœ‹|ä¼ä¸š|ä½›å±±|ä¿¡æ¯|å¥åº·|å…«å¦|å…¬å¸|å…¬ç›Š|å°æ¹¾|å°ç£|å•†åŸŽ|å•†åº—|å•†æ ‡|å˜‰é‡Œ|åœ¨çº¿|å¤§æ‹¿|å¨±ä¹|å®¶é›»|å¹¿ä¸œ|å¾®åš|æ…ˆå–„|æ‰‹æœº|æ‹›è˜|æ”¿åŠ¡|æ”¿åºœ|æ–°é—»|æ—¶å°š|æ›¸ç±|æœºæž„|æ¸¸æˆ|æ¾³é–€|ç‚¹çœ‹|ç§»åŠ¨|ç½‘å€|ç½‘åº—|ç½‘ç«™|ç½‘ç»œ|è”é€š|è°·æ­Œ|è´­ç‰©|é€šè²©|é›†å›¢|é£Ÿå“|é¤åŽ…|é¦™æ¸¯)$/,tc=/https?:\/\//i,rc=new RegExp("^"+tc.source,"i"),ic=/^(javascript|vbscript):/i,oc=/^[A-Za-z][-.+A-Za-z0-9]*:(\/\/)?([^:/]*)/,nc=/^(?:\/\/)?([^/#?:]+)/,ac=Hl;function sc(e){return Hl(e)||$l(e)||43===e||45===e||46===e}var lc=Kl;function cc(e){return 95===e||lc(e)}function uc(e){return Kl(e)||((t=e)<91?t<47?t>=35&&t<=43||45==t:t<61?47==t:61==t||64==t:t<95?91==t||93==t:t<123?95==t:t>=123&&t<=126||10003==t)||Zl(e);var t}function pc(e){return 47===e||63===e||35===e}function dc(e){return ec.test(e.toLowerCase())}var hc=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,mc=/[:/?#]/,fc=/^(https?:\/\/)?(?:www\.)?/i,gc=/^\/\//,yc=function(e){function t(t){var r=e.call(this,t)||this;return r.type="url",r.url="",r.urlMatchType="scheme",r.protocolRelativeMatch=!1,r.stripPrefix={scheme:!0,www:!0},r.stripTrailingSlash=!0,r.decodePercentEncoding=!0,r.protocolPrepended=!1,r.urlMatchType=t.urlMatchType,r.url=t.url,r.protocolRelativeMatch=t.protocolRelativeMatch,r.stripPrefix=t.stripPrefix,r.stripTrailingSlash=t.stripTrailingSlash,r.decodePercentEncoding=t.decodePercentEncoding,r}return Nl(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||"scheme"===this.urlMatchType||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e,t=this.getMatchedText();return this.protocolRelativeMatch&&(t=t.replace(gc,"")),this.stripPrefix.scheme&&(t=t.replace(rc,"")),this.stripPrefix.www&&(t=(e=t).includes("www.")?e.replace(fc,"$1"):e),this.stripTrailingSlash&&(t=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}(t)),this.decodePercentEncoding&&(t=function(e){var t=e.replace(/%(?:22|26|27|3C|3E)/gi,function(e){return"%22"===e?"&quot;":"%26"===e?"&amp;":"%27"===e?"&#39;":"%3C"===e||"%3c"===e?"&lt;":"&gt;"});if(t.includes("%"))try{return decodeURIComponent(t)}catch(e){}return t}(t)),t},t}(Vl),bc=/^mailto:/i,vc=Kl;function wc(e){return vc(e)||((t=e)<47?t<42?33==t||t>=35&&t<=39:t>=42&&t<=43||45==t:t<63?47==t||61==t:t<94?63==t:t>=94&&t<=96||t>=123&&t<=126);var t}var Ac=function(e){function t(t){var r=e.call(this,t)||this;return r.type="email",r.email="",r.email=t.email,r}return Nl(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(Vl);function Sc(e){return 95===e||Kl(e)}var xc=["twitter","facebook","instagram","tiktok","youtube"],Oc=function(e){function t(t){var r=e.call(this,t)||this;return r.type="hashtag",r.serviceName="twitter",r.hashtag="",r.serviceName=t.serviceName,r.hashtag=t.hashtag,r}return Nl(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;case"tiktok":return"https://www.tiktok.com/tag/"+t;case"youtube":return"https://youtube.com/hashtag/"+t;default:Ll(e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),r=this.getServiceName();return r&&t.push(r),t},t}(Vl),Pc={twitter:/^@\w{1,15}$/,instagram:/^@[_\w]{1,30}$/,soundcloud:/^@[-a-z0-9_]{3,25}$/,tiktok:/^@[.\w]{1,23}[\w]$/,youtube:/^@[-.Â·\w]{3,30}$/};function Tc(e){return 45===e||46===e||95===e||Hl(e)||$l(e)}var Ic=["twitter","instagram","soundcloud","tiktok","youtube"],Dc=function(e){function t(t){var r=e.call(this,t)||this;return r.type="mention",r.serviceName="twitter",r.mention="",r.mention=t.mention,r.serviceName=t.serviceName,r}return Nl(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;case"youtube":return"https://youtube.com/@"+this.mention;default:Ll(this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),r=this.getServiceName();return r&&t.push(r),t},t}(Vl),Cc=/[-. ()]/,Ec=new RegExp("^".concat(/(?:(?:(?:(\+)?\d{1,3}[-. ]?)?\(?\d{3}\)?[-. ]?\d{3}[-. ]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-. ]?(?:\d[-. ]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source,"$"));function _c(e){return 45===e||46===e||32===e}function jc(e){return 44===e||59===e}var zc=function(e){function t(t){var r=e.call(this,t)||this;return r.type="phone",r.number="",r.plusSign=!1,r.number=t.number,r.plusSign=t.plusSign,r}return Nl(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(Vl),Nc=function(){function e(e,t){this.charIdx=0,this.matches=[],this._stateMachines=[],this.schemeUrlMachinesCount=0,this.text=e,this.tagBuilder=t.tagBuilder,this.stripPrefix=t.stripPrefix,this.stripTrailingSlash=t.stripTrailingSlash,this.decodePercentEncoding=t.decodePercentEncoding,this.hashtagServiceName=t.hashtagServiceName,this.mentionServiceName=t.mentionServiceName}return Object.defineProperty(e.prototype,"stateMachines",{get:function(){return this._stateMachines},enumerable:!1,configurable:!0}),e.prototype.addMachine=function(e){this._stateMachines.push(e),Eu(e)&&this.schemeUrlMachinesCount++},e.prototype.removeMachine=function(e){this._stateMachines=this._stateMachines.filter(function(t){return t!==e}),Eu(e)&&this.schemeUrlMachinesCount--},e.prototype.hasSchemeUrlMachine=function(){return this.schemeUrlMachinesCount>0},e}();function kc(e,t,r){var i=e.charIdx;if(35===r)e.addMachine({type:2,startIdx:i,state:28,acceptStateReached:!1});else if(64===r)e.addMachine({type:3,startIdx:i,state:30,acceptStateReached:!1});else if(47===r)e.addMachine(Du(i,11));else if(43===r)e.addMachine(Cu(i,37));else if(40===r)e.addMachine(Cu(i,32));else{if($l(r)&&(e.addMachine(Cu(i,38)),e.addMachine(function(e){return{type:0,startIdx:e,state:13,acceptStateReached:!1,matchType:2,octetsEncountered:1}}(i))),vc(r)){var o="m"===t.toLowerCase()?15:22;e.addMachine(function(e,t){return{type:1,startIdx:e,state:t,acceptStateReached:!1}}(i,o))}ac(r)&&e.addMachine(Iu(i,0)),Kl(r)&&e.addMachine(Du(i,5))}}function Rc(e,t,r){58===r?t.state=2:45===r?t.state=1:sc(r)||e.removeMachine(t)}function Mc(e,t,r){var i=e.charIdx;45===r||(47===r?(e.removeMachine(t),e.addMachine(Du(i,11))):sc(r)?t.state=0:e.removeMachine(t))}function Fc(e,t,r){var i=e.charIdx;47===r?t.state=3:46===r?e.removeMachine(t):lc(r)?(t.state=5,ac(r)&&e.addMachine(Iu(i,0))):e.removeMachine(t)}function Lc(e,t,r){47===r?t.state=4:uc(r)?(t.state=10,t.acceptStateReached=!0):Ou(e,t)}function Gc(e,t,r,i){47===i?(t.state=10,t.acceptStateReached=!0):lc(i)?(t.state=5,t.acceptStateReached=!0):e.removeMachine(t)}function Uc(e,t,r){47===r?t.state=12:e.removeMachine(t)}function Wc(e,t,r){lc(r)?t.state=5:e.removeMachine(t)}function qc(e,t,r){46===r?t.state=7:45===r?t.state=6:58===r?t.state=8:pc(r)?t.state=10:cc(r)||Ou(e,t)}function Bc(e,t,r,i){45===i||(46===i?Ou(e,t):lc(i)?t.state=5:Ou(e,t))}function Vc(e,t,r,i){46===i?Ou(e,t):lc(i)?(t.state=5,t.acceptStateReached=!0):Ou(e,t)}function Hc(e,t,r){46===r?t.state=14:58===r?t.state=8:$l(r)||(pc(r)?t.state=10:Kl(r)?e.removeMachine(t):Ou(e,t))}function $c(e,t,r){$l(r)?(t.octetsEncountered++,4===t.octetsEncountered&&(t.acceptStateReached=!0),t.state=13):Ou(e,t)}function Jc(e,t,r){$l(r)?t.state=9:Ou(e,t)}function Xc(e,t,r){$l(r)||(pc(r)?t.state=10:Ou(e,t))}function Kc(e,t,r){uc(r)||Ou(e,t)}function Zc(e,t,r,i){"a"===r.toLowerCase()?t.state=16:ou(e,t,i)}function Qc(e,t,r,i){"i"===r.toLowerCase()?t.state=17:ou(e,t,i)}function Yc(e,t,r,i){"l"===r.toLowerCase()?t.state=18:ou(e,t,i)}function eu(e,t,r,i){"t"===r.toLowerCase()?t.state=19:ou(e,t,i)}function tu(e,t,r,i){"o"===r.toLowerCase()?t.state=20:ou(e,t,i)}function ru(e,t,r){58===r?t.state=21:ou(e,t,r)}function iu(e,t,r){wc(r)?t.state=22:e.removeMachine(t)}function ou(e,t,r){46===r?t.state=23:64===r?t.state=24:wc(r)?t.state=22:e.removeMachine(t)}function nu(e,t,r){46===r||64===r?e.removeMachine(t):wc(r)?t.state=22:e.removeMachine(t)}function au(e,t,r){lc(r)?t.state=25:e.removeMachine(t)}function su(e,t,r){46===r?t.state=27:45===r?t.state=26:cc(r)||Ou(e,t)}function lu(e,t,r){45===r||46===r?Ou(e,t):cc(r)?t.state=25:Ou(e,t)}function cu(e,t,r){46===r||45===r?Ou(e,t):lc(r)?(t.state=25,t.acceptStateReached=!0):Ou(e,t)}function uu(e,t,r){Sc(r)?(t.state=29,t.acceptStateReached=!0):e.removeMachine(t)}function pu(e,t,r){Sc(r)||Ou(e,t)}function du(e,t,r){Tc(r)?(t.state=31,t.acceptStateReached=!0):e.removeMachine(t)}function hu(e,t,r){Tc(r)||(Kl(r)?e.removeMachine(t):Ou(e,t))}function mu(e,t,r,i){$l(i)?t.state=38:(e.removeMachine(t),kc(e,r,i))}function fu(e,t,r,i){$l(i)?t.state=33:e.removeMachine(t),kc(e,r,i)}function gu(e,t,r){$l(r)?t.state=34:e.removeMachine(t)}function yu(e,t,r){$l(r)?t.state=35:e.removeMachine(t)}function bu(e,t,r){41===r?t.state=36:e.removeMachine(t)}function vu(e,t,r,i){$l(i)?t.state=38:_c(i)?t.state=39:e.removeMachine(t)}function wu(e,t,r,i){var o=e.charIdx;t.acceptStateReached=!0,jc(i)?t.state=40:35===i?t.state=41:$l(i)||(40===i?t.state=32:_c(i)?t.state=39:(Ou(e,t),ac(i)&&e.addMachine(Iu(o,0))))}function Au(e,t,r,i){$l(i)?t.state=38:40===i?t.state=32:(Ou(e,t),kc(e,r,i))}function Su(e,t,r){jc(r)||(35===r?t.state=41:$l(r)?t.state=38:Ou(e,t))}function xu(e,t,r){jc(r)?t.state=40:$l(r)?e.removeMachine(t):Ou(e,t)}function Ou(e,t){var r=e.matches,i=e.text,o=e.charIdx,n=e.tagBuilder,a=e.stripPrefix,s=e.stripTrailingSlash,l=e.decodePercentEncoding,c=e.hashtagServiceName,u=e.mentionServiceName;if(e.removeMachine(t),t.acceptStateReached){var p,d,h,m=t.startIdx,f=i.slice(t.startIdx,o);switch(f=function(e){for(var t={"(":0,"{":0,"[":0},r=0;r<e.length;r++){var i=e.charAt(r);Ql(n=e.charCodeAt(r))?t[i]++:Yl(n)&&t[Tu[i]]--}for(var o=e.length-1;o>=0;){var n;if(i=e.charAt(o),Yl(n=e.charCodeAt(o))){var a=Tu[i];if(!(t[a]<0))break;t[a]++,o--}else{if(!Zl(n))break;o--}}return e.slice(0,o+1)}(f),t.type){case 0:if(64===i.charCodeAt(t.startIdx-1))return;switch(t.matchType){case 0:var g=tc.exec(f);if(g&&(m+=g.index,f=f.slice(g.index)),!function(e){if(ic.test(e))return!1;var t=e.match(oc);if(!t)return!1;var r=!!t[1],i=t[2];return!!r||!(-1===i.indexOf(".")||!/[A-Za-z]/.test(i))}(f))return;break;case 1:if(!function(e){var t=e.match(nc);if(!t)return!1;var r=t[0].split(".");return!(r.length<2||!dc(r[r.length-1]))}(f))return;break;case 2:if(h=f.split(mc,1)[0],!hc.test(h))return;break;default:Ll(t)}r.push(new yc({tagBuilder:n,matchedText:f,offset:m,urlMatchType:Pu(t.matchType),url:f,protocolRelativeMatch:"//"===f.slice(0,2),stripPrefix:a,stripTrailingSlash:s,decodePercentEncoding:l}));break;case 1:dc(f.split(".").pop())&&r.push(new Ac({tagBuilder:n,matchedText:f,offset:m,email:f.replace(bc,"")}));break;case 2:f.length<=140&&r.push(new Oc({tagBuilder:n,matchedText:f,offset:m,serviceName:c,hashtag:f.slice(1)}));break;case 3:d=f,Pc[u].test(d)&&r.push(new Dc({tagBuilder:n,matchedText:f,offset:m,serviceName:u,mention:f.slice(1)}));break;case 4:if(("+"===(p=f=f.replace(/ +$/g,"")).charAt(0)||Cc.test(p))&&Ec.test(p)){var y=f.replace(/[^0-9,;#]/g,"");r.push(new zc({tagBuilder:n,matchedText:f,offset:m,number:y,plusSign:"+"===f.charAt(0)}))}break;default:Ll(t)}}}function Pu(e){switch(e){case 0:return"scheme";case 1:return"tld";case 2:return"ipV4";default:Ll(e)}}var Tu={")":"(","}":"{","]":"["};function Iu(e,t){return{type:0,startIdx:e,state:t,acceptStateReached:!1,matchType:0}}function Du(e,t){return{type:0,startIdx:e,state:t,acceptStateReached:!1,matchType:1}}function Cu(e,t){return{type:4,startIdx:e,state:t,acceptStateReached:!1}}function Eu(e){return 0===e.type&&0===e.matchType}var _u=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing},ju=new _u,zu=function(e,t){this.charIdx=0,this.state=0,this.currentDataIdx=0,this.currentTag=ju,this.html=e,this.callbacks=t};function Nu(e,t){"<"===t&&rp(e)}function ku(e,t,r){"!"===t?e.state=13:"/"===t?(e.state=2,e.currentTag=new _u(kl(kl({},e.currentTag),{isClosing:!0}))):"<"===t?rp(e):Hl(r)?(e.state=3,e.currentTag=new _u(kl(kl({},e.currentTag),{isOpening:!0}))):(e.state=0,e.currentTag=ju)}function Ru(e,t,r){Xl(r)?(e.currentTag=new _u(kl(kl({},e.currentTag),{name:op(e)})),e.state=4):"<"===t?rp(e):"/"===t?(e.currentTag=new _u(kl(kl({},e.currentTag),{name:op(e)})),e.state=12):">"===t?(e.currentTag=new _u(kl(kl({},e.currentTag),{name:op(e)})),ip(e)):Hl(r)||$l(r)||":"===t||tp(e)}function Mu(e,t,r){">"===t?tp(e):Hl(r)?e.state=3:tp(e)}function Fu(e,t,r){var i;Xl(r)||("/"===t?e.state=12:">"===t?ip(e):"<"===t?rp(e):"="===t||Jl(r)||(i=r)>=0&&i<=31||127==i?tp(e):e.state=5)}function Lu(e,t,r){Xl(r)?e.state=6:"/"===t?e.state=12:"="===t?e.state=7:">"===t?ip(e):"<"===t?rp(e):Jl(r)&&tp(e)}function Gu(e,t,r){Xl(r)||("/"===t?e.state=12:"="===t?e.state=7:">"===t?ip(e):"<"===t?rp(e):Jl(r)?tp(e):e.state=5)}function Uu(e,t,r){Xl(r)||('"'===t?e.state=8:"'"===t?e.state=9:/[>=`]/.test(t)?tp(e):"<"===t?rp(e):e.state=10)}function Wu(e,t){'"'===t&&(e.state=11)}function qu(e,t){"'"===t&&(e.state=11)}function Bu(e,t,r){Xl(r)?e.state=4:">"===t?ip(e):"<"===t&&rp(e)}function Vu(e,t,r){Xl(r)?e.state=4:"/"===t?e.state=12:">"===t?ip(e):"<"===t?rp(e):(e.state=4,function(e){e.charIdx--}(e))}function Hu(e,t){">"===t?(e.currentTag=new _u(kl(kl({},e.currentTag),{isClosing:!0})),ip(e)):tp(e)}function $u(e){var t=e.html,r=e.charIdx;"--"===t.slice(r,r+2)?(e.charIdx++,e.currentTag=new _u(kl(kl({},e.currentTag),{type:"comment"})),e.state=14):"DOCTYPE"===t.slice(r,r+7).toUpperCase()?(e.charIdx+=6,e.currentTag=new _u(kl(kl({},e.currentTag),{type:"doctype"})),e.state=20):tp(e)}function Ju(e,t){"-"===t?e.state=15:">"===t?tp(e):e.state=16}function Xu(e,t){"-"===t?e.state=18:">"===t?tp(e):e.state=16}function Ku(e,t){"-"===t&&(e.state=17)}function Zu(e,t){e.state="-"===t?18:16}function Qu(e,t){">"===t?ip(e):"!"===t?e.state=19:"-"===t||(e.state=16)}function Yu(e,t){"-"===t?e.state=17:">"===t?ip(e):e.state=16}function ep(e,t){">"===t?ip(e):"<"===t&&rp(e)}function tp(e){e.state=0,e.currentTag=ju}function rp(e){e.state=1,e.currentTag=new _u({idx:e.charIdx})}function ip(e){var t=e.html.slice(e.currentDataIdx,e.currentTag.idx);t&&e.callbacks.onText(t,e.currentDataIdx);var r=e.currentTag;"comment"===r.type?e.callbacks.onComment(r.idx):"doctype"===r.type?e.callbacks.onDoctype(r.idx):(r.isOpening&&e.callbacks.onOpenTag(r.name,r.idx),r.isClosing&&e.callbacks.onCloseTag(r.name,r.idx)),tp(e),e.currentDataIdx=e.charIdx+1}function op(e){var t=e.currentTag.idx+(e.currentTag.isClosing?2:1);return e.html.slice(t,e.charIdx).toLowerCase()}var np=function(){function e(t){var r,i;void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.tagBuilder=null,this.urls=(null==(i=t.urls)&&(i=!0),Ml(i)?{schemeMatches:i,tldMatches:i,ipV4Matches:i}:{schemeMatches:!Ml(i.schemeMatches)||i.schemeMatches,tldMatches:!Ml(i.tldMatches)||i.tldMatches,ipV4Matches:!Ml(i.ipV4Matches)||i.ipV4Matches}),this.email=Ml(t.email)?t.email:this.email,this.phone=Ml(t.phone)?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow=Ml(t.newWindow)?t.newWindow:this.newWindow,this.stripPrefix=(null==(r=t.stripPrefix)&&(r=!0),Ml(r)?{scheme:r,www:r}:{scheme:!Ml(r.scheme)||r.scheme,www:!Ml(r.www)||r.www}),this.stripTrailingSlash=Ml(t.stripTrailingSlash)?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding=Ml(t.decodePercentEncoding)?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var o=this.mention;if(!1!==o&&-1===Ic.indexOf(o))throw new Error("invalid `mention` cfg '".concat(o,"' - see docs"));var n,a=this.hashtag;if(!1!==a&&-1===xc.indexOf(a))throw new Error("invalid `hashtag` cfg '".concat(a,"' - see docs"));this.truncate="number"==typeof(n=t.truncate)?{length:n,location:"end"}:kl({length:Number.POSITIVE_INFINITY,location:"end"},n),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,r){return new e(r).link(t)},e.parse=function(t,r){return new e(r).parse(t)},e.prototype.parse=function(e){var t=this,r=["a","style","script"],i=0,o=[];return function(e,t){for(var r=new zu(e,t),i=e.length;r.charIdx<i;){var o=e.charAt(r.charIdx),n=e.charCodeAt(r.charIdx);switch(r.state){case 0:Nu(r,o);break;case 1:ku(r,o,n);break;case 2:Mu(r,o,n);break;case 3:Ru(r,o,n);break;case 4:Fu(r,o,n);break;case 5:Lu(r,o,n);break;case 6:Gu(r,o,n);break;case 7:Uu(r,o,n);break;case 8:Wu(r,o);break;case 9:qu(r,o);break;case 10:Bu(r,o,n);break;case 11:Vu(r,o,n);break;case 12:Hu(r,o);break;case 13:$u(r);break;case 14:Ju(r,o);break;case 15:Xu(r,o);break;case 16:Ku(r,o);break;case 17:Zu(r,o);break;case 18:Qu(r,o);break;case 19:Yu(r,o);break;case 20:ep(r,o);break;default:Ll(r.state)}r.charIdx++}r.currentDataIdx<r.charIdx&&function(e){var t=e.html.slice(e.currentDataIdx,e.charIdx);e.callbacks.onText(t,e.currentDataIdx),e.currentDataIdx=e.charIdx+1}(r)}(e,{onOpenTag:function(e){r.indexOf(e)>=0&&i++},onText:function(e,r){if(0===i){var n=e.split(/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),a=r;n.forEach(function(e,r){if(r%2==0){var i=t.parseText(e,a);o.push.apply(o,function(e,t,r){if(r||2===arguments.length)for(var i,o=0,n=t.length;o<n;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}(i),!1))}a+=e.length})}},onCloseTag:function(e){r.indexOf(e)>=0&&(i=Math.max(i-1,0))},onComment:function(){},onDoctype:function(){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},e.prototype.compactMatches=function(e){e.sort(ap);for(var t=0;t<e.length-1;){var r=e[t],i=r.getOffset(),o=r.getMatchedText().length;if(t+1<e.length&&e[t+1].getOffset()===i){var n=e[t+1].getMatchedText().length>o?t:t+1;e.splice(n,1)}else t++}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||Fl(e,function(e){return"hashtag"===e.getType()}),this.email||Fl(e,function(e){return"email"===e.getType()}),this.phone||Fl(e,function(e){return"phone"===e.getType()}),this.mention||Fl(e,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Fl(e,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.tldMatches||Fl(e,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),this.urls.ipV4Matches||Fl(e,function(e){return"url"===e.getType()&&"ipV4"===e.getUrlMatchType()}),e},e.prototype.parseText=function(e,t){t=t||0;for(var r=function(e,t){for(var r=new Nc(e,t);r.charIdx<r.text.length;r.charIdx++){var i=e.charAt(r.charIdx),o=e.charCodeAt(r.charIdx);if(0===r.stateMachines.length)kc(r,i,o);else{for(var n=r.stateMachines.length-1;n>=0;n--){var a=r.stateMachines[n];switch(a.state){case 11:Uc(r,a,o);break;case 12:Wc(r,a,o);break;case 0:Rc(r,a,o);break;case 1:Mc(r,a,o);break;case 2:Fc(r,a,o);break;case 3:Lc(r,a,o);break;case 4:Gc(r,a,0,o);break;case 5:qc(r,a,o);break;case 6:Bc(r,a,0,o);break;case 7:Vc(r,a,0,o);break;case 13:Hc(r,a,o);break;case 14:$c(r,a,o);break;case 8:Jc(r,a,o);break;case 9:Xc(r,a,o);break;case 10:Kc(r,a,o);break;case 15:Zc(r,a,i,o);break;case 16:Qc(r,a,i,o);break;case 17:Yc(r,a,i,o);break;case 18:eu(r,a,i,o);break;case 19:tu(r,a,i,o);break;case 20:ru(r,a,o);break;case 21:iu(r,a,o);break;case 22:ou(r,a,o);break;case 23:nu(r,a,o);break;case 24:au(r,a,o);break;case 25:su(r,a,o);break;case 26:lu(r,a,o);break;case 27:cu(r,a,o);break;case 28:uu(r,a,o);break;case 29:pu(r,a,o);break;case 30:du(r,a,o);break;case 31:hu(r,a,o);break;case 32:fu(r,a,i,o);break;case 33:gu(r,a,o);break;case 34:yu(r,a,o);break;case 35:bu(r,a,o);break;case 36:vu(r,a,0,o);break;case 37:mu(r,a,i,o);break;case 38:wu(r,a,0,o);break;case 39:Au(r,a,i,o);break;case 40:Su(r,a,o);break;case 41:xu(r,a,o);break;default:Ll(a.state)}}if(!r.hasSchemeUrlMachine()&&r.charIdx>0&&ac(o)){var s=r.text.charCodeAt(r.charIdx-1);ac(s)||r.addMachine(Iu(r.charIdx,0))}}}for(var l=r.stateMachines.length-1;l>=0;l--)r.stateMachines.forEach(function(e){return Ou(r,e)});return r.matches}(e,{tagBuilder:this.getTagBuilder(),stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding,hashtagServiceName:this.hashtag,mentionServiceName:this.mention||"twitter"}),i=0,o=r.length;i<o;i++)r[i].setOffset(t+r[i].getOffset());return r},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),r=new Array(2*t.length+1),i=0,o=0,n=t.length;o<n;o++){var a=t[o];r.push(e.substring(i,a.getOffset())),r.push(this.createMatchReturnVal(a)),i=a.getOffset()+a.getMatchedText().length}return r.push(e.substring(i)),r.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof Ul?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new Bl({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="4.1.5",e}();function ap(e,t){return e.getOffset()-t.getOffset()}const sp=np;var lp=r(33281),cp=r(11776),up=r(86332),pp=r(5783),dp=r(85405),hp=r(9715),mp=r(73504),fp=r(83605),gp=r(68243);const yp=function(e,t){this.position=e,this.headingPitchRoll=t},bp=function(e,t){this.position=e,this.headingPitchRange=t};function vp(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new bs.A,this.tourEnd=new bs.A,this.entryStart=new bs.A,this.entryEnd=new bs.A,this._activeEntries=[]}function wp(e){for(let t=e.pop();void 0!==t;t=e.pop())t.stop()}function Ap(e,t,r){const i=this.playlist[this.playlistIndex];if(i){const o=Sp.bind(this,e,t,r);if(this._activeEntries.push(i),this.entryStart.raiseEvent(i),i.blocking)i.play(o,e.scene.camera,t);else{const n=this;i.play(function(){n.entryEnd.raiseEvent(i);const e=n._activeEntries.indexOf(i);e>=0&&n._activeEntries.splice(e,1)}),o(e,t,r)}}else(0,aa.A)(r)&&r(!1)}function Sp(e,t,r,i){const o=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(o,i),i)r(i);else{const i=this._activeEntries.indexOf(o);i>=0&&this._activeEntries.splice(i,1),this.playlistIndex++,Ap.call(this,e,t,r)}}vp.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},vp.prototype.play=function(e,t){this.tourStart.raiseEvent();const r=this;Ap.call(this,e,t,function(e){r.playlistIndex=0,e||wp(r._activeEntries),r.tourEnd.raiseEvent(e)})},vp.prototype.stop=function(){wp(this._activeEntries)};const xp=vp;var Op=r(54042),Pp=r(46866);function Tp(e,t,r){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=r,this.flyToMode=t}Tp.prototype.play=function(e,t,r){if(this.activeCamera=t,(0,aa.A)(e)&&null!==e){const t=this;this.activeCallback=function(r){delete t.activeCallback,delete t.activeCamera,e(!(0,aa.A)(r)&&r)}}const i=this.getCameraOptions(r);if(this.view.headingPitchRoll)t.flyTo(i);else if(this.view.headingPitchRange){const e=new Bo.A(this.view.position);t.flyToBoundingSphere(e,i)}},Tp.prototype.stop=function(){(0,aa.A)(this.activeCamera)&&this.activeCamera.cancelFlight(),(0,aa.A)(this.activeCallback)&&this.activeCallback(!0)},Tp.prototype.getCameraOptions=function(e){let t={duration:this.duration};return(0,aa.A)(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=Pp.A.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),(0,aa.A)(e)&&(t=(0,Op.A)(t,e)),t};const Ip=Tp;function Dp(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}Dp.prototype.play=function(e){const t=this;this.activeCallback=e,this.timeout=setTimeout(function(){delete t.activeCallback,e(!1)},1e3*this.duration)},Dp.prototype.stop=function(){clearTimeout(this.timeout),(0,aa.A)(this.activeCallback)&&this.activeCallback(!0)};const Cp=Dp;var Ep=r(47485),_p=r(29094),jp=r(2261),zp=r(25669),Np=r(43817),kp=r(90890),Rp=r(51390),Mp=r(85082),Fp=r(56392),Lp=r(87117),Gp=r(53193);const Up={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){let t=e.toLowerCase();return t=(0,yl.A)(t),Up[t]}};let Wp;"undefined"!=typeof DOMParser&&(Wp=new DOMParser);const qp=new sp({stripPrefix:!1,email:!1,replaceFn:function(e){return"scheme"===e.urlMatchType||"www"===e.urlMatchType}}),Bp=32,Vp=2414016,Hp=16093e3,$p=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],Jp=["http://www.google.com/kml/ext/2.2"],Xp={kml:$p,gx:Jp,atom:["http://www.w3.org/2005/Atom"],kmlgx:$p.concat(Jp)},Kp={Document:Md,Folder:function(e,t,r,i){const o=Rd(e,t,r),n=(0,hl.A)(r);n.parentEntity=o.entity,Md(0,t,n,i)},Placemark:function(e,t,r,i){const o=Rd(e,t,r),n=o.entity,a=o.styleEntity;let s=!1;const l=t.childNodes;for(let t=0,i=l.length;t<i&&!s;t++){const i=l.item(t),o=Nd[i.localName];(0,aa.A)(o)&&(o(e,r.entityCollection,i,n,a,n.id),s=!0)}s||(n.merge(a),Ed(e,n,a))},NetworkLink:function(e,t,r,i){const o=Rd(e,t,r).entity,n=r.sourceResource,a=r.uriResolver;let s=cd(t,"Link",Xp.kml);if((0,aa.A)(s)||(s=cd(t,"Url",Xp.kml)),(0,aa.A)(s)){let t,u,p=hd(s,"href",Xp.kml);if((0,aa.A)(p)){let d=p;if(p=fd(p,n,r.uriResolver),/^data:/.test(p.getUrlComponent()))/\.kmz/i.test(n.getUrlComponent())||(d=n.getDerivedResource({url:d}));else{var l,c;if(d=p.clone(),t=hd(s,"viewRefreshMode",Xp.kml),"onRegion"===t)return void(0,Ol.A)("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");u=null!==(l=hd(s,"viewBoundScale",Xp.kml))&&void 0!==l?l:1;const r="onStop"===t?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",i=null!==(c=hd(s,"viewFormat",Xp.kml))&&void 0!==c?c:r,o=hd(s,"httpQuery",Xp.kml);(0,aa.A)(i)&&p.setQueryParameters((0,Il.A)(Bd(i))),(0,aa.A)(o)&&p.setQueryParameters((0,Il.A)(Bd(o)));const n=e._ellipsoid;Xd(p,e.camera,e.canvas,u,e._lastCameraView.bbox,n)}const h={sourceUri:d,uriResolver:a,context:o.id,screenOverlayContainer:r.screenOverlayContainer},m=new gp.A,f=Zd(e,m,p,h).then(function(r){var i;const n=e._entityCollection,a=m.values;n.suspendEvents();for(let e=0;e<a.length;e++){const t=a[e];(0,aa.A)(t.parent)||(t.parent=o,Yd(t)),n.add(t)}n.resumeEvents();const l=hd(s,"refreshMode",Xp.kml);let c=null!==(i=dd(s,"refreshInterval",Xp.kml))&&void 0!==i?i:0;if("onInterval"===l&&c>0||"onExpire"===l||"onStop"===t){const t=cd(r,"NetworkLinkControl",Xp.kml),i=(0,aa.A)(t),n=yt.A.now(),a={id:(0,fl.A)(),href:p,cookie:{},lastUpdated:n,updating:!1,entity:o,viewBoundScale:u,needsUpdate:!1,cameraUpdateTime:n};let m=0;var d,h;if(i&&(a.cookie=(0,Il.A)(null!==(d=hd(t,"cookie",Xp.kml))&&void 0!==d?d:""),m=null!==(h=dd(t,"minRefreshPeriod",Xp.kml))&&void 0!==h?h:0),"onInterval"===l)i&&(c=Math.max(m,c)),a.refreshMode=qd.INTERVAL,a.time=c;else if("onExpire"===l){let e;if(i&&(e=hd(t,"expires",Xp.kml)),(0,aa.A)(e))try{const t=yt.A.fromIso8601(e),r=yt.A.secondsDifference(t,n);r>0&&r<m&&yt.A.addSeconds(n,m,t),a.refreshMode=qd.EXPIRE,a.time=t}catch(e){(0,Ol.A)("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else(0,Ol.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else if((0,aa.A)(e.camera)){var f;a.refreshMode=qd.STOP,a.time=null!==(f=dd(s,"viewRefreshTime",Xp.kml))&&void 0!==f?f:0}else(0,Ol.A)("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");(0,aa.A)(a.refreshMode)&&e._networkLinks.set(a.id,a)}}).catch(function(t){(0,Ol.A)("An error occured during loading ".concat(p.url)),e._error.raiseEvent(e,t)});i.addPromise(f)}}},GroundOverlay:function(e,t,r,i){const o=Rd(e,t,r).entity;let n,a=!1;const s=e._ellipsoid,l=ad(cd(t,"LatLonQuad",Xp.gx),s),c=dd(t,"drawOrder",Xp.kml);if((0,aa.A)(l))n=wd(),n.hierarchy=new Tl.A(l),n.zIndex=c,o.polygon=n,a=!0;else{n=new kp.A,n.zIndex=c,o.rectangle=n;const e=cd(t,"LatLonBox",Xp.kml);if((0,aa.A)(e)){let t=dd(e,"west",Xp.kml),r=dd(e,"south",Xp.kml),i=dd(e,"east",Xp.kml),o=dd(e,"north",Xp.kml);(0,aa.A)(t)&&(t=Rn.A.negativePiToPi(Rn.A.toRadians(t))),(0,aa.A)(r)&&(r=Rn.A.clampToLatitudeRange(Rn.A.toRadians(r))),(0,aa.A)(i)&&(i=Rn.A.negativePiToPi(Rn.A.toRadians(i))),(0,aa.A)(o)&&(o=Rn.A.clampToLatitudeRange(Rn.A.toRadians(o))),n.coordinates=new As.A(t,r,i,o);const a=dd(e,"rotation",Xp.kml);if((0,aa.A)(a)){const e=Rn.A.toRadians(a);n.rotation=e,n.stRotation=e}}}const u=cd(t,"Icon",Xp.kml),p=Sd(u,e,r.sourceResource,r.uriResolver,!0);if((0,aa.A)(p)){a&&(0,Ol.A)("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");const e=dd(u,"x",Xp.gx),r=dd(u,"y",Xp.gx),i=dd(u,"w",Xp.gx),o=dd(u,"h",Xp.gx);((0,aa.A)(e)||(0,aa.A)(r)||(0,aa.A)(i)||(0,aa.A)(o))&&(0,Ol.A)("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),n.material=p,n.material.color=bd(t,"color",Xp.kml),n.material.transparent=!0}else n.material=bd(t,"color",Xp.kml);let d=hd(t,"altitudeMode",Xp.kml);(0,aa.A)(d)?"absolute"===d?(n.height=dd(t,"altitude",Xp.kml),n.zIndex=void 0):"clampToGround"!==d&&(0,Ol.A)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: ".concat(d)):(d=hd(t,"altitudeMode",Xp.gx),"relativeToSeaFloor"===d?((0,Ol.A)("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),n.height=dd(t,"altitude",Xp.kml),n.zIndex=void 0):"clampToSeaFloor"===d?(0,Ol.A)("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):(0,aa.A)(d)&&(0,Ol.A)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: ".concat(d)))},PhotoOverlay:Wd,ScreenOverlay:function(e,t,r,i){const o=r.screenOverlayContainer;if(!(0,aa.A)(o))return;const n=r.sourceResource,a=r.uriResolver,s=Sd(cd(t,"Icon",Xp.kml),e,n,a,!1);if(!(0,aa.A)(s))return;const l=document.createElement("img");e._screenOverlays.push(l),l.src=s.url,l.onload=function(){const e=["position: absolute"],r=cd(t,"screenXY",Xp.kml),i=cd(t,"overlayXY",Xp.kml),o=cd(t,"size",Xp.kml);let n,a,s,c,u,p;(0,aa.A)(o)&&(n=sd(o,"x"),a=sd(o,"y"),s=ld(o,"xunits"),c=ld(o,"yunits"),(0,aa.A)(n)&&-1!==n&&0!==n&&("fraction"===s?u="width: ".concat(Math.floor(100*n),"%"):"pixels"===s&&(u="width: ".concat(n,"px")),e.push(u)),(0,aa.A)(a)&&-1!==a&&0!==a&&("fraction"===c?p="height: ".concat(Math.floor(100*a),"%"):"pixels"===c&&(p="height: ".concat(a,"px")),e.push(p))),l.style=e.join(";");let d=0,h=l.height;(0,aa.A)(i)&&(n=sd(i,"x"),a=sd(i,"y"),s=ld(i,"xunits"),c=ld(i,"yunits"),(0,aa.A)(n)&&("fraction"===s?d=n*l.width:("pixels"===s||"insetPixels"===s)&&(d=n)),(0,aa.A)(a)&&("fraction"===c?h=a*l.height:("pixels"===c||"insetPixels"===c)&&(h=a))),(0,aa.A)(r)&&(n=sd(r,"x"),a=sd(r,"y"),s=ld(r,"xunits"),c=ld(r,"yunits"),(0,aa.A)(n)&&("fraction"===s?u="".concat("left: calc(").concat(Math.floor(100*n),"% - ").concat(d,"px)"):"pixels"===s?u="left: ".concat(n-d,"px"):"insetPixels"===s&&(u="right: ".concat(n-d,"px")),e.push(u)),(0,aa.A)(a)&&("fraction"===c?p="".concat("bottom: calc(").concat(Math.floor(100*a),"% - ").concat(h,"px)"):"pixels"===c?p="bottom: ".concat(a-h,"px"):"insetPixels"===c&&(p="top: ".concat(a-h,"px")),e.push(p))),l.style=e.join(";")},o.appendChild(l)},Tour:function(e,t,r,i){const o=hd(t,"name",Xp.kml),n=ld(t,"id"),a=new xp(o,n),s=cd(t,"Playlist",Xp.gx);if(s){const t=e._ellipsoid,r=s.childNodes;for(let e=0;e<r.length;e++){const i=r[e];if(i.localName){const e=Fd[i.localName];e?e(a,i,t):console.log("Unknown KML Tour playlist entry type ".concat(i.localName))}}}e._kmlTours.push(a)}};function Zp(e){this._dataSource=e,this._deferred=(0,gl.A)(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}function Qp(e){const t={xsi:"http://www.w3.org/2001/XMLSchema-instance"};let r,i,o,n;for(const a in t)t.hasOwnProperty(a)&&(o=RegExp("[< ]".concat(a,":")),n="xmlns:".concat(a,"="),o.test(e)&&-1===e.indexOf(n)&&((0,aa.A)(r)||(r=e.substr(0,e.indexOf("<kml")+4),i=e.substr(r.length)),r+=" ".concat(n,'"').concat(t[a],'"')));return(0,aa.A)(r)&&(e=r+i),e}function Yp(e){let t=e.indexOf("xmlns:");const r=e.indexOf(">",t);let i,o,n;for(;-1!==t&&t<r;)i=e.slice(t,e.indexOf('"',t)),o=t,t=e.indexOf(i,t+1),-1!==t?(n=e.indexOf('"',e.indexOf('"',t)+1),t=(e=e.slice(0,t-1)+e.slice(n+1,e.length)).indexOf("xmlns:",o-1)):t=e.indexOf("xmlns:",o+1);return e}async function ed(e,t){var r;const i=null!==(r=Up.detectFromFilename(e.filename))&&void 0!==r?r:"application/octet-stream",o=await e.getData(new lp.M3(i));t[e.filename]=o}function td(e,t,r,i){const o=i.keys,n=new Te("."),a=e.querySelectorAll(t);for(let e=0;e<a.length;e++){const s=a[e],l=s.getAttribute(r);if((0,aa.A)(l)){const e=new Te(l).absoluteTo(n).toString(),a=o.indexOf(e);if(-1!==a){const e=o[a];s.setAttribute(r,i[e]),"a"===t&&null===s.getAttribute("download")&&s.setAttribute("download",e)}}}}function rd(e,t,r,i){const o=e.querySelectorAll(t);for(let e=0;e<o.length;e++){const t=o[e],n=fd(t.getAttribute(r),i);(0,aa.A)(n)&&t.setAttribute(r,n.url)}}function id(e,t,r){let i=ld(e,"id");i=(0,aa.A)(i)&&0!==i.length?i:(0,fl.A)(),(0,aa.A)(r)&&(i=r+i);let o=t.getById(i);return(0,aa.A)(o)&&(i=(0,fl.A)(),(0,aa.A)(r)&&(i=r+i)),o=t.add(new mp.A({id:i})),(0,aa.A)(o.kml)||(o.addProperty("kml"),o.kml=new th),o}function od(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function nd(e,t){if(!(0,aa.A)(e))return ul.A.fromDegrees(0,0,0,t);const r=e.match(/[^\s,\n]+/g);if(!(0,aa.A)(r))return ul.A.fromDegrees(0,0,0,t);let i=parseFloat(r[0]),o=parseFloat(r[1]),n=parseFloat(r[2]);return i=isNaN(i)?0:i,o=isNaN(o)?0:o,n=isNaN(n)?0:n,ul.A.fromDegrees(i,o,n,t)}function ad(e,t){if(!(0,aa.A)(e))return;const r=e.textContent.match(/[^\s\n]+/g);if(!(0,aa.A)(r))return;const i=r.length,o=new Array(i);let n=0;for(let e=0;e<i;e++)o[n++]=nd(r[e],t);return o}function sd(e,t){if(!(0,aa.A)(e))return;const r=e.getAttribute(t);if(null!==r){const e=parseFloat(r);return isNaN(e)?void 0:e}}function ld(e,t){if(!(0,aa.A)(e))return;const r=e.getAttribute(t);return null!==r?r:void 0}function cd(e,t,r){if(!(0,aa.A)(e))return;const i=e.childNodes,o=i.length;for(let e=0;e<o;e++){const o=i[e];if(o.localName===t&&-1!==r.indexOf(o.namespaceURI))return o}}function ud(e,t,r){if(!(0,aa.A)(e))return;const i=[],o=e.getElementsByTagNameNS("*",t),n=o.length;for(let e=0;e<n;e++){const n=o[e];n.localName===t&&-1!==r.indexOf(n.namespaceURI)&&i.push(n)}return i}function pd(e,t,r){if(!(0,aa.A)(e))return[];const i=[],o=e.childNodes,n=o.length;for(let e=0;e<n;e++){const n=o[e];n.localName===t&&-1!==r.indexOf(n.namespaceURI)&&i.push(n)}return i}function dd(e,t,r){const i=cd(e,t,r);if((0,aa.A)(i)){const e=parseFloat(i.textContent);return isNaN(e)?void 0:e}}function hd(e,t,r){const i=cd(e,t,r);if((0,aa.A)(i))return i.textContent.trim()}function md(e,t,r){const i=cd(e,t,r);if((0,aa.A)(i)){const e=i.textContent.trim();return"1"===e||/^true$/i.test(e)}}function fd(e,t,r){if(!(0,aa.A)(e))return;let i;if((0,aa.A)(r)){let o=r[e=e.replace(/\\/g,"/")];if((0,aa.A)(o))i=new Vi.A({url:o});else{const n=new Te(t.getUrlComponent());o=r[new Te(e).absoluteTo(n)],(0,aa.A)(o)&&(i=new Vi.A({url:o}))}}return(0,aa.A)(i)||(i=t.getDerivedResource({url:e})),i}Object.defineProperties(Zp.prototype,{dataSource:{get:function(){return this._dataSource}}}),Zp.prototype.addNodes=function(e,t){this._stack.push({nodes:e,index:0,processingData:t}),this._used=!0},Zp.prototype.addPromise=function(e){this._promises.push(e)},Zp.prototype.wait=function(){const e=this._deferred;return this._used||e.resolve(),Promise.all([e.promise,Promise.all(this._promises)])},Zp.prototype.process=function(){const e=1===this._stack.length;return e&&(this._started=Qd._getTimestamp()),this._process(e)},Zp.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;const e=this;setTimeout(function(){e._timeoutSet=!1,e._started=Qd._getTimestamp(),e._process(!0)},0)},Zp.prototype._nextNode=function(){const e=this._stack,t=e[e.length-1],r=t.index,i=t.nodes;if(r!==i.length)return++t.index,i[r]},Zp.prototype._pop=function(){const e=this._stack;return e.pop(),0!==e.length||(this._deferred.resolve(),!1)},Zp.prototype._process=function(e){const t=this.dataSource,r=this._stack[this._stack.length-1].processingData;let i=this._nextNode();for(;(0,aa.A)(i);){const e=Kp[i.localName];if((0,aa.A)(e)&&(-1!==Xp.kml.indexOf(i.namespaceURI)||-1!==Xp.gx.indexOf(i.namespaceURI))&&(e(t,i,r,this),this._timeoutSet||Qd._getTimestamp()>this._started+this._timeThreshold))return void this._giveUpTime();i=this._nextNode()}this._pop()&&e&&this._process(!0)};const gd={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function yd(e,t){if(!(0,aa.A)(e)||/^\s*$/gm.test(e))return;"#"===e[0]&&(e=e.substring(1));const r=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,n=parseInt(e.substring(6,8),16)/255;return t?(n>0?(gd.maximumRed=n,gd.red=void 0):(gd.maximumRed=void 0,gd.red=0),o>0?(gd.maximumGreen=o,gd.green=void 0):(gd.maximumGreen=void 0,gd.green=0),i>0?(gd.maximumBlue=i,gd.blue=void 0):(gd.maximumBlue=void 0,gd.blue=0),gd.alpha=r,ml.A.fromRandom(gd)):new ml.A(n,o,i,r)}function bd(e,t,r){const i=hd(e,t,r);if((0,aa.A)(i))return yd(i,"random"===hd(e,"colorMode",r))}function vd(){const e=new up.A;return e.width=Bp,e.height=Bp,e.scaleByDistance=new Sl.A(Vp,1,Hp,.1),e.pixelOffsetScaleByDistance=new Sl.A(Vp,1,Hp,.1),e}function wd(){const e=new jp.A;return e.outline=!0,e.outlineColor=ml.A.WHITE,e}function Ad(){const e=new Ep.A;return e.translucencyByDistance=new Sl.A(3e6,1,5e6,0),e.pixelOffset=new Vo.A(17,0),e.horizontalOrigin=El.A.LEFT,e.font="16px sans-serif",e.style=_l.A.FILL_AND_OUTLINE,e}function Sd(e,t,r,i,o){let n=hd(e,"href",Xp.kml);if(!(0,aa.A)(n)||0===n.length)return;if(0===n.indexOf("root://icons/palette-")){var a,s;const t=n.charAt(21);let r=null!==(a=dd(e,"x",Xp.gx))&&void 0!==a?a:0,i=null!==(s=dd(e,"y",Xp.gx))&&void 0!==s?s:0;r=Math.min(r/32,7),i=7-Math.min(i/32,7);const o=8*i+r;n="https://maps.google.com/mapfiles/kml/pal".concat(t,"/icon").concat(o,".png")}const l=fd(n,r,i);if(o){var c,u;const r=hd(e,"refreshMode",Xp.kml),i=hd(e,"viewRefreshMode",Xp.kml);"onInterval"===r||"onExpire"===r?(0,Ol.A)("kml-refreshMode-".concat(r),"KML - Unsupported Icon refreshMode: ".concat(r)):"onStop"!==i&&"onRegion"!==i||(0,Ol.A)("kml-refreshMode-".concat(i),"KML - Unsupported Icon viewRefreshMode: ".concat(i));const o=null!==(c=hd(e,"viewBoundScale",Xp.kml))&&void 0!==c?c:1,n="onStop"===i?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",a=null!==(u=hd(e,"viewFormat",Xp.kml))&&void 0!==u?u:n,s=hd(e,"httpQuery",Xp.kml);(0,aa.A)(a)&&l.setQueryParameters((0,Il.A)(Bd(a))),(0,aa.A)(s)&&l.setQueryParameters((0,Il.A)(Bd(s)));const p=t._ellipsoid;return Xd(l,t.camera,t.canvas,o,t._lastCameraView.bbox,p),l}return l}function xd(e,t,r,i,o){let n=dd(t,"scale",Xp.kml);const a=dd(t,"heading",Xp.kml),s=bd(t,"color",Xp.kml),l=cd(t,"Icon",Xp.kml);let c=Sd(l,e,i,o,!1);(0,aa.A)(l)&&!(0,aa.A)(c)&&(c=!1);const u=dd(l,"x",Xp.gx),p=dd(l,"y",Xp.gx),d=dd(l,"w",Xp.gx),h=dd(l,"h",Xp.gx),m=cd(t,"hotSpot",Xp.kml),f=sd(m,"x"),g=sd(m,"y"),y=ld(m,"xunits"),b=ld(m,"yunits");let v,w,A=r.billboard;(0,aa.A)(A)||(A=vd(),r.billboard=A),A.image=c,A.scale=n,A.color=s,((0,aa.A)(u)||(0,aa.A)(p)||(0,aa.A)(d)||(0,aa.A)(h))&&(A.imageSubRegion=new ll.A(u,p,d,h)),(0,aa.A)(a)&&0!==a&&(A.rotation=Rn.A.toRadians(-a),A.alignedAxis=ul.A.UNIT_Z),n=null!=n?n:1,(0,aa.A)(f)&&("pixels"===y?v=-f*n:"insetPixels"===y?v=(f-Bp)*n:"fraction"===y&&(v=-f*Bp*n),v+=16*n),(0,aa.A)(g)&&("pixels"===b?w=g*n:"insetPixels"===b?w=(-g+Bp)*n:"fraction"===b&&(w=g*Bp*n),w-=16*n),((0,aa.A)(v)||(0,aa.A)(w))&&(A.pixelOffset=new Vo.A(v,w))}function Od(e,t,r,i,o){for(let d=0,h=t.childNodes.length;d<h;d++){const h=t.childNodes.item(d);if("IconStyle"===h.localName)xd(e,h,r,i,o);else if("LabelStyle"===h.localName){var n,a;let e=r.label;(0,aa.A)(e)||(e=Ad(),r.label=e),e.scale=null!==(n=dd(h,"scale",Xp.kml))&&void 0!==n?n:e.scale,e.fillColor=null!==(a=bd(h,"color",Xp.kml))&&void 0!==a?a:e.fillColor,e.text=r.name}else if("LineStyle"===h.localName){let e=r.polyline;(0,aa.A)(e)||(e=new zp.A,r.polyline=e),e.width=dd(h,"width",Xp.kml),e.material=bd(h,"color",Xp.kml),(0,aa.A)(bd(h,"outerColor",Xp.gx))&&(0,Ol.A)("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),(0,aa.A)(dd(h,"outerWidth",Xp.gx))&&(0,Ol.A)("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),(0,aa.A)(dd(h,"physicalWidth",Xp.gx))&&(0,Ol.A)("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),(0,aa.A)(md(h,"labelVisibility",Xp.gx))&&(0,Ol.A)("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===h.localName){var s,l,c;let e=r.polygon;(0,aa.A)(e)||(e=wd(),r.polygon=e),e.material=null!==(s=bd(h,"color",Xp.kml))&&void 0!==s?s:e.material,e.fill=null!==(l=md(h,"fill",Xp.kml))&&void 0!==l?l:e.fill,e.outline=null!==(c=md(h,"outline",Xp.kml))&&void 0!==c?c:e.outline}else if("BalloonStyle"===h.localName){var u,p;const e=null!==(u=yd(hd(h,"bgColor",Xp.kml)))&&void 0!==u?u:ml.A.WHITE,t=null!==(p=yd(hd(h,"textColor",Xp.kml)))&&void 0!==p?p:ml.A.BLACK,i=hd(h,"text",Xp.kml);r.addProperty("balloonStyle"),r.balloonStyle={bgColor:e,textColor:t,text:i}}else if("ListStyle"===h.localName){const e=hd(h,"listItemType",Xp.kml);"radioFolder"!==e&&"checkOffOnly"!==e||(0,Ol.A)("kml-listStyle-".concat(e),"KML - Unsupported ListStyle with listItemType: ".concat(e))}}}function Pd(e,t,r){return t.fetchXML().then(function(i){return Td(e,i,r,t,!0)})}function Td(e,t,r,i,o,n){let a,s,l,c;const u=ud(t,"Style",Xp.kml);if((0,aa.A)(u)){const t=u.length;for(a=0;a<t;a++)c=u[a],s=ld(c,"id"),(0,aa.A)(s)&&(s="#".concat(s),o&&(0,aa.A)(i)&&(s=i.getUrlComponent()+s),(0,aa.A)(r.getById(s))||(l=new mp.A({id:s}),r.add(l),Od(e,c,l,i,n)))}const p=ud(t,"StyleMap",Xp.kml);if((0,aa.A)(p)){const t=p.length;for(a=0;a<t;a++){const t=p[a];if(s=ld(t,"id"),(0,aa.A)(s)){const a=pd(t,"Pair",Xp.kml);for(let t=0;t<a.length;t++){const u=a[t],p=hd(u,"key",Xp.kml);if("normal"===p){if(s="#".concat(s),o&&(0,aa.A)(i)&&(s=i.getUrlComponent()+s),!(0,aa.A)(r.getById(s))){l=r.getOrCreateEntity(s);let t=hd(u,"styleUrl",Xp.kml);if((0,aa.A)(t)){"#"!==t[0]&&(t="#".concat(t)),o&&(0,aa.A)(i)&&(t=i.getUrlComponent()+t);const e=r.getById(t);(0,aa.A)(e)&&l.merge(e)}else c=cd(u,"Style",Xp.kml),Od(e,c,l,i,n)}}else(0,Ol.A)("kml-styleMap-".concat(p),"KML - Unsupported StyleMap key: ".concat(p))}}}}const d=[],h=t.getElementsByTagName("styleUrl"),m=h.length;for(a=0;a<m;a++){const t=h[a].textContent;if("#"!==t[0]){const o=t.split("#");if(2===o.length){const t=o[0],n=i.getDerivedResource({url:t});d.push(Pd(e,n,r))}}}return d}function Id(e,t,r){const i=new Rp.A(e,t.id,["position"]),o=new Fp.A(t.position);t.polyline=(0,aa.A)(r.polyline)?r.polyline.clone():new zp.A,t.polyline.positions=new Np.A([i,o])}function Dd(e,t){return!(0,aa.A)(e)&&!(0,aa.A)(t)||"clampToGround"===e?Cl.Ay.CLAMP_TO_GROUND:"relativeToGround"===e?Cl.Ay.RELATIVE_TO_GROUND:"absolute"===e?Cl.Ay.NONE:"clampToSeaFloor"===t?((0,Ol.A)("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),Cl.Ay.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?((0,Ol.A)("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),Cl.Ay.RELATIVE_TO_GROUND):((0,aa.A)(e)?(0,Ol.A)("kml-altitudeMode-unknown","KML - Unknown <kml:altitudeMode>:".concat(e,", using <kml:altitudeMode>:CLAMP_TO_GROUND.")):(0,Ol.A)("kml-gx:altitudeMode-unknown","KML - Unknown <gx:altitudeMode>:".concat(t,", using <kml:altitudeMode>:CLAMP_TO_GROUND.")),Cl.Ay.CLAMP_TO_GROUND)}function Cd(e,t,r){return"relativeToSeaFloor"===r||"absolute"===t||"relativeToGround"===t?e:(((0,aa.A)(t)&&"clampToGround"!==t||(0,aa.A)(r)&&"clampToSeaFloor"!==r)&&(0,Ol.A)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: ".concat(null!=t?t:r)),new Fp.A(e))}function Ed(e,t,r,i){let o=t.label;(0,aa.A)(o)||(o=(0,aa.A)(r.label)?r.label.clone():Ad(),t.label=o),o.text=t.name;let n=t.billboard;(0,aa.A)(n)||(n=(0,aa.A)(r.billboard)?r.billboard.clone():vd(),t.billboard=n),(0,aa.A)(n.image)?n.image.getValue()||(n.image=void 0):n.image=e._pinBuilder.fromColor(ml.A.YELLOW,64);let a=1;(0,aa.A)(n.scale)&&(a=n.scale.getValue(),0!==a?o.pixelOffset=new Vo.A(16*a+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),(0,aa.A)(i)&&e._clampToGround&&(n.heightReference=i,o.heightReference=i)}function _d(e,t){let r=e.path;(0,aa.A)(r)||(r=new _p.A,r.leadTime=0,e.path=r);const i=t.polyline;(0,aa.A)(i)&&(r.material=i.material,r.width=i.width)}function jd(e,t,r,i,o){const n=cd(r,"coordinates",Xp.kml),a=hd(r,"altitudeMode",Xp.kml),s=hd(r,"altitudeMode",Xp.gx),l=md(r,"extrude",Xp.kml),c=md(r,"tessellate",Xp.kml),u=od(a,s),p=dd(r,"drawOrder",Xp.gx),d=e._ellipsoid,h=ad(n,d);let m=o.polyline;if(u&&l){const e=new Gp.A;i.wall=e,e.positions=h;const t=o.polygon;(0,aa.A)(t)&&(e.fill=t.fill,e.material=t.material),e.outline=!0,(0,aa.A)(m)?(e.outlineColor=(0,aa.A)(m.material)?m.material.color:ml.A.WHITE,e.outlineWidth=m.width):(0,aa.A)(t)&&(e.outlineColor=(0,aa.A)(t.material)?t.material.color:ml.A.WHITE)}else if(e._clampToGround&&!u&&c){const e=new zp.A;var f;e.clampToGround=!0,i.polyline=e,e.positions=h,(0,aa.A)(m)?(e.material=(0,aa.A)(m.material)?m.material.color.getValue(Al.A.MINIMUM_VALUE):ml.A.WHITE,e.width=null!==(f=m.width)&&void 0!==f?f:1):(e.material=ml.A.WHITE,e.width=1),e.zIndex=p}else(0,aa.A)(p)&&(0,Ol.A)("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),e._clampToGround&&!c&&(0,Ol.A)("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),m=(0,aa.A)(m)?m.clone():new zp.A,i.polyline=m,m.positions=function(e,t,r,i){if(!(0,aa.A)(e))return;if("relativeToSeaFloor"===r||"absolute"===t||"relativeToGround"===t)return e;((0,aa.A)(t)&&"clampToGround"!==t||(0,aa.A)(r)&&"clampToSeaFloor"!==r)&&(0,Ol.A)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: ".concat(null!=t?t:r));const o=e.length;for(let t=0;t<o;t++){const r=e[t];i.scaleToGeodeticSurface(r,r)}return e}(h,a,s,d),c&&!u||(m.arcType=al.A.NONE);return!0}function zd(e,t,r,i,o,n,a,s,l){const c=e[0],u=e[e.length-1],p=new Mp.A;p.addSamples(e,t),r.intervals.addInterval(new bt.A({start:c,stop:u,isStartIncluded:l,isStopIncluded:l,data:Cd(p,a,s)})),i.addInterval(new bt.A({start:c,stop:u,isStartIncluded:l,isStopIncluded:l})),o.intervals.addInterval(new bt.A({start:c,stop:u,isStartIncluded:l,isStopIncluded:l,data:n}))}const Nd={Point:function(e,t,r,i,o){const n=hd(r,"coordinates",Xp.kml),a=hd(r,"altitudeMode",Xp.kml),s=hd(r,"altitudeMode",Xp.gx),l=md(r,"extrude",Xp.kml),c=nd(n,e._ellipsoid);return i.position=c,Ed(e,i,o,Dd(a,s)),l&&od(a,s)&&Id(t,i,o),!0},LineString:jd,LinearRing:jd,Polygon:function(e,t,r,i,o){const n=cd(r,"outerBoundaryIs",Xp.kml);let a=cd(n,"LinearRing",Xp.kml),s=cd(a,"coordinates",Xp.kml);const l=e._ellipsoid;let c=ad(s,l);const u=md(r,"extrude",Xp.kml),p=od(hd(r,"altitudeMode",Xp.kml),hd(r,"altitudeMode",Xp.gx)),d=(0,aa.A)(o.polygon)?o.polygon.clone():wd(),h=o.polyline;if((0,aa.A)(h)&&(d.outlineColor=(0,aa.A)(h.material)?h.material.color:ml.A.WHITE,d.outlineWidth=h.width),i.polygon=d,p?(d.perPositionHeight=!0,d.extrudedHeight=u?0:void 0):e._clampToGround||(d.height=0),(0,aa.A)(c)){const e=new Tl.A(c),t=pd(r,"innerBoundaryIs",Xp.kml);for(let r=0;r<t.length;r++){a=pd(t[r],"LinearRing",Xp.kml);for(let t=0;t<a.length;t++)s=cd(a[t],"coordinates",Xp.kml),c=ad(s,l),(0,aa.A)(c)&&e.holes.push(new Tl.A(c))}d.hierarchy=e}return!0},Track:function(e,t,r,i,o){const n=hd(r,"altitudeMode",Xp.kml),a=hd(r,"altitudeMode",Xp.gx),s=pd(r,"coord",Xp.gx),l=pd(r,"angles",Xp.gx),c=pd(r,"when",Xp.kml),u=md(r,"extrude",Xp.kml),p=od(n,a),d=e._ellipsoid;l.length>0&&(0,Ol.A)("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");const h=Math.min(s.length,c.length),m=[],f=[];for(let e=0;e<h;e++){const t=nd(s[e].textContent,d);m.push(t),f.push(yt.A.fromIso8601(c[e].textContent))}const g=new Mp.A;return g.addSamples(f,m),i.position=g,Ed(e,i,o,Dd(n,a)),_d(i,o),i.availability=new Dl.A,c.length>0&&i.availability.addInterval(new bt.A({start:f[0],stop:f[f.length-1]})),p&&u&&Id(t,i,o),!0},MultiTrack:function(e,t,r,i,o){const n=md(r,"interpolate",Xp.gx),a=pd(r,"Track",Xp.gx);let s,l,c,u=!1;const p=new Lp.A,d=new Dl.A,h=new pp.A,m=e._ellipsoid;for(let e=0,t=a.length;e<t;e++){const t=a[e],r=pd(t,"when",Xp.kml),i=pd(t,"coord",Xp.gx),o=hd(t,"altitudeMode",Xp.kml),f=hd(t,"altitudeMode",Xp.gx),g=od(o,f),y=md(t,"extrude",Xp.kml),b=Math.min(i.length,r.length),v=[];s=[];for(let e=0;e<b;e++){const t=nd(i[e].textContent,m);v.push(t),s.push(yt.A.fromIso8601(r[e].textContent))}n&&((0,aa.A)(l)&&zd([l,s[0]],[c,v[0]],h,d,p,!1,"absolute",void 0,!1),l=s[b-1],c=v[v.length-1]),zd(s,v,h,d,p,g&&y,o,f,!0),u=u||g&&y}return i.availability=d,i.position=h,Ed(e,i,o),_d(i,o),u&&(Id(t,i,o),i.polyline.show=p),!0},MultiGeometry:function(e,t,r,i,o,n){const a=r.childNodes;let s=!1;for(let r=0,l=a.length;r<l;r++){const l=a.item(r),c=Nd[l.localName];if((0,aa.A)(c)){const r=id(l,t,n);r.parent=i,r.name=i.name,r.availability=i.availability,r.description=i.description,r.kml=i.kml,c(e,t,l,r,o)&&(s=!0)}}return s},Model:function(e,t,r,i,o){return(0,Ol.A)("kml-unsupportedGeometry","KML - Unsupported geometry: ".concat(r.localName)),!1}};let kd;function Rd(e,t,r){const i=r.entityCollection,o=r.parentEntity,n=r.sourceResource,a=r.uriResolver,s=id(t,i,r.context),l=s.kml,c=function(e,t,r,i,o){const n=new mp.A;let a,s=-1;const l=t.childNodes,c=l.length;for(let e=0;e<c;e++){const t=l[e];"Style"!==t.localName&&"StyleMap"!==t.localName||(s=e)}if(-1!==s){const t=l[s];if("Style"===t.localName)Od(e,t,n,i,o);else{const s=pd(t,"Pair",Xp.kml);for(let t=0;t<s.length;t++){const l=s[t],c=hd(l,"key",Xp.kml);if("normal"===c){const t=hd(l,"styleUrl",Xp.kml);(0,aa.A)(t)?(a=r.getById(t),(0,aa.A)(a)||(a=r.getById("#".concat(t))),(0,aa.A)(a)&&n.merge(a)):Od(e,cd(l,"Style",Xp.kml),n,i,o)}else(0,Ol.A)("kml-styleMap-".concat(c),"KML - Unsupported StyleMap key: ".concat(c))}}}const u=hd(t,"styleUrl",Xp.kml);if((0,aa.A)(u)){let e=u;if("#"!==u[0]&&-1!==u.indexOf("#")){const t=u.split("#"),r=t[0],o=i.getDerivedResource({url:r});e="".concat(o.getUrlComponent(),"#").concat(t[1])}a=r.getById(e),(0,aa.A)(a)||(a=r.getById("#".concat(e))),(0,aa.A)(a)&&n.merge(a)}return n}(e,t,r.styleCollection,n,a),u=hd(t,"name",Xp.kml);s.name=u,s.parent=o;let p=function(e){const t=cd(e,"TimeSpan",Xp.kmlgx);if(!(0,aa.A)(t))return;let r;const i=cd(t,"begin",Xp.kmlgx);let o=(0,aa.A)(i)?yt.A.fromIso8601(i.textContent):void 0;const n=cd(t,"end",Xp.kmlgx);let a=(0,aa.A)(n)?yt.A.fromIso8601(n.textContent):void 0;if((0,aa.A)(o)&&(0,aa.A)(a)){if(yt.A.lessThan(a,o)){const e=o;o=a,a=e}r=new Dl.A,r.addInterval(new bt.A({start:o,stop:a}))}else(0,aa.A)(o)?(r=new Dl.A,r.addInterval(new bt.A({start:o,stop:Al.A.MAXIMUM_VALUE}))):(0,aa.A)(a)&&(r=new Dl.A,r.addInterval(new bt.A({start:Al.A.MINIMUM_VALUE,stop:a})));return r}(t);(0,aa.A)(p)||(p=function(e){const t=cd(e,"TimeStamp",Xp.kmlgx),r=hd(t,"when",Xp.kmlgx);if(!(0,aa.A)(t)||!(0,aa.A)(r)||0===r.length)return;const i=yt.A.fromIso8601(r),o=new Dl.A;return o.addInterval(new bt.A({start:i,stop:Al.A.MAXIMUM_VALUE})),o}(t)),s.availability=p,Yd(s);const d=md(t,"visibility",Xp.kml);s.show=function e(t){return!t||t.show&&e(t.parent)}(o)&&(null==d||d);const h=cd(t,"author",Xp.atom),m=l.author;m.name=hd(h,"name",Xp.atom),m.uri=hd(h,"uri",Xp.atom),m.email=hd(h,"email",Xp.atom);const f=cd(t,"link",Xp.atom),g=l.link;g.href=ld(f,"href"),g.hreflang=ld(f,"hreflang"),g.rel=ld(f,"rel"),g.type=ld(f,"type"),g.title=ld(f,"title"),g.length=ld(f,"length"),l.address=hd(t,"address",Xp.kml),l.phoneNumber=hd(t,"phoneNumber",Xp.kml),l.snippet=hd(t,"Snippet",Xp.kml),function(e,t){const r=cd(e,"ExtendedData",Xp.kml);if(!(0,aa.A)(r))return;(0,aa.A)(cd(r,"SchemaData",Xp.kml))&&(0,Ol.A)("kml-schemaData","KML - SchemaData is unsupported"),(0,aa.A)(ld(r,"xmlns:prefix"))&&(0,Ol.A)("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");const i={},o=pd(r,"Data",Xp.kml);if((0,aa.A)(o)){const e=o.length;for(let t=0;t<e;t++){const e=o[t],r=ld(e,"name");(0,aa.A)(r)&&(i[r]={displayName:hd(e,"displayName",Xp.kml),value:hd(e,"value",Xp.kml)})}}t.kml.extendedData=i}(t,s),function(e,t,r,i,o){var n;let a,s,l;const c=t.kml,u=c.extendedData,p=hd(e,"description",Xp.kml),d=null!==(n=t.balloonStyle)&&void 0!==n?n:r.balloonStyle;let h=ml.A.WHITE,m=ml.A.BLACK,f=p;var g,y,b;let v;var w,A,S;if((0,aa.A)(d)&&(h=null!==(g=d.bgColor)&&void 0!==g?g:ml.A.WHITE,m=null!==(y=d.textColor)&&void 0!==y?y:ml.A.BLACK,f=null!==(b=d.text)&&void 0!==b?b:p),(0,aa.A)(f)){if(f=f.replace("$[name]",null!==(w=t.name)&&void 0!==w?w:""),f=f.replace("$[description]",null!=p?p:""),f=f.replace("$[address]",null!==(A=c.address)&&void 0!==A?A:""),f=f.replace("$[Snippet]",null!==(S=c.snippet)&&void 0!==S?S:""),f=f.replace("$[id]",t.id),f=f.replace("$[geDirections]",""),(0,aa.A)(u)){const e=f.match(/\$\[.+?\]/g);if(null!==e)for(a=0;a<e.length;a++){const t=e[a];let r=t.substr(2,t.length-3);const i=/\/displayName$/.test(r);r=r.replace(/\/displayName$/,""),v=u[r],(0,aa.A)(v)&&(v=i?v.displayName:v.value),(0,aa.A)(v)&&(f=f.replace(t,null!=v?v:""))}}}else if((0,aa.A)(u)&&(l=Object.keys(u),l.length>0)){for(f='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',a=0;a<l.length;a++){var x,O;s=l[a],v=u[s],f+="<tr><th>".concat(null!==(x=v.displayName)&&void 0!==x?x:s,"</th><td>").concat(null!==(O=v.value)&&void 0!==O?O:"","</td></tr>")}f+="</tbody></table>"}if(!(0,aa.A)(f))return;f=qp.link(f),kd.innerHTML=f;const P=kd.querySelectorAll("a");for(a=0;a<P.length;a++)P[a].setAttribute("target","_blank");(0,aa.A)(i)&&i.keys.length>1&&(td(kd,"a","href",i),td(kd,"link","href",i),td(kd,"area","href",i),td(kd,"img","src",i),td(kd,"iframe","src",i),td(kd,"video","src",i),td(kd,"audio","src",i),td(kd,"source","src",i),td(kd,"track","src",i),td(kd,"input","src",i),td(kd,"embed","src",i),td(kd,"script","src",i),td(kd,"video","poster",i)),rd(kd,"a","href",o),rd(kd,"link","href",o),rd(kd,"area","href",o),rd(kd,"img","src",o),rd(kd,"iframe","src",o),rd(kd,"video","src",o),rd(kd,"audio","src",o),rd(kd,"source","src",o),rd(kd,"track","src",o),rd(kd,"input","src",o),rd(kd,"embed","src",o),rd(kd,"script","src",o),rd(kd,"video","poster",o);let T='<div class="cesium-infoBox-description-lighter" style="';T+="overflow:auto;",T+="word-wrap:break-word;",T+="background-color:".concat(h.toCssColorString(),";"),T+="color:".concat(m.toCssColorString(),";"),T+='">',T+="".concat(kd.innerHTML,"</div>"),kd.innerHTML="",t.description=T}(t,s,c,a,n);const y=e._ellipsoid;return Ud(t,s,y),Gd(t,s,y),(0,aa.A)(cd(t,"Region",Xp.kml))&&(0,Ol.A)("kml-region","KML - Placemark Regions are unsupported"),{entity:s,styleEntity:c}}function Md(e,t,r,i){i.addNodes(t.childNodes,r),i.process()}"undefined"!=typeof document&&(kd=document.createElement("div"));const Fd={FlyTo:function(e,t,r){const i=dd(t,"duration",Xp.gx),o=hd(t,"flyToMode",Xp.gx),n={kml:{}};Ud(t,n,r),Gd(t,n,r);const a=n.kml.lookAt||n.kml.camera,s=new Ip(i,o,a);e.addPlaylistEntry(s)},Wait:function(e,t){const r=dd(t,"duration",Xp.gx);e.addPlaylistEntry(new Cp(r))},SoundCue:Ld,AnimatedUpdate:Ld,TourControl:Ld};function Ld(e,t){(0,Ol.A)("KML Tour unsupported node ".concat(t.localName))}function Gd(e,t,r){const i=cd(e,"Camera",Xp.kml);if((0,aa.A)(i)){var o,n,a,s,l,c;const e=null!==(o=dd(i,"longitude",Xp.kml))&&void 0!==o?o:0,u=null!==(n=dd(i,"latitude",Xp.kml))&&void 0!==n?n:0,p=null!==(a=dd(i,"altitude",Xp.kml))&&void 0!==a?a:0,d=null!==(s=dd(i,"heading",Xp.kml))&&void 0!==s?s:0,h=null!==(l=dd(i,"tilt",Xp.kml))&&void 0!==l?l:0,m=null!==(c=dd(i,"roll",Xp.kml))&&void 0!==c?c:0,f=ul.A.fromDegrees(e,u,p,r),g=wl.A.fromDegrees(d,h-90,m);t.kml.camera=new yp(f,g)}}function Ud(e,t,r){const i=cd(e,"LookAt",Xp.kml);if((0,aa.A)(i)){var o,n,a,s;const e=null!==(o=dd(i,"longitude",Xp.kml))&&void 0!==o?o:0,l=null!==(n=dd(i,"latitude",Xp.kml))&&void 0!==n?n:0,c=null!==(a=dd(i,"altitude",Xp.kml))&&void 0!==a?a:0;let u=dd(i,"heading",Xp.kml),p=dd(i,"tilt",Xp.kml);const d=null!==(s=dd(i,"range",Xp.kml))&&void 0!==s?s:0;p=Rn.A.toRadians(null!=p?p:0),u=Rn.A.toRadians(null!=u?u:0);const h=new vl.A(u,p-Rn.A.PI_OVER_TWO,d),m=ul.A.fromDegrees(e,l,c,r);t.kml.lookAt=new bp(m,h)}}function Wd(e,t,r,i){e._unsupportedNode.raiseEvent(e,r.parentEntity,t,r.entityCollection,r.styleCollection,r.sourceResource,r.uriResolver),(0,Ol.A)("kml-unsupportedFeature-".concat(t.nodeName),"KML - Unsupported feature: ".concat(t.nodeName))}const qd={INTERVAL:0,EXPIRE:1,STOP:2};function Bd(e){if(!(0,aa.A)(e)||0===e.length)return"";const t=e[0];return"&"!==t&&"?"!==t||(e=e.substring(1)),e}const Vd=new As.A,Hd=new Ho.A,$d=new Vo.A,Jd=new ul.A;function Xd(e,t,r,i,o,n){function a(e){return e<-Rn.A.PI_OVER_TWO?-Rn.A.PI_OVER_TWO:e>Rn.A.PI_OVER_TWO?Rn.A.PI_OVER_TWO:e}function s(e){return e>Rn.A.PI?e-Rn.A.TWO_PI:e<-Rn.A.PI?e+Rn.A.TWO_PI:e}let l=(0,xl.A)(e.queryParameters);if(l=l.replace(/%5B/g,"[").replace(/%5D/g,"]"),(0,aa.A)(t)&&t._mode!==jl.A.MORPHING){let e,c;if(o=null!=o?o:Vd,(0,aa.A)(r)&&($d.x=.5*r.clientWidth,$d.y=.5*r.clientHeight,e=t.pickEllipsoid($d,n,Jd)),(0,aa.A)(e)?c=n.cartesianToCartographic(e,Hd):(c=As.A.center(o,Hd),e=n.cartographicToCartesian(c)),(0,aa.A)(i)&&!Rn.A.equalsEpsilon(i,1,Rn.A.EPSILON9)){const e=o.width*i*.5,t=o.height*i*.5;o=new As.A(s(c.longitude-e),a(c.latitude-t),s(c.longitude+e),a(c.latitude+t))}l=l.replace("[bboxWest]",Rn.A.toDegrees(o.west).toString()),l=l.replace("[bboxSouth]",Rn.A.toDegrees(o.south).toString()),l=l.replace("[bboxEast]",Rn.A.toDegrees(o.east).toString()),l=l.replace("[bboxNorth]",Rn.A.toDegrees(o.north).toString());const u=Rn.A.toDegrees(c.longitude).toString(),p=Rn.A.toDegrees(c.latitude).toString();l=l.replace("[lookatLon]",u),l=l.replace("[lookatLat]",p),l=l.replace("[lookatTilt]",Rn.A.toDegrees(t.pitch).toString()),l=l.replace("[lookatHeading]",Rn.A.toDegrees(t.heading).toString()),l=l.replace("[lookatRange]",ul.A.distance(t.positionWC,e)),l=l.replace("[lookatTerrainLon]",u),l=l.replace("[lookatTerrainLat]",p),l=l.replace("[lookatTerrainAlt]",c.height.toString()),n.cartesianToCartographic(t.positionWC,Hd),l=l.replace("[cameraLon]",Rn.A.toDegrees(Hd.longitude).toString()),l=l.replace("[cameraLat]",Rn.A.toDegrees(Hd.latitude).toString()),l=l.replace("[cameraAlt]",Rn.A.toDegrees(Hd.height).toString());const d=t.frustum,h=d.aspectRatio;let m="",f="";if((0,aa.A)(h)){const e=Rn.A.toDegrees(d.fov);h>1?(m=e,f=e/h):(f=e,m=e*h)}l=l.replace("[horizFov]",m.toString()),l=l.replace("[vertFov]",f.toString())}else l=l.replace("[bboxWest]","-180"),l=l.replace("[bboxSouth]","-90"),l=l.replace("[bboxEast]","180"),l=l.replace("[bboxNorth]","90"),l=l.replace("[lookatLon]",""),l=l.replace("[lookatLat]",""),l=l.replace("[lookatRange]",""),l=l.replace("[lookatTilt]",""),l=l.replace("[lookatHeading]",""),l=l.replace("[lookatTerrainLon]",""),l=l.replace("[lookatTerrainLat]",""),l=l.replace("[lookatTerrainAlt]",""),l=l.replace("[cameraLon]",""),l=l.replace("[cameraLat]",""),l=l.replace("[cameraAlt]",""),l=l.replace("[horizFov]",""),l=l.replace("[vertFov]","");(0,aa.A)(r)?(l=l.replace("[horizPixels]",r.clientWidth),l=l.replace("[vertPixels]",r.clientHeight)):(l=l.replace("[horizPixels]",""),l=l.replace("[vertPixels]","")),l=l.replace("[terrainEnabled]","1"),l=l.replace("[clientVersion]","1"),l=l.replace("[kmlVersion]","2.2"),l=l.replace("[clientName]","Cesium"),l=l.replace("[language]","English"),e.setQueryParameters((0,Il.A)(l))}function Kd(e,t,r,i,o,n,a){t.removeAll();const s=r.documentElement;let l=hd("Document"===s.localName?s:cd(s,"Document",Xp.kml),"name",Xp.kml);(0,aa.A)(l)||(l=(0,ea.A)(i.getUrlComponent())),(0,aa.A)(e._name)||(e._name=l);const c=new Qd._DeferredLoading(e),u=new gp.A(e);return Promise.all(Td(e,r,u,i,!1,o)).then(function(){let s=r.documentElement;if("kml"===s.localName){const e=s.childNodes;for(let t=0;t<e.length;t++){const r=e[t];if((0,aa.A)(Kp[r.localName])){s=r;break}}}const l={parentEntity:void 0,entityCollection:t,styleCollection:u,sourceResource:i,uriResolver:o,context:a,screenOverlayContainer:n};return t.suspendEvents(),function(e,t,r,i){const o=Kp[t.localName];(0,aa.A)(o)?o(e,t,r,i):Wd(e,t,r)}(e,s,l,c),t.resumeEvents(),c.wait().then(function(){return r.documentElement})})}function Zd(e,t,r,i){let o=(i=null!=i?i:gs.A.EMPTY_OBJECT).sourceUri;const n=i.uriResolver,a=i.context;let s=i.screenOverlayContainer,l=r;if("string"==typeof r||r instanceof Vi.A){l=(r=Vi.A.createIfNeeded(r)).fetchBlob(),o=null!=o?o:r.clone();const t=e._resourceCredits,i=r.credits;if((0,aa.A)(i)){const e=i.length;for(let r=0;r<e;r++)t.push(i[r])}}else o=null!=o?o:Vi.A.DEFAULT.clone();return o=Vi.A.createIfNeeded(o),(0,aa.A)(s)&&(s=(0,cp.A)(s)),Promise.resolve(l).then(function(r){return r instanceof Blob?function(e){const t=e.slice(0,Math.min(4,e.size)),r=(0,gl.A)(),i=new FileReader;return i.addEventListener("load",function(){r.resolve(1347093252===new DataView(i.result).getUint32(0,!1))}),i.addEventListener("error",function(){r.reject(i.error)}),i.readAsArrayBuffer(t),r.promise}(r).then(function(i){return i?async function(e,t,r,i,o){const n=(0,cl.A)("ThirdParty/Workers/zip-web-worker.js"),a=(0,cl.A)("ThirdParty/zip-module.wasm");(0,lp.jK)({workerURI:n,wasmURI:a});const s=new lp.zg(new lp.nZ(r)),l=await s.getEntries(),c=[],u={};let p;for(let e=0;e<l.length;e++){const t=l[e];t.directory||(/\.kml$/i.test(t.filename)?(0,aa.A)(p)&&/\//i.test(t.filename)?c.push(ed(t,u)):((0,aa.A)(p)&&c.push(ed(p,u)),p=t):c.push(ed(t,u)))}if((0,aa.A)(p)&&c.push(async function(e,t){let r=await e.getData(new lp.rd);r=Qp(r),r=Yp(r),t.kml=Wp.parseFromString(r,"application/xml")}(p,u)),await Promise.all(c),s.close(),!(0,aa.A)(u.kml))throw new ta.A("KMZ file does not contain a KML document.");return u.keys=Object.keys(u),Kd(e,t,u.kml,i,u,o)}(e,t,r,o,s):function(e){const t=(0,gl.A)(),r=new FileReader;return r.addEventListener("load",function(){t.resolve(r.result)}),r.addEventListener("error",function(){t.reject(r.error)}),r.readAsText(e),t.promise}(r).then(function(r){let i,l;r=Yp(r=Qp(r));try{i=Wp.parseFromString(r,"application/xml")}catch(e){l=e.toString()}if((0,aa.A)(l)||i.body||"parsererror"===i.documentElement.tagName){let e=(0,aa.A)(l)?l:i.documentElement.firstChild.nodeValue;throw e||(e=i.body.innerText),new ta.A(e)}return Kd(e,t,i,o,n,s,a)})}):Kd(e,t,r,o,n,s,a)}).catch(function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}function Qd(e){var t;const r=(e=null!=e?e:gs.A.EMPTY_OBJECT).camera,i=e.canvas;this._changed=new bs.A,this._error=new bs.A,this._loading=new bs.A,this._refresh=new bs.A,this._unsupportedNode=new bs.A,this._clock=void 0,this._entityCollection=new gp.A(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new Pl.A,this._networkLinks=new sl.A,this._entityCluster=new fp.A,this.canvas=i,this.camera=r,this._lastCameraView={position:(0,aa.A)(r)?ul.A.clone(r.positionWC):void 0,direction:(0,aa.A)(r)?ul.A.clone(r.directionWC):void 0,up:(0,aa.A)(r)?ul.A.clone(r.upWC):void 0,bbox:(0,aa.A)(r)?r.computeViewRectangle():As.A.clone(As.A.MAX_VALUE)},this._ellipsoid=null!==(t=e.ellipsoid)&&void 0!==t?t:ys.A.default;let o=e.credit;"string"==typeof o&&(o=new fs.A(o)),this._credit=o,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}function Yd(e){const t=e.parent;if((0,aa.A)(t)){const r=t.availability;if((0,aa.A)(r)){const t=e.availability;(0,aa.A)(t)?t.intersect(r):e.availability=r}}}Qd.load=function(e,t){return new Qd(t=null!=t?t:gs.A.EMPTY_OBJECT).load(e,t)},Object.defineProperties(Qd.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}}),Qd.prototype.load=function(e,t){var r;t=null!=t?t:gs.A.EMPTY_OBJECT,dp.A.setLoading(this,!0);const i=this._name;this._name=void 0,this._clampToGround=null!==(r=t.clampToGround)&&void 0!==r&&r;const o=this;return Zd(this,this._entityCollection,e,t).then(function(){let e;const t=o._entityCollection.computeAvailability();let r=t.start,n=t.stop;const a=yt.A.equals(r,Al.A.MINIMUM_VALUE),s=yt.A.equals(n,Al.A.MAXIMUM_VALUE);if(!a||!s){let t;a&&(t=new Date,t.setHours(0,0,0,0),r=yt.A.fromDate(t)),s&&(t=new Date,t.setHours(24,0,0,0),n=yt.A.fromDate(t)),e=new hp.A,e.startTime=r,e.stopTime=n,e.currentTime=yt.A.clone(r),e.clockRange=pl.A.LOOP_STOP,e.clockStep=dl.A.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(yt.A.secondsDifference(n,r)/60,1),31556900))}let l=!1;return e!==o._clock&&(o._clock=e,l=!0),i!==o._name&&(l=!0),l&&o._changed.raiseEvent(o),dp.A.setLoading(o,!1),o}).catch(function(e){return dp.A.setLoading(o,!1),o._error.raiseEvent(o,e),console.log(e),Promise.reject(e)})},Qd.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};const eh=new sl.A;function th(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}Qd.prototype.update=function(e){const t=this._networkLinks;if(0===t.length)return!0;const r=yt.A.now(),i=this;function o(e){const t=e._children,r=t.length;for(let e=0;e<r;++e){const r=t[e];eh.set(r.id,r),o(r)}}eh.removeAll();let n=!1;const a=this._lastCameraView,s=this.camera;!(0,aa.A)(s)||s.positionWC.equalsEpsilon(a.position,Rn.A.EPSILON7)&&s.directionWC.equalsEpsilon(a.direction,Rn.A.EPSILON7)&&s.upWC.equalsEpsilon(a.up,Rn.A.EPSILON7)||(a.position=ul.A.clone(s.positionWC),a.direction=ul.A.clone(s.directionWC),a.up=ul.A.clone(s.upWC),a.bbox=s.computeViewRectangle(),n=!0);const l=new sl.A;let c=!1;return t.values.forEach(function(e){const t=e.entity;if(!eh.contains(t.id)){if(!e.updating){let u=!1;if(e.refreshMode===qd.INTERVAL?yt.A.secondsDifference(r,e.lastUpdated)>e.time&&(u=!0):e.refreshMode===qd.EXPIRE?yt.A.greaterThan(r,e.time)&&(u=!0):e.refreshMode===qd.STOP&&(n&&(e.needsUpdate=!0,e.cameraUpdateTime=r),e.needsUpdate&&yt.A.secondsDifference(r,e.cameraUpdateTime)>=e.time&&(u=!0)),u){var s;o(t),e.updating=!0;const r=new gp.A,n=e.href.clone();n.setQueryParameters(e.cookie);const u=null!==(s=i._ellipsoid)&&void 0!==s?s:ys.A.default;Xd(n,i.camera,i.canvas,e.viewBoundScale,a.bbox,u),Zd(i,r,n,{context:t.id}).then(function(e,t,r,i,o){return function(n){if(!i.contains(t.id))return;let a=!1;const s=cd(n,"NetworkLinkControl",Xp.kml);let l=0;if((0,aa.A)(s)){var c,u;if((0,aa.A)(cd(s,"Update",Xp.kml)))return(0,Ol.A)("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,void i.remove(t.id);t.cookie=(0,Il.A)(null!==(c=hd(s,"cookie",Xp.kml))&&void 0!==c?c:""),l=null!==(u=dd(s,"minRefreshPeriod",Xp.kml))&&void 0!==u?u:0}const p=yt.A.now(),d=t.refreshMode;if(d===qd.INTERVAL)(0,aa.A)(s)&&(t.time=Math.max(l,t.time));else if(d===qd.EXPIRE){let e;if((0,aa.A)(s)&&(e=hd(s,"expires",Xp.kml)),(0,aa.A)(e))try{const r=yt.A.fromIso8601(e),i=yt.A.secondsDifference(r,p);i>0&&i<l&&yt.A.addSeconds(p,l,r),t.time=r}catch(e){(0,Ol.A)("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),a=!0}else(0,Ol.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),a=!0}const h=t.entity,m=e._entityCollection,f=r.values;function g(e){m.remove(e);const t=e._children,r=t.length;for(let e=0;e<r;++e)g(t[e])}m.suspendEvents();const y=m.values.slice();let b;for(b=0;b<y.length;++b){const e=y[b];e.parent===h&&(e.parent=void 0,g(e))}for(m.resumeEvents(),m.suspendEvents(),b=0;b<f.length;b++){const e=f[b];(0,aa.A)(e.parent)||(e.parent=h,Yd(e)),m.add(e)}m.resumeEvents(),a?i.remove(t.id):t.lastUpdated=p;const v=m.computeAvailability(),w=v.start,A=v.stop,S=yt.A.equals(w,Al.A.MINIMUM_VALUE),x=yt.A.equals(A,Al.A.MAXIMUM_VALUE);if(!S||!x){const t=e._clock;t.startTime===w&&t.stopTime===A||(t.startTime=w,t.stopTime=A,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,o.getUrlComponent(!0))}}(i,e,r,l,n)).catch(function(t){const r="NetworkLink ".concat(e.href," refresh failed: ").concat(t);console.log(r),i._error.raiseEvent(i,r)}),c=!0}}l.set(e.id,e)}}),c&&(this._networkLinks=l,this._changed.raiseEvent(this)),!0},Qd._DeferredLoading=Zp,Qd._getTimestamp=bl.A;const rh=Qd;var ih,oh,nh,ah,sh,lh,ch;function uh(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function ph(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let dh=(ih=(0,K.A)({type:"string",name:"KML data source URI.",description:"Overrides the url to use for resolving relative links and other KML network features."}),oh=(0,K.A)({type:"string",name:"kmlString",description:"A kml string"}),nh=(0,K.A)({type:"boolean",name:"Clamp to Ground",description:"true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground"}),ah=class extends((0,u.A)(d.A,Ki.Ay,_e.Ay,ke.A,ln.A)){constructor(){super(...arguments),uh(this,"dataSourceUri",sh,this),uh(this,"kmlString",lh,this),uh(this,"clampToGround",ch,this)}},sh=ph(ah.prototype,"dataSourceUri",[ih],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lh=ph(ah.prototype,"kmlString",[oh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ch=ph(ah.prototype,"clampToGround",[nh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ah);var hh,mh,fh=r(73685);function gh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yh(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const bh=/\.kmz$/i;let vh=(mh=class e extends((0,$i.Ay)((0,Ee.A)((0,fh.A)((0,s.A)((0,g.A)(dh)))))){constructor(){super(...arguments),gh(this,"_dataSource",void 0),gh(this,"_kmlFile",void 0),(0,i.Gn)(this)}get type(){return e.type}setFileInput(e){this._kmlFile=e}get hasLocalData(){return(0,n.A)(this._kmlFile)}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}async forceLoadMapItems(){try{let e;if((0,n.A)(this.kmlString)?e=(new DOMParser).parseFromString(this.kmlString,"text/xml"):(0,n.A)(this._kmlFile)?e=this._kmlFile.name&&this._kmlFile.name.match(bh)?this._kmlFile:await na(this._kmlFile):(0,n.A)(this.ionResource)?e=this.ionResource:(0,n.A)(this.url)&&(e=(0,ie.A)(this,this.url)),!e)throw(0,At.mG)({sender:this,title:Pe.Ay.t("models.kml.unableToLoadItemTitle"),message:Pe.Ay.t("models.kml.unableToLoadItemMessage")});this._dataSource=await rh.load(e,{clampToGround:this.clampToGround,sourceUri:this.dataSourceUri?(0,ie.A)(this,this.dataSourceUri,"1d"):void 0})}catch(e){throw(0,At.mG)(At.Ay.from(e,{sender:this,title:Pe.Ay.t("models.kml.errorLoadingTitle"),message:Pe.Ay.t("models.kml.errorLoadingMessage",{appName:this.terria.appName})}))}}get mapItems(){return this.isLoadingMapItems||void 0===this._dataSource?[]:(this._dataSource.show=this.show,[this._dataSource])}forceLoadMetadata(){return this.loadIonResource()}},gh(mh,"type","kml"),yh((hh=mh).prototype,"hasLocalData",[i.EW],Object.getOwnPropertyDescriptor(hh.prototype,"hasLocalData"),hh.prototype),yh(hh.prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(hh.prototype,"cacheDuration"),hh.prototype),yh(hh.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(hh.prototype,"mapItems"),hh.prototype),hh);const wh=vh;var Ah,Sh,xh,Oh,Ph,Th,Ih,Dh,Ch,Eh=r(81328);function _h(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function jh(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let zh=(Ah=(0,K.A)({name:"url",description:"The Mapbox server url.",type:"string"}),Sh=(0,K.A)({name:"mapId",description:"The Mapbox Map ID.",type:"string"}),xh=(0,K.A)({name:"accessToken",description:"The public access token for the imagery.",type:"string"}),Oh=(0,K.A)({name:"format",description:"The format of the image request.",type:"string"}),Ph=class extends((0,u.A)(Ji.A,_e.Ay,Ki.Ay,ke.A)){constructor(){super(...arguments),_h(this,"url",Th,this),_h(this,"mapId",Ih,this),_h(this,"accessToken",Dh,this),_h(this,"format",Ch,this)}},Th=jh(Ph.prototype,"url",[Ah],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://api.mapbox.com/v4/"}}),Ih=jh(Ph.prototype,"mapId",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dh=jh(Ph.prototype,"accessToken",[xh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ch=jh(Ph.prototype,"format",[Oh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"png"}}),Ph);var Nh,kh;function Rh(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mh(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Fh=(kh=class e extends((0,s.A)((0,$i.Ay)((0,g.A)(zh)))){constructor(){super(...arguments),Rh(this,"type",e.type),(0,i.Gn)(this)}get imageryProvider(){var e;const t=this.mapId,r=this.accessToken;if(void 0===t||void 0===r)return;const i=void 0===this.url?void 0:(0,ie.A)(this,this.url);return new Eh.A({url:i,mapId:t,accessToken:r,credit:this.attribution,maximumLevel:null!==(e=this.maximumLevel)&&void 0!==e?e:25,minimumLevel:this.minimumLevel,format:this.format})}forceLoadMapItems(){return Promise.resolve()}get mapItems(){const e=this.imageryProvider;return void 0===e?[]:[{imageryProvider:e,show:this.show,alpha:this.opacity,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]}},Rh(kh,"type","mapbox-map"),Mh((Nh=kh).prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(Nh.prototype,"imageryProvider"),Nh.prototype),Mh(Nh.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Nh.prototype,"mapItems"),Nh.prototype),Nh);const Lh=/\/$/,Gh=new fs.A('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function Uh(e){var t,r,i;const o=(e=null!=e?e:gs.A.EMPTY_OBJECT).styleId,n=e.accessToken;this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;const a=Vi.A.createIfNeeded(null!==(t=e.url)&&void 0!==t?t:"https://api.mapbox.com/styles/v1/");this._styleId=o,this._accessToken=n;const s=null!==(r=e.tilesize)&&void 0!==r?r:512;this._tilesize=s;const l=null!==(i=e.username)&&void 0!==i?i:"mapbox";this._username=l;const c=(0,aa.A)(e.scaleFactor)?"@2x":"";let u,p=a.getUrlComponent();Lh.test(p)||(p+="/"),p+="".concat(this._username,"/").concat(o,"/tiles/").concat(this._tilesize,"/{z}/{x}/{y}").concat(c),a.url=p,a.setQueryParameters({access_token:n}),(0,aa.A)(e.credit)?(u=e.credit,"string"==typeof u&&(u=new fs.A(u))):u=Gh,this._resource=a,this._imageryProvider=new Hi.A({url:a,credit:u,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(Uh.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),Uh.prototype.getTileCredits=function(e,t,r){},Uh.prototype.requestImage=function(e,t,r,i){return this._imageryProvider.requestImage(e,t,r,i)},Uh.prototype.pickFeatures=function(e,t,r,i,o){return this._imageryProvider.pickFeatures(e,t,r,i,o)},Uh._defaultCredit=Gh;const Wh=Uh;var qh,Bh,Vh,Hh,$h,Jh,Xh,Kh,Zh,Qh,Yh,em,tm;function rm(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function im(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let om=(qh=(0,K.A)({name:"url",description:"The Mapbox server url.",type:"string"}),Bh=(0,K.A)({name:"accessToken",description:"The username of the map account.",type:"string"}),Vh=(0,K.A)({name:"styleId",description:"The Mapbox Style ID. eg 'streets-v11', 'outdoors-v11'. You can find more styleIds for the 'mapbox' user here: https://docs.mapbox.com/api/maps/styles/#mapbox-styles",type:"string"}),Hh=(0,K.A)({name:"accessToken",description:"The public access token for the imagery.",type:"string"}),$h=(0,K.A)({name:"tilesize",description:"The size of the image tiles.",type:"number"}),Jh=(0,K.A)({name:"scaleFactor",description:"When true, the tiles are rendered at a @2x scale factor.",type:"boolean"}),Xh=class extends((0,u.A)(Ji.A,_e.Ay,Ki.Ay,ke.A)){constructor(){super(...arguments),rm(this,"url",Kh,this),rm(this,"username",Zh,this),rm(this,"styleId",Qh,this),rm(this,"accessToken",Yh,this),rm(this,"tilesize",em,this),rm(this,"scaleFactor",tm,this)}},Kh=im(Xh.prototype,"url",[qh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://api.mapbox.com/styles/v1/"}}),Zh=im(Xh.prototype,"username",[Bh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"mapbox"}}),Qh=im(Xh.prototype,"styleId",[Vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yh=im(Xh.prototype,"accessToken",[Hh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),em=im(Xh.prototype,"tilesize",[$h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 512}}),tm=im(Xh.prototype,"scaleFactor",[Jh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xh);var nm,am;function sm(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lm(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let cm=(am=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(om)))){constructor(){super(...arguments),sm(this,"type",e.type),(0,i.Gn)(this)}forceLoadMapItems(){return Promise.resolve()}get imageryProvider(){const e=this.styleId,t=this.accessToken;if(void 0!==e&&void 0!==t)return new Wh({url:this.url,username:this.username,styleId:e,accessToken:t,tilesize:this.tilesize,scaleFactor:this.scaleFactor?this.scaleFactor:void 0,minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel,credit:this.attribution})}get mapItems(){const e=this.imageryProvider;return void 0===e?[]:[{imageryProvider:e,show:this.show,alpha:this.opacity,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]}},sm(am,"type","mapbox-style"),lm((nm=am).prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(nm.prototype,"imageryProvider"),nm.prototype),lm(nm.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(nm.prototype,"mapItems"),nm.prototype),nm);var um=r(2568),pm=r(87791);function dm(e,t){return"number"==typeof e?e:t}function hm(e){if(e.includes("$type"))return e=>!0;if("=="===e[0])return(t,r)=>r.props[e[1]]===e[2];if("!="===e[0])return(t,r)=>r.props[e[1]]!==e[2];if("!"===e[0]){const t=hm(e[1]);return(e,r)=>!t(e,r)}if("<"===e[0])return(t,r)=>dm(r.props[e[1]],1/0)<e[2];if("<="===e[0])return(t,r)=>dm(r.props[e[1]],1/0)<=e[2];if(">"===e[0])return(t,r)=>dm(r.props[e[1]],-1/0)>e[2];if(">="===e[0])return(t,r)=>dm(r.props[e[1]],-1/0)>=e[2];if("in"===e[0])return(t,r)=>e.slice(2,e.length).includes(r.props[e[1]]);if("!in"===e[0])return(t,r)=>!e.slice(2,e.length).includes(r.props[e[1]]);if("has"===e[0])return(t,r)=>e[1]in r.props;if("!has"===e[0])return(t,r)=>!(e[1]in r.props);if("all"===e[0]){const t=e.slice(1,e.length).map(e=>hm(e));return(e,r)=>t.every(t=>t(e,r))}if("any"===e[0]){const t=e.slice(1,e.length).map(e=>hm(e));return(e,r)=>t.some(t=>t(e,r))}return console.log("Unimplemented filter: ",e[0]),e=>!1}function mm(e){if(e.base&&e.stops)return t=>(0,um.oN)(e.base,e.stops)(t-1);if("interpolate"===e[0]&&"exponential"===e[1][0]&&"zoom"===e[2][0]){const t=e.slice(3),r=[];for(let e=0;e<t.length;e+=2)r.push([t[e],t[e+1]]);return t=>(0,um.oN)(e[1][1],r)(t-1)}if("step"===e[0]&&"get"===e[1][0]){const t=e.slice(2),r=e[1][1];return(e,i)=>{const o=null==i?void 0:i.props[r];if("number"==typeof o){if(o<t[1])return t[0];for(let e=1;e<t.length;e+=2)if(o<=t[e])return t[e+1]}return t[t.length-1]}}return console.log("Unimplemented numeric fn: ",e),e=>1}function fm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e?"number"==typeof e?e:(r,i)=>i?mm(e)(r,i):t:t}function gm(e,t){const r=fm(e,1),i=fm(t);return(e,t)=>{const o="number"==typeof r?r:r(e,t);return i?o+("number"==typeof i?i:i(e,t)):o}}function ym(e,t){const r=[];for(const i of e["text-font"])i in t&&r.push(t[i]);0===r.length&&r.push({face:"sans-serif"});const i=e["text-size"];let o="";r.length&&r[0].weight&&(o="".concat(r[0].weight," "));let n="";if(r.length&&r[0].style&&(n="".concat(r[0].style," ")),"number"==typeof i)return e=>"".concat(n).concat(o).concat(i,"px ").concat(r.map(e=>e.face).join(", "));if(i.stops){let e=1.4;i.base?e=i.base:i.base=e;const t=mm(i);return(e,i)=>"".concat(n).concat(o).concat(t(e,i),"px ").concat(r.map(e=>e.face).join(", "))}if("step"===i[0]){const e=mm(i);return(t,i)=>"".concat(n).concat(o).concat(e(t,i),"px ").concat(r.map(e=>e.face).join(", "))}return console.log("Can't parse font: ",e),e=>"12px sans-serif"}var bm,vm,wm,Am,Sm,xm,Om,Pm,Tm,Im,Dm,Cm,Em,_m,jm,zm,Nm,km,Rm,Mm,Fm,Lm,Gm,Um=r(1988);function Wm(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function qm(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Bm=(bm=(0,Re.b)({description:"Creates one catalog item from url that points to a mvt service.",example:{type:"mvt",name:"mvt example",description:"Federal electoral boundaries which will apply at the 2019 federal election. Produced by combining boundary datasets provided by AEC for each state.",url:"https://tiles.terria.io/ELB_2019/{z}/{x}/{y}.pbf",opacity:1,lineColor:"hsl(180,80%,30%)",layer:"ELB_2019",maximumNativeZoom:12,minimumZoom:0,id:"some unique id"}}),vm=(0,K.A)({type:"string",name:"lineColor",description:"This property exists for backward compatibility. The outline color of the features, specified as a CSS color string. This will only be used if `layer` trait has been set. For more complex styling - see `style` trait."}),wm=(0,K.A)({type:"string",name:"fillColor",description:"This property exists for backward compatibility. The fill color of the features, specified as a CSS color string. This will only be used if `layer` trait has been set. For more complex styling - see `style` trait."}),Am=(0,K.A)({type:"string",name:"layer",description:"This property exists for backward compatibility. It can be used to only show a particular layer in the tileset."}),Sm=(0,hr.A)({name:"style",description:'JSON style spec for MVT. This supports subset of Mapbox style spec (https://docs.mapbox.com/mapbox-gl-js/style-spec/layers/).\n\nFor supported properties - refer to https://github.com/protomaps/protomaps.js/blob/master/src/compat/json_style.ts.\n\nFor example:\n```json\n{\n  "layers": [\n    {\n      "type": "fill",\n      "source-layer": "buildings",\n      "paint": {\n        "fill-color": "black"\n      }\n    },\n    {\n      "type": "line",\n      "source-layer": "buildings",\n      "paint": {\n        "line-color": "red",\n        "line-width": 1\n      }\n    },\n    {\n      "type": "symbol",\n      "source-layer": "places",\n      "layout": {\n        "text-size": 20,\n        "text-font": "sans-serif"\n      },\n      "paint": {\n        "text-color": "red"\n      }\n    }\n  ]\n}\n```'}),xm=(0,K.A)({type:"string",name:"Style URL",description:"URL to JSON file for styling. See `style` trait for more info."}),Om=(0,K.A)({type:"string",name:"idProperty",description:"The name of the property that is a unique ID for features."}),Pm=(0,K.A)({type:"string",name:"nameProperty",description:"The name of the property from which to obtain the name of features."}),Tm=(0,K.A)({type:"number",name:"maximumNativeZoom",description:"The maximum zoom level for which tile files exist."}),Im=(0,K.A)({type:"number",name:"maximumZoom",description:"The maximum zoom level that can be displayed by using the data in the  MapboxVectorTileCatalogItem#maximumNativeZoom tiles."}),Dm=(0,K.A)({type:"number",name:"minimumZoom",description:"The minimum zoom level for which tile files exist."}),bm((Em=class extends((0,u.A)(Xi.A,d.A,Ki.Ay,_e.Ay,ke.A,Ji.A)){constructor(){super(...arguments),Wm(this,"lineColor",_m,this),Wm(this,"fillColor",jm,this),Wm(this,"layer",zm,this),Wm(this,"style",Nm,this),Wm(this,"styleUrl",km,this),Wm(this,"idProperty",Rm,this),Wm(this,"nameProperty",Mm,this),Wm(this,"maximumNativeZoom",Fm,this),Wm(this,"maximumZoom",Lm,this),Wm(this,"minimumZoom",Gm,this)}},_m=qm(Em.prototype,"lineColor",[vm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jm=qm(Em.prototype,"fillColor",[wm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zm=qm(Em.prototype,"layer",[Am],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nm=qm(Em.prototype,"style",[Sm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),km=qm(Em.prototype,"styleUrl",[xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rm=qm(Em.prototype,"idProperty",[Om],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"FID"}}),Mm=qm(Em.prototype,"nameProperty",[Pm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fm=qm(Em.prototype,"maximumNativeZoom",[Tm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 12}}),Lm=qm(Em.prototype,"maximumZoom",[Im],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 28}}),Gm=qm(Em.prototype,"minimumZoom",[Dm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Cm=Em))||Cm);var Vm,Hm,$m,Jm;function Xm(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Km(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Zm=(Hm=class e extends((0,pt.Ay)(Bm)){constructor(e,t){super(),this.item=e,this.styleJson=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.styleJson)}static async load(t){let r;if(t.styleUrl)try{r=await(0,H.A)((0,ie.A)(t,t.styleUrl))}catch(e){throw At.Ay.from(e,"Failed to load style JSON from url ".concat(t.styleUrl))}return new e(t,r)}get style(){return this.styleJson}get opacity(){return 1}get legends(){return this.item.fillColor||this.item.lineColor?[(0,ut.A)(Um.A,{items:[(0,ut.A)(Um.G,{color:this.item.fillColor,outlineColor:this.item.lineColor,outlineWidth:this.item.lineColor?1:void 0,title:this.item.name})]})]:[]}},Xm(Hm,"stratumName","MapboxVectorTileLoadable"),Km((Vm=Hm).prototype,"legends",[i.EW],Object.getOwnPropertyDescriptor(Vm.prototype,"legends"),Vm.prototype),Vm);dt.A.addLoadStratum(Zm.stratumName);let Qm=(Jm=class e extends((0,$i.Ay)((0,Ee.A)((0,s.A)((0,g.A)(Bm))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.mapboxVectorTile.name")}async forceLoadMetadata(){const e=await Zm.load(this);(0,i.h5)(()=>{this.strata.set(Zm.stratumName,e)})}get parsedJsonStyle(){if(this.style)return function(e,t){if(!e||!e.layers)return;const r=[],i=[],o=new Map;try{for(const n of e.layers){if(o.set(n.id,n),n.layout&&"none"===n.layout.visibility)continue;if(n.ref){const e=o.get(n.ref);n.type=e.type,n.filter=e.filter,n.source=e.source,n["source-layer"]=e["source-layer"]}let e;n.filter&&(e=hm(n.filter)),"fill"===n.type?r.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.JY({fill:n.paint["fill-color"],opacity:n.paint["fill-opacity"]})}):"fill-extrusion"===n.type?r.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.JY({fill:n.paint["fill-extrusion-color"],opacity:n.paint["fill-extrusion-opacity"]})}):"line"===n.type?n.paint["line-dasharray"]?r.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.Z$({width:gm(n.paint["line-width"],n.paint["line-gap-width"]),dash:n.paint["line-dasharray"],dashColor:n.paint["line-color"]})}):r.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.Z$({color:n.paint["line-color"],width:gm(n.paint["line-width"],n.paint["line-gap-width"])})}):"symbol"===n.type?"line"===n.layout["symbol-placement"]?i.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.bg({font:ym(n.layout,t),fill:n.paint["text-color"],width:n.paint["text-halo-width"],stroke:n.paint["text-halo-color"],textTransform:n.layout["text-transform"],labelProps:n.layout["text-field"]?[n.layout["text-field"]]:void 0})}):i.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.kC({font:ym(n.layout,t),fill:n.paint["text-color"],stroke:n.paint["text-halo-color"],width:n.paint["text-halo-width"],textTransform:n.layout["text-transform"],labelProps:n.layout["text-field"]?[n.layout["text-field"]]:void 0})}):"circle"===n.type&&r.push({dataLayer:n["source-layer"],filter:e,symbolizer:new um.rD({radius:n.paint["circle-radius"],fill:n.paint["circle-color"],stroke:n.paint["circle-stroke-color"],width:n.paint["circle-stroke-width"]})})}i.reverse()}catch(e){At.Ay.from(e,"Error parsing mapbox style").log()}return{paintRules:r,labelRules:i,tasks:[]}}(this.style,{})}get paintRules(){const e=[];return this.layer&&(this.fillColor&&e.push({dataLayer:this.layer,symbolizer:new um.JY({fill:this.fillColor}),minzoom:this.minimumZoom,maxzoom:this.maximumZoom,filter:(e,t)=>t.geomType===um.tc.Polygon}),this.lineColor&&e.push({dataLayer:this.layer,symbolizer:new um.Z$({color:this.lineColor}),minzoom:this.minimumZoom,maxzoom:this.maximumZoom})),this.parsedJsonStyle&&e.push(...this.parsedJsonStyle.paintRules),e}get labelRules(){return this.parsedJsonStyle?this.parsedJsonStyle.labelRules:[]}get imageryProvider(){if(void 0!==this.url)return new pm.Ay({terria:this.terria,id:this.url,data:(0,ie.A)(this,this.url),minimumZoom:this.minimumZoom,maximumNativeZoom:this.maximumNativeZoom,maximumZoom:this.maximumZoom,rectangle:this.cesiumRectangle,credit:this.attribution,paintRules:this.paintRules,labelRules:this.labelRules,idProperty:this.idProperty})}forceLoadMapItems(){return Promise.resolve()}get mapItems(){return this.isLoadingMapItems||void 0===this.imageryProvider?[]:[{imageryProvider:this.imageryProvider,show:this.show,alpha:this.opacity,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]}},Xm(Jm,"type","mvt"),Km(($m=Jm).prototype,"parsedJsonStyle",[i.EW],Object.getOwnPropertyDescriptor($m.prototype,"parsedJsonStyle"),$m.prototype),Km($m.prototype,"paintRules",[i.EW],Object.getOwnPropertyDescriptor($m.prototype,"paintRules"),$m.prototype),Km($m.prototype,"labelRules",[i.EW],Object.getOwnPropertyDescriptor($m.prototype,"labelRules"),$m.prototype),Km($m.prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor($m.prototype,"imageryProvider"),$m.prototype),Km($m.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor($m.prototype,"mapItems"),$m.prototype),$m);const Ym=Qm;var ef,tf,rf,of,nf,af,sf;function lf(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function cf(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let uf=(ef=(0,Re.b)({description:"Creates one base map item from url that points to an OpenStreetMap service.",example:{item:{type:"open-street-map",name:"Voyager",url:"https://global.ssl.fastly.net/rastertiles/voyager/",attribution:"Â© OpenStreetMap contributors ODbL, Â© CartoDB CC-BY 3.0",opacity:1,subdomains:["cartodb-basemaps-a","cartodb-basemaps-b","cartodb-basemaps-c","cartodb-basemaps-d"]},image:"https://terria-catalogs-public.storage.googleapis.com/misc/basemaps/icons/voyager-aus.png",id:"some unique id"}}),tf=(0,K.A)({name:"File extension",description:"The file extension used to retrieve Open Street Map data",type:"string"}),rf=(0,mr.A)({name:"Subdomains",description:"Array of subdomains, one of which will be prepended to each tile URL. This is useful for overcoming browser limit on the number of simultaneous requests per host.",type:"string"}),ef((nf=class extends((0,u.A)(Ji.A,Xi.A,d.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),lf(this,"fileExtension",af,this),lf(this,"subdomains",sf,this)}},af=cf(nf.prototype,"fileExtension",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"png"}}),sf=cf(nf.prototype,"subdomains",[rf],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),of=nf))||of);var pf,df;function hf(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let mf=(df=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(uf)))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}forceLoadMapItems(){return Promise.resolve()}get mapItems(){const e=this.imageryProvider;return(0,n.A)(e)?[{show:this.show,alpha:this.opacity,imageryProvider:e,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}get imageryProvider(){var e,t;if((0,n.A)(this.templateUrl))return new Hi.A({url:(t=this.templateUrl,(0,ie.A)(this,ff(t))),subdomains:this.subdomains.slice(),credit:this.attribution,maximumLevel:null!==(e=this.maximumLevel)&&void 0!==e?e:25,minimumLevel:this.minimumLevel,tileHeight:this.tileHeight,tileWidth:this.tileWidth})}get templateUrl(){if(!(0,n.A)(this.url))return;const e=new(Ie())(this.url);this.subdomains.length>0&&-1===this.url.indexOf("{s}")&&e.hostname("{s}.".concat(e.hostname()));const t=e.path(),r="/"===t[t.length-1]?"":"/";return e.path("".concat(t).concat(r,"{z}/{x}/{y}.").concat(this.fileExtension)),decodeURI(e.toString())}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(df,"type","open-street-map"),hf((pf=df).prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(pf.prototype,"mapItems"),pf.prototype),hf(pf.prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(pf.prototype,"imageryProvider"),pf.prototype),hf(pf.prototype,"templateUrl",[i.EW],Object.getOwnPropertyDescriptor(pf.prototype,"templateUrl"),pf.prototype),pf);function ff(e){return new(Ie())(e).search(""),decodeURI(e.toString())}var gf,yf,bf,vf,wf,Af,Sf,xf=r(26406),Of=r(48726);function Pf(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Tf(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let If=(gf=(0,K.A)({type:"string",name:"Location ID Filter",description:'\n    A string to filter locations using the id field, locations matching the filter will be included,\n    multiple filters can be seperated using a comma, eg "*boorowa*,*environdata*"\n    '}),yf=(0,K.A)({type:"string",name:"Stream ID Filter",description:'\n    A string to filter streams using the id field, streams matching the filter will be included,\n    multiple filters can be seperated using a comma, eg "*SHT31DIS_ALL*,*environdata*"\n    '}),bf=(0,Pt.A)({type:Of.A,name:"Style",description:"Styling rules that follow [simplestyle-spec](https://github.com/mapbox/simplestyle-spec)"}),vf=class extends((0,u.A)(xf.A,Ki.Ay,_e.Ay,ke.A,d.A)){constructor(){super(...arguments),Pf(this,"locationIdFilter",wf,this),Pf(this,"streamIdFilter",Af,this),Pf(this,"style",Sf,this)}},wf=Tf(vf.prototype,"locationIdFilter",[gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Af=Tf(vf.prototype,"streamIdFilter",[yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sf=Tf(vf.prototype,"style",[bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vf);var Df,Cf;function Ef(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function _f(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jf extends((0,pt.Ay)(If)){constructor(e,t){super(),this.senapsLocationsCatalogItem=e,this.geojsonItem=t,this.geojsonItem=t}duplicateLoadableStratum(e){return new jf(e,this.geojsonItem)}static async load(e){const t=e._constructLocationsUrl();try{const r=(await(0,H.A)((0,ie.A)(e,t,"0d")))._embedded.locations,i=[];for(let t=0;t<r.length;t++){const o=r[t].id,n=(0,ie.A)(e,e._constructStreamsUrl(o),"0d");i.push((0,H.A)(n))}const o=await Promise.all(i),a={type:"FeatureCollection",features:r.map((e,t)=>{const r={type:"Feature",properties:{id:e.id,description:e.description,endpoint:e._links.self.href,hasStreams:null,streamIds:[]},geometry:e.geojson};return function(e,t,r){const i=r[t];0===i.count?e.properties.hasStreams=!1:void 0!==i._embedded&&(e.properties.streamIds=i._embedded.streams.map(e=>e.id),e.properties.hasStreams=!0)}(r,t,o),r})},s=new Or.default(void 0,e.terria);if(s.setTrait(C.A.definition,"geoJsonData",a),s.setTrait(C.A.definition,"clampToGround",!0),(0,n.A)(e.style)&&s.setTrait(C.A.definition,"style",e.style),!e.url)throw new At.Ay({title:Pe.Ay.t("models.senaps.retrieveErrorTitle"),message:Pe.Ay.t("models.senaps.missingSenapsBaseUrl")});const l=(0,ie.A)(e,e.url,"0d"),c=(0,ut.A)(It.e,{template:"<h4>".concat(Pe.Ay.t("models.senaps.locationHeadingFeatureInfo"),': {{id}}</h4>\n  <h5 style="margin-bottom:5px;">').concat(Pe.Ay.t("models.senaps.availableStreamsHeadingFeatureInfo"),"</h5>\n  {{#hasStreams}}\n    <ul>{{#streamIds}}\n      <li>{{.}}</li>\n    {{/streamIds}}</ul>\n    <br/>\n    <chart\n      identifier='{{id}}'\n      title='{{id}}'\n      sources='").concat(l,"/observations?streamid={{#terria.urlEncodeComponent}}{{streamIds}}{{/terria.urlEncodeComponent}}&limit=1440&media=csv&csvheader=false&sort=descending,").concat(l,"/observations?streamid={{#terria.urlEncodeComponent}}{{streamIds}}{{/terria.urlEncodeComponent}}&limit=7200&media=csv&csvheader=false&sort=descending'\n      source-names='1d,5d'\n      downloads='").concat(l,"/observations?streamid={{#terria.urlEncodeComponent}}{{streamIds}}{{/terria.urlEncodeComponent}}&limit=1440&media=csv&csvheader=false&sort=descending,").concat(l,"/observations?streamid={{#terria.urlEncodeComponent}}{{streamIds}}{{/terria.urlEncodeComponent}}&limit=7200&media=csv&csvheader=false&sort=descending'\n      download-names='1d,5d'\n    >\n    </chart>\n  {{/hasStreams}}\n  {{^hasStreams}}\n    <br/><br/>\n  {{/hasStreams}}\n  ")});return e.setTrait(C.A.definition,"featureInfoTemplate",c),(await s.loadMapItems()).throwIfError(),new jf(e,s)}catch(e){throw At.Ay.from(e,{title:Pe.Ay.t("models.senaps.retrieveErrorTitle"),message:Pe.Ay.t(401===e.statusCode?"models.senaps.missingKeyErrorMessage":"models.senaps.generalErrorMessage")})}}get dataSource(){return this.geojsonItem}}_f(jf,"stratumName","SenapsLocations"),dt.A.addLoadStratum(jf.stratumName);const zf=(_f(Cf=class e extends((0,$i.Ay)((0,Ee.A)((0,s.A)((0,g.A)(If))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.senaps.name")}forceLoadMapItems(){return jf.load(this).then(e=>{void 0!==e&&(0,i.h5)(()=>{this.strata.set(jf.stratumName,e)})})}get geoJsonItem(){const e=this.strata.get(jf.stratumName);return(0,n.A)(e)?e.dataSource:void 0}get mapItems(){return(0,n.A)(this.geoJsonItem)?this.geoJsonItem.mapItems.map(e=>(e.show=this.show,e)):[]}forceLoadMetadata(){return Promise.resolve()}_constructLocationsUrl(){if(!this.url)throw new At.Ay({title:Pe.Ay.t("models.senaps.retrieveErrorTitle"),message:Pe.Ay.t("models.senaps.missingSenapsBaseUrl")});const e=new(Ie())("".concat(this.url,"/locations"));return void 0!==this.locationIdFilter&&e.setSearch("id",this.locationIdFilter),e.setSearch("count","1000"),e.setSearch("expand","true"),e.toString()}_constructStreamsUrl(e){if(!this.url)throw new At.Ay({title:Pe.Ay.t("models.senaps.retrieveErrorTitle"),message:Pe.Ay.t("models.senaps.missingSenapsBaseUrl")});const t=new(Ie())("".concat(this.url,"/streams"));return void 0!==this.streamIdFilter&&t.setSearch("id",this.streamIdFilter),t.setSearch("locationid",e),t.toString()}},"type","senaps-locations"),Ef((Df=Cf).prototype,"geoJsonItem",[i.EW],Object.getOwnPropertyDescriptor(Df.prototype,"geoJsonItem"),Df.prototype),Ef(Df.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Df.prototype,"mapItems"),Df.prototype),Df);var Nf,kf=r(14528),Rf=()=>new DecompressionStream("deflate-raw");try{Rf(),Nf=async e=>{let t,r,i=Rf(),o=i.writable.getWriter(),n=i.readable.getReader(),a=[],s=0,l=0;for(o.write(e),o.close();!(r=await n.read()).done;)t=r.value,a.push(t),s+=t.length;return!a[1]&&t||(t=new Uint8Array(s),a.map(e=>(t.set(e,l),l+=e.length))),t}}catch{}var Mf=new TextDecoder,Ff=e=>{throw new Error("but-unzip~"+e)},Lf=e=>Mf.decode(e);const Gf=/.+\.(shp|dbf|json|prj|cpg)$/i;function Uf(e){let t=0,r=1;const i=e.length;let o,n;const a=[e[0][0],e[0][1],e[0][0],e[0][1]];for(;r<i;)o=n||e[0],n=e[r],t+=(n[0]-o[0])*(n[1]+o[1]),r++,n[0]<a[0]&&(a[0]=n[0]),n[1]<a[1]&&(a[1]=n[1]),n[0]>a[2]&&(a[2]=n[0]),n[1]>a[3]&&(a[3]=n[1]);return{ring:e,clockWise:t>0,bbox:a,children:[]}}function Wf(e,t){return!(e.bbox[0]>t.bbox[0]||e.bbox[1]>t.bbox[1]||e.bbox[2]<t.bbox[2]||e.bbox[3]<t.bbox[3])}function qf(e,t=!1){const r=[],i=[];for(const o of e){const e=Uf(o);e.clockWise!==t?r.push(e):i.push(e)}const o=[];for(const e of i){let t;for(const i of r)Wf(i,e)&&(t?Wf(t,i)&&(t=i):t=i);t?t.children.push(e.ring):o.push(e)}if(t)return{outers:r,orphens:o};if(o.length&&!t){const t=qf(e,!0);if(0===t.orphens.length){const e=[];for(const r of t.outers)e.push([r.ring.toReversed()].concat(r.children.map(e=>e.toReversed())));return e}}const n=[];for(const e of r)n.push([e.ring].concat(e.children));return n}globalThis.URL,Vf.prototype.parsePoint=function(e){return{type:"Point",coordinates:this.parseCoord(e,0)}},Vf.prototype.parseZPoint=function(e){const t=this.parsePoint(e);return t.coordinates.push(e.getFloat64(16,!0)),t},Vf.prototype.parsePointArray=function(e,t,r){const i=[];let o=0;for(;o<r;)i.push(this.parseCoord(e,t)),t+=16,o++;return i},Vf.prototype.parseZPointArray=function(e,t,r,i){let o=0;for(;o<r;)i[o].push(e.getFloat64(t,!0)),o++,t+=8;return i},Vf.prototype.parseArrayGroup=function(e,t,r,i,o){const n=[];let a,s,l=0,c=0;for(;l<i;)l++,r+=4,a=c,c=l===i?o:e.getInt32(r,!0),s=c-a,s&&(n.push(this.parsePointArray(e,t,s)),t+=s<<4);return n},Vf.prototype.parseZArrayGroup=function(e,t,r,i){let o=0;for(;o<r;)i[o]=this.parseZPointArray(e,t,i[o].length,i[o]),t+=i[o].length<<3,o++;return i},Vf.prototype.parseMultiPoint=function(e){const t={},r=e.getInt32(32,!0);if(!r)return null;const i=this.parseCoord(e,0),o=this.parseCoord(e,16);return t.bbox=[i[0],i[1],o[0],o[1]],1===r?(t.type="Point",t.coordinates=this.parseCoord(e,36)):(t.type="MultiPoint",t.coordinates=this.parsePointArray(e,36,r)),t},Vf.prototype.parseZMultiPoint=function(e){const t=this.parseMultiPoint(e);if(!t)return null;let r;if("Point"===t.type)return t.coordinates.push(e.getFloat64(72,!0)),t;r=t.coordinates.length;const i=52+(r<<4);return t.coordinates=this.parseZPointArray(e,i,r,t.coordinates),t},Vf.prototype.parsePolyline=function(e){const t={},r=e.getInt32(32,!0);if(!r)return null;const i=this.parseCoord(e,0),o=this.parseCoord(e,16);t.bbox=[i[0],i[1],o[0],o[1]];const n=e.getInt32(36,!0);let a,s;return 1===r?(t.type="LineString",a=44,t.coordinates=this.parsePointArray(e,a,n)):(t.type="MultiLineString",a=40+(r<<2),s=40,t.coordinates=this.parseArrayGroup(e,a,40,r,n)),t},Vf.prototype.parseZPolyline=function(e){const t=this.parsePolyline(e);if(!t)return null;const r=t.coordinates.length;let i;if("LineString"===t.type)return i=60+(r<<4),t.coordinates=this.parseZPointArray(e,i,r,t.coordinates),t;{const o=t.coordinates.reduce(function(e,t){return e+t.length},0);return i=56+(o<<4)+(r<<2),t.coordinates=this.parseZArrayGroup(e,i,r,t.coordinates),t}},Vf.prototype.polyFuncs=function(e){return e?"LineString"===e.type?(e.type="Polygon",e.coordinates=[e.coordinates],e):(e.coordinates=qf(e.coordinates),1===e.coordinates.length?(e.type="Polygon",e.coordinates=e.coordinates[0],e):(e.type="MultiPolygon",e)):e},Vf.prototype.parsePolygon=function(e){return this.polyFuncs(this.parsePolyline(e))},Vf.prototype.parseZPolygon=function(e){return this.polyFuncs(this.parseZPolyline(e))};const Bf={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function Vf(e,t){if(!(this instanceof Vf))return new Vf(e,t);this.buffer=e,this.headers=this.parseHeader(),this.shpFuncs(t),this.rows=this.getRows()}function Hf(e,t){return new Vf(e,t).rows}Vf.prototype.shpFuncs=function(e){let t=this.headers.shpCode;if(t>20&&(t-=20),!(t in Bf))throw new Error(`I don't know shp type "${t}"`);var r;this.parseFunc=this[Bf[t]],this.parseCoord=(r=e)?function(e,t){const i=[e.getFloat64(t,!0),e.getFloat64(t+8,!0)];return r.inverse(i)}:function(e,t){return[e.getFloat64(t,!0),e.getFloat64(t+8,!0)]}},Vf.prototype.getShpCode=function(){return this.parseHeader().shpCode},Vf.prototype.parseHeader=function(){const e=this.buffer;return{length:e.getInt32(24)<<1,version:e.getInt32(28,!0),shpCode:e.getInt32(32,!0),bbox:[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}},Vf.prototype.getRows=function(){let e=100;const t=this.buffer.byteLength-8,r=[];let i;for(;e<=t&&(i=this.getRow(e),i);)e+=8,e+=i.len,i.type?r.push(this.parseFunc(i.data)):r.push(null);return r},Vf.prototype.getRow=function(e){const t=this.buffer.getInt32(e),r=this.buffer.getInt32(e+4)<<1;return 0===r?{id:t,len:r,type:0}:e+r+8>this.buffer.byteLength?void 0:{id:t,len:r,data:new DataView(this.buffer.buffer,this.buffer.byteOffset+e+12,r-4),type:this.buffer.getInt32(e+8,!0)}};var $f=/^(?:ANSI\s)?(\d+)$/m;function Jf(e,t){if(!e)return i;try{new TextDecoder(e.trim())}catch(o){var r=$f.exec(e);return r&&!t?Jf("windows-"+r[1],!0):(e=void 0,i)}return i;function i(t){var r=new TextDecoder(e||void 0);return(r.decode(t,{stream:!0})+r.decode()).replace(/\0/g,"").trim()}}function Xf(e,t,r,i,o){var n=o(new Uint8Array(e.buffer.slice(e.byteOffset+t,e.byteOffset+t+r)));switch(i){case"N":case"F":case"O":return parseFloat(n,10);case"D":return new Date(n.slice(0,4),parseInt(n.slice(4,6),10)-1,n.slice(6,8));case"L":return"y"===n.toLowerCase()||"t"===n.toLowerCase();default:return n}}function Kf(e,t,r,i){for(var o,n,a={},s=0,l=r.length;s<l;)o=Xf(e,t,(n=r[s]).len,n.dataType,i),t+=n.len,void 0!==o&&(a[n.name]=o),s++;return a}function Zf(e,t){for(var r=Jf(t),i=function(e){var t={};return t.lastUpdated=new Date(e.getUint8(1)+1900,e.getUint8(2),e.getUint8(3)),t.records=e.getUint32(4,!0),t.headerLen=e.getUint16(8,!0),t.recLen=e.getUint16(10,!0),t}(e),o=function(e,t,r){for(var i=[],o=32;o<t&&(i.push({name:r(new Uint8Array(e.buffer.slice(e.byteOffset+o,e.byteOffset+o+11))),dataType:String.fromCharCode(e.getUint8(o+11)),len:e.getUint8(o+16),decimal:e.getUint8(o+17)}),13!==e.getUint8(o+32));)o+=32;return i}(e,i.headerLen-1,r),n=2+(o.length+1<<5),a=i.recLen,s=i.records,l=[];s;)l.push(Kf(e,n,o,r)),n+=a,s--;return l}function Qf(e){return e instanceof globalThis.ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)}globalThis.URL,new TextDecoder;const Yf=async function(e,t){let r;e=(e=>{if(!e)throw new Error("forgot to pass buffer");if(Qf(e))return new Uint8Array(e);if(Qf(e.buffer))return 1===e.BYTES_PER_ELEMENT?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("invalid buffer like object")})(e);const i=await(async e=>{const t={},r=[];for(const i of function*(e,t=Nf){let r=e.length-20,i=Math.max(r-65516,2);for(;-1!==(r=e.lastIndexOf(80,r-1))&&(75!==e[r+1]||5!==e[r+2]||6!==e[r+3])&&r>i;);-1===r&&Ff(2);let o=(t,i)=>e.subarray(r+=t,r+=i),n=new DataView(e.buffer,e.byteOffset),a=e=>n.getUint16(e+r,!0),s=e=>n.getUint32(e+r,!0),l=a(10);for(l!==a(8)&&Ff(3),r=s(16);l--;){let e,i=a(10),n=a(30),l=a(32),c=s(20),u=s(42),p=Lf(o(46,a(28))),d=Lf(o(n,l)),h=r;r=u,e=o(30+a(26)+a(28),c),yield{filename:p,comment:d,read:()=>8&i?t(e):i?Ff(1):e},r=h}}(e))Gf.test(i.filename)&&r.push(Promise.resolve(i.read()).then(e=>t[i.filename]=e));await Promise.all(r);const i={},o=new TextDecoder;for(const[e,r]of Object.entries(t))"shp"===e.slice(-3).toLowerCase()||"dbf"===e.slice(-3).toLowerCase()?i[e]=new DataView(r.buffer,r.byteOffset,r.byteLength):i[e]=o.decode(r);return i})(e),o=[];for(r in t=t||[],i)-1===r.indexOf("__MACOSX")&&(".shp"===r.slice(-4).toLowerCase()?(o.push(r.slice(0,-4)),i[r.slice(0,-3)+r.slice(-3).toLowerCase()]=i[r]):".prj"===r.slice(-4).toLowerCase()?i[r.slice(0,-3)+r.slice(-3).toLowerCase()]=(0,kf.default)(i[r]):".json"===r.slice(-5).toLowerCase()||t.indexOf(r.split(".").pop())>-1?o.push(r.slice(0,-3)+r.slice(-3).toLowerCase()):".dbf"!==r.slice(-4).toLowerCase()&&".cpg"!==r.slice(-4).toLowerCase()||(i[r.slice(0,-3)+r.slice(-3).toLowerCase()]=i[r]));if(!o.length)throw new Error("no layers founds");const n=o.map(function(e){let r,o;const n=e.lastIndexOf(".");return n>-1&&e.slice(n).indexOf("json")>-1?(r=JSON.parse(i[e]),r.fileName=e.slice(0,n)):t.indexOf(e.slice(n+1))>-1?(r=i[e],r.fileName=e):(i[e+".dbf"]&&(o=Zf(i[e+".dbf"],i[e+".cpg"])),r=function([e,t]){const r={type:"FeatureCollection",features:[]};let i=0;const o=e.length;for(t||(t=[]);i<o;)r.features.push({type:"Feature",geometry:e[i],properties:t[i]||{}}),i++;return r}([Hf(i[e+".shp"],i[e+".prj"]),o]),r.fileName=e),r});return 1===n.length?n[0]:n};var eg,tg=r(93936);let rg=(0,Re.b)({description:"Creates one catalog item from url that points to a zipped shapefile.",example:{type:"shp",name:"shp (shapefile) example",url:"https://tiles.terria.io/terriajs-examples/shp/airports.zip",id:"some unique id"}})(eg=class extends((0,u.A)(Ir.h,_e.Ay)){})||eg;var ig,og;function ng(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ag(e){return Array.isArray(e)&&e.every(e=>(0,wt.OW)(e)||ag(e))}let sg=(og=class e extends((0,Tr.Ay)((0,g.A)(rg))){constructor(){super(...arguments),ng(this,"_file",void 0),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.shapefile.name")}setFileInput(e){this._file=e}get hasLocalData(){return(0,n.A)(this._file)}async forceLoadGeojsonData(){if(this._file)return await cg(this._file);if(this.url){if((0,tg.K0)(this.url)){if("undefined"==typeof FileReader)throw(0,Or.w)(this.terria);const e=await(0,tg.Ay)((0,ie.A)(this,this.url));return await cg(e)}throw At.Ay.from("Invalid URL: Only zipped shapefiles are supported (the extension must be `.zip`)")}throw At.Ay.from("Failed to load shapefile - no URL of file has been defined")}},ng(og,"type","shp"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((ig=og).prototype,"hasLocalData",[i.EW],Object.getOwnPropertyDescriptor(ig.prototype,"hasLocalData"),ig.prototype),ig);const lg=e=>{const t={type:"FeatureCollection",features:[]};for(let r=0;r<e.length;r++){const i=e[r];for(let e=0;e<i.features.length;e++)t.features.push(i.features[e])}return t};async function cg(e){const t=await e.arrayBuffer(),r=await Yf(t);return ag(r)?lg(r):r}const ug=sg;var pg,dg=r(17027),hg=r(52662);let mg=(0,Re.b)({description:"Creates one catalog item for a Tile Map Service (TMS) imagery tileset.",example:{type:"tms",name:"Natural Earth II (TMS)",url:"https://storage.googleapis.com/terria-datasets-public/basemaps/natural-earth-tiles"}})(pg=class extends((0,u.A)(Ji.A,Xi.A,d.A,Ki.Ay,_e.Ay,ke.A)){})||pg;var fg,gg,yg;function bg(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let vg=(yg=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(mg)))){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"imageryProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,gg,this),(0,i.Gn)(this)}get type(){return e.type}async forceLoadMapItems(){let e;this.url&&(e=await hg.A.fromUrl((0,ie.A)(this,this.url),{minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel,tileWidth:this.tileWidth,tileHeight:this.tileHeight,credit:this.attribution})),(0,i.h5)(()=>{this.imageryProvider=e})}get mapItems(){return this.imageryProvider?[{imageryProvider:this.imageryProvider,show:this.show,alpha:this.opacity,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}},function(e,t){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:"tms",enumerable:!0,configurable:!0,writable:!0}):e[t]="tms"}(yg,"type"),gg=bg((fg=yg).prototype,"imageryProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bg(fg.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(fg.prototype,"mapItems"),fg.prototype),fg);var wg,Ag,Sg,xg,Og,Pg,Tg;function Ig(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Dg(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Cg=(wg=(0,Re.b)({description:"Creates one catalog item from url that points to a template imagery service.",example:{name:"url-template-imagery example",type:"url-template-imagery",url:"https://storage.googleapis.com/terria-datasets-public/basemaps/natural-earth-tiles/{z}/{x}/{reverseY}.png",maximumLevel:7,id:"some unique id for url-template-imagery example"}}),Ag=(0,K.A)({type:"string",name:"Pick features URL",description:"URL template to use to use to pick features. See URL template to use to use to pick features for list of keywords. "}),Sg=(0,mr.A)({name:"Subdomains",description:"Array of subdomains, one of which will be prepended to each tile URL. This is useful for overcoming browser limit on the number of simultaneous requests per host. Subdomains will be substituted for ${s} keyword",type:"string"}),wg((Og=class extends((0,u.A)(Ji.A,Xi.A,d.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),Ig(this,"pickFeaturesUrl",Pg,this),Ig(this,"subdomains",Tg,this)}},Pg=Dg(Og.prototype,"pickFeaturesUrl",[Ag],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tg=Dg(Og.prototype,"subdomains",[Sg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xg=Og))||xg);var Eg,_g;function jg(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let zg=(_g=class e extends((0,$i.Ay)((0,s.A)((0,g.A)(Cg)))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}forceLoadMapItems(){return Promise.resolve()}get mapItems(){const e=this.imageryProvider;return(0,n.A)(e)?[{show:this.show,alpha:this.opacity,imageryProvider:e,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}get imageryProvider(){if((0,n.A)(this.url))return new Hi.A({url:(0,ie.A)(this,this.url),subdomains:this.subdomains.slice(),credit:this.attribution,maximumLevel:this.maximumLevel,minimumLevel:this.minimumLevel,tileHeight:this.tileHeight,tileWidth:this.tileWidth,pickFeaturesUrl:this.pickFeaturesUrl,enablePickFeatures:this.allowFeaturePicking})}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(_g,"type","url-template-imagery"),jg((Eg=_g).prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Eg.prototype,"mapItems"),Eg.prototype),jg(Eg.prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(Eg.prototype,"imageryProvider"),Eg.prototype),Eg);var Ng,kg,Rg,Mg,Fg,Lg,Gg,Ug=r(44709),Wg=r(6065),qg=r(89697),Bg=r(7717);function Vg(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Hg(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let $g=(Ng=(0,Re.b)({description:'Creates a catalog group or item from url that points to a terria catalog json file.\n  \n  <strong>Note:</strong> \n  <li>The referenced json file may contain more items than you need.</li>\n  <li>Specify required catalog entry IDs (e.g. "LAEMW8fc") in <code>path</code>. If not specified, the whole catalog will be added.</li>\n  <li>If the reference is a group, it is helpful to set <code>isGroup</code> to <code>true</code>.</li>',example:{type:"terria-reference",url:"https://tiles.terria.io/terriajs-examples/terria-reference/a-terria-catalog.json",isGroup:!0,path:["LAEMW8fc"],name:"terria-reference example",id:"some unique id for terria-reference example"}}),kg=(0,K.A)({name:"Is Open",description:"True if this group is open and its contents are visible; otherwise, false. (This only applies if `isGroup = true`)",type:"boolean"}),Rg=(0,mr.A)({type:"string",name:"Path",description:"The path to the catalog item or group in the target catalog file given as a list of IDs. If not given, Terria will create a pseudo-group with all the catalog items in the catalog file as its members."}),Ng((Fg=class extends((0,u.A)(d.A,Kr.A)){constructor(){super(...arguments),Vg(this,"isOpen",Lg,this),Vg(this,"path",Gg,this)}},Lg=Hg(Fg.prototype,"isOpen",[kg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gg=Hg(Fg.prototype,"path",[Rg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mg=Fg))||Mg);function Jg(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Xg extends((0,Ee.A)((0,Xr.A)((0,g.A)($g)))){constructor(){super(...arguments),Jg(this,"forceLoadReference",(0,i.L3)(function*(e){var t;if(void 0===this.url||void 0===this.uniqueId)return;const r=yield(0,Bg.A)((0,ie.A)(this,this.url,this.cacheDuration));if(!(0,wt.OW)(r)||!Array.isArray(r.catalog))return;let i;if(i=this.path?function(e,t){const r=t.reduce((e,t)=>Array.isArray(null==e?void 0:e.members)?e.members.find(e=>(null==e?void 0:e.id)===t):void 0,{members:e});return r}(r.catalog,this.path.slice()):{type:"group",members:r.catalog,name:this.name},"string"==typeof(null===(t=i)||void 0===t?void 0:t.type)){const e=Qr.A.create(i.type,this.uniqueId,this.terria,this);if(void 0===e)throw new At.Ay({sender:this,title:Pe.Ay.t("models.catalog.unsupportedTypeTitle"),message:Pe.Ay.t("models.catalog.unsupportedTypeMessage",{type:'"'.concat(i.type,'"')})});return void 0!==i.name&&(i.name=this.name),Ce.A.isMixedInto(e)&&(0,n.A)(i.isOpen)&&"boolean"==typeof i.isOpen&&e.setTrait(C.A.definition,"isOpen",i.isOpen),(0,gi.A)(e,C.A.definition,i).catchError(t=>{e.setTrait(C.A.underride,"isExperiencingIssues",!0),t.log()}),e}throw new At.Ay({sender:this,title:Pe.Ay.t("models.terria-reference.failedToLoadTarget"),message:Pe.Ay.t("models.terria-reference.failedToLoadTarget")})}))}get type(){return Xg.type}}Jg(Xg,"type","terria-reference");var Kg,Zg,Qg,Yg,ey,ty,ry,iy,oy,ny,ay,sy,ly,cy,uy,py=r(89544);function dy(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function hy(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}r(26910);let my=(Kg=(0,K.A)({name:"ID",description:"The ID of this distribution format.",type:"string"}),Zg=(0,K.A)({name:"Format Regular Expression",description:"A regular expression that is matched against the distribution's format. This must be defined for this format to be used",type:"string"}),Qg=(0,K.A)({name:"URL Regular Expression",description:"A regular expression that is matched against the url, this will only be used if `formatRegex` matches.",type:"string"}),Yg=(0,K.A)({name:"Maximum file size (MB)",description:"The maximum allowed file size for this format (in megabytes).",type:"number",isNullable:!0}),ey=(0,K.A)({type:"boolean",name:"Only use if sole resource",description:'This resource will only match if no other resource types match for a given dataset. Like a "last-resort" resource. This will be ignored if `useSingleResource` is used'}),ty=(0,K.A)({type:"boolean",name:"Remove duplicate resources",description:"Remove resources if they have the same `name`. If duplicates are found, then the newest resource will be used (according to created property). This is applied per format"}),ry=(0,hr.A)({name:"Definition",description:"The catalog member definition to use when the URL and Format regular expressions match. The `URL` property will also be set."}),iy=class extends ze.A{constructor(){super(...arguments),dy(this,"id",oy,this),dy(this,"formatRegex",ny,this),dy(this,"urlRegex",ay,this),dy(this,"maxFileSize",sy,this),dy(this,"onlyUseIfSoleResource",ly,this),dy(this,"removeDuplicates",cy,this),dy(this,"definition",uy,this)}static isRemoval(e){return null===e.definition}},oy=hy(iy.prototype,"id",[Kg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ny=hy(iy.prototype,"formatRegex",[Zg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ay=hy(iy.prototype,"urlRegex",[Qg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sy=hy(iy.prototype,"maxFileSize",[Yg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ly=hy(iy.prototype,"onlyUseIfSoleResource",[ey],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cy=hy(iy.prototype,"removeDuplicates",[ty],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),uy=hy(iy.prototype,"definition",[ry],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iy);var fy,gy,yy,by,vy,wy,Ay,Sy,xy,Oy,Py,Ty=r(53538);function Iy(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Dy(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Cy=(fy=(0,K.A)({type:"boolean",name:"Use resource name",description:"True to use the name of the resource for the name of the catalog item; false to use the name of the dataset."}),gy=(0,K.A)({type:"boolean",name:"Use combination name where multiple resources",description:"Use a combination of the name and the resource format and dataset where there are multiple resources for a single dataset."}),yy=(0,K.A)({type:"boolean",name:"Use combination of dataset and resource name where multiple resources",description:"Use a combination of the name and the resource and dataset name where there are multiple resources for a single dataset."}),by=(0,Ne.Ay)({name:"Supported Resource Formats",description:"The supported distribution formats and their mapping to Terria types. These are listed in order of preference.",type:my,idProperty:"id"}),vy=(0,K.A)({type:"boolean",name:"Use single resource",description:"Only use a single resource for each dataset. If multiple resources exist, the highest match from `supportedResourceFormats` will be used. If this is true, then `useDatasetNameAndFormatWhereMultipleResources` and `useCombinationNameWhereMultipleResources` will be ignored"}),wy=class extends((0,u.A)(Ty.A)){constructor(){super(...arguments),Iy(this,"useResourceName",Ay,this),Iy(this,"useDatasetNameAndFormatWhereMultipleResources",Sy,this),Iy(this,"useCombinationNameWhereMultipleResources",xy,this),Iy(this,"supportedResourceFormats",Oy,this),Iy(this,"useSingleResource",Py,this)}},Ay=Dy(wy.prototype,"useResourceName",[fy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Sy=Dy(wy.prototype,"useDatasetNameAndFormatWhereMultipleResources",[gy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),xy=Dy(wy.prototype,"useCombinationNameWhereMultipleResources",[yy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Oy=Dy(wy.prototype,"supportedResourceFormats",[by],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Py=Dy(wy.prototype,"useSingleResource",[vy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wy);var Ey,_y,jy,zy,Ny,ky,Ry,My,Fy,Ly,Gy,Uy,Wy,qy,By,Vy,Hy;function $y(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Jy(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Xy=(Ey=(0,Re.b)({description:"Creates a group with members from Ckan server.\n\n  <strong>Note:</strong> \n  <br>The following example will</br>\n  <li>Request datasets of specific types only.</li>\n  <li>Organise members in subgroups according to their organisations.</li>\n  <li>For any wms type item, use ESPG:3857 as crs.</li>",example:{url:"https://discover.data.vic.gov.au/",type:"ckan-group",name:"DataVic Open Data Portal",filterQuery:[{fq:'+(res_format:(wms OR WMS OR shapefile OR Shapefile OR "zip (shp)" OR shp OR SHP OR kmz OR GeoJSON OR geojson OR csv-geo-au OR aus-geo-csv))'}],groupBy:"organization",supportedResourceFormats:[{id:"WMS",urlRegex:"^((?!data.gov.au/geoserver).)*$"},{id:"Kml",onlyUseIfSoleResource:!0},{id:"Shapefile",onlyUseIfSoleResource:!0}],ungroupedTitle:"Organisation not declared",itemPropertiesByType:[{type:"wms",itemProperties:{crs:"EPSG:3857"}}],resourceIdTemplate:"{{resource.name}}-{{resource.format}}",restrictResourceIdTemplateToOrgsWithNames:["department-of-energy-environment-climate-action","department-of-jobs-skills-industry-regions","department-of-transport-and-planning","victorian-electoral-commission"],id:"some id"}}),_y=(0,hr.A)({name:"Filter Query",description:"Gets or sets the filter query to pass to CKAN when querying the available data sources and their groups. Each item in the\n         array causes an independent request to the CKAN, and the results are concatenated.  The\n         search string is equivalent to what would be in the parameters segment of the url calling the CKAN search api.\n         See the [Solr documentation](http://wiki.apache.org/solr/CommonQueryParameters#fq) for information about filter queries.\n         Each item is an object ({ fq: 'res_format:wms' }). For robustness sake, a query string is also allowed. E.g.\n         \"fq=(res_format:wms OR res_format:WMS)\" and \"fq=+(res_format%3Awms%20OR%20res_format%3AWMS)\" are allowed.\n         <li>To get all the datasets with wms resources: [{ fq: 'res_format%3awms' }]</li>\n         <li>To get all wms/WMS datasets in the Surface Water group: [{q: 'groups=Surface Water', fq: 'res_format:WMS' }]</li>\n         <li>To get both wms and esri-mapService datasets: [{q: 'res_format:WMS'}, {q: 'res_format:\"Esri REST\"' }]</li>\n         <li>To get all datasets with no filter, you can use ['']</li>\n       "}),jy=(0,K.A)({type:"string",name:"Group By",description:"Gets or sets a value indicating how datasets should be grouped.  Valid values are:\n     * none - Datasets are put in a flat list; they are not grouped at all.\n     * group - Datasets are grouped according to their CKAN group.  Datasets that are not in any groups are put at the top level.\n     * organization - Datasets are grouped by their CKAN organization.  Datasets that are not associated with an organization are put at the top level.\n     "}),zy=(0,K.A)({type:"string",name:"Ungrouped title",description:"A title for the group holding all items that don't have a group in CKAN.\n      If the value is a blank string or undefined, these items will be left at the top level, not grouped."}),Ny=(0,K.A)({type:"boolean",name:"Allow entire WMS Servers",description:"True to allow entire WMS servers (that is, WMS resources without a clearly-defined layer) to be added to the catalog; otherwise, false."}),ky=(0,K.A)({type:"boolean",name:"Exclude inactive datasets",description:'True to remove inactive datasets. Where `state = "deleted"` (CKAN official), `state === "draft"` (CKAN official) or `data_state === "inactive"` (Data.gov.au CKAN).'}),Ry=(0,K.A)({type:"string",name:"Resource ID template string.",description:"A Mustache formatted template string for generating a custom resource id from resource description. By default we use `resource.id` as the ID of the CKAN item but some CKAN services change their resource IDs frequently which can break terria features link share links or catalog search indexing. You can use `customResourceIdTemplate` to instruct terria to construct a different ID instead of the default `resource.id`. The template string will receive the entire `resource` as a template variable. Example usage: '{{resource.name}}-{{resource.format}}'."}),My=(0,mr.A)({type:"string",name:"Restrict resource id template to organization with names",description:"Names of organisations for which `customResourceIdTemplate` should be used."}),Ey((Ly=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A,Cy)){constructor(){super(...arguments),$y(this,"filterQuery",Gy,this),$y(this,"groupBy",Uy,this),$y(this,"ungroupedTitle",Wy,this),$y(this,"allowEntireWmsServers",qy,this),$y(this,"excludeInactiveDatasets",By,this),$y(this,"resourceIdTemplate",Vy,this),$y(this,"restrictResourceIdTemplateToOrgsWithNames",Hy,this)}},Gy=Jy(Ly.prototype,"filterQuery",[_y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{fq:'(res_format:(czml OR CZML OR geojson OR GeoJSON OR WMS OR wms OR kml OR KML OR kmz OR KMZ OR WFS OR wfs OR CSV-GEO-AU OR csv-geo-au OR "Esri REST"))'}]}}),Uy=Jy(Ly.prototype,"groupBy",[jy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"organization"}}),Wy=Jy(Ly.prototype,"ungroupedTitle",[zy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"No group"}}),qy=Jy(Ly.prototype,"allowEntireWmsServers",[Ny],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),By=Jy(Ly.prototype,"excludeInactiveDatasets",[ky],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Vy=Jy(Ly.prototype,"resourceIdTemplate",[Ry],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hy=Jy(Ly.prototype,"restrictResourceIdTemplateToOrgsWithNames",[My],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fy=Ly))||Fy);class Ky extends((0,pt.Ay)(Cy)){duplicateLoadableStratum(e){return new Ky}get supportedResourceFormats(){return[{id:"GeoJson",formatRegex:"^geojson$",maxFileSize:150,definition:{type:"geojson"}},{id:"Shapefile",formatRegex:"shapefile|shp|zip (shp)",urlRegex:".zip$",maxFileSize:100,definition:{type:"shp"}},{id:"WMS",formatRegex:"^wms$",definition:{type:"wms"}},{id:"ArcGIS MapServer",formatRegex:"^esri rest$|^arcgis geoservices rest api$",urlRegex:"MapServer",definition:{type:"esri-mapServer"}},{id:"Czml",formatRegex:"^czml$",maxFileSize:50,definition:{type:"czml"}},{id:"ArcGIS FeatureServer",formatRegex:"^esri rest$|^arcgis geoservices rest api$",urlRegex:"FeatureServer",definition:{type:"esri-featureServer"}},{id:"CSV",formatRegex:"^csv-geo-",definition:{type:"csv"}},{id:"Kml",formatRegex:"^km[lz]$",maxFileSize:30,definition:{type:"kml"}}].map(e=>(0,ut.A)(my,e))}}!function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ky,"stratumName","ckanDefaultFormats"),dt.A.addDefaultStratum(Ky.stratumName);var Zy,Qy,Yy,eb,tb,rb,ib,ob=r(86123);function nb(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function ab(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let sb=(Zy=(0,Re.b)({description:"Creates a calalog item that references a ckan item.\n\n  <strong>Note:</strong> \n  <li>The property <code>resourceId</code> in the example below is a Ckan resource Id that references a geospatial type (wms) data.</li>",example:{url:"https://discover.data.vic.gov.au",type:"ckan-item",resourceId:"22b8cf52-4583-4609-a3da-a6e1805829d9",name:"A Ckan Item (WMS)",id:"some id"}}),Qy=(0,K.A)({name:"Dataset ID",description:"The CKAN ID of the dataset.",type:"string"}),Yy=(0,K.A)({name:"Magda Record Data",description:"The Resource ID of the dataset to use",type:"string"}),Zy((tb=class extends((0,u.A)(d.A,Ki.Ay,Cy,Kr.A)){constructor(){super(...arguments),nb(this,"datasetId",rb,this),nb(this,"resourceId",ib,this)}},rb=ab(tb.prototype,"datasetId",[Qy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ib=ab(tb.prototype,"resourceId",[Yy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eb=tb))||eb);var lb,cb,ub,pb;function db(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hb(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let mb=(cb=class e extends((0,pt.Ay)(sb)){constructor(e,t){super(),this.ckanItemReference=e,this.ckanCatalogGroup=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(this.ckanItemReference,this.ckanCatalogGroup)}static async load(t,r){if(void 0===t._ckanDataset)if(void 0!==t.datasetId&&void 0!==t.resourceId)t._ckanDataset=await gb(t),t._ckanResource=function(e,t){if(void 0!==e)for(let r=0;r<e.resources.length;++r)if(e.resources[r].id===t)return e.resources[r]}(t._ckanDataset,t.resourceId),t.setSupportedFormatFromResource(t._ckanResource);else if(void 0!==t.datasetId&&void 0===t.resourceId){t._ckanDataset=await gb(t);const e=bb(t._ckanDataset,t.preparedSupportedFormats);if(void 0===e[0])return;t._ckanResource=e[0].resource,t._supportedFormat=e[0].format}else void 0===t.datasetId&&void 0!==t.resourceId&&(t._ckanResource=await async function(e){const t=new(Ie())(e.url).segment("api/3/action/resource_show").addQuery({id:e.resourceId}),r=await(0,H.A)((0,ie.A)(e,t.toString()));return r.result?r.result:void 0}(t),t._supportedFormat=vb(t._ckanResource,t.preparedSupportedFormats));return new e(t,r)}get ckanDataset(){return this.ckanItemReference._ckanDataset}get ckanResource(){return this.ckanItemReference._ckanResource}get url(){return Sb(this.ckanItemReference)}get name(){return Ab(this.ckanItemReference)}get rectangle(){if(void 0!==this.ckanDataset){if(void 0!==this.ckanDataset.extras){const e=[];if(this.ckanDataset.extras.forEach(t=>{"bbox-west-long"===t.key&&(e[0]=parseFloat(t.value)),"bbox-south-lat"===t.key&&(e[1]=parseFloat(t.value)),"bbox-north-lat"===t.key&&(e[2]=parseFloat(t.value)),"bbox-east-long"===t.key&&(e[3]=parseFloat(t.value))}),4===e.length)return(0,ut.A)(Ki.Ts,{west:e[0],south:e[1],east:e[2],north:e[3]})}if(void 0!==this.ckanDataset.geo_coverage){const e=this.ckanDataset.geo_coverage.split(",");if(4===e.length)return(0,ut.A)(Ki.Ts,{west:parseInt(e[0],10),south:parseInt(e[1],10),east:parseInt(e[2],10),north:parseInt(e[3],10)})}if((0,n.A)(this.ckanDataset.spatial)&&""!==this.ckanDataset.spatial){const e=JSON.parse(this.ckanDataset.spatial);if("Polygon"===e.type&&5===e.coordinates[0].length)return(0,ut.A)(Ki.Ts,{west:e.coordinates[0][0][0],south:e.coordinates[0][0][1],east:e.coordinates[0][2][0],north:e.coordinates[0][2][1]})}}}get info(){function e(e){return e.match(/^\d\d\d\d-\d\d-\d\d.*/)?e.substr(0,10):e}const t=[];return void 0===this.ckanDataset||(void 0!==this.ckanDataset.license_url?t.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.licence"),content:"[".concat(this.ckanDataset.license_title||this.ckanDataset.license_url,"](").concat(this.ckanDataset.license_url,")")})):void 0!==this.ckanDataset.license_title&&t.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.licence"),content:this.ckanDataset.license_title})),t.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.contact_point"),content:this.ckanDataset.contact_point}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.datasetDescription"),content:this.ckanDataset.notes}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.author"),content:this.ckanDataset.author})),this.ckanDataset.organization&&t.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.datasetCustodian"),content:this.ckanDataset.organization.description||this.ckanDataset.organization.title})),t.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.metadata_created"),content:e(this.ckanDataset.metadata_created)}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.metadata_modified"),content:e(this.ckanDataset.metadata_modified)}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.ckan.update_freq"),content:this.ckanDataset.update_freq}))),t}get isGroup(){var e;if((null===(e=this.ckanItemReference._supportedFormat)||void 0===e||null===(e=e.definition)||void 0===e?void 0:e.type)===bi.Ay.type&&!this.ckanItemReference.wmsLayers)return!0}},db(cb,"stratumName","ckanDataset"),hb((lb=cb).prototype,"ckanDataset",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"ckanDataset"),lb.prototype),hb(lb.prototype,"ckanResource",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"ckanResource"),lb.prototype),hb(lb.prototype,"url",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"url"),lb.prototype),hb(lb.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"name"),lb.prototype),hb(lb.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"rectangle"),lb.prototype),hb(lb.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"info"),lb.prototype),hb(lb.prototype,"isGroup",[i.EW],Object.getOwnPropertyDescriptor(lb.prototype,"isGroup"),lb.prototype),lb);dt.A.addLoadStratum(mb.stratumName);let fb=(pb=class e extends((0,Ee.A)((0,Xr.A)((0,g.A)(sb)))){constructor(e,t,r,o){super(e,t,r,o),db(this,"_ckanDataset",void 0),db(this,"_ckanResource",void 0),db(this,"_ckanCatalogGroup",void 0),db(this,"_supportedFormat",void 0),(0,i.Gn)(this),this.strata.set(Ky.stratumName,new Ky)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.ckan.name")}get preparedSupportedFormats(){return this.supportedResourceFormats?this.supportedResourceFormats.map(yb):[]}setDataset(e){this._ckanDataset=e}setResource(e){this._ckanResource=e}setCkanCatalog(e){this._ckanCatalogGroup=e}setSupportedFormat(e){this._supportedFormat=e}setSupportedFormatFromResource(e){this._supportedFormat=vb(e,this.preparedSupportedFormats)}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}async setCkanStrata(e){const t=await mb.load(this,this._ckanCatalogGroup);void 0!==t&&(0,i.h5)(()=>{e.strata.set(mb.stratumName,t)})}setSharedStratum(e){this.strata.set(_b.stratumName,e)}async forceLoadReference(e){var t;if(await this.setCkanStrata(this),void 0===this._supportedFormat)return;const r=(null!==(t=this._supportedFormat.definition)&&void 0!==t?t:{}).type;if("string"!=typeof r)return;let i;return r===bi.Ay.type?this.wmsLayers?(i=new bi.Ay(this.uniqueId,this.terria,this),i.setTrait(C.A.definition,"layers",decodeURI(this.wmsLayers))):i=new Oi(this.uniqueId,this.terria,this):i=Qr.A.create(r,this.uniqueId,this.terria,this),void 0!==i?(await this.setCkanStrata(i),i.setTrait(C.A.definition,"name",this.name),i):void 0}get wmsLayers(){var e,t,r,i,o,n,a,s,l;const c=null===(e=new(Ie())(Sb(this)))||void 0===e?void 0:e.search(!0),u=null!==(t=null!==(r=null===(i=this.itemPropertiesByIds)||void 0===i||null===(i=i.find(e=>this.uniqueId&&e.ids.includes(this.uniqueId)))||void 0===i||null===(i=i.itemProperties)||void 0===i?void 0:i.layers)&&void 0!==r?r:null===(o=this.itemPropertiesByType)||void 0===o||null===(o=o.find(e=>e.type===bi.Ay.type))||void 0===o||null===(o=o.itemProperties)||void 0===o?void 0:o.layers)&&void 0!==t?t:null===(n=this.itemProperties)||void 0===n?void 0:n.layers,p=null!==(a=null!==(s=(0,wt.Eo)(u)?u:void 0)&&void 0!==s?s:null===(l=this._ckanResource)||void 0===l?void 0:l.wms_layer)&&void 0!==a?a:(null==c?void 0:c.LAYERS)||(null==c?void 0:c.layers)||(null==c?void 0:c.typeName);return null==p?void 0:p.split(",").map(e=>e.trim()).join(",")}},db(pb,"type","ckan-item"),hb((ub=pb).prototype,"preparedSupportedFormats",[i.EW],Object.getOwnPropertyDescriptor(ub.prototype,"preparedSupportedFormats"),ub.prototype),hb(ub.prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(ub.prototype,"cacheDuration"),ub.prototype),hb(ub.prototype,"setSharedStratum",[i.XI],Object.getOwnPropertyDescriptor(ub.prototype,"setSharedStratum"),ub.prototype),hb(ub.prototype,"wmsLayers",[i.EW],Object.getOwnPropertyDescriptor(ub.prototype,"wmsLayers"),ub.prototype),ub);async function gb(e){const t=new(Ie())(e.url).segment("api/3/action/package_show").addQuery({id:e.datasetId}),r=await(0,H.A)((0,ie.A)(e,t.toString()));if(r.result)return r.result}const yb=(0,ob.Aj)(e=>({id:e.id,definition:e.definition,maxFileSize:e.maxFileSize,removeDuplicates:e.removeDuplicates,onlyUseIfSoleResource:e.onlyUseIfSoleResource,formatRegex:e.formatRegex,urlRegex:e.urlRegex,formatRegexParsed:e.formatRegex?new RegExp(e.formatRegex,"i"):void 0,urlRegexParsed:e.urlRegex?new RegExp(e.urlRegex,"i"):void 0}));function bb(e,t){if(!e)return[];const r=[];for(let i=0;i<t.length;++i){const o=t[i];for(let t=0;t<e.resources.length;++t){const i=e.resources[t];wb(i,o)&&r.push({resource:i,format:o})}}return r}function vb(e,t){if(void 0!==e)for(let r=0;r<t.length;++r){const i=t[r];if(wb(e,i))return i}}function wb(e,t){let r=!1;return!!(0,n.A)(t.formatRegexParsed)&&(t.formatRegexParsed.test(e.format)&&(r=!0),r&&(0,n.A)(t.urlRegexParsed)&&!t.urlRegexParsed.test(e.url)&&(r=!1),r&&(0,n.A)(t.maxFileSize)&&null!==t.maxFileSize&&(0,n.A)(e.size)&&null!==e.size&&e.size/1048576>t.maxFileSize&&(r=!1),r)}function Ab(e){if(e._ckanResource)return e.useResourceName?e._ckanResource.name:e._ckanDataset?e.useCombinationNameWhereMultipleResources&&e._ckanDataset.resources.length>1?e._ckanDataset.title+" - "+e._ckanResource.name:e.useDatasetNameAndFormatWhereMultipleResources&&e._ckanDataset.resources.length>1?e._ckanDataset.title+" - "+e._ckanResource.format:e._ckanDataset.title:e._ckanResource.name}function Sb(e){var t;if(void 0!==e._ckanResource)return void 0!==e._supportedFormat&&"wms"===(null!==(t=e._supportedFormat.definition)&&void 0!==t?t:{}).type&&e._ckanResource.wms_api_url?e._ckanResource.wms_api_url:e._ckanResource.url}var xb,Ob,Pb,Tb;function Ib(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function Db(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function Cb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Db(Object(r),!0).forEach(function(t){Eb(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Db(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Eb(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _b(e){const t=Object.keys(Cy.traits).reduce((t,r)=>Cb(Cb({},t),{},{get[r](){return e[r]}}),{});return(0,i.sH)(t)}_b.stratumName="ckanItemReferenceInheritedPropertiesStratum",dt.A.addLoadStratum(_b.stratumName);let jb=(Ob=class e extends((0,pt.Ay)(Xy)){constructor(e,t){super(),this._catalogGroup=e,this._ckanResponse=t,Eb(this,"groups",[]),Eb(this,"filteredGroups",[]),Eb(this,"datasets",[]),Eb(this,"filteredDatasets",[]),(0,i.Gn)(this),this.datasets=this.getDatasets(),this.filteredDatasets=this.getFilteredDatasets(),this.groups=this.getGroups(),this.filteredGroups=this.getFilteredGroups()}duplicateLoadableStratum(t){return new e(t,this._ckanResponse)}static addFilterQuery(e,t){return"string"==typeof t?e.query(e.query()+"&"+t):Object.keys(t).forEach(r=>e.addQuery(r,t[r])),e.normalize(),e}static async load(t){let r;for(let i=0;i<t.filterQuery.length;++i){const o=t.filterQuery[i],n=new(Ie())(t.url).segment("api/3/action/package_search").addQuery({start:0,rows:1e3,sort:"metadata_created asc"});e.addFilterQuery(n,o);const a=await kb(n,t);void 0===r?r=a:r.result.results=r.result.results.concat(a.result.results)}if(void 0!==r)return new e(t,r)}get preparedSupportedFormats(){return this._catalogGroup.supportedResourceFormats?this._catalogGroup.supportedResourceFormats.map(yb):[]}get members(){if(void 0!==this.filteredGroups&&"none"!==this._catalogGroup.groupBy){const e=[];return this.filteredGroups.forEach(t=>{t.members.length>0&&e.push(t.uniqueId)}),e}return(0,vt.A)(this.filteredDatasets.map(e=>e.resources.map(t=>this.getItemId(e,t))))}getDatasets(){return this._ckanResponse.result.results}getFilteredDatasets(){if(0===this.datasets.length)return[];if(void 0!==this._catalogGroup.excludeMembers){const e=this._catalogGroup.excludeMembers;return this.datasets.filter(t=>-1===e.indexOf(t.title))}return this.datasets}getGroups(){if("none"===this._catalogGroup.groupBy)return[];let e=[];"organization"===this._catalogGroup.groupBy&&function(e,t){e.filteredDatasets.forEach(r=>{if(null!==r.organization){const i=e._catalogGroup.uniqueId+"/"+r.organization.id;let o=e._catalogGroup.terria.getModelById(xe.A,i);void 0===o&&(o=Nb(i,e._catalogGroup.terria,r.organization.title)),t.push(o)}})}(this,e),"group"===this._catalogGroup.groupBy&&function(e,t){e.filteredDatasets.forEach(r=>{r.groups.forEach(r=>{const i=e._catalogGroup.uniqueId+"/"+r.id;let o=e._catalogGroup.terria.getModelById(xe.A,i);void 0===o&&(o=Nb(i,e._catalogGroup.terria,r.display_name),o.setTrait(C.A.definition,"description",r.description)),t.push(o)})})}(this,e);const t=function(e){const t=e._catalogGroup.uniqueId+"/ungrouped";let r=e._catalogGroup.terria.getModelById(xe.A,t);return void 0===r&&(r=Nb(t,e._catalogGroup.terria,e._catalogGroup.ungroupedTitle)),r}(this);return e=[...new Set(e)],e.sort(function(e,t){return void 0===e.name||void 0===t.name?0:e.name<t.name?-1:e.name>t.name?1:0}),[...e,t]}getFilteredGroups(){if(0===this.groups.length)return[];if(void 0!==this._catalogGroup.excludeMembers){const e=this._catalogGroup.excludeMembers;return this.groups.filter(t=>void 0!==t.name&&-1===e.indexOf(t.name))}return this.groups}createMembersFromDatasets(){this.filteredDatasets.forEach(e=>{this.createMemberFromDataset(e)})}addCatalogItemToCatalogGroup(e,t,r){const i=this._catalogGroup.terria.getModelById(xe.A,r);void 0!==i&&i.add(C.A.definition,e)}addCatalogItemByCkanGroupsToCatalogGroup(e,t){if(0===t.groups.length){const r=this._catalogGroup.uniqueId+"/ungrouped";return void this.addCatalogItemToCatalogGroup(e,t,r)}t.groups.forEach(r=>{const i=this._catalogGroup.uniqueId+"/"+r.id;this.addCatalogItemToCatalogGroup(e,t,i)})}createMemberFromDataset(e){if(!(0,n.A)(e.id))return;if(this._catalogGroup.excludeInactiveDatasets&&("deleted"===e.state||"draft"===e.state||"inactive"===e.data_state))return;const t=bb(e,this.preparedSupportedFormats);let r=[];const i=new Set;this._catalogGroup.useSingleResource?r=t[0]?[t[0]]:[]:this.preparedSupportedFormats.forEach(e=>{let o=t.filter(t=>t.format.id===e.id);0!==o.length&&(e.removeDuplicates&&(o=Object.values(o.reduce((e,t)=>{const r=t.resource.name;return(!e[r]||e[r]&&e[r].resource.created<t.resource.created)&&(e[r]=t),e},{}))),e.onlyUseIfSoleResource?t.length===o.length&&r.push(...o):r.push(...o),o.length>1&&e.id&&i.add(e.id))});const o=_b(this._catalogGroup);for(let t=0;t<r.length;++t){const{resource:n,format:s}=r[t],l=this.getItemId(e,n);let c=this._catalogGroup.terria.getModelById(fb,l);if(void 0===c){var a;if(c=new fb(l,this._catalogGroup.terria),1===r.length?(c.setTrait(C.A.override,"useCombinationNameWhereMultipleResources",!1),c.setTrait(C.A.override,"useDatasetNameAndFormatWhereMultipleResources",!1)):s.id&&i.has(s.id)&&c.setTrait(C.A.override,"useResourceName",!0),c.setDataset(e),c.setCkanCatalog(this._catalogGroup),c.setSharedStratum(o),c.setResource(n),c.setSupportedFormat(s),c.setCkanStrata(c),(null===(a=s.definition)||void 0===a?void 0:a.type)===bi.Ay.type&&!c.wmsLayers&&!this._catalogGroup.allowEntireWmsServers)return;c.terria.addModel(c);const t=Ab(c);if(t&&c.setTrait(C.A.definition,"name",t),"organization"===this._catalogGroup.groupBy){const t=e.organization?this._catalogGroup.uniqueId+"/"+e.organization.id:this._catalogGroup.uniqueId+"/ungrouped";this.addCatalogItemToCatalogGroup(c,e,t)}else"group"===this._catalogGroup.groupBy&&this.addCatalogItemByCkanGroupsToCatalogGroup(c,e)}}}getItemId(e,t){const r=this.buildResourceId(e,t);return"".concat(this._catalogGroup.uniqueId,"/").concat(e.id,"/").concat(r)}buildResourceId(e,t){var r;const i=this.resourceIdTemplateForOrg(null===(r=e.organization)||void 0===r?void 0:r.name);return i?gt().render(i,{resource:t}).replace("/",""):t.id}resourceIdTemplateForOrg(e){const t=this._catalogGroup.resourceIdTemplate;if(!t)return;const r=this._catalogGroup.restrictResourceIdTemplateToOrgsWithNames;return Array.isArray(r)||(0,i.Fq)(r)?r.includes(e)?t:void 0:t}},Eb(Ob,"stratumName","ckanServer"),Ib((xb=Ob).prototype,"preparedSupportedFormats",[i.EW],Object.getOwnPropertyDescriptor(xb.prototype,"preparedSupportedFormats"),xb.prototype),Ib(xb.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(xb.prototype,"members"),xb.prototype),Ib(xb.prototype,"getFilteredDatasets",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"getFilteredDatasets"),xb.prototype),Ib(xb.prototype,"getGroups",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"getGroups"),xb.prototype),Ib(xb.prototype,"getFilteredGroups",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"getFilteredGroups"),xb.prototype),Ib(xb.prototype,"createMembersFromDatasets",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"createMembersFromDatasets"),xb.prototype),Ib(xb.prototype,"addCatalogItemToCatalogGroup",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"addCatalogItemToCatalogGroup"),xb.prototype),Ib(xb.prototype,"addCatalogItemByCkanGroupsToCatalogGroup",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"addCatalogItemByCkanGroupsToCatalogGroup"),xb.prototype),Ib(xb.prototype,"createMemberFromDataset",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"createMemberFromDataset"),xb.prototype),Ib(xb.prototype,"getItemId",[i.XI],Object.getOwnPropertyDescriptor(xb.prototype,"getItemId"),xb.prototype),xb);dt.A.addLoadStratum(jb.stratumName);let zb=(Tb=class e extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Xy))))){constructor(e,t,r){super(e,t,r),(0,i.Gn)(this),this.strata.set(Ky.stratumName,new Ky)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.ckan.nameServer")}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}async forceLoadMetadata(){if(!this.strata.get(jb.stratumName)){const e=await jb.load(this);if(void 0===e)return;(0,i.h5)(()=>{this.strata.set(jb.stratumName,e)})}}async forceLoadMembers(){const e=this.strata.get(jb.stratumName);e&&await(0,De.A)(()=>e.createMembersFromDatasets())}},Eb(Tb,"type","ckan-group"),Ib((Pb=Tb).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(Pb.prototype,"cacheDuration"),Pb.prototype),Pb);function Nb(e,t,r){const i=new xe.A(e,t);return i.setTrait(C.A.definition,"name",r),t.addModel(i),i}async function kb(e,t){const r=await Rb(e,t);if(void 0===r||!r||!r.help)throw(0,At.mG)({title:Pe.Ay.t("models.ckan.errorLoadingTitle"),message:Pe.Ay.t("models.ckan.errorLoadingMessage")});let i=1001;for(;i<r.result.count;)await Mb(e,t,r,i),i+=1e3;return r}async function Rb(e,t){return await(0,H.A)((0,ie.A)(t,e.toString()))}async function Mb(e,t,r,i){e.setQuery("start",i);const o=await Rb(e,t);void 0!==o&&(r.result.results=r.result.results.concat(o.result.results))}var Fb;let Lb=(0,Re.b)({description:'Creates a group that has individual ESRI services ("MapServer" or "FeatureServer") in the given URL as members (subgroups) in the catalog.',example:{type:"esri-group",name:"Sydney",url:"https://services1.arcgis.com/cNVyNtjGVZybOQWZ/arcgis/rest/services",id:"some id"}})(Fb=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A)){})||Fb;var Gb;let Ub=(0,Re.b)({description:"Creates a group that has individual ESRI WFS layers in the given URL as members.\n\n  <strong>Note:</strong> <i>To exclude unwanted layers, specify their <b>names</b> in property <code>excludeMembers</code>.</i>",example:{url:"https://services7.arcgis.com/fVJQ0uhT9L4zp35f/arcgis/rest/services/ActivityArea_gdb/FeatureServer",type:"esri-featureServer-group",excludeMembers:["BCC SHWEP"],name:"Activity Area",id:"some id"}})(Gb=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A)){})||Gb;var Wb,qb,Bb,Vb,Hb,$b,Jb,Xb,Kb,Zb,Qb,Yb,ev,tv,rv,iv,ov,nv,av,sv,lv,cv,uv,pv,dv,hv,mv,fv,gv,yv,bv,vv,wv,Av=r(71569),Sv=r(62722),xv=r(22032),Ov=r(80589),Pv=r(56480),Tv=r(10807);function Iv(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Dv(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Cv=(Wb=(0,Re.b)({description:"Creates a single item in the catalog from one ESRI Feature Server layer.\n\n  <strong>Note:</strong> <i>Must specify <b>layer ID</b>, e.g. <code>/0</code>, in the URL path.</i>\n\n  Some traits are only relevant when the service supports tiling (see `tileRequests` trait).",example:{url:"https://services5.arcgis.com/OvOcYIrJnM97ABBA/arcgis/rest/services/Australian_Public_Hospitals_WFL1/FeatureServer/0",type:"esri-featureServer",name:"Australian Public Hospitals",id:"some id"}}),qb=(0,K.A)({type:"boolean",name:"Clamp to Ground",description:"Whether the features in this service should be clamped to the terrain surface."}),Bb=(0,K.A)({type:"boolean",name:"Use style information from service",description:"Whether to symbolise the data using the drawingInfo object available in the service endpoint."}),Vb=(0,K.A)({type:"string",name:"layerDef",description:"DEPRECATED, use `where` instead. The 'layerDef' string to pass to the server when requesting geometry."}),Hb=(0,K.A)({type:"string",name:"Where clause",description:"The 'where' string to pass to the server when requesting geometry."}),$b=(0,K.A)({type:"number",name:"Maximum features",description:"The maximum number of features to be retrieved from the feature service."}),Jb=(0,K.A)({type:"number",name:"Features per request",description:"The number of features to be retrieved from the feature service in each request. This should be equal to the maxRecordCount specified by the server."}),Xb=(0,K.A)({type:"boolean",name:"Supports pagination",description:"Whether this feature service supports pagination. By default, this will be inferred from the server's response."}),Kb=(0,K.A)({type:"boolean",name:"Tile requests",description:"Whether this feature service supports tiled requests. This will be true by default, if the server supports tiling and no unsupported Point/Label/Trail styles are used (for example custom marker images)"}),Zb=(0,K.A)({type:"boolean",name:"Clip tile requests to rectangle",description:"Gets or sets a value indicating whether this dataset should be clipped to the {@link CatalogItem#rectangle}.\nIf true, no part of the dataset will be displayed outside the rectangle.\nThis property is true by default, leading to better performance and avoiding tile request errors that might occur when requesting tiles outside the server-specified rectangle.\nHowever, it may also cause features to be cut off in some cases, such as if a server reports an extent that does not take into account that the representation of features sometimes require a larger spatial extent than the features themselves.\nFor example, if a point feature on the edge of the extent is drawn as a circle with a radius of 5 pixels, half of that circle will be cut off."}),Qb=(0,K.A)({type:"number",name:"Maximum features",description:"For each tile, the maximum number of features to be retrieved from the feature service. This will limit the number of requests, each request uses featuresPerTileRequest trait."}),Yb=(0,K.A)({type:"number",name:"Features per request",description:"The number of features to be retrieved from the feature service in each request. This should be equal to the tileMaxRecordCount specified by the server."}),ev=(0,K.A)({type:"number",name:"maxRecordCountFactor",description:"When set, the maximum number of features returned by the query will equal the maxRecordCount of the service multiplied by this factor. This only applies to tiled requests. This will use the server's default value."}),tv=(0,K.A)({type:"boolean",name:"Tile requests",description:"Whether this feature service supports tiled requests. By default, this will be inferred from the server's response."}),rv=(0,K.A)({type:"string",name:"Object ID Field",description:"The field in the feature service that contains the unique identifier for each feature."}),iv=(0,mr.A)({type:"string",name:"Out Fields",description:"The fields to be included in the response from the feature service. This will default to the object ID field, and include any fields required for styling. Currently, this only applies to tiled requests."}),Wb((nv=class extends((0,u.A)(d.A,Ki.Ay,_e.Ay,ke.A,Ir.h,Pv.A,Tv.c)){constructor(){super(...arguments),Iv(this,"clampToGround",av,this),Iv(this,"useStyleInformationFromService",sv,this),Iv(this,"layerDef",lv,this),Iv(this,"where",cv,this),Iv(this,"maxFeatures",uv,this),Iv(this,"featuresPerRequest",pv,this),Iv(this,"supportsPagination",dv,this),Iv(this,"tileRequests",hv,this),Iv(this,"clipToRectangle",mv,this),Iv(this,"maxTiledFeatures",fv,this),Iv(this,"featuresPerTileRequest",gv,this),Iv(this,"maxRecordCountFactor",yv,this),Iv(this,"supportsQuantization",bv,this),Iv(this,"objectIdField",vv,this),Iv(this,"outFields",wv,this)}},av=Dv(nv.prototype,"clampToGround",[qb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),sv=Dv(nv.prototype,"useStyleInformationFromService",[Bb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),lv=Dv(nv.prototype,"layerDef",[Vb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"1=1"}}),cv=Dv(nv.prototype,"where",[Hb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"1=1"}}),uv=Dv(nv.prototype,"maxFeatures",[$b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5e3}}),pv=Dv(nv.prototype,"featuresPerRequest",[Jb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),dv=Dv(nv.prototype,"supportsPagination",[Xb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hv=Dv(nv.prototype,"tileRequests",[Kb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),mv=Dv(nv.prototype,"clipToRectangle",[Zb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),fv=Dv(nv.prototype,"maxTiledFeatures",[Qb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e5}}),gv=Dv(nv.prototype,"featuresPerTileRequest",[Yb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4e3}}),yv=Dv(nv.prototype,"maxRecordCountFactor",[ev],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),bv=Dv(nv.prototype,"supportsQuantization",[tv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),vv=Dv(nv.prototype,"objectIdField",[rv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"OBJECTID"}}),wv=Dv(nv.prototype,"outFields",[iv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["OBJECTID"]}}),ov=nv))||ov);var Ev,_v,jv=r(88562),zv=r(58696),Nv=r(67763),kv=r(43376),Rv=r(47659),Mv=r(69823);function Fv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function Lv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fv(Object(r),!0).forEach(function(t){Gv(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fv(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Gv(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uv(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const Wv={esriFieldTypeSmallInteger:"scalar",esriFieldTypeInteger:"scalar",esriFieldTypeSingle:"scalar",esriFieldTypeDouble:"scalar",esriFieldTypeString:"text",esriFieldTypeDate:"time",esriFieldTypeOID:"scalar",esriFieldTypeGeometry:"hidden",esriFieldTypeBlob:"hidden",esriFieldTypeRaster:"hidden",esriFieldTypeGUID:"hidden",esriFieldTypeGlobalID:"hidden",esriFieldTypeXML:"hidden",esriFieldTypeBigInteger:"scalar"};let qv=(_v=class e extends((0,pt.Ay)(Cv)){constructor(e,t){super(),this._item=e,this._featureServer=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._featureServer)}static async load(t){if(void 0===t.url)return new e(t,void 0);const r=(i=t,(0,ie.A)(i,new(Ie())(i.url).addQuery("f","json").toString()));var i;const o=await(0,H.A)(r);return new e(t,o)}get shortReport(){var e;if(void 0!==(null===(e=this._item.readyData)||void 0===e?void 0:e.features)&&this._item.readyData.features.length>=this._item.maxFeatures)return Pe.Ay.t("models.arcGisFeatureServerCatalogItem.reachedMaxFeatureLimit",this._item)}get maxScaleDenominator(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.minScale}get minScaleDenominator(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.maxScale}get name(){var e;if(void 0!==(null===(e=this._featureServer)||void 0===e?void 0:e.name)&&this._featureServer.name.length>0)return ti(this._featureServer.name)}get dataCustodian(){var e,t,r;if(null!==(e=this._featureServer)&&void 0!==e&&e.documentInfo&&null!==(t=this._featureServer)&&void 0!==t&&t.documentInfo.Author&&(null===(r=this._featureServer)||void 0===r?void 0:r.documentInfo.Author.length)>0)return this._featureServer.documentInfo.Author}get rectangle(){var e,t,r,i;const o=null===(e=this._featureServer)||void 0===e?void 0:e.extent,a=null!==(t=null==o||null===(r=o.spatialReference)||void 0===r?void 0:r.latestWkid)&&void 0!==t?t:null==o||null===(i=o.spatialReference)||void 0===i?void 0:i.wkid;if((0,n.A)(o)&&(0,n.A)(a)){const e="EPSG:"+a;if(!(0,n.A)(jv.A[e]))return;const t=jv.A[e],r="EPSG:4326";let i=(0,kf.default)(t,r,[o.xmin,o.ymin]);const s=i[0],l=i[1];i=(0,kf.default)(t,r,[o.xmax,o.ymax]);const c={west:s,south:l,east:i[0],north:i[1]};return(0,ut.A)(Ki.Ts,c)}}get info(){var e,t;return[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogItem.dataDescription"),content:null===(e=this._featureServer)||void 0===e?void 0:e.description}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogItem.copyrightText"),content:null===(t=this._featureServer)||void 0===t?void 0:t.copyrightText})]}get supportsPagination(){return void 0!==this._featureServer&&void 0!==this._featureServer.advancedQueryCapabilities&&!!this._featureServer.advancedQueryCapabilities.supportsPagination}get activeStyle(){return"ESRI"}get styles(){var e;const t=null===(e=this._featureServer)||void 0===e||null===(e=e.drawingInfo)||void 0===e?void 0:e.renderer;if(!t)return[];const r=t.type;if("simple"===r){var i,o;const e=t,r=e.symbol;if(null!==(i=e.visualVariables)&&void 0!==i&&i.length&&console.warn("WARNING: Terria does not support visual variables in ArcGisFeatureService SimpleRenderers"),!r)return[];const n=(0,Mv.Zc)(r,e.label);return[(0,ut.A)(Mt.A,{id:"ESRI",hidden:!1,color:(0,ut.A)(zv.A,{nullColor:null!==(o=n.color)&&void 0!==o?o:"#ffffff"}),pointSize:n.pointSize,point:(0,ut.A)(Rv.Ay,{null:n.point}),outline:(0,ut.A)(Nv.Ay,{null:n.outline})})]}if("uniqueValue"===r){var n;const e=t,r=e.uniqueValueInfos.map(e=>(0,Mv.Zc)(e.symbol,e.label)),i=(0,Mv.Zc)(e.defaultSymbol,void 0),o=!!e.uniqueValueInfos.find(e=>{var t;return"esriPMS"!==(null===(t=e.symbol)||void 0===t?void 0:t.type)});return(e.field2||e.field3)&&console.warn("WARNING: Terria only supports ArcGisFeatureService UniqueValueRenderers with a single field (`field1`), not multiple fields (`field2` or `field3`)"),null!==(n=e.visualVariables)&&void 0!==n&&n.length&&console.warn("WARNING: Terria does not support visual variables in ArcGisFeatureService UniqueValueRenderers"),e.valueExpression&&console.warn("WARNING: Terria does not support value expressions in ArcGisFeatureService UniqueValueRenderers"),e.field1?[(0,ut.A)(Mt.A,{id:"ESRI",hidden:!1,color:o?(0,ut.A)(zv.A,{colorColumn:e.field1,mapType:"enum",enumColors:e.uniqueValueInfos.map((e,t)=>{var i;return(0,ut.A)(zv.k,{value:e.value,color:null!==(i=r[t].color)&&void 0!==i?i:"#ffffff"})}),nullColor:i.color}):(0,ut.A)(zv.A,{nullColor:"#FFFFFF"}),pointSize:(0,ut.A)(kv.A,{}),point:(0,ut.A)(Rv.Ay,{mapType:"enum",column:e.field1,enum:e.uniqueValueInfos.map((e,t)=>(0,ut.A)(Rv.ns,Lv({value:e.value},r[t].point))),null:i.point}),outline:(0,ut.A)(Nv.Ay,{mapType:"enum",column:e.field1,enum:e.uniqueValueInfos.map((e,t)=>(0,ut.A)(Nv.Hu,Lv({value:e.value},r[t].outline))),null:i.outline})})]:(console.warn("WARNING: Terria does not support empty field1 in UniqueValueRenderers, using default style"),[])}if("classBreaks"===r){var a;const e=t;null!==(a=e.visualVariables)&&void 0!==a&&a.length&&console.warn("WARNING: Terria does not support visual variables in ArcGisFeatureService ClassBreakRenderers"),e.valueExpression&&console.warn("WARNING: Terria does not support value expressions in ArcGisFeatureService ClassBreakRenderers");const r=e.classBreakInfos.map(e=>(0,Mv.Zc)(e.symbol,e.label)),i=(0,Mv.Zc)(e.defaultSymbol,void 0),o=!!e.classBreakInfos.find(e=>{var t;return"esriPMS"!==(null===(t=e.symbol)||void 0===t?void 0:t.type)});return[(0,ut.A)(Mt.A,{id:"ESRI",hidden:!1,color:o?(0,ut.A)(zv.A,{mapType:"bin",colorColumn:e.field,binColors:r.map(e=>{var t;return null!==(t=e.color)&&void 0!==t?t:""}),binMaximums:e.classBreakInfos.map(e=>e.classMaxValue),nullColor:i.color}):(0,ut.A)(zv.A,{nullColor:"#FFFFFF"}),pointSize:(0,ut.A)(kv.A,{}),point:(0,ut.A)(Rv.Ay,{mapType:"bin",column:e.field,bin:e.classBreakInfos.map((e,t)=>(0,ut.A)(Rv.fj,Lv({maxValue:e.classMaxValue},r[t].point))),null:i.point}),outline:(0,ut.A)(Nv.Ay,{mapType:"bin",column:e.field,bin:e.classBreakInfos.map((e,t)=>(0,ut.A)(Nv.nD,Lv({maxValue:e.classMaxValue},r[t].outline))),null:i.outline})})]}console.warn("WARNING: Terria does not support ArcGisFeatureService renderers of type ".concat(r))}get columns(){var e,t;return null!==(e=null===(t=this._featureServer)||void 0===t||null===(t=t.fields)||void 0===t?void 0:t.filter(e=>!!Wv[e.type]||(console.warn("WARNING: Terria does not support ESRI field type ".concat(e.type)),!1)).map(e=>{var t;return(0,ut.A)(Rt.Ay,{name:e.name,title:e.alias,type:null===(t=Wv[e.type])||void 0===t?void 0:t.toString()})}))&&void 0!==e?e:[]}get featuresPerRequest(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.maxRecordCount}get featuresPerTileRequest(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.tileMaxRecordCount}get maxRecordCountFactor(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.maxRecordCountFactor}get supportsQuantization(){var e;return!(null===(e=this._featureServer)||void 0===e||!e.supportsCoordinatesQuantization)}get tileRequests(){var e,t;return!this._item.forceCesiumPrimitives&&((null===(e=this._featureServer)||void 0===e?void 0:e.supportsTilesAndBasicQueriesMode)&&"string"==typeof(null===(t=this._featureServer)||void 0===t?void 0:t.supportedQueryFormats)&&this._featureServer.supportedQueryFormats.toLowerCase().includes("pbf")?!(0,xv.S)(this._item):void 0)}get objectIdField(){var e;return null===(e=this._featureServer)||void 0===e?void 0:e.objectIdField}get outFields(){var e,t;return Array.from(new Set([this._item.objectIdField,this._item.activeTableStyle.tableColorMap.colorTraits.colorColumn,null===(e=this._item.activeTableStyle.outlineStyleMap.traits)||void 0===e?void 0:e.column,null===(t=this._item.activeTableStyle.pointStyleMap.traits)||void 0===t?void 0:t.column])).filter(e=>!!e)}},Gv(_v,"stratumName","featureServer"),Uv((Ev=_v).prototype,"shortReport",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"shortReport"),Ev.prototype),Uv(Ev.prototype,"maxScaleDenominator",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"maxScaleDenominator"),Ev.prototype),Uv(Ev.prototype,"minScaleDenominator",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"minScaleDenominator"),Ev.prototype),Uv(Ev.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"name"),Ev.prototype),Uv(Ev.prototype,"dataCustodian",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"dataCustodian"),Ev.prototype),Uv(Ev.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"rectangle"),Ev.prototype),Uv(Ev.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"info"),Ev.prototype),Uv(Ev.prototype,"supportsPagination",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"supportsPagination"),Ev.prototype),Uv(Ev.prototype,"activeStyle",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"activeStyle"),Ev.prototype),Uv(Ev.prototype,"styles",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"styles"),Ev.prototype),Uv(Ev.prototype,"columns",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"columns"),Ev.prototype),Uv(Ev.prototype,"tileRequests",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"tileRequests"),Ev.prototype),Uv(Ev.prototype,"outFields",[i.EW],Object.getOwnPropertyDescriptor(Ev.prototype,"outFields"),Ev.prototype),Ev);var Bv,Vv;function Hv(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}dt.A.addLoadStratum(qv.stratumName);let $v=(Vv=class e extends((0,Ov.A)((0,Tr.Ay)((0,g.A)(Cv)))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.arcGisFeatureServerCatalogItem.name")}async forceLoadMetadata(){if(void 0===this.strata.get(qv.stratumName)){const e=await qv.load(this);(0,i.h5)(()=>{this.strata.set(qv.stratumName,e)})}}async forceLoadGeojsonData(){var e;if(this.tileRequests)return(0,Oo.Lr)([]);const t=async e=>{const t=(0,ie.A)(this,this.buildEsriJsonUrl(e).throwIfUndefined().toString());return await(0,H.A)(t)};var r;if(!this.supportsPagination)return null!==(r=(0,Av.A)(await t()))&&void 0!==r?r:{type:"FeatureCollection",features:[]};const i=this.featuresPerRequest,o=this.maxFeatures,n=await t(0),a=e=>e.map(e=>{var t;return null!==(t=e.attributes.OBJECTID)&&void 0!==t?t:e.attributes.objectid}),s=new Set(a(n.features));let l=0,c=n.exceededTransferLimit;for(;n.features.length<=o&&!0===c;){l+=i;const e=await t(l);if(void 0===e.features||0===e.features.length)break;const r=a(e.features);if(r.every(e=>s.has(e)))break;r.forEach(e=>s.add(e)),n.features=n.features.concat(e.features),c=e.exceededTransferLimit,c&&console.log("warning: exceeded transfer limit")}return null!==(e=(0,Av.A)(n))&&void 0!==e?e:{type:"FeatureCollection",features:[]}}get imageryProvider(){if(!this.strata.has(qv.stratumName))return;const{paintRules:e,labelRules:t}=(0,xv.z)(this,!1,!0),r=this.buildEsriJsonUrl().logError("Failed to create valid FeatureServer URL");if(!r)return;const i=(0,ie.A)(this,r.toString());let o=new pm.Ay({maximumZoom:this.getMaximumLevel(!1),minimumZoom:this.getMinimumLevel(!1),terria:this.terria,data:new Sv.Y({url:i,outFields:[...this.outFields],featuresPerTileRequest:this.featuresPerTileRequest,maxRecordCountFactor:this.maxRecordCountFactor,maxTiledFeatures:this.maxTiledFeatures,tilingScheme:new Mn.A,enablePickFeatures:this.allowFeaturePicking,objectIdField:this.objectIdField,supportsQuantization:this.supportsQuantization}),id:this.uniqueId,paintRules:e,labelRules:t});return o=this.wrapImageryPickFeatures(o),o=this.updateRequestImage(o),o}get mapItems(){return this.tileRequests?this.imageryProvider?[{imageryProvider:this.imageryProvider,show:this.show,alpha:this.opacity,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]:super.mapItems}get dataColumnMajor(){return super.dataColumnMajor.length>0?super.dataColumnMajor:this.columns.map(e=>{var t;return[null!==(t=e.name)&&void 0!==t?t:""]})}buildEsriJsonUrl(e){const t=function(e){const t=new(Ie())(e);return t.search(""),t.toString()}(this.url||"0d"),r=function(e){const t=e.match(/^(.*FeatureServer)\/(\d+)/);return(0,n.A)(t)&&null!==t&&t.length>2?{layerId:t[2],urlWithoutLayerId:t[1]}:{urlWithoutLayerId:e}}(t),i=r.layerId;if(!(0,n.A)(i))return To.A.error((0,At.mG)({title:{key:"models.arcGisFeatureServerCatalogItem.invalidServiceTitle"},message:{key:"models.arcGisFeatureServerCatalogItem.invalidServiceMessage"}}));const o="1=1"===this.where?this.layerDef:this.where,a=new(Ie())(t).segment("query").addQuery("f","json").addQuery("where",o).addQuery("outFields","*").addQuery("outSR","4326");return void 0!==e&&a.addQuery("resultRecordCount",this.featuresPerRequest).addQuery("resultOffset",e),new To.A(a)}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Vv,"type","esri-featureServer"),Hv((Bv=Vv).prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(Bv.prototype,"imageryProvider"),Bv.prototype),Hv(Bv.prototype,"mapItems",[i.$Z],Object.getOwnPropertyDescriptor(Bv.prototype,"mapItems"),Bv.prototype),Hv(Bv.prototype,"dataColumnMajor",[i.$Z],Object.getOwnPropertyDescriptor(Bv.prototype,"dataColumnMajor"),Bv.prototype),Bv);var Jv,Xv;function Kv(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zv(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Qv=(Xv=class e extends((0,pt.Ay)(Ub)){constructor(e,t){super(),this._catalogGroup=e,this._featureServer=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._featureServer)}get featureServerData(){return this._featureServer}get name(){if(this._featureServer.documentInfo&&this._featureServer.documentInfo.Title&&this._featureServer.documentInfo.Title.length>0)return ti(this._featureServer.documentInfo.Title)}get info(){return[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.serviceDescription"),content:this._featureServer.serviceDescription}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.dataDescription"),content:this._featureServer.description}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.copyrightText"),content:this._featureServer.copyrightText})]}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}get dataCustodian(){if(this._featureServer.documentInfo&&this._featureServer.documentInfo.Author&&this._featureServer.documentInfo.Author.length>0)return this._featureServer.documentInfo.Author}static async load(t){const r=new(Ie())(t.url).addQuery("f","json");return(0,H.A)((0,ie.A)(t,r.toString())).then(r=>{if(!r||!r.layers)throw(0,At.mG)({title:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.invalidServiceTitle"),message:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.invalidServiceMessage")});return new e(t,r)}).catch(()=>{throw(0,At.mG)({sender:t,title:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.groupNotAvailableTitle"),message:Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.groupNotAvailableMessage")})})}get members(){return(0,o.A)(this.layers.map(e=>{if((0,n.A)(e.id))return this._catalogGroup.uniqueId+"/"+e.id}))}get layers(){return this._featureServer.layers}createMembersFromLayers(){this.layers.forEach(e=>this.createMemberFromLayer(e))}createMemberFromLayer(e){if(!(0,n.A)(e.id))return;const t=this._catalogGroup.uniqueId+"/"+e.id,r=this._catalogGroup.terria.getModelById($v,t);let i;void 0===r?(i=new $v(t,this._catalogGroup.terria),this._catalogGroup.terria.addModel(i)):i=r,i.strata.delete(C.A.definition),i.setTrait(C.A.definition,"name",ti(e.name));const o=new(Ie())(this._catalogGroup.url).segment(e.id+"");i.setTrait(C.A.definition,"url",o.toString())}},Kv(Xv,"stratumName","featureServer"),Zv((Jv=Xv).prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"name"),Jv.prototype),Zv(Jv.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"info"),Jv.prototype),Zv(Jv.prototype,"cacheDuration",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"cacheDuration"),Jv.prototype),Zv(Jv.prototype,"dataCustodian",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"dataCustodian"),Jv.prototype),Zv(Jv.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"members"),Jv.prototype),Zv(Jv.prototype,"layers",[i.EW],Object.getOwnPropertyDescriptor(Jv.prototype,"layers"),Jv.prototype),Zv(Jv.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(Jv.prototype,"createMembersFromLayers"),Jv.prototype),Zv(Jv.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(Jv.prototype,"createMemberFromLayer"),Jv.prototype),Jv);dt.A.addLoadStratum(Qv.stratumName);class Yv extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Ub))))){get type(){return Yv.type}get typeName(){return Pe.Ay.t("models.arcGisFeatureServerCatalogGroup.name")}forceLoadMetadata(){return Qv.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(Qv.stratumName,e)})})}async forceLoadMembers(){const e=this.strata.get(Qv.stratumName);e&&await(0,De.A)(()=>e.createMembersFromLayers())}}var ew;Kv(Yv,"type","esri-featureServer-group");let tw=(0,Re.b)({description:"Creates a group that has individual ESRI WMS layers in the given URL as members in the catalog.",example:{type:"esri-mapServer-group",name:"Catchment Scale Land Use",id:"354db2f2",url:"https://www.asris.csiro.au/arcgis/rest/services/abares/clum_50m_2018/MapServer"}})(ew=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A)){})||ew;var rw=r(27677);const iw=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?(0,rw.A)(e,void 0,t):[]};var ow,nw,aw,sw,lw,cw,uw,pw,dw,hw,mw,fw,gw,yw,bw,vw,ww,Aw,Sw,xw,Ow,Pw=r(95093),Tw=r.n(Pw),Iw=r(86317),Dw=r(24011),Cw=r(85232),Ew=r(3239),_w=r(51533),jw=r(28928),zw=r(9193);function Nw(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function kw(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Rw=(ow=(0,Re.b)({description:'Creates a single item in the catalog from one or many ESRI WMS layers.\n\n  <strong>Note:</strong> <i>The following example does not specify <b>layers</b> property therefore will present all layers in the given URL as single catalog item. To present specific layers only, add them in <b>layers</b> property, e.g. <code>"layers": "AUS_GA_2500k_MiscLines,AUS_GA_2500k_Faults"</code>.</i>',example:{url:"https://services.ga.gov.au/gis/rest/services/GA_Surface_Geology/MapServer",type:"esri-mapServer",name:"Surface Geology"}}),nw=(0,K.A)({type:"string",name:"Layer(s)",description:"The layer or layers to display. This can be a comma separated string of layer IDs or names."}),aw=(0,K.A)({type:"number",name:"Maximum scale",description:"Gets or sets the denominator of the largest scale (smallest denominator) for which tiles should be requested.  For example, if this value is 1000, then tiles representing a scale larger than 1:1000 (i.e. numerically smaller denominator, when zooming in closer) will not be requested.  Instead, tiles of the largest-available scale, as specified by this property, will be used and will simply get blurier as the user zooms in closer."}),sw=(0,hr.A)({name:"Parameters",description:"Additional parameters to pass to the MapServer when requesting images."}),lw=(0,K.A)({name:"Token URL",description:"URL to use for fetching request tokens",type:"string"}),cw=(0,K.A)({type:"number",name:"Maximum Refresh Intervals",description:"The maximum number of discrete times that can be created by a single date range when layer in time-enabled."}),uw=(0,K.A)({name:"Time Window Duration",description:"Specify a time window duration when querying a time-enabled layer. Will not query with time window for non-positive value",type:"number"}),pw=(0,K.A)({name:"Time Window Unit",description:"The time window unit for the `Time Window Duration`. Any units supported by `moment` module are valid, such as, `year`, `month`, `week`, `day`, `hour`, etc. Will not query time with window if the unit is invalid or undefined.",type:"string"}),dw=(0,K.A)({name:"Is Forward Time Window",description:"If true, the time window is forward from the current time. Otherwise backward. Default to forward window.",type:"boolean"}),hw=(0,K.A)({name:"Use Pre-Cached Tiles If Available",description:"If true, the server's pre-cached tiles are used if they are available. If false, then the MapServer export endpoint will be used. This will default to true if no specific layers are fetched (i.e. all layers are fetched). Otherwise, it will default to false. This will also default to false if parameters have been specified",type:"boolean"}),ow((fw=class extends((0,u.A)(Ji.A,Xi.A,d.A,_e.Ay,ke.A,zw.A,Tv.c)){constructor(){super(...arguments),Nw(this,"layers",gw,this),Nw(this,"maximumScale",yw,this),Nw(this,"parameters",bw,this),Nw(this,"tokenUrl",vw,this),Nw(this,"maxRefreshIntervals",ww,this),Nw(this,"timeWindowDuration",Aw,this),Nw(this,"timeWindowUnit",Sw,this),Nw(this,"isForwardTimeWindow",xw,this),Nw(this,"usePreCachedTilesIfAvailable",Ow,this)}},gw=kw(fw.prototype,"layers",[nw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yw=kw(fw.prototype,"maximumScale",[aw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bw=kw(fw.prototype,"parameters",[sw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vw=kw(fw.prototype,"tokenUrl",[lw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ww=kw(fw.prototype,"maxRefreshIntervals",[cw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e4}}),Aw=kw(fw.prototype,"timeWindowDuration",[uw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sw=kw(fw.prototype,"timeWindowUnit",[pw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xw=kw(fw.prototype,"isForwardTimeWindow",[dw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ow=kw(fw.prototype,"usePreCachedTilesIfAvailable",[hw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mw=fw))||mw);const Mw=function(e,t,r){const i={url:t,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({url:r})};return(0,$.A)(i).then(function(t){const r=JSON.parse(t);if(!(0,aa.A)(r.token))throw new At.Ay({title:Pe.Ay.t("models.getToken.errorTitle"),message:Pe.Ay.t("models.getToken.invalidToken",{email:'<a href="mailto:'+e.supportEmail+'">'+e.supportEmail+"</a>."})});return r.token}).catch(()=>{throw new At.Ay({title:Pe.Ay.t("models.getToken.errorTitle"),message:Pe.Ay.t("models.getToken.unableToRequest",{email:'<a href="mailto:'+e.supportEmail+'">'+e.supportEmail+"</a>."})})})};var Fw,Lw,Gw,Uw;function Ww(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qw(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Bw=(Lw=class e extends((0,pt.Ay)(Rw)){constructor(e,t,r,o,n){super(),this._item=e,this.mapServer=t,this.allLayers=r,this._legends=o,this.token=n,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.mapServer,this.allLayers,this._legends,this.token)}static async load(t){var r,i,o,a;if(!(0,n.A)(t.uri)||!(0,n.A)(t.url))throw new At.Ay({title:Pe.Ay.t("models.arcGisMapServerCatalogItem.invalidUrlTitle"),message:Pe.Ay.t("models.arcGisMapServerCatalogItem.invalidUrlMessage")});let s;(0,n.A)(t.tokenUrl)&&(s=await Mw(t.terria,t.tokenUrl,t.url));let l=Hw(t),c=Hw(t).segment("layers"),u=Hw(t).segment("legend");(0,n.A)(s)&&(l=l.addQuery("token",s),c=c.addQuery("token",s),u=u.addQuery("token",s));const p=await $w(t,l);if(!(0,n.A)(p))throw(0,At.mG)({title:Pe.Ay.t("models.arcGisService.invalidServerTitle"),message:Pe.Ay.t("models.arcGisService.invalidServerMessage")});const d=await $w(t,u);let h=[];if(!p.singleFusedMapCache||null===(r=p.capabilities)||void 0===r||!r.includes("TilesOnly")){const e=await $w(t,c);if((0,n.A)(p.layers)&&(h=p.layers),(0,n.A)(null==e?void 0:e.layers)&&(h=e.layers),!(0,n.A)(h)||0===h.length)throw(0,At.mG)({title:Pe.Ay.t("models.arcGisMapServerCatalogItem.noLayersFoundTitle"),message:Pe.Ay.t("models.arcGisMapServerCatalogItem.noLayersFoundMessage",t)})}const m=new e(t,p,h,d,s),f=null!==(i=null===(o=p.fullExtent.spatialReference)||void 0===o?void 0:o.latestWkid)&&void 0!==i?i:null===(a=p.fullExtent.spatialReference)||void 0===a?void 0:a.wkid;return f&&t.terria.configParameters.proj4ServiceBaseUrl&&await _w.A.checkProjection(t.terria.configParameters.proj4ServiceBaseUrl,"EPSG:".concat(f)),m}get maximumScale(){return 0===this._item.layersArray.length?this.mapServer.maxScale:Math.min(...(0,o.A)(this._item.layersArray.map(e=>{let{maxScale:t}=e;return t})))}get layers(){if((0,n.A)(this._item.uri)){const e=this._item.uri.segment(-1);if((0,n.A)(e)&&e.match(/\d+/))return e}}get name(){return 1===this._item.layersArray.length&&this._item.layersArray[0].name&&this._item.layersArray[0].name.length>0?ti(this._item.layersArray[0].name):this.mapServer.documentInfo&&this.mapServer.documentInfo.Title&&this.mapServer.documentInfo.Title.length>0?ti(this.mapServer.documentInfo.Title):this.mapServer.mapName&&this.mapServer.mapName.length>0?ti(this.mapServer.mapName):void 0}get dataCustodian(){if(this.mapServer.documentInfo&&this.mapServer.documentInfo.Author&&this.mapServer.documentInfo.Author.length>0)return this.mapServer.documentInfo.Author}get rectangle(){const e={west:1/0,south:1/0,east:-1/0,north:-1/0};if(0!==this._item.layersArray.length&&"extent"in this._item.layersArray[0]?function(e,t){t.forEach(function(t){t.extent&&Xw(t.extent,e)})}(e,this._item.layersArray):Xw(this.mapServer.fullExtent,e),e.west!==1/0)return(0,ut.A)(Ki.Ts,e)}get info(){var e;const t=1===this._item.layersArray.length?this._item.layersArray[0]:void 0;return(0,o.A)([t?(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogItem.dataDescription"),content:t.description}):void 0,(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogItem.serviceDescription"),content:this.mapServer.description}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogItem.copyrightText"),content:null!==(e=null==t?void 0:t.copyrightText)&&void 0!==e?e:this.mapServer.copyrightText})])}get legends(){var e;const t=this._item.layersArray,r=/^No[\s_-]?Data$/i,i=/_Labels$/;let o=[];return((null===(e=this._legends)||void 0===e?void 0:e.layers)||[]).forEach(e=>{var n;r.test(e.layerName)||i.test(e.layerName)||t.length>0&&!t.find(t=>t.id===e.layerId)&&!t.find(t=>t.name===e.layerName)||null===(n=e.legend)||void 0===n||n.forEach(t=>{const r=ti(""!==t.label?t.label:e.layerName),i="data:"+t.contentType+";base64,"+t.imageData;o.push((0,ut.A)(Um.G,{title:r,imageUrl:i,imageWidth:t.width,imageHeight:t.height}))})}),o=iw(o,(e,t)=>e.imageUrl===t.imageUrl),[(0,ut.A)(Um.A,{items:o})]}get usePreCachedTilesIfAvailable(){return!!this.mapServer.tileInfo&&!this._item.parameters&&(0===this._item.layersArray.length||!this._item.layers||function(e,t){if(Array.isArray(e)&&(e=new Set(e)),Array.isArray(t)&&(t=new Set(t)),e===t)return!0;if(e.size!==t.size)return!1;const r=new Set([...e,...t]);return r.size===e.size&&r.size===t.size}(this._item.layersArray.map(e=>e.id),this.allLayers.map(e=>e.id)))}},Ww(Lw,"stratumName","mapServer"),qw((Fw=Lw).prototype,"maximumScale",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"maximumScale"),Fw.prototype),qw(Fw.prototype,"layers",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"layers"),Fw.prototype),qw(Fw.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"name"),Fw.prototype),qw(Fw.prototype,"dataCustodian",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"dataCustodian"),Fw.prototype),qw(Fw.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"rectangle"),Fw.prototype),qw(Fw.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"info"),Fw.prototype),qw(Fw.prototype,"legends",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"legends"),Fw.prototype),qw(Fw.prototype,"usePreCachedTilesIfAvailable",[i.EW],Object.getOwnPropertyDescriptor(Fw.prototype,"usePreCachedTilesIfAvailable"),Fw.prototype),Fw);dt.A.addLoadStratum(Bw.stratumName);let Vw=(Uw=class e extends((0,Ee.A)((0,jw.A)((0,Ov.A)((0,s.A)((0,$i.Ay)((0,g.A)(Rw))))))){constructor(){super(...arguments),Ww(this,"_createImageryProvider",(0,Cw.A)(e=>{const t=this.strata.get(Bw.stratumName);if(!(0,n.A)(this.url)||!(0,n.A)(t))return(0,ob.Sx)(Promise.resolve(void 0));const r=Object.assign({},this.parameters),i=null==e?void 0:e.currentTime;if(void 0!==i){const t=this.windowDurationInMs(null==e?void 0:e.timeWindowDuration,null==e?void 0:e.timeWindowUnit);r.time=void 0!==t?this.getTimeWindowQueryString(i,t,null==e?void 0:e.isForwardTimeWindow):i}const o=(0,Ew.w)(this.maximumScale,!0,!1),a=Iw.A.fromUrl((s=Hw(this).toString(),(0,ie.A)(this,function(e){const t=new(Ie())(e);return t.search(""),t.toString()}(s))),{layers:this.layersArray.map(e=>e.id).join(","),tilingScheme:new Mn.A,maximumLevel:o,tileHeight:this.tileHeight,tileWidth:this.tileWidth,parameters:r,enablePickFeatures:this.allowFeaturePicking,usePreCachedTilesIfAvailable:this.usePreCachedTilesIfAvailable,mapServerData:t.mapServer,token:t.token,credit:this.attribution});var s;return(0,ob.Sx)(this.updateRequestImageAsync(a,!1))})),(0,i.Gn)(this)}get typeName(){return Pe.Ay.t("models.arcGisMapServerCatalogItem.name")}get type(){return e.type}async forceLoadMetadata(){const e=await Bw.load(this);(0,i.h5)(()=>{this.strata.set(Bw.stratumName,e)})}forceLoadMapItems(){return Promise.all([this._currentImageryPromise,this._nextImageryPromise]).then(()=>{})}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}get discreteTimes(){const e=this.strata.get(Bw.stratumName);if(void 0===(null==e?void 0:e.mapServer.timeInfo))return;const t=[];return(0,Dw.A)(t,new Date(e.mapServer.timeInfo.timeExtent[0]).toISOString(),new Date(e.mapServer.timeInfo.timeExtent[1]).toISOString(),void 0,this.maxRefreshIntervals),t}getCurrentTime(){return void 0===this.currentDiscreteTimeTag?void 0:new Date(this.currentDiscreteTimeTag).getTime()}get timeParams(){return{currentTime:this.getCurrentTime(),timeWindowDuration:this.timeWindowDuration,timeWindowUnit:this.timeWindowUnit,isForwardTimeWindow:this.isForwardTimeWindow}}get _currentImageryPromise(){const e=this.timeParams;return this._createImageryProvider(e)}get _currentImageryParts(){const e=this._currentImageryPromise;return e.value instanceof Iw.A?{imageryProvider:e.value,alpha:this.opacity,show:this.show,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}:void 0}get _nextImageryPromise(){if(this.terria.timelineStack.contains(this)&&!this.isPaused&&this.nextDiscreteTimeTag){const e=this.timeParams;return this._createImageryProvider(e)}}get _nextImageryParts(){const e=this._nextImageryPromise;if((0,n.A)(e))return e.case({fulfilled:e=>{e instanceof Iw.A&&(e.enablePickFeatures=!1)}}),e.value instanceof Iw.A?{imageryProvider:e.value,alpha:0,show:!0,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}:void 0}windowDurationInMs(e,t){if(void 0===e||0===e||void 0===t)return;const r={};r[t]=e;const i=Tw().duration(r).asMilliseconds();return 0===i?void 0:i}getTimeWindowQueryString(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?Number(e)-t+","+e:e+","+(Number(e)+t)}get mapItems(){const e=[],t=this._currentImageryParts;t&&e.push(t);const r=this._nextImageryParts;return r&&e.push(r),e}get layersArray(){const e=this.strata.get(Bw.stratumName);return e?(0,o.A)((t=e.allLayers,r=this.layers,(0,n.A)(r)?r.split(",").map(function(e){return function(e,t){const r=t.toLowerCase();let i;for(let o=0;o<e.length;++o){const a=e[o];if(a.id.toString()===t)return a;(0,n.A)(a.name)&&a.name.toLowerCase()===r&&(i=a)}return i}(t,e)}):t)):[];var t,r}},Ww(Uw,"type","esri-mapServer"),qw((Gw=Uw).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(Gw.prototype,"cacheDuration"),Gw.prototype),qw(Gw.prototype,"discreteTimes",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"discreteTimes"),Gw.prototype),qw(Gw.prototype,"timeParams",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"timeParams"),Gw.prototype),qw(Gw.prototype,"_currentImageryPromise",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"_currentImageryPromise"),Gw.prototype),qw(Gw.prototype,"_nextImageryPromise",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"_nextImageryPromise"),Gw.prototype),qw(Gw.prototype,"_nextImageryParts",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"_nextImageryParts"),Gw.prototype),qw(Gw.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"mapItems"),Gw.prototype),qw(Gw.prototype,"layersArray",[i.EW],Object.getOwnPropertyDescriptor(Gw.prototype,"layersArray"),Gw.prototype),Gw);function Hw(e){const t=new(Ie())(e.url),r=t.segment(-1);return r&&r.match(/\d+/)&&t.segment(-1,""),t}async function $w(e,t){try{return await(0,H.A)((0,ie.A)(e,t.addQuery("f","json").toString()))}catch(e){return void console.log(e)}}function Jw(e,t){e.xmin<t.west&&(t.west=e.xmin),e.ymin<t.south&&(t.south=e.ymin),e.xmax>t.east&&(t.east=e.xmax),e.ymax>t.north&&(t.north=e.ymax)}function Xw(e,t){var r,i,o;const a=null!==(r=null==e||null===(i=e.spatialReference)||void 0===i?void 0:i.latestWkid)&&void 0!==r?r:null==e||null===(o=e.spatialReference)||void 0===o?void 0:o.wkid;if((0,n.A)(e)&&(0,n.A)(a)){if(4326===a)return Jw(e,t);const r="EPSG:"+a;if(!(0,n.A)(jv.A[r]))return void console.warn("No Proj4 definition for "+r);const i=jv.A[r],o="EPSG:4326";let s=(0,kf.default)(i,o,[e.xmin,e.ymin]);const l=s[0],c=s[1];return s=(0,kf.default)(i,o,[e.xmax,e.ymax]),Jw({xmin:l,ymin:c,xmax:s[0],ymax:s[1]},t)}}var Kw,Zw,Qw,Yw;function eA(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tA(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const rA="all-layers";let iA=(Zw=class e extends((0,pt.Ay)(tw)){constructor(e,t){super(),this._catalogGroup=e,this._mapServer=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._mapServer)}findParentLayers(e){const t=[],r=this.layers.find(t=>t.id===e);return void 0!==r&&(t.push(r.id),-1!==r.parentLayerId&&t.push(...this.findParentLayers(r.parentLayerId))),t}get name(){if(this._mapServer.documentInfo&&this._mapServer.documentInfo.Title&&this._mapServer.documentInfo.Title.length>0)return ti(this._mapServer.documentInfo.Title)}get info(){return[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogGroup.serviceDescription"),content:this._mapServer.serviceDescription}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogGroup.dataDescription"),content:this._mapServer.description}),(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcGisMapServerCatalogGroup.copyrightText"),content:this._mapServer.copyrightText})]}get dataCustodian(){if(this._mapServer.documentInfo&&this._mapServer.documentInfo.Author&&this._mapServer.documentInfo.Author.length>0)return this._mapServer.documentInfo.Author}static async load(t){const r=new(Ie())(t.url).addQuery("f","json"),i=await(0,H.A)((0,ie.A)(t,r.toString()));if(!i||!i.layers&&!i.subLayers)throw(0,At.mG)({title:Pe.Ay.t("models.arcGisMapServerCatalogGroup.invalidServiceTitle"),message:Pe.Ay.t("models.arcGisMapServerCatalogGroup.invalidServiceMessage")});return new e(t,i)}get tilesOnly(){var e;return this._mapServer.singleFusedMapCache&&(null===(e=this._mapServer.capabilities)||void 0===e?void 0:e.includes("TilesOnly"))}get members(){return this.tilesOnly?["".concat(this._catalogGroup.uniqueId,"/").concat(rA)]:(0,o.A)(this.layers.map(e=>{if((0,n.A)(e.id)&&-1===e.parentLayerId)return this._catalogGroup.uniqueId+"/"+e.id}).concat(this.subLayers.map(e=>{if((0,n.A)(e.id))return this._catalogGroup.uniqueId+"/"+e.id})))}get layers(){return this._mapServer.layers||[]}get subLayers(){return this._mapServer.subLayers||[]}createMembersFromLayers(){this.tilesOnly?this.createMemberForSingleFusedMapCache():this.layers.forEach(e=>this.createMemberFromLayer(e))}createMemberForSingleFusedMapCache(){const e="".concat(this._catalogGroup.uniqueId,"/").concat(rA);let t=this._catalogGroup.terria.getModelById(Vw,e);void 0===t&&(t=new Vw(e,this._catalogGroup.terria),this._catalogGroup.terria.addModel(t)),t.strata.delete(C.A.definition),t.setTrait(C.A.definition,"name",Pe.Ay.t("models.arcGisMapServerCatalogGroup.singleFusedMapCacheLayerName").toString()),t.setTrait(C.A.definition,"url",this._catalogGroup.url)}createMemberFromLayer(e){if(!(0,n.A)(e.id))return;const t=this._catalogGroup.uniqueId;let r=t+"/"+e.id;const i=this.findParentLayers(e.id);let o;if(i.length>0&&(r=t+"/"+i.reverse().join("/")),"Group Layer"===e.type||Array.isArray(e.subLayerIds)&&e.subLayerIds.length>0){const e=this._catalogGroup.terria.getModelById(oA,r);void 0===e?(o=new oA(r,this._catalogGroup.terria),this._catalogGroup.terria.addModel(o)):o=e}else{const e=this._catalogGroup.terria.getModelById(Vw,r);void 0===e?(o=new Vw(r,this._catalogGroup.terria),this._catalogGroup.terria.addModel(o)):o=e}o.strata.delete(C.A.definition),o.setTrait(C.A.definition,"name",ti(e.name));const a=new(Ie())(this._catalogGroup.url).segment(e.id.toString());o.setTrait(C.A.definition,"url",a.toString())}},eA(Zw,"stratumName","mapServer"),tA((Kw=Zw).prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(Kw.prototype,"name"),Kw.prototype),tA(Kw.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(Kw.prototype,"info"),Kw.prototype),tA(Kw.prototype,"dataCustodian",[i.EW],Object.getOwnPropertyDescriptor(Kw.prototype,"dataCustodian"),Kw.prototype),tA(Kw.prototype,"tilesOnly",[i.EW],Object.getOwnPropertyDescriptor(Kw.prototype,"tilesOnly"),Kw.prototype),tA(Kw.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(Kw.prototype,"members"),Kw.prototype),tA(Kw.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(Kw.prototype,"createMembersFromLayers"),Kw.prototype),tA(Kw.prototype,"createMemberForSingleFusedMapCache",[i.XI],Object.getOwnPropertyDescriptor(Kw.prototype,"createMemberForSingleFusedMapCache"),Kw.prototype),tA(Kw.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(Kw.prototype,"createMemberFromLayer"),Kw.prototype),Kw);dt.A.addLoadStratum(iA.stratumName);let oA=(Yw=class e extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(tw))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.arcGisMapServerCatalogGroup.name")}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}async forceLoadMetadata(){const e=await iA.load(this);(0,i.h5)(()=>{this.strata.set(iA.stratumName,e)})}async forceLoadMembers(){const e=this.strata.get(iA.stratumName);e&&await(0,De.A)(()=>e.createMembersFromLayers())}},eA(Yw,"type","esri-mapServer-group"),tA((Qw=Yw).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(Qw.prototype,"cacheDuration"),Qw.prototype),Qw);var nA,aA,sA,lA;function cA(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uA(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const pA=["MapServer","FeatureServer"];let dA=(aA=class e extends((0,pt.Ay)(Lb)){constructor(e,t){super(),this._catalogGroup=e,this._arcgisServer=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._arcgisServer)}get arcgisServerData(){return this._arcgisServer}static async load(t){const r=new(Ie())(t.url).addQuery("f","json");return(0,H.A)((0,ie.A)(t,r.toString())).then(r=>{if(!r||!r.folders&&!r.services)throw(0,At.mG)({title:Pe.Ay.t("models.arcGisService.invalidServiceTitle"),message:Pe.Ay.t("models.arcGisService.invalidServiceMessage")});return new e(t,r)}).catch(()=>{throw(0,At.mG)({sender:t,title:Pe.Ay.t("models.arcGisService.groupNotAvailableTitle"),message:Pe.Ay.t("models.arcGisService.groupNotAvailableMessage")})})}get members(){return(0,o.A)(this.folders.map(e=>this._catalogGroup.uniqueId+"/"+mA(fA(this._catalogGroup),e)).concat(this.services.filter(e=>-1!==pA.indexOf(e.type)).map(e=>this._catalogGroup.uniqueId+"/"+mA(fA(this._catalogGroup),e.name)+"/"+e.type)))}get folders(){return this._arcgisServer.folders?this._arcgisServer.folders:[]}get services(){return this._arcgisServer.services?this._arcgisServer.services:[]}createMembersFromFolders(){this.folders.forEach(e=>this.createMemberFromFolder(e))}createMemberFromFolder(e){const t=mA(fA(this._catalogGroup),e),r=this._catalogGroup.uniqueId+"/"+t,i=this._catalogGroup.terria.getModelById(hA,r);let o;void 0===i?(o=new hA(r,this._catalogGroup.terria),this._catalogGroup.terria.addModel(o)):o=i,o.strata.delete(C.A.definition),o.setTrait(C.A.definition,"name",ti(e));const n=new(Ie())(this._catalogGroup.url).segment(e);o.setTrait(C.A.definition,"url",n.toString())}createMembersFromServices(){this.services.forEach(e=>this.createMemberFromService(e))}createMemberFromService(e){const t=mA(fA(this._catalogGroup),e.name),r=pA.indexOf(e.type);if(r<0)return;const i=this._catalogGroup.uniqueId+"/"+t+"/"+e.type;let o;if(0===r){const e=this._catalogGroup.terria.getModelById(oA,i);void 0===e?(o=new oA(i,this._catalogGroup.terria),this._catalogGroup.terria.addModel(o)):o=e}else{const e=this._catalogGroup.terria.getModelById(Yv,i);void 0===e?(o=new Yv(i,this._catalogGroup.terria),this._catalogGroup.terria.addModel(o)):o=e}o.strata.delete(C.A.definition),o.setTrait(C.A.definition,"name",ti(t));const n=new(Ie())(this._catalogGroup.url).segment(t).segment(e.type);o.setTrait(C.A.definition,"url",n.toString())}},cA(aA,"stratumName","arcgisServer"),uA((nA=aA).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(nA.prototype,"members"),nA.prototype),uA(nA.prototype,"folders",[i.EW],Object.getOwnPropertyDescriptor(nA.prototype,"folders"),nA.prototype),uA(nA.prototype,"services",[i.EW],Object.getOwnPropertyDescriptor(nA.prototype,"services"),nA.prototype),uA(nA.prototype,"createMembersFromFolders",[i.XI],Object.getOwnPropertyDescriptor(nA.prototype,"createMembersFromFolders"),nA.prototype),uA(nA.prototype,"createMemberFromFolder",[i.XI],Object.getOwnPropertyDescriptor(nA.prototype,"createMemberFromFolder"),nA.prototype),uA(nA.prototype,"createMembersFromServices",[i.XI],Object.getOwnPropertyDescriptor(nA.prototype,"createMembersFromServices"),nA.prototype),uA(nA.prototype,"createMemberFromService",[i.XI],Object.getOwnPropertyDescriptor(nA.prototype,"createMemberFromService"),nA.prototype),nA);dt.A.addLoadStratum(dA.stratumName);let hA=(lA=class e extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Lb))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.arcGisService.name")}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}forceLoadMetadata(){const e=this.url||"";return/\/MapServer(\/?.*)?$/i.test(e)?iA.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(iA.stratumName,e)})}):/\/FeatureServer(\/.*)?$/i.test(e)?Qv.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(Qv.stratumName,e)})}):dA.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(dA.stratumName,e)})})}async forceLoadMembers(){const e=this.strata.get(dA.stratumName)||this.strata.get(iA.stratumName)||this.strata.get(Qv.stratumName);await(0,De.A)(()=>{e instanceof dA?(e.createMembersFromFolders(),e.createMembersFromServices()):(e instanceof iA||e instanceof Qv)&&e.createMembersFromLayers()})}},cA(lA,"type","esri-group"),uA((sA=lA).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(sA.prototype,"cacheDuration"),sA.prototype),sA);function mA(e,t){return(e||0!==e.length)&&0===t.indexOf(e)?t.substring(e.length+1):t}function fA(e){const t=/rest\/services\/(.*)/i.exec(e.url||"");return t&&t.length>1?t[1]:""}var gA,yA,bA,vA,wA,AA,SA,xA,OA,PA,TA,IA,DA,CA,EA,_A,jA,zA,NA,kA,RA,MA,FA,LA,GA,UA,WA,qA,BA,VA,HA,$A,JA,XA,KA,ZA,QA,YA,eS,tS,rS,iS=r(1251),oS=r(53721),nS=r(46753),aS=r(90293),sS=r(4901);function lS(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class cS{constructor(e){var t,r,o,n,a,s,l,c;lS(this,"tilingScheme",void 0),lS(this,"ellipsoid",void 0),lS(this,"tileWidth",void 0),lS(this,"tileHeight",void 0),lS(this,"minimumLevel",void 0),lS(this,"maximumLevel",void 0),lS(this,"rectangle",void 0),lS(this,"errorEvent",new bs.A),lS(this,"ready",!0),lS(this,"credit",void 0),lS(this,"enablePickFeatures",void 0),lS(this,"usePreCachedTiles",void 0),lS(this,"tileDiscardPolicy",void 0),lS(this,"baseResource",void 0),lS(this,"defaultNightAlpha",void 0),lS(this,"defaultDayAlpha",void 0),lS(this,"hasAlphaChannel",!0),lS(this,"defaultAlpha",void 0),lS(this,"defaultBrightness",void 0),lS(this,"defaultContrast",void 0),lS(this,"defaultGamma",void 0),lS(this,"defaultHue",void 0),lS(this,"defaultSaturation",void 0),lS(this,"defaultMagnificationFilter",void 0),lS(this,"defaultMinificationFilter",void 0),lS(this,"readyPromise",Promise.resolve(!0)),(0,i.Gn)(this),this.tilingScheme=null!==(t=e.tilingScheme)&&void 0!==t?t:new kn.A,this.rectangle=null!==(r=e.rectangle)&&void 0!==r?r:this.tilingScheme.rectangle,this.ellipsoid=ys.A.WGS84,this.tileWidth=null!==(o=e.tileWidth)&&void 0!==o?o:256,this.tileHeight=null!==(n=e.tileHeight)&&void 0!==n?n:256,this.minimumLevel=null!==(a=e.minimumLevel)&&void 0!==a?a:0,this.maximumLevel=null!==(s=e.maximumLevel)&&void 0!==s?s:25,this.ready=!0,this.credit="string"==typeof e.credit?new fs.A(e.credit):e.credit,this.enablePickFeatures=null===(l=e.enablePickFeatures)||void 0===l||l,this.usePreCachedTiles=null!==(c=e.usePreCachedTiles)&&void 0!==c&&c,this.baseResource=new Vi.A(e.url),this.baseResource.appendForwardSlash(),e.parameters&&this.baseResource.appendQueryParameters(e.parameters),e.token&&this.baseResource.appendQueryParameters({token:e.token}),this.tileDiscardPolicy=new nS.A({missingImageUrl:this.buildImageResource(0,0,this.maximumLevel).url,pixelsToCheck:[new Vo.A(0,0),new Vo.A(200,20),new Vo.A(20,200),new Vo.A(80,110),new Vo.A(160,130)],disableCheckIfAllPixelsAreTransparent:!0})}get proxy(){return this.baseResource.proxy}buildImageResource(e,t,r,i){if(this.usePreCachedTiles)return this.baseResource.getDerivedResource({url:"tile/".concat(r,"/").concat(t,"/").concat(e),request:i});{const o=this.tilingScheme.tileXYToNativeRectangle(e,t,r),n={bbox:"".concat(o.west,",").concat(o.south,",").concat(o.east,",").concat(o.north),size:"".concat(this.tileWidth,",").concat(this.tileHeight),format:"png32",transparent:!0,f:"image"};return this.tilingScheme.projection instanceof oS.A?(n.bboxSR=4326,n.imageSR=4326):(n.bboxSR=3857,n.imageSR=3857),this.baseResource.getDerivedResource({url:"exportImage",queryParameters:n,request:i})}}getTileCredits(){return[]}requestImage(e,t,r,i){return sS.A.loadImage(this,this.buildImageResource(e,t,r,i))}async pickFeatures(e,t,r,i,o){if(!this.enablePickFeatures)return[];let n,a,s;if(this.tilingScheme.projection instanceof oS.A)n=Rn.A.toDegrees(i),a=Rn.A.toDegrees(o),s="4326";else{const e=this.tilingScheme.projection.project(new Ho.A(i,o,0));n=e.x,a=e.y,s="3857"}const l={f:"json",geometryType:"esriGeometryPoint",geometry:"{x: ".concat(n,", y: ").concat(a,", spatialReference: {wkid: ").concat(s,"}}"),returnCatalogItems:!1},c=this.baseResource.getDerivedResource({url:"identify",queryParameters:l}),u=await c.fetchJson(),p=[];if(u.value){const e=new aS.A;e.data=u,e.name=u.name,e.properties=u.properties,e.description=u.value,p.push(e)}return p}}function uS(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function pS(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let dS=(gA=(0,K.A)({type:"string",name:"Name",description:"The name of the raster function."}),yA=(0,K.A)({type:"string",name:"Description",description:'optional for well known functions, default is "Raster" for raster function templates.'}),bA=(0,hr.A)({name:"Arguments",description:"Overwrite the raster function default configuration by specifying argument parameters (argument names and value types are defined by the author of each raster function template and are not discoverable through ArcGis REST API)."}),vA=class extends ze.A{constructor(){super(...arguments),uS(this,"rasterFunction",wA,this),uS(this,"variableName",AA,this),uS(this,"rasterFunctionArguments",SA,this)}},wA=pS(vA.prototype,"rasterFunction",[gA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AA=pS(vA.prototype,"variableName",[yA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SA=pS(vA.prototype,"rasterFunctionArguments",[bA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vA),hS=(xA=(0,K.A)({type:"string",name:"Name",description:"The name of the raster function."}),OA=(0,K.A)({type:"string",name:"Description",description:"The description of the raster function."}),PA=(0,K.A)({type:"string",name:"Unit",description:"Help text for the raster function"}),TA=class extends ze.A{constructor(){super(...arguments),uS(this,"name",IA,this),uS(this,"description",DA,this),uS(this,"help",CA,this)}},IA=pS(TA.prototype,"name",[xA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DA=pS(TA.prototype,"description",[OA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CA=pS(TA.prototype,"help",[PA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TA),mS=(EA=(0,Re.b)({example:{url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/CharlotteLAS/ImageServer",type:"esri-imageServer",name:"CharlotteLAS"}}),_A=(0,K.A)({type:"number",name:"Maximum scale",description:"Gets or sets the denominator of the largest scale (smallest denominator) for which tiles should be requested.  For example, if this value is 1000, then tiles representing a scale larger than 1:1000 (i.e. numerically smaller denominator, when zooming in closer) will not be requested.  Instead, tiles of the largest-available scale, as specified by this property, will be used and will simply get blurier as the user zooms in closer. Note: maximumLevel overrides this property."}),jA=(0,hr.A)({name:"Parameters",description:"Additional parameters to pass to the ImageServer when requesting images."}),zA=(0,K.A)({name:"Token URL",description:"URL to use for fetching request tokens",type:"string"}),NA=(0,K.A)({name:"Token",description:"Token to use for fetching request tokens (if not using tokenUrl)",type:"string"}),kA=(0,K.A)({type:"number",name:"Maximum Refresh Intervals",description:"The maximum number of discrete times that can be created by a single date range when layer in time-enabled."}),RA=(0,K.A)({type:"number",name:"WKID",description:"The well-known ID of the spatial reference of the image server. Only Web Mercator (102100 or 102113 or 3857) and WGS84 (4326) are supported."}),MA=(0,K.A)({name:"Use Pre-Cached Tiles",description:"If true, the server's pre-cached tiles are used. If false, then the ImageServer exportImage endpoint will be used. This will default to false if parameters (including time) have been specified, otherwise it will default to true if a server supports pre-cached tiles.",type:"boolean"}),FA=(0,mr.A)({name:"Band IDs",description:"The band IDs to use when requesting images.",type:"number"}),LA=(0,Pt.A)({name:"Rendering Rule",description:'The rendering rule to apply to the image service. This must be a JSON object - for example `{"rasterFunction": "RFTAspectColor"}`. Note `allowRasterFunction` must be true for this to be applied.',type:dS}),GA=(0,K.A)({name:"Allow Raster Function",description:"If true, then the renderingRule will be applied to the image service. If false, the renderingRule will be ignored. This will default to true if an image service supports raster functions.",type:"boolean"}),UA=(0,Ne.Ay)({type:hS,name:"Available raster functions",description:"The available raster functions for the ImageServer. Defaults to all raster functions in the service if the server supports raster functions. Note: `allowRasterFunction` must be true. To set the default raster function, use the `renderingRule` property.",idProperty:"name"}),WA=(0,K.A)({name:"Disable raster functions selectors",description:"When true, disables the dimension selectors in the workbench. This will default to true if the server does not support raster functions.",type:"boolean"}),EA((BA=class extends((0,u.A)(Ji.A,Xi.A,d.A,_e.Ay,ke.A,zw.A,Tv.c)){constructor(){super(...arguments),uS(this,"maximumScale",VA,this),uS(this,"parameters",HA,this),uS(this,"tokenUrl",$A,this),uS(this,"token",JA,this),uS(this,"maxRefreshIntervals",XA,this),uS(this,"wkid",KA,this),uS(this,"usePreCachedTiles",ZA,this),uS(this,"bandIds",QA,this),uS(this,"renderingRule",YA,this),uS(this,"allowRasterFunction",eS,this),uS(this,"availableRasterFunctions",tS,this),uS(this,"disableRasterFunctionSelectors",rS,this)}},VA=pS(BA.prototype,"maximumScale",[_A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HA=pS(BA.prototype,"parameters",[jA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$A=pS(BA.prototype,"tokenUrl",[zA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JA=pS(BA.prototype,"token",[NA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XA=pS(BA.prototype,"maxRefreshIntervals",[kA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e4}}),KA=pS(BA.prototype,"wkid",[RA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 102100}}),ZA=pS(BA.prototype,"usePreCachedTiles",[MA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QA=pS(BA.prototype,"bandIds",[FA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YA=pS(BA.prototype,"renderingRule",[LA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eS=pS(BA.prototype,"allowRasterFunction",[GA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tS=pS(BA.prototype,"availableRasterFunctions",[UA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rS=pS(BA.prototype,"disableRasterFunctionSelectors",[WA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qA=BA))||qA);var fS,gS,yS,bS,vS,wS;function AS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function SS(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xS(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let OS=(gS=class e extends((0,pt.Ay)(mS)){constructor(e,t,r){super(),this._item=e,this.imageServer=t,this._token=r,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.imageServer,this._token)}static async load(t){var r,i,o,a;if(!(0,n.A)(t.uri))throw new At.Ay({title:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidUrlTitle"),message:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidUrlMessage")});let s;(0,n.A)(t.tokenUrl)&&(0,n.A)(t.url)&&(s=await Mw(t.terria,t.tokenUrl,t.url));let l=IS(t);(0,n.A)(s)&&(l=l.addQuery("token",s));const c=await DS(t,l);if(!(0,n.A)(c))throw new At.Ay({title:Pe.Ay.t("models.arcGisService.invalidServerTitle"),message:Pe.Ay.t("models.arcGisService.invalidServerMessage")});if(null===(r=c.capabilities)||void 0===r||!r.includes("Image"))throw new At.Ay({title:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidServiceTitle"),message:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidServiceMessage")});const u=null!==(i=null===(o=c.fullExtent.spatialReference)||void 0===o?void 0:o.latestWkid)&&void 0!==i?i:null===(a=c.fullExtent.spatialReference)||void 0===a?void 0:a.wkid;return u&&t.terria.configParameters.proj4ServiceBaseUrl&&await _w.A.checkProjection(t.terria.configParameters.proj4ServiceBaseUrl,"EPSG:".concat(u)),new e(t,c,s)}get name(){return ti(this.imageServer.name)}get cacheDuration(){return"1d"}get rectangle(){const e={west:1/0,south:1/0,east:-1/0,north:-1/0};if(Xw(this.imageServer.fullExtent,e),e.west!==1/0&&e.south!==1/0&&e.east!==-1/0&&e.north!==-1/0)return e}get description(){return this.imageServer.description}get attribution(){return this.imageServer.copyrightText}get token(){return this._token}get usePreCachedTiles(){if(this._item.parameters||this._item.currentDiscreteJulianDate||this._item.renderingRule.rasterFunction)return!1;if((0,n.A)(this.imageServer.tileInfo)){var e,t,r;const i=null!==(e=null===(t=this.imageServer.tileInfo.spatialReference)||void 0===t?void 0:t.latestWkid)&&void 0!==e?e:null===(r=this.imageServer.tileInfo.spatialReference)||void 0===r?void 0:r.wkid;if(102100===i||102113===i||3857===i||4326===i)return!0}return!1}get wkid(){if(this._item.usePreCachedTiles){var e;const t=null===(e=this.imageServer.tileInfo)||void 0===e?void 0:e.spatialReference.wkid;if(102100===t||102113===t||3857===t||4326===t)return t}}get tileHeight(){var e;if(this._item.usePreCachedTiles)return null===(e=this.imageServer.tileInfo)||void 0===e?void 0:e.rows}get tileWidth(){var e;if(this._item.usePreCachedTiles)return null===(e=this.imageServer.tileInfo)||void 0===e?void 0:e.cols}get maximumScale(){return this.imageServer.maxScale}get maximumLevel(){var e;const t=(0,Ew.w)(this._item.maximumScale,!0,!1);return this._item.usePreCachedTiles&&null!==(e=this.imageServer.tileInfo)&&void 0!==e&&e.lods?Math.min(this.imageServer.tileInfo.lods[this.imageServer.tileInfo.lods.length-1].level,null!=t?t:1/0):t}get minimumLevel(){var e;if(this._item.usePreCachedTiles&&null!==(e=this.imageServer.tileInfo)&&void 0!==e&&e.lods)return this.imageServer.tileInfo.lods[0].level}get allowRasterFunction(){return this.imageServer.allowRasterFunction}get availableRasterFunctions(){var e;return this._item.allowRasterFunction?null===(e=this.imageServer)||void 0===e?void 0:e.rasterFunctionInfos.filter(e=>e.name&&"None"!==e.name).map(e=>(0,ut.A)(hS,{name:e.name,description:"A raster function template."!==e.description?e.description:void 0,help:e.help})):[]}get disableRasterFunctionSelectors(){return!this._item.allowRasterFunction}},SS(gS,"stratumName","arcgisImageserver"),xS((fS=gS).prototype,"usePreCachedTiles",[i.EW],Object.getOwnPropertyDescriptor(fS.prototype,"usePreCachedTiles"),fS.prototype),fS);dt.A.addLoadStratum(OS.stratumName);let PS=(bS=class e extends((0,pt.Ay)(mS)){constructor(e,t){super(),this._item=e,this._legends=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this._legends)}static async load(t){if(!(0,n.A)(t.uri))throw new At.Ay({title:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidUrlTitle"),message:Pe.Ay.t("models.arcGisImageServerCatalogItem.invalidUrlMessage")});let r=IS(t).segment("legend");r.addQuery(t.flattenedParameters),(0,n.A)(t.token)&&(r=r.addQuery("token",t.token));const i=await DS(t,r);return new e(t,i)}get legends(){var e;const t=/^No[\s_-]?Data$/i,r=/_Labels$/;let i=[];return((null===(e=this._legends)||void 0===e?void 0:e.layers)||[]).forEach(e=>{var o;t.test(e.layerName)||r.test(e.layerName)||null===(o=e.legend)||void 0===o||o.forEach(t=>{const r=ti(""!==t.label?t.label:e.layerName),o="data:"+t.contentType+";base64,"+t.imageData;i.push((0,ut.A)(Um.G,{title:r,imageUrl:o,imageWidth:t.width,imageHeight:t.height}))})}),i=iw(i,(e,t)=>e.imageUrl===t.imageUrl),[(0,ut.A)(Um.A,{items:i})]}},SS(bS,"stratumName","arcgisImageserverLegend"),xS((yS=bS).prototype,"legends",[i.EW],Object.getOwnPropertyDescriptor(yS.prototype,"legends"),yS.prototype),yS);dt.A.addLoadStratum(PS.stratumName);let TS=(wS=class e extends((0,Ee.A)((0,jw.A)((0,Ov.A)((0,s.A)((0,$i.Ay)((0,g.A)(mS))))))){constructor(){super(...arguments),SS(this,"_legendStratumLoader",new iS.A(this.forceLoadLegends.bind(this))),SS(this,"_createImageryProvider",(0,Cw.A)(e=>{var t;if(!(0,n.A)(this.url))return;const r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?AS(Object(r),!0).forEach(function(t){SS(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AS(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},this.flattenedParameters);let i;if(e&&(r.time=yt.A.toDate(e).getTime()),102100===this.wkid||102113===this.wkid||3857===this.wkid)i=new Mn.A;else{if(4326!==this.wkid)throw At.Ay.from("Tile spatial reference WKID ".concat(this.wkid," is not supported."));i=new kn.A}return new cS({url:(o=this.url,(0,ie.A)(this,CS(o))),tilingScheme:i,maximumLevel:this.maximumLevel,minimumLevel:this.minimumLevel,tileHeight:this.tileHeight,tileWidth:this.tileWidth,parameters:r,enablePickFeatures:this.allowFeaturePicking,usePreCachedTiles:this.usePreCachedTiles,token:this.token,credit:null!==(t=this.attribution)&&void 0!==t?t:""});var o})),(0,i.Gn)(this)}get typeName(){return Pe.Ay.t("models.arcGisImageServerCatalogItem.name")}get type(){return e.type}async forceLoadMetadata(){const e=await OS.load(this);(0,i.h5)(()=>{this.strata.set(OS.stratumName,e)}),await this._legendStratumLoader.load()}async forceLoadLegends(){const e=await PS.load(this);(0,i.h5)(()=>{this.strata.set(PS.stratumName,e)})}forceLoadMapItems(){return Promise.resolve()}get discreteTimes(){const e=this.strata.get(OS.stratumName);if(void 0===(null==e?void 0:e.imageServer.timeInfo))return;const t=[];return(0,Dw.A)(t,new Date(e.imageServer.timeInfo.timeExtent[0]).toISOString(),new Date(e.imageServer.timeInfo.timeExtent[1]).toISOString(),void 0,this.maxRefreshIntervals),t}get _currentImageryParts(){this._legendStratumLoader.load();const e=this._createImageryProvider(this.currentDiscreteJulianDate);if(e)return{imageryProvider:e,alpha:this.opacity,show:this.show,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}}get _nextImageryParts(){if(this.terria.timelineStack.contains(this)&&!this.isPaused&&this.nextDiscreteTimeTag){const e=this._createImageryProvider(this.nextDiscreteJulianDate);if(e)return e.enablePickFeatures=!1,{imageryProvider:e,alpha:0,show:!0,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}}}get flattenedParameters(){var e;const t=Object.entries(null!==(e=this.parameters)&&void 0!==e?e:{}).reduce((e,t)=>{let[r,i]=t;return(0,wt.OW)(i)?e[r]=JSON.stringify(i):e[r]=i,e},{});return this.renderingRule.rasterFunction&&(t.renderingRule=JSON.stringify(this.traits.renderingRule.toJson(this.renderingRule))),this.bandIds&&(t.bandIds=this.bandIds.join(",")),t}get mapItems(){return this.isLoadingMetadata?[]:[this._currentImageryParts,this._nextImageryParts].filter(n.A)}get selectableDimensions(){return(0,o.A)([...super.selectableDimensions,this.rasterFunctionSelectableDimensions])}get rasterFunctionSelectableDimensions(){var e;if(!this.disableRasterFunctionSelectors)return{id:"raster-functions",name:Pe.Ay.t("models.arcGisImageServerCatalogItem.rasterFunction"),options:this.availableRasterFunctions.map(e=>({id:e.name,name:e.name,description:e.description})),selectedId:null===(e=this.renderingRule)||void 0===e?void 0:e.rasterFunction,allowUndefined:!0,undefinedLabel:"Default",setDimensionValue:(e,t)=>{this.renderingRule?this.renderingRule.setTrait(e,"rasterFunction",t):this.setTrait(e,"renderingRule",(0,ut.A)(dS,{rasterFunction:t}))}}}},SS(wS,"type","esri-imageServer"),xS((vS=wS).prototype,"discreteTimes",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"discreteTimes"),vS.prototype),xS(vS.prototype,"_currentImageryParts",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"_currentImageryParts"),vS.prototype),xS(vS.prototype,"_nextImageryParts",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"_nextImageryParts"),vS.prototype),xS(vS.prototype,"flattenedParameters",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"flattenedParameters"),vS.prototype),xS(vS.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"mapItems"),vS.prototype),xS(vS.prototype,"selectableDimensions",[i.$Z],Object.getOwnPropertyDescriptor(vS.prototype,"selectableDimensions"),vS.prototype),xS(vS.prototype,"rasterFunctionSelectableDimensions",[i.EW],Object.getOwnPropertyDescriptor(vS.prototype,"rasterFunctionSelectableDimensions"),vS.prototype),vS);function IS(e){const t=new(Ie())(e.url),r=t.segment(-1);return r&&r.match(/\d+/)&&t.segment(-1,""),t}async function DS(e,t){try{return await(0,H.A)((0,ie.A)(e,t.addQuery("f","json").toString()))}catch(e){return void console.log(e)}}function CS(e){const t=new(Ie())(e);return t.search(""),t.toString()}var ES,_S,jS,zS,NS,kS,RS,MS,FS,LS=r(58124);function GS(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function US(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let WS=(ES=(0,K.A)({name:"ID",description:"The ID of this items format.",type:"string"}),_S=(0,hr.A)({name:"Url Regular Expression",description:"A regular expression that is matched against the items url."}),jS=(0,K.A)({name:"Format Regular Expression",description:"A regular expression that is matched against the item format.",type:"string"}),zS=(0,hr.A)({name:"Definition",description:"The catalog member definition to use when the URL and Format regular expressions match. The `URL` property will also be set."}),NS=class extends ze.A{constructor(){super(...arguments),GS(this,"id",kS,this),GS(this,"urlRegex",RS,this),GS(this,"formatRegex",MS,this),GS(this,"definition",FS,this)}},kS=US(NS.prototype,"id",[ES],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RS=US(NS.prototype,"urlRegex",[_S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MS=US(NS.prototype,"formatRegex",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FS=US(NS.prototype,"definition",[zS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NS);var qS,BS,VS;let HS=(qS=(0,Ne.Ay)({name:"Supported Formats",description:"The supported formats and their mapping to Terria types. These are listed in order of preference.",type:WS,idProperty:"id"}),BS=class extends((0,u.A)()){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"supportedFormats",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,VS,this)}},VS=function(e,t,r,i){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}(BS.prototype,"supportedFormats",[qS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BS);var $S,JS,XS,KS,ZS,QS,YS,ex,tx,rx,ix,ox,nx;function ax(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function sx(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let lx=($S=(0,Re.b)({description:"Creates a group with members from ArcGIS server portal.\n\n  <strong>Note:</strong> \n  <br>The following example will</br>\n  <li>Request datasets of specific types only.</li>\n  <li>Organise members in subgroups according to their categories.</li>\n  <li>Sort members according to their titles.</li>",example:{url:"https://portal.spatial.nsw.gov.au/portal",type:"arcgis-portal-group",groupBy:"portalCategories",name:"NSW Spatial Portal Categories",searchParams:{q:'(type:"Map Service" OR type:"WMS" OR type:"KML")',sortField:"title"},id:"some id"}}),JS=(0,hr.A)({name:"Search Parameters",description:"An object containing parameters matching the ArcGIS Rest API params, see https://developers.arcgis.com/rest/users-groups-and-items/search-reference.htm"}),XS=(0,hr.A)({name:"Group Search Parameters",description:'An object containing parameters to search by groups using the ArcGIS Rest API params, see https://developers.arcgis.com/rest/users-groups-and-items/group-search.htm\n    Note: this setting is only used when "groupBy" option is set to "organisationsGroups".\n    '}),KS=(0,K.A)({type:"string",name:"Group By",description:'Gets or sets a value indicating how datasets should be grouped.  Valid values are:\n     * none - All available datasets are put in a flat list; they are not grouped at all.\n     * organisationsGroups - Data is retrieved and sorted by the organisations groups.\n     * portalCategories - Data is retrieved and sorted by categories specified by the portal items.\n     * usersGroups - Data is retrieved and sorted by the groups particular to the user.\n     * Note: This requires a user to be signed into portal, with a "portalUsername" to be set in "terria.userProperties", this is not available by default and requires custom configuration of TerriaMap.\n    '}),ZS=(0,K.A)({type:"string",name:"Ungrouped title",description:"A title for the group holding all items that don't have a group in an ArcGIS Portal.\n      If the value is a blank string or undefined, these items will be left at the top level, not grouped."}),QS=(0,K.A)({type:"boolean",name:"Hide empty groups",description:"If a group has no items don't display it in the catalog"}),$S((ex=class extends((0,u.A)(je.A,d.A,_e.Ay,ke.A,HS)){constructor(){super(...arguments),ax(this,"searchParams",tx,this),ax(this,"groupSearchParams",rx,this),ax(this,"groupBy",ix,this),ax(this,"ungroupedTitle",ox,this),ax(this,"hideEmptyGroups",nx,this)}},tx=sx(ex.prototype,"searchParams",[JS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{q:'(type:"Scene Service" OR\n         type:"Feature Service" OR\n         type:"Map Service" OR\n         type:"WMS" OR\n         type:"WFS" OR\n         type:"KML")',sortField:"title"}}}),rx=sx(ex.prototype,"groupSearchParams",[XS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{q:"orgid:0123456789ABCDEF\n       (access:private OR access:org)\n       -owner:esri_nav\n       -owner:esri_livingatlas\n       -owner:esri_boundaries\n       -owner:esri_demographics\n      ",searchUserAccess:"groupMember"}}}),ix=sx(ex.prototype,"groupBy",[KS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"none"}}),ox=sx(ex.prototype,"ungroupedTitle",[ZS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Ungrouped"}}),nx=sx(ex.prototype,"hideEmptyGroups",[QS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),YS=ex))||YS);var cx,ux,px,dx,hx,mx=r(99418);let fx=(cx=(0,Re.b)({description:"Creates an item or group that references an item in ArcGIS portal.\n\n  <strong>Note:</strong> \n  <li>The <code>itemId</code> in the example is the referenced item's ID in the portal.</li>\n  <li>Not all referenced items can be added to the map. E.g., some types need conversions.</li>",example:{type:"arcgis-portal-item",itemId:"084c61c6dd404517bc2db69079ddec38",name:"NSW Administrative Theme",url:"https://portal.spatial.nsw.gov.au/portal",id:"some id"}}),ux=(0,K.A)({name:"Item ID",description:"The ID of the portal item.",type:"string"}),cx((dx=class extends((0,u.A)(d.A,Ki.Ay,Kr.A,HS)){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"itemId",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,hx,this)}},hx=function(e,t,r,i){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}(dx.prototype,"itemId",[ux],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),px=dx))||px);var gx,yx,bx,vx;function wx(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ax(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Sx=(yx=class e extends((0,pt.Ay)(fx)){constructor(e,t){super(),this.arcgisPortalItemReference=e,this.arcgisPortalCatalogGroup=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(this.arcgisPortalItemReference,this.arcgisPortalCatalogGroup)}static async load(t,r){return void 0===t._arcgisItem?void 0!==t.uniqueId&&(t._portalRootUrl=t.url,t._arcgisItem=await async function(e){const t=new(Ie())(e._portalRootUrl).segment("/sharing/rest/content/items/".concat(e.itemId)).addQuery({f:"json"});return await(0,H.A)((0,ie.A)(e,t.toString(),e.cacheDuration))}(t),t.setSupportedFormatFromItem(t._arcgisItem)):void 0!==r&&(t._portalRootUrl=r.url),new e(t,r)}get arcgisPortalItem(){if(void 0!==this.arcgisPortalItemReference._arcgisItem)return this.arcgisPortalItemReference._arcgisItem}get portalItemUrl(){if(void 0!==this.arcgisPortalItem&&void 0!==this.arcgisPortalItemReference._portalRootUrl)return new(Ie())(this.arcgisPortalItemReference._portalRootUrl).segment("/home/item.html").addQuery("id",this.arcgisPortalItem.id).toString()}get url(){if(void 0!==this.arcgisPortalItem)return"Scene Service"===this.arcgisPortalItem.type?"/i3s-to-3dtiles/".concat(this.arcgisPortalItem.url):this.arcgisPortalItem.url}get name(){if(void 0!==this.arcgisPortalItem)return this.arcgisPortalItem.title}get description(){if(void 0!==this.arcgisPortalItem)return mx.A.sanitize(this.arcgisPortalItem.description,{FORBID_ATTR:["style"],FORBID_TAGS:["font"]})}get info(){const e=[];return void 0===this.arcgisPortalItem||(void 0!==this.arcgisPortalItem.licenseInfo&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcgisPortal.licence"),content:mx.A.sanitize(this.arcgisPortalItem.licenseInfo,{FORBID_ATTR:["style"],FORBID_TAGS:["font"]})})),e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.arcgisPortal.openInPortal"),content:'<a href="'.concat(this.portalItemUrl,'"><button>').concat(Pe.Ay.t("models.arcgisPortal.openInPortal"),"</button></a>")}))),e}},wx(yx,"stratumName","arcGisPortalDataset"),Ax((gx=yx).prototype,"arcgisPortalItem",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"arcgisPortalItem"),gx.prototype),Ax(gx.prototype,"portalItemUrl",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"portalItemUrl"),gx.prototype),Ax(gx.prototype,"url",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"url"),gx.prototype),Ax(gx.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"name"),gx.prototype),Ax(gx.prototype,"description",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"description"),gx.prototype),Ax(gx.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(gx.prototype,"info"),gx.prototype),gx);dt.A.addLoadStratum(Sx.stratumName);let xx=(vx=class e extends((0,LS.A)((0,Ee.A)((0,Xr.A)((0,g.A)(fx))))){get type(){return e.type}get typeName(){return Pe.Ay.t("models.arcgisPortal.name")}constructor(t,r,o,n){super(t,r,o,n),wx(this,"_arcgisItem",void 0),wx(this,"_arcgisPortalCatalogGroup",void 0),wx(this,"_supportedFormat",void 0),wx(this,"_portalRootUrl",void 0),(0,i.Gn)(this),this.setTrait(C.A.defaults,"supportedFormats",e.defaultSupportedFormats)}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:(0,n.A)(this._arcgisPortalCatalogGroup)?this._arcgisPortalCatalogGroup.cacheDuration:"0d"}get preparedSupportedFormats(){return this.supportedFormats&&this.supportedFormats.map(Ox)}isItemInSupportedFormats(e){if(void 0!==e)for(let t=0;t<this.preparedSupportedFormats.length;++t){const r=this.preparedSupportedFormats[t];if(void 0===r.formatRegex||void 0===r.urlRegex){if(r.formatRegex){if(r.formatRegex.test(e.type))return r}else if(r.urlRegex&&r.urlRegex.test(e.url))return r}else if(r.formatRegex.test(e.type)&&r.urlRegex.test(e.url))return r}}setDataset(e){this._arcgisItem=e}setArcgisPortalCatalog(e){this._arcgisPortalCatalogGroup=e}setSupportedFormatFromItem(e){this._supportedFormat=this.isItemInSupportedFormats(e)}async setArcgisStrata(e){const t=await Sx.load(this,this._arcgisPortalCatalogGroup);void 0!==t&&(0,i.h5)(()=>{e.strata.set(Sx.stratumName,t)})}async forceLoadReference(e){if(await this.setArcgisStrata(this),void 0===this._supportedFormat)return;const t=await async function(e){if(void 0===e._arcgisItem)return;const t=e._portalRootUrl,r=new(Ie())(t).segment("/sharing/rest/content/items/".concat(e._arcgisItem.id,"/data")).addQuery({f:"json"});try{return await(0,H.A)((0,ie.A)(e,r.toString(),e.cacheDuration))}catch(e){return}}(this);if(void 0!==t&&void 0!==this._arcgisItem&&(!t.error&&t.layers&&1===t.layers.length&&(this._arcgisItem.url="".concat(this._arcgisItem.url,"/").concat(t.layers[0].id)),this.setSupportedFormatFromItem(this._arcgisItem)),void 0!==this._arcgisItem&&"Map Service"===this._arcgisItem.type&&this._arcgisItem.typeKeywords.indexOf("Tiled")>-1){const e=this.preparedSupportedFormats.filter(e=>"esri-mapServer"===e.definition.type);1===e.length&&(this._supportedFormat=e[0])}const r=Qr.A.create(this._supportedFormat.definition.type,this.uniqueId,this.terria,this);if(void 0===r)return;await this.setArcgisStrata(r);const i=this.strata.get(C.A.definition);return i&&(r.strata.set(C.A.definition,i),r.setTrait(C.A.definition,"url",void 0)),r}},wx(vx,"defaultSupportedFormats",[(0,ut.A)(WS,{id:"I3S",formatRegex:"Scene Service",urlRegex:"SceneServer$|SceneServer/$",definition:{type:"3d-tiles"}}),(0,ut.A)(WS,{id:"WMS",formatRegex:"WMS",urlRegex:"WMSServer",definition:{type:"wms"}}),(0,ut.A)(WS,{id:"ArcGIS MapServer Group",formatRegex:"Map Service",urlRegex:"MapServer$|MapServer/$",definition:{type:"esri-mapServer-group"}}),(0,ut.A)(WS,{id:"ArcGIS MapServer",formatRegex:"Map Service",urlRegex:/MapServer\/\d/,definition:{type:"esri-mapServer"}}),(0,ut.A)(WS,{id:"ArcGIS FeatureServer Group",formatRegex:"Feature Service",urlRegex:"FeatureServer$|FeatureServer/$",definition:{type:"esri-featureServer-group"}}),(0,ut.A)(WS,{id:"ArcGIS FeatureServer",formatRegex:"Feature Service",urlRegex:/FeatureServer\/\d/,definition:{type:"esri-featureServer"}}),(0,ut.A)(WS,{id:"Kml",formatRegex:"KML",definition:{type:"kml"}})]),wx(vx,"type","arcgis-portal-item"),Ax((bx=vx).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(bx.prototype,"cacheDuration"),bx.prototype),Ax(bx.prototype,"preparedSupportedFormats",[i.EW],Object.getOwnPropertyDescriptor(bx.prototype,"preparedSupportedFormats"),bx.prototype),bx);const Ox=(0,ob.Aj)(e=>({urlRegex:e.urlRegex?new RegExp(e.urlRegex,"i"):void 0,formatRegex:e.formatRegex?new RegExp(e.formatRegex,"i"):void 0,definition:e.definition||{}}));var Px,Tx,Ix,Dx;function Cx(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ex(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let _x=(Tx=class e extends((0,pt.Ay)(lx)){constructor(e,t,r){super(),this._catalogGroup=e,this._arcgisResponse=t,this._arcgisGroupResponse=r,Cx(this,"groups",[]),Cx(this,"filteredGroups",[]),Cx(this,"datasets",[]),Cx(this,"filteredDatasets",[]),(0,i.Gn)(this),this.datasets=this.getDatasets(),this.filteredDatasets=this.getFilteredDatasets(),this.groups=this.getGroups(),this.filteredGroups=this.getFilteredGroups()}duplicateLoadableStratum(t){return new e(t,this._arcgisResponse,this._arcgisGroupResponse)}static async load(t){let r,i;if("organisationsGroups"===t.groupBy||"usersGroups"===t.groupBy){if("organisationsGroups"===t.groupBy){const e=new(Ie())(t.url).segment("/sharing/rest/community/groups").addQuery({num:100,f:"json"});if(void 0!==t.groupSearchParams){const r=t.groupSearchParams;Object.keys(r).forEach(t=>e.addQuery(t,r[t]))}if(r=await Rx(e,t),void 0===r)return}else if("usersGroups"===t.groupBy){const e=new(Ie())(t.url).segment("/sharing/rest/community/self").addQuery({f:"json"}),i=await Mx(e,t);if(void 0===i)return;r={total:i.groups.length,results:i.groups,start:0,num:0,nextStart:0}}if(void 0===r)return;for(let e=0;e<r.results.length;++e){const o=r.results[e],n=new(Ie())(t.url).segment("/sharing/rest/content/groups/".concat(o.id,"/search")).addQuery({num:100,f:"json"});if(t.searchParams){const e=t.searchParams;Object.keys(e).forEach(t=>n.addQuery(t,e[t]))}const a=await Rx(n,t);if(void 0===a)return;a.results.forEach(e=>{e.groupId=o.id}),0===e?i=a:void 0!==i&&void 0!==a&&(i.results=i.results.concat(a.results))}}else{const e=new(Ie())(t.url).segment("/sharing/rest/search").addQuery({num:100,f:"json"});if(void 0!==t.searchParams){const r=t.searchParams;Object.keys(r).forEach(t=>e.addQuery(t,r[t]))}if(i=await Rx(e,t),"portalCategories"===t.groupBy&&void 0!==i){const e=new Map;i.results.forEach(function(t){t.categories.forEach(function(r,i){const o=r.trim();if(0===i&&(t.groupId=o),!e.has(o)){const t=o.split("/"),r={id:o,title:t[t.length-1]};e.set(o,r)}})}),r={total:e.size,results:Array.from(e.values()),start:0,num:0,nextStart:0}}}if(void 0!==i)return new e(t,i,r)}get members(){if(this.filteredGroups.length>0){const e=[];return this.filteredGroups.forEach(t=>{this._catalogGroup.hideEmptyGroups&&t.members.length>0?e.push(t.uniqueId):this._catalogGroup.hideEmptyGroups||e.push(t.uniqueId)}),e}return this.filteredDatasets.map(e=>this._catalogGroup.uniqueId+"/"+e.id,this)}getDatasets(){return this._arcgisResponse.results}getFilteredDatasets(){if(0===this.datasets.length)return[];if(void 0!==this._catalogGroup.excludeMembers){const e=this._catalogGroup.excludeMembers;return this.datasets.filter(t=>-1===e.indexOf(t.title))}return this.datasets}getGroups(){if("none"===this._catalogGroup.groupBy)return[];const e=[...Nx(this),...kx(this)];return e.sort(function(e,t){return void 0===e.nameInCatalog||void 0===t.nameInCatalog?0:e.nameInCatalog<t.nameInCatalog?-1:e.nameInCatalog>t.nameInCatalog?1:0}),e}getFilteredGroups(){if(0===this.groups.length)return[];if(void 0!==this._catalogGroup.excludeMembers){const e=this._catalogGroup.excludeMembers;return this.groups.filter(t=>void 0!==t.name&&-1===e.indexOf(t.name))}return this.groups}createMembersFromDatasets(){this.filteredDatasets.forEach(e=>{this.createMemberFromDataset(e)})}addCatalogItemToCatalogGroup(e,t,r){const i=this._catalogGroup.terria.getModelById(xe.A,r);void 0!==i&&i.add(C.A.definition,e)}addCatalogItemByPortalGroupsToCatalogGroup(e,t){if(void 0===t.groupId){const r=this._catalogGroup.uniqueId+"/ungrouped";return void this.addCatalogItemToCatalogGroup(e,t,r)}const r=this._catalogGroup.uniqueId+"/"+t.groupId;this.addCatalogItemToCatalogGroup(e,t,r)}createMemberFromDataset(e){if(!(0,n.A)(e.id))return;const t=this._catalogGroup.uniqueId,r="".concat(t,"/").concat(e.id);let i=this._catalogGroup.terria.getModelById(xx,r);void 0===i&&(i=new xx(r,this._catalogGroup.terria),i.setDataset(e),i.setArcgisPortalCatalog(this._catalogGroup),i.setSupportedFormatFromItem(e),i.setArcgisStrata(i),i.terria.addModel(i)),"organisationsGroups"!==this._catalogGroup.groupBy&&"usersGroups"!==this._catalogGroup.groupBy&&"portalCategories"!==this._catalogGroup.groupBy||this.addCatalogItemByPortalGroupsToCatalogGroup(i,e),LS.A.isMixedInto(i)&&void 0!==e.access&&i.setAccessType(e.access)}},Cx(Tx,"stratumName","arcgisPortal"),Ex((Px=Tx).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(Px.prototype,"members"),Px.prototype),Ex(Px.prototype,"createMembersFromDatasets",[i.XI],Object.getOwnPropertyDescriptor(Px.prototype,"createMembersFromDatasets"),Px.prototype),Ex(Px.prototype,"addCatalogItemToCatalogGroup",[i.XI],Object.getOwnPropertyDescriptor(Px.prototype,"addCatalogItemToCatalogGroup"),Px.prototype),Ex(Px.prototype,"addCatalogItemByPortalGroupsToCatalogGroup",[i.XI],Object.getOwnPropertyDescriptor(Px.prototype,"addCatalogItemByPortalGroupsToCatalogGroup"),Px.prototype),Ex(Px.prototype,"createMemberFromDataset",[i.XI],Object.getOwnPropertyDescriptor(Px.prototype,"createMemberFromDataset"),Px.prototype),Px);dt.A.addLoadStratum(_x.stratumName);let jx=(Dx=class e extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(lx))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.arcgisPortal.nameGroup")}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"0d"}forceLoadMetadata(){return this.strata.get(_x.stratumName)?Promise.resolve():_x.load(this).then(e=>{void 0!==e&&(0,i.h5)(()=>{this.strata.set(_x.stratumName,e)})})}async forceLoadMembers(){const e=this.strata.get(_x.stratumName);e&&await(0,De.A)(()=>e.createMembersFromDatasets())}},Cx(Dx,"type","arcgis-portal-group"),Ex((Ix=Dx).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(Ix.prototype,"cacheDuration"),Ix.prototype),Ix);function zx(e,t,r){const i=new xe.A(e,t);return i.setTrait(C.A.definition,"name",r),t.addModel(i),i}function Nx(e){const t=e._catalogGroup.uniqueId+"/ungrouped";let r=e._catalogGroup.terria.getModelById(xe.A,t);return void 0===r&&(r=zx(t,e._catalogGroup.terria,e._catalogGroup.ungroupedTitle)),[r]}function kx(e){if(void 0===e._arcgisGroupResponse)return[];const t=[];return e._arcgisGroupResponse.results.forEach(r=>{const i=e._catalogGroup.uniqueId+"/"+r.id;let o=e._catalogGroup.terria.getModelById(xe.A,i);void 0===o&&(o=zx(i,e._catalogGroup.terria,r.title),r.description&&o.setTrait(C.A.definition,"description",r.description)),LS.A.isMixedInto(o)&&void 0!==r.access&&o.setAccessType(r.access),t.push(o)}),t}async function Rx(e,t){const r=await Mx(e,t);if(void 0===r||!r)throw(0,At.mG)({title:Pe.Ay.t("models.arcgisPortal.errorLoadingTitle"),message:Pe.Ay.t("models.arcgisPortal.errorLoadingMessage")});let i=r.nextStart;for(;-1!==i;)i=await Fx(e,t,r,i);return r}async function Mx(e,t){try{return await(0,H.A)((0,ie.A)(t,e.toString(),t.cacheDuration))}catch(e){return void console.log(e)}}async function Fx(e,t,r,i){e.setQuery("start",i);try{const i=await Mx(e,t);return void 0===i?-1:(r.results=r.results.concat(i.results),i.nextStart)}catch(e){return console.log(e),-1}}class Lx extends((0,u.A)(d.A,Ki.Ay,_e.Ay,ke.A)){}var Gx,Ux,Wx;function qx(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Bx=(Wx=class e extends((0,Ee.A)((0,$i.Ay)((0,s.A)((0,g.A)(Lx))))){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"_private_terrainProvider",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,Ux,this),(0,i.Gn)(this)}get type(){return e.type}get mapItems(){const e=this._private_terrainProvider;return e?(this.attribution&&(e._credit=new fs.A(this.attribution)),[e]):[]}forceLoadMapItems(){return void 0===this.url?Promise.resolve():zs.fromUrl(this.url).then(e=>{this._private_terrainProvider=e})}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Wx,"type","arcgis-terrain"),Ux=qx((Gx=Wx).prototype,"_private_terrainProvider",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),qx(Gx.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(Gx.prototype,"mapItems"),Gx.prototype),Gx);r(21489),r(75044),r(28845),r(373),r(3296),r(27208),r(48408);var Vx,Hx,$x,Jx,Xx,Kx,Zx,Qx=r(68515),Yx=r(38592),eO=r(52273),tO=r(6160);function rO(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function iO(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let oO=(Vx=(0,K.A)({type:"string",name:"Up axis",description:"The model's up-axis. By default models are y-up according to the glTF spec, however geo-referenced models will typically be z-up. Valid values are 'X', 'Y', or 'Z'."}),Hx=(0,K.A)({type:"string",name:"Forward axis",description:"The model's forward axis. By default, glTF 2.0 models are Z-forward according to the glTF spec, however older glTF (1.0, 0.8) models used X-forward. Valid values are 'X' or 'Z'."}),$x=(0,K.A)({type:"string",name:"Height reference",description:"Position relative to the ground. Accepted values are NONE, CLAMP_TO_GROUND & RELATIVE_TO_GROUND as described in the cesium doc - https://cesium.com/docs/cesiumjs-ref-doc/global.html#HeightReference"}),Jx=class extends((0,u.A)(Ki.Ay,tO.A,eO.A,_e.Ay,ke.A)){constructor(){super(...arguments),rO(this,"upAxis",Xx,this),rO(this,"forwardAxis",Kx,this),rO(this,"heightReference",Zx,this)}},Xx=iO(Jx.prototype,"upAxis",[Vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kx=iO(Jx.prototype,"forwardAxis",[Hx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zx=iO(Jx.prototype,"heightReference",[$x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"NONE"}}),Jx);var nO,aO=r(57653);let sO=(0,Re.b)({description:"Creates one catalog item from url that points to a gltf file.",example:{name:"gltf example",type:"gltf",url:"https://tiles.terria.io/terriajs-examples/czml/geelong_mini_demo_bin_linux_v1.0-draft_x64.gltf",origin:{longitude:144.3569,latitude:-38.14688,height:-16},heightReference:"CLAMP_TO_TERRAIN",id:"some unique id"}})(nO=class extends((0,u.A)(d.A,Tt.A,aO.A,oO,ln.A)){})||nO;var lO,cO,uO,pO,dO,hO,mO;function fO(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function gO(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let yO=(lO=(0,Re.b)({description:"Creates one catalog item from url that points to a 3d model.",example:{type:"assimp",name:"assimp example",urls:["https://raw.githubusercontent.com/kovacsv/assimpjs/main/examples/testfiles/cube_with_materials.obj","https://raw.githubusercontent.com/kovacsv/assimpjs/main/examples/testfiles/cube_with_materials.mtl"],baseUrl:"https://github.com/kovacsv/assimpjs/raw/main/examples/testfiles/",scale:100,origin:{latitude:-42.8826,longitude:147.3257,height:100},rectangle:{west:147.33,south:-42.9,east:147.33,north:-42.87},id:"some unique id"}}),cO=(0,mr.A)({type:"string",name:"URLs",description:"An array of URLs"}),uO=(0,K.A)({type:"string",name:"Base URL",description:"The base URL that paths in the 3D model (eg textures) are relative to"}),lO((dO=class extends((0,u.A)(sO)){constructor(){super(...arguments),fO(this,"urls",hO,this),fO(this,"baseUrl",mO,this)}},hO=gO(dO.prototype,"urls",[cO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mO=gO(dO.prototype,"baseUrl",[uO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pO=dO))||pO);var bO,vO,wO,AO;function SO(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function xO(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const OO=["apng","avif","gif","jpg","jpeg","jfif","pjpeg","pjp","png","svg","webp","ktx2"];let PO=(AO=class e extends((0,Yx.A)((0,g.A)(yO))){constructor(){super(...arguments),SO(this,"gltfModelUrl",vO,this),SO(this,"hasLocalData",wO,this),(0,i.Gn)(this)}get type(){return e.type}setFileInput(e){const t=URL.createObjectURL(e);this.setTrait(C.A.user,"urls",[t]),this.hasLocalData=!0}async forceLoadMapItems(){const e=this.urls.length>0?this.urls:(0,o.A)([this.url]);if(0===e.length)return;let t=this.baseUrl;if(!t&&1===e.length){const r=new(Ie())(e[0]);t=r.origin()+r.directory()+"/"}const n=new Map,a=[];let l;await Promise.all(e.map(async e=>{if((0,tg.K0)(e)||this.hasLocalData){const t=await(0,tg.Ay)((0,ie.A)(this,e));(await(0,tg.pN)(t)).forEach((e,t)=>{if(0===t&&e.isDirectory&&(l=e.fileName),e.isDirectory)return;a.push({name:e.fileName,arrayBuffer:e.data});const r=new Blob([e.data]),i=URL.createObjectURL(r);let o=e.fileName;l&&(o=e.fileName.startsWith(l)?e.fileName.slice(l.length):e.fileName),n.set(o,i)})}else{const t=await(0,Qx.A)((0,ie.A)(this,e)),r=new(Ie())(e),i=r.filename();a.push({name:i,arrayBuffer:new Uint8Array(t)}),n.set(i,r.absoluteTo(window.location.href).toString())}}));const c=(await Promise.all([r.e(892),r.e(945)]).then(r.t.bind(r,30892,23))).default,u=await c(),p=new u.FileList;for(let e=0;e<a.length;e++)p.AddFile(a[e].name,new Uint8Array(a[e].arrayBuffer));const d=u.ConvertFileList(p,"gltf2"),h=d.FileCount();if(!d.IsSuccess()||0===h)throw At.Ay.from(d.GetErrorCode(),{title:"Failed to convert files to GlTf"});let m;const f=[];for(let e=h-1;e>=0;e--){const r=d.GetFile(e),i=r.GetPath();let o=r.GetContent();if(0===e){var g,y;const e=new File([o],i),r=JSON.parse(await e.text());var b;null===(g=r.buffers)||void 0===g||g.forEach(e=>{if(!e.uri)return;const t=n.get(e.uri);console.log("replacing GlTf buffer path `".concat(e.uri,"` with `").concat(t,"`")),e.uri=t}),null===(y=r.images)||void 0===y||y.forEach(e=>{if(!e.uri)return;let r=e.uri.replace(/\\/g,"/");(r.startsWith("//")||r.startsWith("./"))&&(r=r.slice(2)),OO.some(e=>e===new(Ie())(r).suffix())||f.push(e.uri),n.has(r)?r=n.get(r):t&&(r=new(Ie())(r).absoluteTo(t).toString()),r!==e.uri&&(console.log("replacing GlTf image path `".concat(e.uri,"` with `").concat(r,"`")),e.uri=r)}),r.images&&r.images.length>0&&(null===(b=r.materials)||void 0===b||b.forEach(e=>{var t;null!==(t=e.extensions)&&void 0!==t&&t.KHR_materials_pbrSpecularGlossiness&&(e.extensions.KHR_materials_pbrSpecularGlossiness=void 0)})),o=(new TextEncoder).encode(JSON.stringify(r))}const a=new Blob([o]),s=URL.createObjectURL(a);n.set(i,s),0===e&&(m=s)}if((0,i.h5)(()=>{this.gltfModelUrl=m}),f.length>0)throw new At.Ay({severity:At.FK.Warning,title:"Unsupported texture formats",message:'Catalog item `"'.concat((0,s.m)(this),'"` has unsupported texture formats for the following:  \n').concat(f.map(e=>"- `".concat(e,"`\n")),"\n\nThe model may not display correctly.  \n\nList of supported formats: ").concat(OO.map(e=>"`".concat(e,"`")).join(", "))})}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(AO,"type","assimp"),vO=xO((bO=AO).prototype,"gltfModelUrl",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wO=xO(bO.prototype,"hasLocalData",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xO(bO.prototype,"setFileInput",[i.XI],Object.getOwnPropertyDescriptor(bO.prototype,"setFileInput"),bO.prototype),bO);var TO,IO,DO;function CO(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let EO=(DO=class e extends((0,Ee.A)((0,fh.A)((0,Yx.A)((0,g.A)(sO))))){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"hasLocalData",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,IO,this),(0,i.Gn)(this)}get type(){return e.type}get gltfModelUrl(){return this.ionResource?this.ionResource:this.url}forceLoadMetadata(){return this.loadIonResource()}setFileInput(e){const t=URL.createObjectURL(e);this.setTrait(C.A.user,"url",t),this.hasLocalData=!0}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(DO,"type","gltf"),CO((TO=DO).prototype,"gltfModelUrl",[i.EW],Object.getOwnPropertyDescriptor(TO.prototype,"gltfModelUrl"),TO.prototype),IO=CO(TO.prototype,"hasLocalData",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CO(TO.prototype,"setFileInput",[i.XI],Object.getOwnPropertyDescriptor(TO.prototype,"setFileInput"),TO.prototype),TO);var _O,jO,zO,NO,kO,RO,MO,FO,LO,GO,UO,WO,qO,BO,VO,HO,$O,JO,XO,KO=r(77500),ZO=r(15335),QO=r.n(ZO),YO=r(75305),eP=r(2362),tP=r(25061),rP=r(92562),iP=r(12594),oP=r(18605),nP=r(97279),aP=r(49003),sP=r(72075),lP=r(72209);function cP(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function uP(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let pP=(_O=(0,K.A)({name:"Color",description:"CSS color string",type:"string"}),jO=(0,K.A)({name:"Regular Expression",description:"Regular expression to match on the specified property",type:"string"}),zO=class extends ze.A{constructor(){super(...arguments),cP(this,"color",NO,this),cP(this,"regExp",kO,this)}},NO=uP(zO.prototype,"color",[_O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kO=uP(zO.prototype,"regExp",[jO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zO),dP=(RO=(0,K.A)({name:"Property",description:"Path to the property used to choose the color",type:"string"}),MO=(0,Ne.Ay)({type:pP,name:"Color Groups",description:"",idProperty:"index"}),FO=class extends ze.A{constructor(){super(...arguments),cP(this,"property",LO,this),cP(this,"colorGroups",GO,this)}},LO=uP(FO.prototype,"property",[RO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GO=uP(FO.prototype,"colorGroups",[MO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FO),hP=(UO=(0,K.A)({name:"Maximum draw distance",description:"The farthest distance from the camera that the model will still be drawn",type:"number"}),WO=(0,K.A)({name:"Maximum scale",description:"The maximum scale size of a model. This property is used as an upper limit for scaling due to `minimumPixelSize`",type:"number"}),qO=(0,K.A)({name:"Minimum pixel size",description:"The minimum pixel size of the model regardless of zoom. This can be used to ensure that a model is visible even when the viewer zooms out. When 0.0, no minimum size is enforced",type:"number"}),BO=(0,Pt.A)({name:"Color models by property",description:"Color entity models by reguler expression match of a property of an entity",type:dP}),VO=class extends((0,u.A)(oO,d.A)){constructor(){super(...arguments),cP(this,"maximumDistance",HO,this),cP(this,"maximumScale",$O,this),cP(this,"minimumPixelSize",JO,this),cP(this,"colorModelsByProperty",XO,this)}},HO=uP(VO.prototype,"maximumDistance",[UO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$O=uP(VO.prototype,"maximumScale",[WO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JO=uP(VO.prototype,"minimumPixelSize",[qO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XO=uP(VO.prototype,"colorModelsByProperty",[BO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VO);var mP,fP,gP,yP,bP,vP,wP,AP,SP,xP,OP,PP,TP,IP,DP,CP,EP=r(93566),_P=r(14147);function jP(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function zP(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let NP=(mP=(0,K.A)({name:"Name",description:"The header name",type:"string"}),fP=(0,K.A)({name:"Value",description:"The header value",type:"string"}),gP=class extends ze.A{constructor(){super(...arguments),jP(this,"name",yP,this),jP(this,"value",bP,this)}},yP=zP(gP.prototype,"name",[mP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bP=zP(gP.prototype,"value",[fP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gP),kP=(vP=(0,Re.b)({description:"Creates one catalog item from url that points to a gtfs service.\n  \n  <strong>Note:</strong> \n  <li>You need to obtain a valid api key for the NSW transport api.</li>\n  <li>When the camera is less than <code>maximumDistance</code> (500m) away, bus 3d models (scene.gltf) will be rendered.</li>",example:{type:"gtfs",url:"https://api.transport.nsw.gov.au/v1/gtfs/vehiclepos/buses",image:"https://tiles.terria.io/terriajs-examples/gtfs/TfNSW_B.png",name:"NSW Live Transport - Buses",headers:[{name:"Authorization",value:"apikey put-a-real-api-key-here"}],refreshInterval:60,featureInfoTemplate:{name:"{{vehicle_trip_bus_number}}",template:"<b>Bus:</b> {{route_short_name}}<br><b>Occupancy:</b> {{occupancy_status_str}}<br><b>Speed:</b> {{speed_km}} km/h<br><b style='padding-right: 5px'>Direction:</b> <span style='transform: rotate({{bearing}}deg); width: 10px; display: inline-block' aria-label='{{bearing}} degrees' role='img' title='{{bearing}} degrees'>&#x2B06;</div>"},model:{url:"https://tiles.terria.io/terriajs-examples/gtfs/lowpoly_bus/scene.gltf",scale:.3048,maximumDistance:500},id:"some unique id"}}),wP=(0,Ne.Ay)({name:"Headers",description:"Extra headers to attach to queries to the GTFS endpoint",type:NP,idProperty:"name"}),AP=(0,K.A)({name:"Image url",description:"Url for the image to use to represent a vehicle. Recommended size 32x32 pixels.",type:"string"}),SP=(0,Pt.A)({name:"Scale Image by Distance",description:"Describes how marker images are scaled by distance from the viewer.",type:_P.A}),xP=(0,Pt.A)({name:"Model",description:"3D model to use to represent a vehicle.",type:hP}),vP((PP=class extends((0,u.A)(d.A,_e.Ay,ke.A,Ki.Ay,EP.A,Xi.A,Tt.A)){constructor(){super(...arguments),jP(this,"headers",TP,this),jP(this,"image",IP,this),jP(this,"scaleImageByDistance",DP,this),jP(this,"model",CP,this)}},TP=zP(PP.prototype,"headers",[wP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IP=zP(PP.prototype,"image",[AP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DP=zP(PP.prototype,"scaleImageByDistance",[SP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CP=zP(PP.prototype,"model",[xP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OP=PP))||OP);function RP(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class MP{constructor(){RP(this,"defaultMessage",void 0)}read(e,t){return e.readFields(this.readField,this.defaultMessage,t)}}class FP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{header:null,entity:[]})}readField(e,t,r){null!=r&&(null==t&&(t={}),null!==t.entity&&void 0!==t.entity||(t.entity=[]),1===e?t.header=(new GP).read(r,r.readVarint()+r.pos):2===e&&t.entity.push((new UP).read(r,r.readVarint()+r.pos)))}}var LP=function(e){return e[e.FULL_DATASET=0]="FULL_DATASET",e[e.DIFFERENTIAL=1]="DIFFERENTIAL",e}(LP||{});class GP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{gtfs_realtime_version:"",incrementality:LP.FULL_DATASET,timestamp:0})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.gtfs_realtime_version=r.readString():2===e?t.incrementality=r.readVarint():3===e&&(t.timestamp=r.readVarint()))}}class UP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{id:"",is_deleted:!1,trip_update:null,vehicle:null,alert:null})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.id=r.readString():2===e?t.is_deleted=r.readBoolean():3===e?t.trip_update=(new WP).read(r,r.readVarint()+r.pos):4===e?t.vehicle=(new HP).read(r,r.readVarint()+r.pos):5===e&&(t.alert=(new KP).read(r,r.readVarint()+r.pos)))}}class WP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{trip:{},vehicle:{},stop_time_update:[],timestamp:0,delay:0})}readField(e,t,r){null!=r&&(null==t&&(t={}),null!==t.stop_time_update&&void 0!==t.stop_time_update||(t.stop_time_update=[]),1===e?t.trip=(new tT).read(r,r.readVarint()+r.pos):3===e?t.vehicle=(new lT).read(r,r.readVarint()+r.pos):2===e?t.stop_time_update.push((new BP).read(r,r.readVarint()+r.pos)):4===e?t.timestamp=r.readVarint():5===e&&(t.delay=r.readVarint(!0)))}}class qP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{delay:0,time:0,uncertainty:0})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.delay=r.readVarint(!0):2===e?t.time=r.readVarint(!0):3===e&&(t.uncertainty=r.readVarint(!0)))}}class BP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{stop_sequence:0,stop_id:"",arrival:null,departure:null,schedule_relationship:VP.NO_DATA})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.stop_sequence=r.readVarint():4===e?t.stop_id=r.readString():2===e?t.arrival=(new qP).read(r,r.readVarint()+r.pos):3===e?t.departure=(new qP).read(r,r.readVarint()+r.pos):5===e&&(t.schedule_relationship=r.readVarint()))}}var VP=function(e){return e[e.SCHEDULED=0]="SCHEDULED",e[e.SKIPPED=1]="SKIPPED",e[e.NO_DATA=2]="NO_DATA",e}(VP||{});class HP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{trip:null,vehicle:null,position:null,current_stop_sequence:0,stop_id:"",current_status:$P.IN_TRANSIT_TO,timestamp:0,congestion_level:JP.UNKNOWN_CONGESTION_LEVEL,occupancy_status:XP.EMPTY})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.trip=(new tT).read(r,r.readVarint()+r.pos):8===e?t.vehicle=(new lT).read(r,r.readVarint()+r.pos):2===e?t.position=(new eT).read(r,r.readVarint()+r.pos):3===e?t.current_stop_sequence=r.readVarint():7===e?t.stop_id=r.readString():4===e?t.current_status=r.readVarint():5===e?t.timestamp=r.readVarint():6===e?t.congestion_level=r.readVarint():9===e&&(t.occupancy_status=r.readVarint()))}}let $P=function(e){return e[e.INCOMING_AT=0]="INCOMING_AT",e[e.STOPPED_AT=1]="STOPPED_AT",e[e.IN_TRANSIT_TO=2]="IN_TRANSIT_TO",e}({}),JP=function(e){return e[e.UNKNOWN_CONGESTION_LEVEL=0]="UNKNOWN_CONGESTION_LEVEL",e[e.RUNNING_SMOOTHLY=1]="RUNNING_SMOOTHLY",e[e.STOP_AND_GO=2]="STOP_AND_GO",e[e.CONGESTION=3]="CONGESTION",e[e.SEVERE_CONGESTION=4]="SEVERE_CONGESTION",e}({}),XP=function(e){return e[e.EMPTY=0]="EMPTY",e[e.MANY_SEATS_AVAILABLE=1]="MANY_SEATS_AVAILABLE",e[e.FEW_SEATS_AVAILABLE=2]="FEW_SEATS_AVAILABLE",e[e.STANDING_ROOM_ONLY=3]="STANDING_ROOM_ONLY",e[e.CRUSHED_STANDING_ROOM_ONLY=4]="CRUSHED_STANDING_ROOM_ONLY",e[e.FULL=5]="FULL",e[e.NOT_ACCEPTING_PASSENGERS=6]="NOT_ACCEPTING_PASSENGERS",e}({});class KP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{active_period:[],informed_entity:[],cause:ZP.CONSTRUCTION,effect:QP.STOP_MOVED,url:null,header_text:null,description_text:null})}readField(e,t,r){null!=r&&(null==t&&(t={}),null!==t.active_period&&void 0!==t.active_period||(t.active_period=[]),null!==t.informed_entity&&void 0!==t.informed_entity||(t.informed_entity=[]),1===e?t.active_period.push((new YP).read(r,r.readVarint()+r.pos)):5===e?t.informed_entity.push((new cT).read(r,r.readVarint()+r.pos)):6===e?t.cause=r.readVarint():7===e?t.effect=r.readVarint():8===e?t.url=(new uT).read(r,r.readVarint()+r.pos):10===e?t.header_text=(new uT).read(r,r.readVarint()+r.pos):11===e&&(t.description_text=(new uT).read(r,r.readVarint()+r.pos)))}}var ZP=function(e){return e[e.UNKNOWN_CAUSE=1]="UNKNOWN_CAUSE",e[e.OTHER_CAUSE=2]="OTHER_CAUSE",e[e.TECHNICAL_PROBLEM=3]="TECHNICAL_PROBLEM",e[e.STRIKE=4]="STRIKE",e[e.DEMONSTRATION=5]="DEMONSTRATION",e[e.ACCIDENT=6]="ACCIDENT",e[e.HOLIDAY=7]="HOLIDAY",e[e.WEATHER=8]="WEATHER",e[e.MAINTENANCE=9]="MAINTENANCE",e[e.CONSTRUCTION=10]="CONSTRUCTION",e[e.POLICE_ACTIVITY=11]="POLICE_ACTIVITY",e[e.MEDICAL_EMERGENCY=12]="MEDICAL_EMERGENCY",e}(ZP||{}),QP=function(e){return e[e.NO_SERVICE=1]="NO_SERVICE",e[e.REDUCED_SERVICE=2]="REDUCED_SERVICE",e[e.SIGNIFICANT_DELAYS=3]="SIGNIFICANT_DELAYS",e[e.ADDITIONAL_SERVICE=4]="ADDITIONAL_SERVICE",e[e.MODIFIED_SERVICE=5]="MODIFIED_SERVICE",e[e.OTHER_EFFECT=6]="OTHER_EFFECT",e[e.UNKNOWN_EFFECT=7]="UNKNOWN_EFFECT",e[e.STOP_MOVED=8]="STOP_MOVED",e}(QP||{});class YP extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{start:0,end:0})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.start=r.readVarint():2===e&&(t.end=r.readVarint()))}}class eT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{latitude:0,longitude:0,bearing:0,odometer:0,speed:0})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.latitude=r.readFloat():2===e?t.longitude=r.readFloat():3===e?t.bearing=r.readFloat():4===e?t.odometer=r.readDouble():5===e&&(t.speed=r.readFloat()))}}class tT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{trip_id:"",route_id:"",direction_id:0,start_time:"",start_date:"",schedule_relationship:sT.SCHEDULED})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.trip_id=r.readString():5===e?t.route_id=r.readString():6===e?t.direction_id=r.readVarint():2===e?t.start_time=r.readString():3===e?t.start_date=r.readString():4===e&&(t.schedule_relationship=r.readVarint()))}}var rT,iT,oT,nT,aT,sT=function(e){return e[e.SCHEDULED=0]="SCHEDULED",e[e.ADDED=1]="ADDED",e[e.UNSCHEDULED=2]="UNSCHEDULED",e[e.CANCELED=3]="CANCELED",e}(sT||{});class lT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{id:"",label:"",license_plate:""})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.id=r.readString():2===e?t.label=r.readString():3===e&&(t.license_plate=r.readString()))}}class cT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{agency_id:"",route_id:"",route_type:0,trip:null,stop_id:""})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.agency_id=r.readString():2===e?t.route_id=r.readString():3===e?t.route_type=r.readVarint(!0):4===e?t.trip=(new tT).read(r,r.readVarint()+r.pos):5===e&&(t.stop_id=r.readString()))}}class uT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{translation:[]})}readField(e,t,r){null!=r&&(null==t&&(t={}),null!==t.translation&&void 0!==t.translation||(t.translation=[]),1===e&&t.translation.push((new pT).read(r,r.readVarint()+r.pos)))}}class pT extends MP{constructor(){super(...arguments),RP(this,"defaultMessage",{text:"",language:""})}readField(e,t,r){null!=r&&(null==t&&(t={}),1===e?t.text=r.readString():2===e&&(t.language=r.readString()))}}function dT(e,t){switch(e){case"route_short_name":{const e=(0,KO.A)(t,"vehicle.trip.route_id");return void 0!==e&&e.indexOf("_")+1>0?e.substr(e.indexOf("_")+1):""}case"occupancy_status#str":{const e=(0,KO.A)(t,"vehicle.occupancy_status");if(null!=e)switch(e){case XP.EMPTY:return"Empty";case XP.MANY_SEATS_AVAILABLE:return"Many seats available";case XP.FEW_SEATS_AVAILABLE:return"Few seats available";case XP.STANDING_ROOM_ONLY:return"Standing room only";case XP.CRUSHED_STANDING_ROOM_ONLY:return"Crushed standing room only";case XP.FULL:return"Full";case XP.NOT_ACCEPTING_PASSENGERS:return"Not accepting passengers"}break}case"speed#km":return(3.6*(0,KO.A)(t,"vehicle.position.speed",0)).toFixed(2);case"speed":return(0,KO.A)(t,"vehicle.position.speed",0).toFixed(2);case"bearing":return(0,KO.A)(t,"vehicle.position.bearing",0).toFixed(2);default:return}}function hT(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mT(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let fT=(iT=class e extends((0,pt.Ay)(kP)){constructor(e){super(),this._item=e,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}static async load(t){return new e(t)}get rectangle(){return(0,ut.A)(Ki.Ts,this._item._bbox)}},hT(iT,"stratumName","gtfs"),mT((rT=iT).prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(rT.prototype,"rectangle"),rT.prototype),rT);dt.A.addLoadStratum(fT.stratumName);let gT=(aT=class e extends((0,Ee.A)((0,St.A)((0,$i.Ay)((0,s.A)((0,g.A)(kP)))))){static get type(){return"gtfs"}get type(){return e.type}get dataSource(){this._dataSource.entities.suspendEvents();const e=this.convertManyFeedEntitiesToBillboardData(this.gtfsFeedEntities);for(const r of e){if(void 0===r.sourceId)continue;const e=this._dataSource.entities.getOrCreateEntity(r.sourceId);if(!e.model)if(this._coloredModels){var t;const i=null===(t=r.featureInfo)||void 0===t?void 0:t.get("entity"),o=(0,KO.A)(i,this.model.colorModelsByProperty.property);if(void 0!==o){const t=this.model.colorModelsByProperty.colorGroups.findIndex(e=>void 0!==e.regExp&&new RegExp(e.regExp).test(o));-1!==t&&(e.model=this._coloredModels[t]),e.point=void 0}else e.model=this._model}else this._model&&(e.model=this._model);if(void 0!==this.model&&null!==this.model&&void 0!==r.orientation&&null!==r.orientation&&(e.orientation=new tP.A(r.orientation)),void 0===r.position||e.position&&e.position.getValue(new yt.A)===r.position||(e.position=new eP.A(r.position)),null!==r.billboard&&void 0!==r.billboard&&(null!==e.billboard&&void 0!==e.billboard||(e.billboard=r.billboard),r.billboard.color&&(r.billboard.color.getValue(new yt.A).alpha=this.opacity),e.billboard.color&&e.billboard.color.equals(r.billboard.color)||(e.billboard.color=r.billboard.color)),null!==r.point&&void 0!==r.point&&(null!==e.point&&void 0!==e.point||(e.point=r.point),r.point.color&&(r.point.color.getValue(new yt.A).alpha=this.opacity),e.point.color&&e.point.color.equals(r.point.color)||(e.point.color=r.point.color)),void 0!==r.featureInfo&&null!==r.featureInfo){e.properties=new nP.A;for(const t of r.featureInfo.keys())e.properties.addProperty(t,r.featureInfo.get(t))}}if(this._dataSource.entities.values.length>e.length){const t=new Set(e.map(e=>e.sourceId));this._dataSource.entities.values.filter(e=>!t.has(e.id)).forEach(e=>this._dataSource.entities.remove(e))}return this._dataSource.entities.resumeEvents(),this._dataSource}refreshData(){this.forceLoadMapItems()}get mapItems(){return this._dataSource.show=this.show,[this.dataSource]}get _cesiumUpAxis(){return void 0===this.model.upAxis?aP.A.Y:aP.A.fromName(this.model.upAxis)}get _cesiumForwardAxis(){return void 0===this.model.forwardAxis?aP.A.Z:aP.A.fromName(this.model.forwardAxis)}get _model(){var e,t;if(void 0===this.model.url)return;const r={uri:new tP.A(this.model.url),upAxis:new tP.A(this._cesiumUpAxis),forwardAxis:new tP.A(this._cesiumForwardAxis),scale:new tP.A(null!==(e=this.model.scale)&&void 0!==e?e:1),heightReference:new tP.A(Cl.Ay.RELATIVE_TO_GROUND),distanceDisplayCondition:new tP.A({near:0,far:this.model.maximumDistance}),maximumScale:new tP.A(this.model.maximumScale),minimumPixelSize:new tP.A(null!==(t=this.model.minimumPixelSize)&&void 0!==t?t:0),shadows:lP.A.DISABLED};return new iP.A(r)}get _coloredModels(){var e,t;const r=null===(e=this.model)||void 0===e||null===(e=e.colorModelsByProperty)||void 0===e?void 0:e.colorGroups,i=this._model;if((0,n.A)(i)&&(0,n.A)(null===(t=this.model)||void 0===t||null===(t=t.colorModelsByProperty)||void 0===t?void 0:t.property)&&(0,n.A)(r)&&0!==r.length)return r.map(e=>{let{color:t}=e;const r=i.clone();return r.color=new tP.A(ml.A.fromCssColorString(null!=t?t:"white")),r.colorBlendMode=new tP.A(sP.A.MIX),r.colorBlendAmount=new tP.A(.7),r})}constructor(e,t,r){super(e,t,r),hT(this,"disposer",void 0),hT(this,"_bbox",{west:1/0,south:1/0,east:-1/0,north:-1/0}),hT(this,"_dataSource",new rP.A("billboard")),function(e,t,r,i){r&&Object.defineProperty(e,"gtfsFeedEntities",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,nT,this),hT(this,"convertManyFeedEntitiesToBillboardData",(0,ob.Aj)(e=>{const t=new Map;for(let r=0;r<e.length;++r){const i=e[r],o=this.convertFeedEntityToBillboardData(i);if(o&&o.position&&o.featureInfo){const e=o.featureInfo.get("entity").vehicle.vehicle;t.has(e.id)&&e.timestamp?t.get(e.id).timestamp<e.timestamp&&t.set(e.id,o):t.set(e.id,o)}}return[...t.values()]})),(0,i.Gn)(this)}forceLoadMetadata(){return Promise.resolve()}forceLoadMapItems(){return void 0===this.strata.get(fT.stratumName)&&fT.load(this).then(e=>{(0,i.h5)(()=>{this.strata.set(fT.stratumName,e)})}),this.retrieveData().then(e=>{(0,i.h5)(()=>{void 0!==e.entity&&null!==e.entity&&(this.gtfsFeedEntities=e.entity,this.terria.currentViewer.notifyRepaintRequired())})}).catch(e=>{throw new At.Ay({title:"Could not load ".concat(this.nameInCatalog,"."),sender:this,message:"There was an error loading the data for ".concat(this.nameInCatalog,".")})})}retrieveData(){const e={"Content-Type":"application/x-google-protobuf;charset=UTF-8","Cache-Control":"no-cache"};return void 0!==this.headers&&this.headers.forEach(t=>{let{name:r,value:i}=t;void 0!==r&&void 0!==i&&(e[r]=i)}),null!==this.url&&void 0!==this.url?(0,Qx.A)((0,ie.A)(this,this.url),e).then(e=>{const t=new(QO())(new Uint8Array(e));return(new FP).read(t)}):Promise.reject()}convertFeedEntityToBillboardData(t){if(void 0===t.id)return{};let r,i;const o=new Map;var n,a,s;null!==t.vehicle&&void 0!==t.vehicle&&null!==t.vehicle.position&&void 0!==t.vehicle.position&&null!==t.vehicle.position.latitude&&void 0!==t.vehicle.position.latitude&&null!==t.vehicle.position.longitude&&void 0!==t.vehicle.position.longitude&&null!==t.vehicle.position.bearing&&void 0!==t.vehicle.position.bearing&&(n=t.vehicle.position.latitude,a=t.vehicle.position.longitude,s=this._bbox,a<s.west&&(s.west=a),n<s.south&&(s.south=n),a>s.east&&(s.east=a),n>s.north&&(s.north=n),r=ul.A.fromDegrees(t.vehicle.position.longitude,t.vehicle.position.latitude),i=YO.A.headingPitchRollQuaternion(r,wl.A.fromDegrees(t.vehicle.position.bearing-90,0,0)));for(const r of e.FEATURE_INFO_TEMPLATE_FIELDS)o.set(r,dT(r,t));let l,c;return o.set("entity",t),void 0!==this.image&&null!==this.image?l=new up.A({image:new tP.A(this.image),heightReference:new tP.A(Cl.Ay.RELATIVE_TO_GROUND),scaleByDistance:this.scaleImageByDistance.nearValue===this.scaleImageByDistance.farValue?void 0:new tP.A(new Sl.A(this.scaleImageByDistance.near,this.scaleImageByDistance.nearValue,this.scaleImageByDistance.far,this.scaleImageByDistance.farValue)),scale:this.scaleImageByDistance.nearValue===this.scaleImageByDistance.farValue&&1!==this.scaleImageByDistance.nearValue?new tP.A(this.scaleImageByDistance.nearValue):void 0,color:new tP.A(new ml.A(1,1,1,this.opacity))}):c=new oP.A({color:new tP.A(ml.A.CYAN),outlineWidth:new tP.A(1),outlineColor:new tP.A(ml.A.WHITE),scaleByDistance:this.scaleImageByDistance.nearValue===this.scaleImageByDistance.farValue?void 0:new tP.A(new Sl.A(this.scaleImageByDistance.near,this.scaleImageByDistance.nearValue,this.scaleImageByDistance.far,this.scaleImageByDistance.farValue)),pixelSize:this.scaleImageByDistance.nearValue===this.scaleImageByDistance.farValue&&1!==this.scaleImageByDistance.nearValue?new tP.A(32*this.scaleImageByDistance.nearValue):new tP.A(32),heightReference:new tP.A(Cl.Ay.RELATIVE_TO_GROUND)}),{sourceId:t.id,position:r,orientation:i,featureInfo:o,billboard:l,point:c}}},hT(aT,"FEATURE_INFO_TEMPLATE_FIELDS",["route_short_name","occupancy_status#str","speed#km","speed","bearing"]),nT=mT((oT=aT).prototype,"gtfsFeedEntities",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mT(oT.prototype,"dataSource",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"dataSource"),oT.prototype),mT(oT.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"mapItems"),oT.prototype),mT(oT.prototype,"_cesiumUpAxis",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"_cesiumUpAxis"),oT.prototype),mT(oT.prototype,"_cesiumForwardAxis",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"_cesiumForwardAxis"),oT.prototype),mT(oT.prototype,"_model",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"_model"),oT.prototype),mT(oT.prototype,"_coloredModels",[i.EW],Object.getOwnPropertyDescriptor(oT.prototype,"_coloredModels"),oT.prototype),oT);var yT,bT,vT,wT,AT,ST,xT,OT,PT,TT,IT,DT,CT,ET,_T,jT,zT,NT,kT,RT,MT,FT,LT,GT,UT,WT,qT,BT,VT,HT,$T,JT,XT,KT,ZT,QT,YT=r(34098),eI=r(76287);function tI(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function rI(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let iI=(yT=(0,K.A)({type:"string",name:"Domain Property Name",description:"Domain Property Name."}),bT=(0,K.A)({type:"string",name:"Hierarchy Separator",description:"Hierarchy Separator."}),vT=(0,K.A)({type:"string",name:"Query Property Name",description:"Query Property Name."}),wT=class extends ze.A{constructor(){super(...arguments),tI(this,"domainPropertyName",AT,this),tI(this,"hierarchySeparator",ST,this),tI(this,"queryPropertyName",xT,this)}},AT=rI(wT.prototype,"domainPropertyName",[yT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ST=rI(wT.prototype,"hierarchySeparator",[bT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xT=rI(wT.prototype,"queryPropertyName",[vT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wT),oI=(OT=(0,Re.b)({description:"Creates one catalog group from url that points to a csw service.\n  The url in the example supports CORS therefore do not use proxy. Using a proxy might not work.",example:{type:"csw-group",url:"http://oa-gis.csiro.au/geonetwork/srv/eng/csw",domainSpecification:{domainPropertyName:"awavea",hierarchySeparator:" | ",queryPropertyName:"subject"},name:"Marine Energy Context Layers",id:"some unique ID"}}),PT=(0,K.A)({type:"boolean",name:"Flatten",description:"True to flatten the layers into a single list; false to use the layer hierarchy."}),TT=(0,Pt.A)({type:iI,name:"Domain Specification",description:"Domain Specification"}),IT=(0,K.A)({type:"boolean",name:"Include WMS",description:"True to allow WMS resources to be added to the catalog; otherwise, false."}),DT=(0,K.A)({type:"boolean",name:"Include KML",description:"True to allow KML resources to be added to the catalog; otherwise, false."}),CT=(0,K.A)({type:"boolean",name:"Include CSV",description:"True to allow CSV resources to be added to the catalog; otherwise, false."}),ET=(0,K.A)({type:"boolean",name:"Include ESRI Map Server",description:"True to allow ESRI Map resources to be added to the catalog; otherwise, false."}),_T=(0,K.A)({type:"boolean",name:"Include GeoJSON",description:"True to allow GeoJSON resources to be added to the catalog; otherwise, false"}),jT=(0,K.A)({type:"string",name:"WMS Resource Format",description:"Gets or sets a regular expression that, when it matches the protocol attribute of a URI element of a record, indicates that the URI is a WMS resource."}),zT=(0,K.A)({type:"string",name:"KML Resource Format",description:"Gets or sets a regular expression that, when it matches the protocol attribute of a URI element of a record, indicates that the resource is a KML resource."}),NT=(0,K.A)({type:"string",name:"CSV Resource Format",description:"Gets or sets a regular expression that, when it matches the protocol attribute of a URI element of a record, indicates that the URI is a CSV resource."}),kT=(0,K.A)({type:"string",name:"ESRI MapServer Resource Format",description:"Gets or sets a regular expression that, when it matches the protocol attribute of a URI element of a record, indicates that the URI is a Esri MapServer resource."}),RT=(0,K.A)({type:"string",name:"WMS Resource Format",description:"Gets or sets a regular expression that, when it matches the protocol attribute of a URI element of a record, indicates that the URI is a GeoJSON resource."}),MT=(0,K.A)({type:"string",name:"GetRecords Template",description:"Gets or sets the template XML string to POST to the CSW server to query for catalog items.  If this property is undefined,`lib/Models/CswGetRecordsTemplate.xml` is used.  The XML string should have a `{startPosition}` placeholder to be replaced with the next start position in order to allow incremental paging of results.."}),OT((LT=class extends((0,u.A)(pi.A,je.A,d.A,_e.Ay,ke.A)){constructor(){super(...arguments),tI(this,"flatten",GT,this),tI(this,"domainSpecification",UT,this),tI(this,"includeWms",WT,this),tI(this,"includeKml",qT,this),tI(this,"includeCsv",BT,this),tI(this,"includeEsriMapServer",VT,this),tI(this,"includeGeoJson",HT,this),tI(this,"wmsResourceFormat",$T,this),tI(this,"kmlResourceFormat",JT,this),tI(this,"csvResourceFormat",XT,this),tI(this,"esriMapServerResourceFormat",KT,this),tI(this,"geoJsonResourceFormat",ZT,this),tI(this,"getRecordsTemplate",QT,this)}},GT=rI(LT.prototype,"flatten",[PT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),UT=rI(LT.prototype,"domainSpecification",[TT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WT=rI(LT.prototype,"includeWms",[IT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qT=rI(LT.prototype,"includeKml",[DT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),BT=rI(LT.prototype,"includeCsv",[CT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),VT=rI(LT.prototype,"includeEsriMapServer",[ET],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),HT=rI(LT.prototype,"includeGeoJson",[_T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$T=rI(LT.prototype,"wmsResourceFormat",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\\bwms\\b"}}),JT=rI(LT.prototype,"kmlResourceFormat",[zT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\\bkml\\b"}}),XT=rI(LT.prototype,"csvResourceFormat",[NT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\\bcsv-geo-"}}),KT=rI(LT.prototype,"esriMapServerResourceFormat",[kT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\\besri rest\\b"}}),ZT=rI(LT.prototype,"geoJsonResourceFormat",[RT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\\bgeojson\\b"}}),QT=rI(LT.prototype,"getRecordsTemplate",[MT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FT=LT))||FT);var nI,aI;function sI(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lI(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}function cI(e){if((0,n.A)(e))return Array.isArray(e)?e:[e]}let uI=(aI=class e extends((0,pt.Ay)(oI)){static async load(t){if(void 0===t.url)throw new At.Ay({title:Pe.Ay.t("models.csw.missingUrlTitle"),message:Pe.Ay.t("models.csw.missingUrlMessage")});const r=[];if(!t.flatten&&t.domainSpecification.domainPropertyName&&t.domainSpecification.hierarchySeparator&&t.domainSpecification.queryPropertyName){var i;const e=new(Ie())((0,ie.A)(t,t.url)).query({service:"CSW",version:"2.0.2",request:"GetDomain",propertyname:t.domainSpecification.domainPropertyName});let o;try{const t=await(0,ra.A)(e.toString());if(!t||!t.documentElement||"GetDomainResponse"!==t.documentElement.localName)throw"Invalid XML response";o=(0,eI.A)(t)}catch(e){throw console.log(e),(0,At.mG)({sender:t,title:Pe.Ay.t("models.csw.notUseableTitle"),message:Pe.Ay.t("models.csw.notUseableMessage")})}if(!o)throw(0,At.mG)({sender:t,title:Pe.Ay.t("models.csw.errorLoadingTitle"),message:Pe.Ay.t("models.csw.checkCORSDomain")});const n=(0,YT.A)(null===(i=cI(o.DomainValues))||void 0===i?void 0:i.map(e=>{var t;return cI(null==e||null===(t=e.ListOfValues)||void 0===t?void 0:t.Value)})).filter(e=>"string"==typeof e);n.forEach(e=>{pI(e.split(t.domainSpecification.hierarchySeparator),0,r,t.domainSpecification.hierarchySeparator,t.domainSpecification.queryPropertyName)})}let o=!0,a=1;const s=[];for(;o;){var l,c,u,p,d,h,m,f,g,y,b;const e=(null!==(l=t.getRecordsTemplate)&&void 0!==l?l:'<?xml version="1.0" encoding="utf-8"?>\n<csw:GetRecords xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" version="2.0.2" service="CSW" resultType="results" startPosition="{startPosition}" maxRecords="100">\n    <csw:Query typeNames="csw:Record" xmlns:ogc="http://www.opengis.net/ogc" xmlns:gml="http://www.opengis.net/gml">\n        <csw:ElementSetName>full</csw:ElementSetName>\n        <csw:Constraint version="1.1.0">\n            <ogc:Filter>\n                <ogc:Or>\n                    <ogc:PropertyIsLike wildCard="%" singleChar="#" escapeChar="!">\n                        <ogc:PropertyName>dc:format</ogc:PropertyName>\n                        <ogc:Literal>%WMS%</ogc:Literal>\n                    </ogc:PropertyIsLike>\n                    <ogc:PropertyIsLike wildCard="%" singleChar="#" escapeChar="!">\n                        <ogc:PropertyName>OnlineResourceType</ogc:PropertyName>\n                        <ogc:Literal>%WMS%</ogc:Literal>\n                    </ogc:PropertyIsLike>\n                    <ogc:PropertyIsLike wildCard="%" singleChar="#" escapeChar="!">\n                        <ogc:PropertyName>apiso:ServiceType</ogc:PropertyName>\n                        <ogc:Literal>%WMS%</ogc:Literal>\n                    </ogc:PropertyIsLike>\n                </ogc:Or>\n            </ogc:Filter>\n        </csw:Constraint>\n    </csw:Query>\n</csw:GetRecords>\n').replace("{startPosition}",a),r=await(0,$.A)({url:(0,ie.A)(t,new(Ie())(t.url).query("").toString(),"1d"),responseType:"document",method:"POST",overrideMimeType:"text/xml",data:e,headers:{"Content-Type":"application/xml"}});if(!(0,n.A)(r))throw(0,At.mG)({sender:t,title:Pe.Ay.t("models.csw.errorLoadingRecordsTitle"),message:Pe.Ay.t("models.csw.errorLoadingRecordsMessage")});const i=(0,eI.A)(r);if(i.Exception){let e=Pe.Ay.t("models.csw.unknownError");throw i.Exception.ExceptionText&&(e=Pe.Ay.t("models.csw.exceptionMessage",{exceptionText:i.Exception.ExceptionText})),new At.Ay({sender:t,title:Pe.Ay.t("models.csw.errorLoadingTitle"),message:e})}s.push(...null!==(c=null==i||null===(u=i.SearchResults)||void 0===u?void 0:u.Record)&&void 0!==c?c:[]);const v="string"==typeof(null==i||null===(p=i.SearchResults)||void 0===p?void 0:p.nextRecord)?parseInt(null!==(d=null==i||null===(h=i.SearchResults)||void 0===h?void 0:h.nextRecord)&&void 0!==d?d:"0",10):null==i||null===(m=i.SearchResults)||void 0===m?void 0:m.nextRecord,w="string"==typeof(null==i||null===(f=i.SearchResults)||void 0===f?void 0:f.numberOfRecordsMatched)?parseInt(null!==(g=null==i||null===(y=i.SearchResults)||void 0===y?void 0:y.numberOfRecordsMatched)&&void 0!==g?g:"0",10):null==i||null===(b=i.SearchResults)||void 0===b?void 0:b.numberOfRecordsMatched;!(0,n.A)(v)||0===v||v>=w?o=!1:a=v}return r.length>0&&s.forEach(e=>{var t;null===(t=dI(r,e))||void 0===t||t.records.push(e)}),new e(t,r,s)}constructor(e,t,r){super(),this.catalogGroup=e,this.metadataGroups=t,this.records=r,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.metadataGroups,this.records)}get members(){return 0===this.metadataGroups.length?this.records.map(e=>"".concat(this.catalogGroup.uniqueId,"/").concat(e.identifier)):this.metadataGroups.map(e=>"".concat(this.catalogGroup.uniqueId,"/").concat(e.groupName))}createMembersFromLayers(){0===this.metadataGroups.length?this.records.forEach(e=>this.createRecord(this.catalogGroup.uniqueId,e)):this.metadataGroups.forEach(e=>this.createMetadataGroup(this.catalogGroup.uniqueId,e))}createMetadataGroup(e,t){const r="".concat(e,"/").concat(t.groupName),i=this.catalogGroup.terria.getModelById(xe.A,r);let n;return void 0===i?(n=new xe.A(r,this.catalogGroup.terria),this.catalogGroup.terria.addModel(n)):n=i,n.strata.delete(C.A.definition),n.setTrait(C.A.definition,"name",t.groupName),n.setTrait(C.A.definition,"members",(0,o.A)([...t.children.map(e=>this.createMetadataGroup(r,e).uniqueId),...t.records.map(e=>{var t;return null===(t=this.createRecord(r,e))||void 0===t?void 0:t.uniqueId})])),n}createRecord(e,t){var r;const i=cI(null!==(r=t.URI)&&void 0!==r?r:t.references);if(!(0,n.A)(i))return;const o=[],a=[];let s;const l=this.resourceFormats.filter(e=>e.enabled);for(let e=0;e<i.length;e++){const t=i[e];if(!t)return;const r=l.findIndex(e=>{var r,i;return null===(r=null!==(i=t.protocol)&&void 0!==i?i:t.scheme)||void 0===r?void 0:r.match(e.regex)});-1===r||o[r]?("LegendUrl"===(null==t?void 0:t.description)&&(s=t),a.push({url:t.toString(),description:t.description?t.description:t.name})):o[r]=t}const c="".concat(e,"/").concat(t.identifier),u=o.findIndex(e=>(0,n.A)(e));if(-1!==u){var p;const e=this.resourceFormats[u].contructor,r=this.catalogGroup.terria.getModelById(e,c);let i;void 0===r?(i=new e(c,this.catalogGroup.terria),this.catalogGroup.terria.addModel(i)):i=r,i.strata.delete(C.A.definition),i.setTrait(C.A.definition,"name",null!==(p=t.title)&&void 0!==p?p:t.identifier);const n=o[u];var d;if(i.setTrait(C.A.definition,"url",n.toString()),t.abstract)i.setTrait(C.A.definition,"description",null===(d=cI(t.abstract))||void 0===d?void 0:d.join("\n\n"));else if(t.description){var h;i.setTrait(C.A.definition,"description",null===(h=cI(t.description))||void 0===h?void 0:h.join("\n\n"))}const l=[];var m;if(t.contributor&&cI(t.contributor).length>0&&l.push({name:Pe.Ay.t("models.csw.dataResponsibility"),content:null===(m=cI(t.contributor))||void 0===m?void 0:m.join("\n\n")}),l.push({name:Pe.Ay.t("models.csw.links"),content:a.map(e=>"[".concat(e.description,"](").concat(e.url,")")).join("\n\n")}),i.setTrait(C.A.definition,"info",l),i.setTrait(C.A.definition,"metadataUrls",[{title:Pe.Ay.t("models.csw.metadataURL"),url:new(Ie())((0,ie.A)(this.catalogGroup,this.catalogGroup.url)).query({service:"CSW",version:"2.0.2",request:"GetRecordById",outputSchema:"http://www.opengis.net/cat/csw/2.0.2",ElementSetName:"full",id:t.identifier}).toString()}]),s&&i.setTrait(C.A.definition,"legends",[{url:s.toString()}]),i instanceof bi.Ay){if(!n.name)return;i.setTrait(C.A.definition,"layers",n.name)}if(i instanceof Vw){if(!n.name)return;i.setTrait(C.A.definition,"layers",n.name)}return i}}get resourceFormats(){return[{enabled:this.catalogGroup.includeWms,regex:new RegExp(this.catalogGroup.wmsResourceFormat,"i"),contructor:bi.Ay},{enabled:this.catalogGroup.includeEsriMapServer,regex:new RegExp(this.catalogGroup.esriMapServerResourceFormat,"i"),contructor:Vw},{enabled:this.catalogGroup.includeKml,regex:new RegExp(this.catalogGroup.kmlResourceFormat,"i"),contructor:wh},{enabled:this.catalogGroup.includeGeoJson,regex:new RegExp(this.catalogGroup.geoJsonResourceFormat,"i"),contructor:Or.default},{enabled:this.catalogGroup.includeCsv,regex:new RegExp(this.catalogGroup.csvResourceFormat,"i"),contructor:re.A}]}},sI(aI,"stratumName","CswStratum"),lI((nI=aI).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(nI.prototype,"members"),nI.prototype),lI(nI.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(nI.prototype,"createMembersFromLayers"),nI.prototype),lI(nI.prototype,"createMetadataGroup",[i.XI],Object.getOwnPropertyDescriptor(nI.prototype,"createMetadataGroup"),nI.prototype),lI(nI.prototype,"createRecord",[i.XI],Object.getOwnPropertyDescriptor(nI.prototype,"createRecord"),nI.prototype),lI(nI.prototype,"resourceFormats",[i.EW],Object.getOwnPropertyDescriptor(nI.prototype,"resourceFormats"),nI.prototype),nI);function pI(e,t,r,i,o){if(t>e.length-1)return;let n=r.findIndex(r=>r.groupName===e[t]);if(-1===n){let a,s=!0;if(t+1!==e.length){const r=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");a="^"+e.slice(0,t+1).join(r)+r}else a=e.slice(0,t+1).join(i),s=!1;r.push({field:o,value:a,regex:s,groupName:e[t],children:[],records:[]}),n=r.length-1}pI(e,t+1,r[n].children,i,o)}function dI(e,t){for(let i=0;i<e.length;i++){const a=e[i];var r;if(a.field)if((0,o.A)(null!==(r=cI(t[a.field]))&&void 0!==r?r:[]).find(e=>hI(a.value,e,a.regex))){if(a.children){const e=dI(a.children,t);if((0,n.A)(e))return e}return a}}}function hI(e,t,r){return(0,n.A)(r)&&r?new RegExp(e).test(t):e===t}dt.A.addLoadStratum(uI.stratumName);class mI extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(oI))))){get type(){return mI.type}async forceLoadMetadata(){if(void 0!==this.strata.get(uI.stratumName))return;const e=await uI.load(this);(0,i.h5)(()=>{this.strata.set(uI.stratumName,e)})}async forceLoadMembers(){const e=this.strata.get(uI.stratumName);e&&await(0,De.A)(()=>e.createMembersFromLayers())}}sI(mI,"type","csw-group");var fI,gI,yI,bI,vI,wI,AI,SI,xI,OI,PI,TI,II,DI,CI,EI,_I,jI,zI,NI,kI,RI,MI,FI,LI,GI,UI,WI,qI,BI,VI,HI,$I,JI,XI,KI,ZI,QI,YI,eD=r(99651);function tD(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function rD(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let iD=(fI=(0,K.A)({name:"Identifier",type:"string",description:"A string that identifies the property when communicating with the server."}),gI=(0,K.A)({name:"Title",type:"string",description:"A display title."}),yI=(0,K.A)({name:"Units",type:"string",description:"The unit of the property value"}),bI=(0,K.A)({name:"Default duration",type:"string",description:"The intervals between observations. eg: 10d - Final character must be s, h, d or y for seconds, hours, days or years."}),vI=class extends ze.A{constructor(){super(...arguments),tD(this,"identifier",wI,this),tD(this,"title",AI,this),tD(this,"units",SI,this),tD(this,"defaultDuration",xI,this)}},wI=rD(vI.prototype,"identifier",[fI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AI=rD(vI.prototype,"title",[gI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SI=rD(vI.prototype,"units",[yI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xI=rD(vI.prototype,"defaultDuration",[bI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vI);class oD extends((0,u.A)(iD)){}let nD=(OI=(0,K.A)({name:"Request size limit",type:"number",description:"Gets or sets the maximum number of timeseries to request of the server in a single GetObservation request. Servers may have a Response Size Limit, eg. 250. Note the number of responses may be different to the number requested, eg. the BoM server can return > 1 timeseries/feature identifier, (such as ...stations/41001702), so it can be sensible to set this below the response size limit."}),PI=(0,K.A)({name:"Request number limit",type:"number",description:"Gets or sets the maximum number of GetObservation requests that we can fire off at a time. If the response size limit is 250, and this is 4, then observations for at most 1000 features will load. If there are more than 1000 features, they will be shown without observation data, until they are clicked."}),TI=(0,K.A)({name:"Request template",type:"string",description:"The template XML string to POST to the SOS server to query for GetObservation. If this property is undefined, `SensorObservationServiceCatalogItem.defaultRequestTemplate` is used. This is used as a Mustache template. See SensorObservationServiceRequestTemplate.xml for the default. Be careful with newlines inside tags: Mustache can add an extra space in the front of them, which causes the request to fail on the SOS server."}),II=(0,Ne.Ay)({name:"Observable properties",type:iD,idProperty:"identifier",description:"The sensor observation service observableProperties that the user can choose from for this catalog item."}),DI=(0,K.A)({name:"Filter by procedure",type:"boolean",description:"Whether to include the list of procedures in GetFeatureOfInterest calls, so that only locations that support those procedures are returned. For some servers (such as BoM's Water Data Online), this causes the request to time out."}),CI=(0,Ne.Ay)({name:"Procedures",type:oD,idProperty:"identifier",description:"The sensor observation service procedures that the user can choose from for this catalog item."}),EI=(0,K.A)({name:"Procedures name",type:"string",description:"Gets or sets the name seen by the user for the list of procedures. Defaults to `Procedure`, but eg. for BoM, `Frequency` would be better."}),_I=(0,K.A)({name:"Observable properties name",type:"string",description:"Gets or sets the name seen by the user for the list of observable properties. Defaults to `Property`, but eg. for BoM, `Observation type` would be better."}),jI=(0,mr.A)({name:"Station ID whitelist",type:"string",description:"If set, an array of IDs. Only station IDs that match these will be included."}),zI=(0,mr.A)({name:"Station ID blacklist",type:"string",description:"If set, an array of IDs. Only station IDs that match these will be included."}),NI=(0,K.A)({name:"Start date",type:"string",description:"An start date in ISO8601 format. All requests filter to this start date. Set to undefined for no temporal filter."}),kI=(0,K.A)({name:"End date",type:"string",description:"An end date in ISO8601 format. All requests filter to this end date. Set to undefined to use the current date."}),RI=(0,K.A)({name:"Show as chart",type:"boolean",description:"When `true`, loads the observation data for charts instead of feature points data to plot on map"}),MI=(0,K.A)({name:"Chart feature of interest identifier",type:"string",description:"The `identifier` of the feature-of-interest for which we are showing the chart."}),FI=(0,K.A)({name:"Selected observable id",type:"string",description:"The identifier of the selected observable property"}),LI=class extends((0,u.A)(Dt.A,d.A)){constructor(){super(...arguments),tD(this,"requestSizeLimit",GI,this),tD(this,"requestNumberLimit",UI,this),tD(this,"requestTemplate",WI,this),tD(this,"observableProperties",qI,this),tD(this,"filterByProcedures",BI,this),tD(this,"procedures",VI,this),tD(this,"proceduresName",HI,this),tD(this,"observablePropertiesName",$I,this),tD(this,"stationIdWhitelist",JI,this),tD(this,"stationIdBlacklist",XI,this),tD(this,"startDate",KI,this),tD(this,"endDate",ZI,this),tD(this,"showAsChart",QI,this),tD(this,"chartFeatureOfInterestIdentifier",YI,this)}get selectedObservableId(){}},GI=rD(LI.prototype,"requestSizeLimit",[OI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),UI=rD(LI.prototype,"requestNumberLimit",[PI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),WI=rD(LI.prototype,"requestTemplate",[TI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qI=rD(LI.prototype,"observableProperties",[II],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),BI=rD(LI.prototype,"filterByProcedures",[DI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),VI=rD(LI.prototype,"procedures",[CI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),HI=rD(LI.prototype,"proceduresName",[EI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Pe.Ay.t("models.sensorObservationService.procedure")}}),$I=rD(LI.prototype,"observablePropertiesName",[_I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Pe.Ay.t("models.sensorObservationService.property")}}),JI=rD(LI.prototype,"stationIdWhitelist",[jI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XI=rD(LI.prototype,"stationIdBlacklist",[zI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KI=rD(LI.prototype,"startDate",[NI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZI=rD(LI.prototype,"endDate",[kI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QI=rD(LI.prototype,"showAsChart",[RI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),YI=rD(LI.prototype,"chartFeatureOfInterestIdentifier",[MI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rD(LI.prototype,"selectedObservableId",[FI],Object.getOwnPropertyDescriptor(LI.prototype,"selectedObservableId"),LI.prototype),LI);var aD,sD,lD,cD,uD,pD=r(94533);function dD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function hD(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dD(Object(r),!0).forEach(function(t){mD(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function mD(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fD(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}dt.A.addLoadStratum(xt.A.stratumName);let gD=(aD=class e extends xt.A{constructor(e){super(e),this.catalogItem=e,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}get activeStyle(){var e;return null===(e=this.catalogItem.procedures[0])||void 0===e?void 0:e.identifier}get styles(){return this.catalogItem.procedures.map(e=>(0,ut.A)(Mt.A,{id:e.identifier,title:e.title,pointSize:(0,ut.A)(kv.A,{pointSizeColumn:e.identifier}),hidden:!1}))}get defaultChartStyle(){const e=this.catalogItem.tableColumns.find(e=>e.type===c.A.time),t=this.catalogItem.tableColumns.find(e=>e.type===c.A.scalar);if(e&&t)return(0,ut.A)(Mt.A,{chart:(0,ut.A)(pD.A,{xAxisColumn:e.name,lines:[(0,ut.A)(pD.h,{yAxisColumn:t.name})]})})}},fD(aD.prototype,"activeStyle",[i.$Z],Object.getOwnPropertyDescriptor(aD.prototype,"activeStyle"),aD.prototype),fD(aD.prototype,"styles",[i.$Z],Object.getOwnPropertyDescriptor(aD.prototype,"styles"),aD.prototype),fD(aD.prototype,"defaultChartStyle",[i.$Z],Object.getOwnPropertyDescriptor(aD.prototype,"defaultChartStyle"),aD.prototype),aD),yD=(fD((sD=class{constructor(e,t){this.catalogItem=e,this.requestTemplate=t,(0,i.Gn)(this)}get url(){return this.catalogItem.url}get observedProperties(){return(0,o.A)(this.catalogItem.observableProperties.map(e=>e.identifier))}get procedures(){if(this.catalogItem.filterByProcedures)return(0,o.A)(this.catalogItem.procedures.map(e=>e.identifier))}async perform(){if(void 0===this.url)return;const e={action:"GetFeatureOfInterest",actionClass:"foiRetrieval",parameters:AD({observedProperty:this.observedProperties,procedure:this.procedures})},t=await wD(this.catalogItem,this.url,this.requestTemplate,e);return null==t?void 0:t.GetFeatureOfInterestResponse}}).prototype,"url",[i.EW],Object.getOwnPropertyDescriptor(sD.prototype,"url"),sD.prototype),fD(sD.prototype,"observedProperties",[i.EW],Object.getOwnPropertyDescriptor(sD.prototype,"observedProperties"),sD.prototype),fD(sD.prototype,"procedures",[i.EW],Object.getOwnPropertyDescriptor(sD.prototype,"procedures"),sD.prototype),sD),bD=(fD((lD=class{constructor(e,t){this.catalogItem=e,this.foiIdentifier=t,(0,i.Gn)(this)}get url(){return this.catalogItem.url}get requestTemplate(){return this.catalogItem.requestTemplate||vD.defaultRequestTemplate}get parameters(){const e=this.catalogItem.chartFeatureOfInterestIdentifier,t=this.catalogItem.selectedObservable,r=this.catalogItem.selectedProcedure;if(void 0!==e&&void 0!==r&&void 0!==t)return AD({procedure:r.identifier,observedProperty:t.identifier,featureOfInterest:e})}get temporalFilters(){const e=this.catalogItem.selectedObservable,t=this.catalogItem.selectedProcedure;if(void 0===t||void 0===e)return;const r=t.defaultDuration||e.defaultDuration,i=this.catalogItem.endDate||yt.A.toIso8601(yt.A.now(),0);if(r){let e=function(e,t){const r=parseFloat(t);if(isNaN(r)||0===r)throw new eD.A("Bad duration "+t);const i=new yt.A;let o=yt.A.fromIso8601(e);switch(t.slice(t.length-1)){case"s":o=yt.A.addSeconds(o,r,i);break;case"h":o=yt.A.addHours(o,r,i);break;case"d":o=yt.A.addHours(o,24*r,i);break;case"y":{const e=Math.round(365*r);o=yt.A.addDays(o,e,i);break}default:throw new eD.A('Unknown duration type "'+t+'" (use s, h, d or y)')}return yt.A.toIso8601(o)}(i,"-"+r);return this.catalogItem.startDate&&e<this.catalogItem.startDate&&(e=this.catalogItem.startDate),[{index:1,startDate:e,endDate:i}]}return this.catalogItem.startDate?[{index:1,startDate:this.catalogItem.startDate,endDate:i}]:void 0}async perform(){if(void 0===this.url||void 0===this.parameters)return;const e={action:"GetObservation",actionClass:"core",parameters:this.parameters,temporalFilters:this.temporalFilters},t=await wD(this.catalogItem,this.url,this.requestTemplate,e);return null==t?void 0:t.GetObservationResponse}}).prototype,"url",[i.EW],Object.getOwnPropertyDescriptor(lD.prototype,"url"),lD.prototype),fD(lD.prototype,"requestTemplate",[i.EW],Object.getOwnPropertyDescriptor(lD.prototype,"requestTemplate"),lD.prototype),fD(lD.prototype,"parameters",[i.EW],Object.getOwnPropertyDescriptor(lD.prototype,"parameters"),lD.prototype),fD(lD.prototype,"temporalFilters",[i.EW],Object.getOwnPropertyDescriptor(lD.prototype,"temporalFilters"),lD.prototype),lD),vD=(uD=class e extends((0,l.A)((0,g.A)(nD))){constructor(e,t,r){super(e,t,r),(0,i.Gn)(this),this.strata.set(xt.A.stratumName,new gD(this))}get type(){return"sos"}async forceLoadMetadata(){}async forceLoadTableData(){return!0===this.showAsChart?this.loadChartData():this.loadFeaturesData()}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"0d"}async loadFeaturesData(){const t=new yD(this,this.requestTemplate||e.defaultRequestTemplate),r=await t.perform();if(void 0===r)return[];const o=(0,i.h5)(()=>this.name||"");if(void 0===r.featureMember)throw new At.Ay({sender:this,title:o,message:Pe.Ay.t("models.sensorObservationService.unknownFormat")});let n=Array.isArray(r.featureMember)?r.featureMember:[r.featureMember];const a=(0,i.h5)(()=>this.stationIdWhitelist);a&&(n=n.filter(e=>{var t;return(null===(t=e.MonitoringPoint)||void 0===t?void 0:t.identifier)&&a.indexOf(String(e.MonitoringPoint.identifier))>=0}));const s=(0,i.h5)(()=>this.stationIdBlacklist);s&&(n=n.filter(e=>e.MonitoringPoint&&s.indexOf(String(e.MonitoringPoint.identifier))<0));const l=["identifier"],c=["lat"],u=["lon"],p=["name"],d=["id"],h=["type"],m=["chart"];return n.forEach(e=>{var t,r,i;const o=null===(t=e.MonitoringPoint)||void 0===t||null===(t=t.shape)||void 0===t?void 0:t.Point;if(!o)throw new eD.A("Non-point feature not shown. You may want to implement `representAsGeoJson`. "+JSON.stringify(o));if(!e.MonitoringPoint)return;if(null===(r=o.pos)||void 0===r||!r.split)return;if(!e.MonitoringPoint.identifier)return;const[n,a]=o.pos.split(" "),s=e.MonitoringPoint.identifier,f=e.MonitoringPoint.name,g=e.MonitoringPoint["gml:id"],y=null===(i=e.MonitoringPoint.type)||void 0===i?void 0:i["xlink:href"],b=function(e,t){const r=void 0===t?"":'name="'.concat(t,'"');return'<sos-chart identifier="'.concat(e,'" ').concat(r,' can-download="false"></sos-chart>')}(s,f);l.push(s),c.push(n),u.push(a),p.push(f||""),d.push(g||""),h.push(y||""),m.push(b)}),[l,c,u,p,d,h,m]}async loadChartData(){const e=this.chartFeatureOfInterestIdentifier;if(void 0===e)return[];const t=new bD(this,e),r=await t.perform();return void 0===r?[]:(0,i.h5)(()=>{const e=this.selectedProcedure,t=this.selectedObservable,o=["date"],n=["values"],a=["identifiers"],s=[this.proceduresName],l=[this.observablePropertiesName],c=void 0===r.observationData||Array.isArray(r.observationData)?r.observationData:[r.observationData];return c?(c.map(e=>e.OM_Observation).forEach(r=>{r&&(r=>{var i;let c=null==r||null===(i=r.result)||void 0===i||null===(i=i.MeasurementTimeseries)||void 0===i?void 0:i.point;if(!c)return;Array.isArray(c)||(c=[c]);const u=c.map(e=>e.MeasurementTVP),p=r.featureOfInterest["xlink:href"]||"";o.push(...u.map(e=>"object"==typeof e.time?"":e.time)),n.push(...u.map(e=>"object"==typeof e.value?"":e.value)),a.push(...u.map(e=>p)),s.push(...u.map(t=>e.identifier||"")),l.push(...u.map(e=>t.identifier||""))})(r)}),(0,i.h5)(()=>{const e=this.addObject(C.A.defaults,"columns","values");null==e||e.setTrait(C.A.defaults,"name","values"),null==e||e.setTrait(C.A.defaults,"title",this.valueTitle)}),[o,n,["observations"],a,s,l]):[]})}get valueTitle(){if(void 0===this.selectedObservable||void 0===this.selectedProcedure)return;const e=this.selectedObservable.units||this.selectedProcedure.units;return this.selectedObservable.title+" "+this.selectedProcedure.title+(void 0!==e?" ("+e+")":"")}get selectableDimensions(){return(0,o.A)([...super.selectableDimensions.filter(e=>{var t;return e.id!==(null===(t=this.proceduresSelector)||void 0===t?void 0:t.id)}),this.proceduresSelector,this.observablesSelector])}get proceduresSelector(){const e=super.styleDimensions;if(void 0===e)return;const t=this;return hD(hD({},e),{},{get name(){return t.proceduresName}})}get observablesSelector(){if(0===this.mapItems.length)return;const e=this;return{get id(){return"observables"},get name(){return e.observablePropertiesName},get options(){return(0,o.A)(e.observableProperties.map(e=>{if(e.identifier&&e.title)return{id:e.identifier,name:e.title||e.identifier}}))},get selectedId(){return e.selectedObservableId},setDimensionValue(t,r){e.setTrait(t,"selectedObservableId",r)}}}get selectedObservableId(){var e;return super.selectedObservableId||(null===(e=this.observableProperties[0])||void 0===e?void 0:e.identifier)}get selectedObservable(){return this.observableProperties.find(e=>e.identifier===this.selectedObservableId)}get selectedProcedure(){return this.procedures.find(e=>e.identifier===this.activeTableStyle.id)}},mD(uD,"type","sos"),mD(uD,"defaultRequestTemplate",'<soap12:Envelope xmlns:soap12="http://www.w3.org/2003/05/soap-envelope"\n  xmlns:sos="http://www.opengis.net/sos/2.0"\n  xmlns:wsa="http://www.w3.org/2005/08/addressing"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xmlns:ows="http://www.opengis.net/ows/1.1"\n  xmlns:fes="http://www.opengis.net/fes/2.0"\n  xmlns:gml="http://www.opengis.net/gml/3.2"\n  xmlns:swes="http://www.opengis.net/swes/2.0"\n  xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd"\n>\n    <soap12:Header>\n        <wsa:To>http://www.ogc.org/SOS</wsa:To>\n        <wsa:Action>http://www.opengis.net/def/serviceOperation/sos/{{actionClass}}/2.0/{{action}}</wsa:Action>\n        <wsa:ReplyTo>\n            <wsa:Address>http://www.w3.org/2005/08/addressing/anonymous</wsa:Address>\n        </wsa:ReplyTo>\n    <wsa:MessageID>0</wsa:MessageID>\n    </soap12:Header>\n    <soap12:Body>\n        <sos:{{action}} service="SOS" version="2.0.0">\n            {{#temporalFilters}}\n            <sos:temporalFilter>\n                <fes:During>\n                    <fes:ValueReference>om:phenomenonTime</fes:ValueReference>\n                    <gml:TimePeriod gml:id="tp{{index}}">\n                        <gml:beginPosition>{{startDate}}</gml:beginPosition>\n                        <gml:endPosition>{{endDate}}</gml:endPosition>\n                    </gml:TimePeriod>\n                </fes:During>\n            </sos:temporalFilter>\n            {{/temporalFilters}}\n            {{#parameters}}\n            <sos:{{name}}>{{value}}</sos:{{name}}>\n            {{/parameters}}\n        </sos:{{action}}>\n    </soap12:Body>\n</soap12:Envelope>'),fD((cD=uD).prototype,"forceLoadTableData",[i.XI],Object.getOwnPropertyDescriptor(cD.prototype,"forceLoadTableData"),cD.prototype),fD(cD.prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(cD.prototype,"cacheDuration"),cD.prototype),fD(cD.prototype,"loadFeaturesData",[i.XI],Object.getOwnPropertyDescriptor(cD.prototype,"loadFeaturesData"),cD.prototype),fD(cD.prototype,"loadChartData",[i.XI],Object.getOwnPropertyDescriptor(cD.prototype,"loadChartData"),cD.prototype),fD(cD.prototype,"valueTitle",[i.EW],Object.getOwnPropertyDescriptor(cD.prototype,"valueTitle"),cD.prototype),fD(cD.prototype,"selectableDimensions",[i.$Z],Object.getOwnPropertyDescriptor(cD.prototype,"selectableDimensions"),cD.prototype),fD(cD.prototype,"proceduresSelector",[i.EW],Object.getOwnPropertyDescriptor(cD.prototype,"proceduresSelector"),cD.prototype),fD(cD.prototype,"observablesSelector",[i.EW],Object.getOwnPropertyDescriptor(cD.prototype,"observablesSelector"),cD.prototype),fD(cD.prototype,"selectedObservableId",[i.$Z],Object.getOwnPropertyDescriptor(cD.prototype,"selectedObservableId"),cD.prototype),fD(cD.prototype,"selectedObservable",[i.EW],Object.getOwnPropertyDescriptor(cD.prototype,"selectedObservable"),cD.prototype),fD(cD.prototype,"selectedProcedure",[i.EW],Object.getOwnPropertyDescriptor(cD.prototype,"selectedProcedure"),cD.prototype),cD);async function wD(e,t,r,o){const n=gt().render(r,o),a=await(0,$.A)({url:(0,ie.A)(e,t),responseType:"document",method:"POST",overrideMimeType:"text/xml",data:n,headers:{"Content-Type":"application/soap+xml"}});if(void 0===a)return;const s=(0,eI.A)(a);if(s.Exception){let t=Pe.Ay.t("models.sensorObservationService.unknownError");throw s.Exception.ExceptionText&&(t=Pe.Ay.t("models.sensorObservationService.exceptionMessage",{exceptionText:s.Exception.ExceptionText})),new At.Ay({sender:e,title:(0,i.h5)(()=>e.name||""),message:t})}if(void 0===s.Body)throw new At.Ay({sender:e,title:(0,i.h5)(()=>e.name||""),message:Pe.Ay.t("models.sensorObservationService.missingBody")});return s.Body}function AD(e){return Object.keys(e).reduce((t,r)=>{let i=e[r];return Array.isArray(i)||(i=[i]),0===i.length?t:t.concat((0,o.A)(i.map(e=>void 0===e?void 0:{name:r,value:e})))},[])}var SD;let xD=(0,Re.b)({description:"Creates a group of all layers in the catalog from a url that points to a WFS service.",example:{type:"wfs-group",name:"wfs-group example",url:"https://warehouse.ausseabed.gov.au/geoserver/ows",id:"some unique id for wfs-group example"}})(SD=class extends((0,u.A)(pi.A,je.A,d.A,_e.Ay,ke.A)){})||SD;var OD;function PD(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TD(e){const t=[];return(0,wt.Eo)(e.DefaultSRS)&&t.push(e.DefaultSRS),Array.isArray(e.OtherSRS)?e.OtherSRS.forEach(e=>{(0,wt.Eo)(e)&&t.push(e)}):(0,wt.Eo)(e.OtherSRS)&&t.push(e.OtherSRS),{layerName:e.Name,srsArray:t}}class ID{constructor(e,t){PD(this,"service",void 0),PD(this,"outputTypes",void 0),PD(this,"featureTypes",void 0),PD(this,"srsNames",void 0),this.service=function(e){var t,r,i,o,n,a,s;const l=e.ServiceProvider,c=e.ServiceIdentification,u=null==l||null===(t=l.ServiceContact)||void 0===t||null===(t=t.ContactInfo)||void 0===t?void 0:t.Address;return{Title:null==c?void 0:c.Title,Abstract:null==c?void 0:c.Abstract,Fees:null==c?void 0:c.Fees,AccessConstraints:null==c?void 0:c.AccessConstraints,KeywordList:{Keyword:null==c||null===(r=c.Keywords)||void 0===r?void 0:r.Keyword},ContactInformation:{ContactPersonPrimary:{ContactPerson:null==l||null===(i=l.ServiceContact)||void 0===i?void 0:i.IndividualName,ContactOrganization:null==l?void 0:l.ProviderName},ContactPosition:null==l||null===(o=l.ServiceContact)||void 0===o?void 0:o.PositionName,ContactAddress:{Address:null==u?void 0:u.DeliveryPoint,City:null==u?void 0:u.City,StateOrProvince:null==u?void 0:u.AdministrativeArea,PostCode:null==u?void 0:u.PostalCode,Country:null==u?void 0:u.Country},ContactVoiceTelephone:null==l||null===(n=l.ServiceContact)||void 0===n||null===(n=n.ContactInfo)||void 0===n||null===(n=n.Phone)||void 0===n?void 0:n.Voice,ContactFacsimileTelephone:null==l||null===(a=l.ServiceContact)||void 0===a||null===(a=a.ContactInfo)||void 0===a||null===(a=a.Phone)||void 0===a?void 0:a.Facsimile,ContactElectronicMailAddress:null==l||null===(s=l.ServiceContact)||void 0===s||null===(s=s.ContactInfo)||void 0===s||null===(s=s.Address)||void 0===s?void 0:s.ElectronicMailAddress}}}(t),this.outputTypes=function(e){var t;const r=null===(t=e.OperationsMetadata)||void 0===t||null===(t=t.Operation)||void 0===t||null===(t=t.find(e=>"GetFeature"===e.name))||void 0===t||null===(t=t.Parameter)||void 0===t||null===(t=t.find(e=>"outputFormat"===e.name))||void 0===t?void 0:t.Value;if((0,n.A)(r))return Array.isArray(r)?r:[r]}(t),this.featureTypes=function(e){var t;let r=null===(t=e.FeatureTypeList)||void 0===t?void 0:t.FeatureType;return(0,n.A)(r)?(Array.isArray(r)||(r=[r]),r.map(e=>{var t,r,i;const o=null===(t=e.WGS84BoundingBox)||void 0===t?void 0:t.LowerCorner.split(" "),a=null===(r=e.WGS84BoundingBox)||void 0===r?void 0:r.UpperCorner.split(" ");let s;return(0,n.A)(e.OutputFormats)&&(s=Array.isArray(e.OutputFormats)?e.OutputFormats.map(e=>e.Format):[e.OutputFormats.Format]),{Title:e.Title,Name:e.Name,Abstract:e.Abstract,Keyword:null===(i=e.Keywords)||void 0===i?void 0:i.Keyword,WGS84BoundingBox:{westBoundLongitude:o&&parseFloat(o[0]),southBoundLatitude:o&&parseFloat(o[1]),eastBoundLongitude:a&&parseFloat(a[0]),northBoundLatitude:a&&parseFloat(a[1])},OutputFormats:s}})||[]):[]}(t),this.srsNames=function(e){var t;const r=null===(t=e.FeatureTypeList)||void 0===t?void 0:t.FeatureType;let i=[];var o;return Array.isArray(r)?i=r.map(TD):i.push(TD(null===(o=e.FeatureTypeList)||void 0===o?void 0:o.FeatureType)),i}(t)}findLayer(e){let t=this.featureTypes.find(t=>t.Name===e);if(!t){const r=e.indexOf(":");if(r>=0){const i=e.substring(r+1);t=this.featureTypes.find(e=>e.Name===i)}}return t||(t=this.featureTypes.find(t=>t.Title===e)),t}}OD=ID,PD(ID,"fromUrl",(0,ob.Aj)(e=>(0,ra.A)(e).then(function(t){const r=(0,eI.A)(t);if(!(0,aa.A)(r.ServiceIdentification))throw new At.Ay({title:"Invalid GetCapabilities",message:"The URL ".concat(e," was retrieved successfully but it does not appear to be a valid Web Feature Service (WFS) GetCapabilities document.")+"\n\nEither the catalog file has been set up incorrectly, or the server address has changed."});return new OD(t,r)})));var DD=["Curve","LineString","Point","Polygon","MultiCurve","MultiPoint","MultiSurface","Surface"];function CD(e,t){for(var r=!0,i=0;i<e.childNodes.length;++i){var o=e.childNodes[i];o.nodeType===Node.ELEMENT_NODE&&(r=!1),DD.indexOf(o.localName)>=0||o.hasChildNodes()&&CD(o,t)&&(t[o.localName]=o.textContent)}return r}function ED(e){for(var t,r=0;!(0,aa.A)(t)&&r<e.childNodes.length;++r){var i=e.childNodes[r];if(DD.indexOf(i.localName)>=0)return ga(i);t=ED(i)}return t}var _D,jD,zD,ND,kD,RD,MD,FD,LD,GD,UD,WD,qD,BD,VD;function HD(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function $D(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}const JD=["EPSG:4326","urn:ogc:def:crs:EPSG::4326","urn:x-ogc:def:crs:EPSG:4326","CRS:84","EPSG:4283"],XD=["EPSG:3857","urn:ogc:def:crs:EPSG::3857","urn:x-ogc:def:crs:EPSG:3857","EPSG:900913","urn:ogc:def:crs:EPSG::900913","urn:x-ogc:def:crs:EPSG:900913"];let KD=(_D=(0,Re.b)({description:"Creates a single item in the catalog from url that points to a WFS service.\n  <strong>Note:</strong> <i>Must specify property <b>typeNames</b>.</i>",example:{type:"wfs",name:"wfs example",url:"https://warehouse.ausseabed.gov.au/geoserver/ows",typeNames:"ausseabed:AHO_Reference_Surface__Broome__2023_0_5m_L0_Coverage",id:"some unique id for wfs example"}}),jD=(0,K.A)({type:"string",name:"Type Name(s)",description:"The type name or names to display."}),zD=(0,K.A)({type:"number",name:"Max features",description:"Maximum number of features to display."}),ND=(0,K.A)({type:"string",name:"Srs Name",description:"Spatial Reference System to use. For WFS we prefer WGS 84 (".concat(JD.join(", "),"). With WFS requests it is best to use the urn identifier for the srsName, to enforce lat,long order in returned results.")}),kD=(0,K.A)({type:"string",name:"Output Format",description:"Output format to request for WFS requests. We prefer GeoJSON. We support gml3 and gml3.1.1 but only in EPSG:4326 projection or similar."}),RD=(0,hr.A)({name:"Parameters",description:"Additional parameters to pass to the WFS Server when requesting features."}),MD=(0,Pt.A)({type:Of.A,name:"Style",description:"Styling rules that follow [simplestyle-spec](https://github.com/mapbox/simplestyle-spec)"}),_D((LD=class extends((0,u.A)(Ir.h,pi.A)){constructor(){super(...arguments),HD(this,"typeNames",GD,this),HD(this,"maxFeatures",UD,this),HD(this,"srsName",WD,this),HD(this,"outputFormat",qD,this),HD(this,"parameters",BD,this),HD(this,"style",VD,this)}},GD=$D(LD.prototype,"typeNames",[jD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UD=$D(LD.prototype,"maxFeatures",[zD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),WD=$D(LD.prototype,"srsName",[ND],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qD=$D(LD.prototype,"outputFormat",[kD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BD=$D(LD.prototype,"parameters",[RD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VD=$D(LD.prototype,"style",[MD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),FD=LD))||FD);var ZD,QD,YD;function eC(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tC(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let rC=(ZD=class e extends((0,pt.Ay)(KD)){static async load(t,r){if(!(0,n.A)(t.getCapabilitiesUrl))throw new At.Ay({title:Pe.Ay.t("models.webFeatureServiceCatalogItem.missingUrlTitle"),message:Pe.Ay.t("models.webFeatureServiceCatalogItem.missingUrlMessage")});return(0,n.A)(r)||(r=await ID.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration))),new e(t,r)}constructor(e,t){super(),this.catalogItem=e,this.capabilities=t,eC(this,"hasJsonOutputFormat",e=>(0,n.A)(null==e?void 0:e.find(e=>["json","JSON","application/json"].includes(e)))),(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}get capabilitiesFeatureTypes(){return new Map(this.catalogItem.typeNamesArray.map(e=>[e,this.capabilities&&this.capabilities.findLayer(e)]))}get info(){const e=[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogItem.getCapabilitiesUrl"),content:this.catalogItem.getCapabilitiesUrl})];let t;for(const r of this.capabilitiesFeatureTypes.values()){if(!r||!r.Abstract||(0,Yr.A)(r.Abstract,iC.abstractsToIgnore))continue;const i=1===this.capabilitiesFeatureTypes.size?"":" - ".concat(r.Title),o="".concat(Pe.Ay.t("models.webFeatureServiceCatalogItem.abstract")).concat(i);e.push((0,ut.A)(_e.rt,{name:o,content:r.Abstract})),t=t||r.Abstract}const r=this.capabilities&&this.capabilities.service;return r&&(r&&r.Abstract&&!(0,Yr.A)(r.Abstract,iC.abstractsToIgnore)&&r.Abstract!==t&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogItem.abstract"),content:r.Abstract})),r.AccessConstraints&&!/^none$/i.test(r.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogItem.accessConstraints"),content:r.AccessConstraints}))),e}get infoSectionOrder(){let e=[Pe.Ay.t("models.webFeatureServiceCatalogItem.abstract")];return this.capabilitiesFeatureTypes.size>1&&(e=[],this.capabilitiesFeatureTypes.forEach(t=>{t&&t.Abstract&&!(0,Yr.A)(t.Abstract,iC.abstractsToIgnore)&&e.push("".concat(Pe.Ay.t("models.webFeatureServiceCatalogItem.abstract")," - ").concat(t.Title))})),[Pe.Ay.t("preview.disclaimer"),Pe.Ay.t("description.name"),...e,Pe.Ay.t("preview.datasetDescription"),Pe.Ay.t("preview.serviceDescription"),Pe.Ay.t("models.webFeatureServiceCatalogItem.serviceDescription"),Pe.Ay.t("preview.resourceDescription"),Pe.Ay.t("preview.licence"),Pe.Ay.t("preview.accessConstraints"),Pe.Ay.t("models.webFeatureServiceCatalogItem.accessConstraints"),Pe.Ay.t("preview.author"),Pe.Ay.t("preview.contact"),Pe.Ay.t("models.webFeatureServiceCatalogItem.serviceContact"),Pe.Ay.t("preview.created"),Pe.Ay.t("preview.modified"),Pe.Ay.t("preview.updateFrequency"),Pe.Ay.t("models.webFeatureServiceCatalogItem.getCapabilitiesUrl")]}get rectangle(){const e=[...this.capabilitiesFeatureTypes.values()].filter(n.A);return e.length>0?function(e){const t=e.WGS84BoundingBox;if(t)return{west:t.westBoundLongitude,south:t.southBoundLatitude,east:t.eastBoundLongitude,north:t.northBoundLatitude}}(e[0]):void 0}get isGeoServer(){if(!this.capabilities)return;if(!this.capabilities.service||!this.capabilities.service.KeywordList||!this.capabilities.service.KeywordList.Keyword)return!1;const e=this.capabilities.service.KeywordList.Keyword;return(0,ei.A)(e)?e.indexOf("GEOSERVER")>=0:"GEOSERVER"===e}get outputFormat(){var e,t;const r=this.hasJsonOutputFormat(this.capabilities.outputTypes)||[...this.capabilitiesFeatureTypes.values()].reduce((e,t)=>e&&this.hasJsonOutputFormat(null==t?void 0:t.OutputFormats),!0),i=new RegExp(".*gml/3.1.1.*|.*gml3.1.1.*");return r?"JSON":null!==(e=null===(t=this.capabilities.outputTypes)||void 0===t?void 0:t.find(e=>i.test(e)))&&void 0!==e?e:"gml3"}get srsName(){var e,t,r,i,o,n,a,s;const l=[...XD,...JD],c=null!==(e=null===(t=this.catalogItem.uri)||void 0===t?void 0:t.query(!0))&&void 0!==e?e:{},u=null!==(r=null!==(i=null!==(o=null!==(n=c.srsName)&&void 0!==n?n:c.crs)&&void 0!==o?o:c.CRS)&&void 0!==i?i:c.srs)&&void 0!==r?r:c.SRS;if(u&&l.includes(u))return u;const p=null===(a=this.capabilities.srsNames)||void 0===a?void 0:a.find(e=>e.layerName===this.catalogItem.typeNamesArray[0]);return null!==(s=null==p?void 0:p.srsArray.find(e=>JD.includes(e)))&&void 0!==s?s:"urn:ogc:def:crs:EPSG::4326"}},tC(ZD.prototype,"capabilitiesFeatureTypes",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"capabilitiesFeatureTypes"),ZD.prototype),tC(ZD.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"info"),ZD.prototype),tC(ZD.prototype,"infoSectionOrder",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"infoSectionOrder"),ZD.prototype),tC(ZD.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"rectangle"),ZD.prototype),tC(ZD.prototype,"isGeoServer",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"isGeoServer"),ZD.prototype),tC(ZD.prototype,"outputFormat",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"outputFormat"),ZD.prototype),tC(ZD.prototype,"srsName",[i.EW],Object.getOwnPropertyDescriptor(ZD.prototype,"srsName"),ZD.prototype),ZD),iC=(YD=class e extends((0,ci.A)((0,Tr.Ay)((0,g.A)(KD)))){constructor(){super(...arguments),eC(this,"_sourceInfoItemNames",[Pe.Ay.t("models.webFeatureServiceCatalogItem.getCapabilitiesUrl")]),(0,i.Gn)(this)}get type(){return e.type}get defaultGetCapabilitiesUrl(){return this.uri?this.uri.clone().setSearch({service:"WFS",version:"1.1.0",request:"GetCapabilities"}).toString():void 0}async createGetCapabilitiesStratumFromParent(e){const t=await rC.load(this,e);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,t)})}async forceLoadMetadata(){if(void 0!==this.strata.get(ci.A.getCapabilitiesStratumName))return;const e=await rC.load(this);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)})}async forceLoadGeojsonData(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);if(!this.uri)throw new At.Ay({sender:this,title:Pe.Ay.t("models.webFeatureServiceCatalogItem.missingUrlTitle"),message:Pe.Ay.t("models.webFeatureServiceCatalogItem.missingUrlMessage",this)});const t=this.typeNamesArray.filter(t=>!(0,n.A)(e.capabilitiesFeatureTypes.get(t)));if(t.length>0)throw new At.Ay({sender:this,title:Pe.Ay.t("models.webFeatureServiceCatalogItem.noLayerFoundTitle"),message:Pe.Ay.t("models.webFeatureServiceCatalogItem.noLayerFoundMessage",{name:(0,s.m)(this),typeNames:t.join(", ")})});const r=this.uri.clone().setSearch((0,Op.A)({service:"WFS",request:"GetFeature",typeName:this.typeNames,version:"1.1.0",outputFormat:this.outputFormat,srsName:this.srsName,maxFeatures:this.maxFeatures},this.parameters)).toString(),i=await(0,Za.A)((0,ie.A)(this,r));if("JSON"===this.outputFormat&&i.startsWith("<")||i.includes("ExceptionReport")){let e;try{var o;e=null===(o=(0,eI.A)(i).Exception)||void 0===o?void 0:o.ExceptionText}catch(e){}const t=(0,n.A)(e)?new At.Ay({sender:this,title:"Exception from service",message:e}):void 0;throw new At.Ay({sender:this,title:Pe.Ay.t("models.webFeatureServiceCatalogItem.missingDataTitle"),message:"".concat(Pe.Ay.t("models.webFeatureServiceCatalogItem.missingDataMessage",{name:(0,s.m)(this)})),originalError:t})}const a="JSON"===this.outputFormat?JSON.parse(i):function(e){"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));for(var t=[],r=e.documentElement.getElementsByTagNameNS("http://www.opengis.net/gml","featureMember"),i=0;i<r.length;++i){var o=r[i],n={};CD(o,n);var a={type:"Feature",geometry:ED(o),properties:n};(0,aa.A)(a.geometry)&&t.push(a)}return{type:"FeatureCollection",crs:{type:"EPSG",properties:{code:"4326"}},features:t}}(i),l=(0,Pr.qX)(a);if(l)return l;throw At.Ay.from("Invalid geojson data - only FeatureCollection and Feature are supported")}get typeNamesArray(){return Array.isArray(this.typeNames)?this.typeNames:this.typeNames?this.typeNames.split(","):[]}get shortReport(){var e;if(void 0!==(null===(e=this.readyData)||void 0===e?void 0:e.features)&&this.readyData.features.length>=this.maxFeatures)return Pe.Ay.t("models.webFeatureServiceCatalogItem.reachedMaxFeatureLimit",this)}},eC(YD,"abstractsToIgnore",["A compliant implementation of WFS","This is the reference implementation of WFS 1.0.0 and WFS 1.1.0, supports all WFS operations including Transaction."]),eC(YD,"type","wfs"),tC((QD=YD).prototype,"typeNamesArray",[i.EW],Object.getOwnPropertyDescriptor(QD.prototype,"typeNamesArray"),QD.prototype),tC(QD.prototype,"shortReport",[i.$Z],Object.getOwnPropertyDescriptor(QD.prototype,"shortReport"),QD.prototype),QD);const oC=iC;var nC;function aC(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let sC=(nC=class e extends((0,pt.Ay)(xD)){static async load(t){if(void 0===t.getCapabilitiesUrl)throw(0,At.mG)({title:Pe.Ay.t("models.webFeatureServiceCatalogGroup.invalidWFSServerTitle"),message:Pe.Ay.t("models.webFeatureServiceCatalogGroup.invalidWFSServerMessage",this)});const r=await ID.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration));return new e(t,r)}constructor(e,t){super(),this.catalogGroup=e,this.capabilities=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}get name(){if(this.capabilities&&this.capabilities.service&&this.capabilities.service.Title)return ti(this.capabilities.service.Title)}get info(){const e=[],t=this.capabilities&&this.capabilities.service;return t&&(t&&t.Abstract&&!(0,Yr.A)(t.Abstract,oC.abstractsToIgnore)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogGroup.abstract"),content:this.capabilities.service.Abstract})),t&&t.AccessConstraints&&!/^none$/i.test(t.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogGroup.accessConstraints"),content:this.capabilities.service.AccessConstraints})),t&&t.Fees&&!/^none$/i.test(t.Fees)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webFeatureServiceCatalogGroup.fees"),content:this.capabilities.service.Fees}))),e}get members(){return(0,o.A)(this.capabilities.featureTypes.map(e=>this.getLayerId(e)))}createMembersFromLayers(){this.capabilities.featureTypes.forEach(e=>this.createMemberFromLayer(e))}createMemberFromLayer(e){const t=this.getLayerId(e);if(!t)return;const r=this.catalogGroup.terria.getModelById(oC,t);let i;void 0===r?(i=new oC(t,this.catalogGroup.terria),this.catalogGroup.terria.addModel(i)):i=r,i.strata.delete(C.A.definition),i.setTrait(C.A.definition,"name",e.Title),i.setTrait(C.A.definition,"url",this.catalogGroup.url),i.setTrait(C.A.definition,"getCapabilitiesUrl",this.catalogGroup.getCapabilitiesUrl),i.setTrait(C.A.definition,"getCapabilitiesCacheDuration",this.catalogGroup.getCapabilitiesCacheDuration),i.setTrait(C.A.definition,"typeNames",e.Name),i.setTrait(C.A.definition,"hideSource",this.catalogGroup.hideSource),i.setTrait(C.A.definition,"isOpenInWorkbench",this.catalogGroup.isOpenInWorkbench),i.setTrait(C.A.definition,"isExperiencingIssues",this.catalogGroup.isExperiencingIssues),i.createGetCapabilitiesStratumFromParent(this.capabilities)}getLayerId(e){if((0,n.A)(this.catalogGroup.uniqueId))return"".concat(this.catalogGroup.uniqueId,"/").concat(e.Name||e.Title)}},aC(nC.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(nC.prototype,"name"),nC.prototype),aC(nC.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(nC.prototype,"info"),nC.prototype),aC(nC.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(nC.prototype,"members"),nC.prototype),aC(nC.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(nC.prototype,"createMembersFromLayers"),nC.prototype),aC(nC.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(nC.prototype,"createMemberFromLayer"),nC.prototype),nC);class lC extends((0,ci.A)((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(xD)))))){get type(){return lC.type}async forceLoadMetadata(){if(void 0!==this.strata.get(ci.A.getCapabilitiesStratumName))return;const e=await sC.load(this);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)})}async forceLoadMembers(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);e&&await(0,De.A)(()=>e.createMembersFromLayers())}get defaultGetCapabilitiesUrl(){return this.uri?this.uri.clone().setSearch({service:"WFS",version:"1.1.0",request:"GetCapabilities"}).toString():void 0}}var cC,uC,pC,dC,hC;!function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(lC,"type","wfs-group");let mC=(cC=(0,Re.b)({description:"Creates a wmts group in the catalog from a url that points to a wmts-group service.",example:{type:"wmts-group",id:"a unique id for wmts-group example",name:"wmts-group example",url:"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/WMTS/1.0.0/WMTSCapabilities.xml",opacity:1}}),uC=(0,K.A)({type:"boolean",name:"Flatten",description:"True to flatten the layers into a single list; false to use the layer hierarchy."}),cC((dC=class extends((0,u.A)(pi.A,je.A,d.A,_e.Ay,ke.A)){constructor(){super(...arguments),function(e,t,r,i){r&&Object.defineProperty(e,"flatten",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,hC,this)}},hC=function(e,t,r,i){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}(dC.prototype,"flatten",[uC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pC=dC))||pC);var fC;function gC(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yC{constructor(e,t){var r,i;this.xml=e,this.json=t,gC(this,"layers",void 0),gC(this,"tileMatrixSets",void 0),this.layers=[],this.tileMatrixSets=[];const o=null===(r=this.json.Contents)||void 0===r?void 0:r.Layer;o&&Array.isArray(o)?this.layers.push(...o):o&&this.layers.push(o);const n=null===(i=this.json.Contents)||void 0===i?void 0:i.TileMatrixSet;n&&Array.isArray(n)?this.tileMatrixSets.push(...n):n&&this.tileMatrixSets.push(n)}get ServiceIdentification(){return this.json.ServiceIdentification}get OperationsMetadata(){return this.json.OperationsMetadata}get ServiceProvider(){return this.json.ServiceProvider}findLayer(e){if(void 0===this.layers)return;let t=this.layers.find(t=>t.Identifier===e||t.Title===e);if(!t){const r=e.indexOf(":");if(r>=0){const i=e.substring(r+1);t=this.layers.find(e=>e.Identifier===i||e.Title===i)}}return t}findTileMatrix(e){if(void 0!==this.tileMatrixSets)return this.tileMatrixSets.find(t=>t.Identifier===e)}}fC=yC,gC(yC,"fromUrl",(0,ob.Aj)(e=>Promise.resolve((0,ra.A)(e)).then(function(t){const r=(0,eI.A)(t);if(!t||!(0,aa.A)(r.ServiceIdentification))throw(0,At.mG)({title:Pe.Ay.t("models.webMapTileServiceCatalogGroup.invalidCapabilitiesTitle"),message:Pe.Ay.t("models.webMapTileServiceCatalogGroup.invalidCapabilitiesMessage",{url:e})});return new fC(t,r)})));var bC,vC,wC,AC,SC,xC,OC,PC,TC,IC,DC,CC,EC,_C,jC,zC,NC,kC,RC,MC,FC,LC,GC,UC,WC,qC,BC,VC,HC,$C=r(56786);function JC(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function XC(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let KC=(bC=(0,K.A)({type:"string",name:"Style Identifier",description:"The identifier of the style."}),vC=(0,K.A)({type:"string",name:"Title",description:"The title of the style."}),wC=(0,K.A)({type:"string",name:"Abstract",description:"The abstract describing the style."}),AC=(0,Pt.A)({type:Um.A,name:"Style Name",description:"The name of the style."}),SC=(0,K.A)({type:"string",name:"Is Default",description:"True if this Style is default; otherwise, false."}),xC=class extends ze.A{constructor(){super(...arguments),JC(this,"identifier",OC,this),JC(this,"title",PC,this),JC(this,"abstract",TC,this),JC(this,"legend",IC,this),JC(this,"isDefault",DC,this)}},OC=XC(xC.prototype,"identifier",[bC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PC=XC(xC.prototype,"title",[vC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TC=XC(xC.prototype,"abstract",[wC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IC=XC(xC.prototype,"legend",[AC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DC=XC(xC.prototype,"isDefault",[SC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xC),ZC=(CC=(0,K.A)({type:"string",name:"Layer Name",description:"The name of the layer for which styles are available."}),EC=(0,Ne.Ay)({type:KC,name:"Styles",description:"The styles available for this layer.",idProperty:"identifier"}),_C=class extends ze.A{constructor(){super(...arguments),JC(this,"layerName",jC,this),JC(this,"styles",zC,this)}},jC=XC(_C.prototype,"layerName",[CC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zC=XC(_C.prototype,"styles",[EC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_C),QC=(NC=(0,Re.b)({description:"Creates a single item in the catalog from a url that points to a wmts service.",example:{type:"wmts",id:"a unique id for wmts example",name:"wmts example",url:"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Boundaries_and_Places/MapServer/WMTS/1.0.0/WMTSCapabilities.xml",layer:"Reference_World_Boundaries_and_Places",opacity:1}}),kC=(0,K.A)({type:"string",name:"Is GeoServer",description:"True if this WMS is a GeoServer; otherwise, false."}),RC=(0,K.A)({type:"string",name:"Layer",description:"The layer to display."}),MC=(0,K.A)({type:"string",name:"Style",description:"The style to use with `Layer`."}),FC=(0,Ne.Ay)({type:ZC,name:"Available Styles",description:"The available styles.",idProperty:"layerName"}),LC=(0,hr.A)({name:"Parameters",description:"Additional parameters to pass to the MapServer when requesting images."}),NC((UC=class extends((0,u.A)(Xi.A,pi.A,Ji.A,d.A,Ki.Ay,_e.Ay,ke.A)){constructor(){super(...arguments),JC(this,"isGeoServer",WC,this),JC(this,"layer",qC,this),JC(this,"style",BC,this),JC(this,"availableStyles",VC,this),JC(this,"parameters",HC,this)}},WC=XC(UC.prototype,"isGeoServer",[kC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qC=XC(UC.prototype,"layer",[RC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BC=XC(UC.prototype,"style",[MC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VC=XC(UC.prototype,"availableStyles",[FC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HC=XC(UC.prototype,"parameters",[LC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GC=UC))||GC);var YC,eE,tE,rE;function iE(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oE(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let nE=(eE=class e extends((0,pt.Ay)(QC)){static async load(t,r){if(!(0,n.A)(t.getCapabilitiesUrl))throw new At.Ay({title:Pe.Ay.t("models.webMapTileServiceCatalogItem.missingUrlTitle"),message:Pe.Ay.t("models.webMapTileServiceCatalogItem.missingUrlMessage")});return(0,n.A)(r)||(r=await yC.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration))),new e(t,r)}constructor(e,t){super(),this.catalogItem=e,this.capabilities=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}get layer(){let e;return void 0!==this.catalogItem.uri&&(e=this.catalogItem.uri.query(!0).layer),e}get info(){const e=[(0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.getCapabilitiesUrl"),content:this.catalogItem.getCapabilitiesUrl})];let t;const r=this.capabilitiesLayer;r&&r.Abstract&&!(0,Yr.A)(r.Abstract,aE.abstractsToIgnore)&&(e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.dataDescription"),content:r.Abstract})),t=r.Abstract);const i=this.capabilities&&this.capabilities.ServiceIdentification;i&&(i.Abstract&&!(0,Yr.A)(i.Abstract,aE.abstractsToIgnore)&&i.Abstract!==t&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.serviceDescription"),content:i.Abstract})),i.AccessConstraints&&!/^none$/i.test(i.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.accessConstraints"),content:i.AccessConstraints})),i.Fees&&!/^none$/i.test(i.Fees)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.fees"),content:i.Fees})));const o=this.capabilities&&this.capabilities.ServiceProvider;return o&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.serviceContact"),content:sE(o)||""})),(0,n.A)(this.catalogItem.tileMatrixSet)||e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogItem.noUsableTileMatrixTitle"),content:Pe.Ay.t("models.webMapTileServiceCatalogItem.noUsableTileMatrixMessage")})),e}get infoSectionOrder(){return[Pe.Ay.t("preview.disclaimer"),Pe.Ay.t("models.webMapTileServiceCatalogItem.noUsableTileMatrixTitle"),Pe.Ay.t("description.name"),Pe.Ay.t("preview.datasetDescription"),Pe.Ay.t("models.webMapTileServiceCatalogItem.dataDescription"),Pe.Ay.t("preview.serviceDescription"),Pe.Ay.t("models.webMapTileServiceCatalogItem.serviceDescription"),Pe.Ay.t("preview.resourceDescription"),Pe.Ay.t("preview.licence"),Pe.Ay.t("preview.accessConstraints"),Pe.Ay.t("models.webMapTileServiceCatalogItem.accessConstraints"),Pe.Ay.t("models.webMapTileServiceCatalogItem.fees"),Pe.Ay.t("preview.author"),Pe.Ay.t("preview.contact"),Pe.Ay.t("models.webMapTileServiceCatalogItem.serviceContact"),Pe.Ay.t("preview.created"),Pe.Ay.t("preview.modified"),Pe.Ay.t("preview.updateFrequency"),Pe.Ay.t("models.webMapTileServiceCatalogItem.getCapabilitiesUrl")]}get shortReport(){return(0,n.A)(this.catalogItem.tileMatrixSet)?void 0:"".concat(Pe.Ay.t("models.webMapTileServiceCatalogItem.noUsableTileMatrixTitle"),": ").concat(Pe.Ay.t("models.webMapTileServiceCatalogItem.noUsableTileMatrixMessage"))}get legends(){var e;const t=null===(e=this.catalogItem.availableStyles.find(e=>{var t;return e.layerName===(null===(t=this.capabilitiesLayer)||void 0===t?void 0:t.Identifier)}))||void 0===e?void 0:e.styles,r=null==t?void 0:t.find(e=>e.identifier===this.catalogItem.style);if((0,n.A)(null==r?void 0:r.legend))return[(0,ut.A)(Um.A,{url:r.legend.url,urlMimeType:r.legend.urlMimeType})]}get capabilitiesLayer(){return this.catalogItem.layer?this.capabilities.findLayer(this.catalogItem.layer):void 0}get availableStyles(){const e=[];if(!this.capabilities)return e;const t=this.capabilitiesLayer;if(!t)return e;const r=t&&t.Style?Array.isArray(t.Style)?t.Style:[t.Style]:[];return e.push({layerName:null==t?void 0:t.Identifier,styles:r.map(e=>{const t=(0,ei.A)(e.LegendURL)?e.LegendURL[0]:e.LegendURL;let r,i;t&&t["xlink:href"]&&(r=new(Ie())(decodeURIComponent(t["xlink:href"])),i=t.Format);const o=r?(0,ut.A)(Um.A,{url:r.toString(),urlMimeType:i}):void 0;return{identifier:e.Identifier,isDefault:e.isDefault,abstract:e.Abstract,legend:o}})}),e}get usableTileMatrixSets(){const e={"urn:ogc:def:wkss:OGC:1.0:GoogleMapsCompatible":{identifiers:["0"],tileWidth:256,tileHeight:256}},t=new Mn.A,r=this.capabilities.tileMatrixSets;if(void 0!==r){for(let i=0;i<r.length;i++){const o=r[i];if(!o.SupportedCRS||!/EPSG.*900913/.test(o.SupportedCRS)&&!/EPSG.*3857/.test(o.SupportedCRS))continue;const a=o.TileMatrix;if(!(0,n.A)(a)||a.length<1)continue;const s=a[0];if(!(0,n.A)(s.TopLeftCorner))continue;const l=s.TopLeftCorner.split(" "),c=parseFloat(l[0]),u=parseFloat(l[1]),p=t.rectangleToNativeRectangle(t.rectangle);if(!(Math.abs(c-p.west)>1||Math.abs(u-p.north)>1)&&(0,aa.A)(o.TileMatrix)&&o.TileMatrix.length>0){const t=o.TileMatrix.map(function(e){return e.Identifier}),r=o.TileMatrix[0];e[o.Identifier]={identifiers:t,tileWidth:r.TileWidth,tileHeight:r.TileHeight}}}return e}}get rectangle(){const e=this.capabilitiesLayer;if(!e)return;const t=e.WGS84BoundingBox;if(t){const e=t.LowerCorner.split(" "),r=t.UpperCorner.split(" ");return{west:parseFloat(e[0]),south:parseFloat(e[1]),east:parseFloat(r[0]),north:parseFloat(r[1])}}}get style(){var e,t,r,i;if(!(0,n.A)(this.catalogItem.layer))return;const o=null===(e=this.availableStyles.find(e=>{var t;return e.layerName===(null===(t=this.capabilitiesLayer)||void 0===t?void 0:t.Identifier)}))||void 0===e?void 0:e.styles;return null!==(t=null==o||null===(r=o.find(e=>e.isDefault))||void 0===r?void 0:r.identifier)&&void 0!==t?t:null==o||null===(i=o[0])||void 0===i?void 0:i.identifier}},iE(eE,"stratumName","wmtsServer"),oE((YC=eE).prototype,"layer",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"layer"),YC.prototype),oE(YC.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"info"),YC.prototype),oE(YC.prototype,"infoSectionOrder",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"infoSectionOrder"),YC.prototype),oE(YC.prototype,"shortReport",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"shortReport"),YC.prototype),oE(YC.prototype,"legends",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"legends"),YC.prototype),oE(YC.prototype,"capabilitiesLayer",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"capabilitiesLayer"),YC.prototype),oE(YC.prototype,"availableStyles",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"availableStyles"),YC.prototype),oE(YC.prototype,"usableTileMatrixSets",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"usableTileMatrixSets"),YC.prototype),oE(YC.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"rectangle"),YC.prototype),oE(YC.prototype,"style",[i.EW],Object.getOwnPropertyDescriptor(YC.prototype,"style"),YC.prototype),YC),aE=(rE=class e extends((0,$i.Ay)((0,ci.A)((0,Ee.A)((0,s.A)((0,g.A)(QC)))))){constructor(){super(...arguments),iE(this,"_sourceInfoItemNames",[Pe.Ay.t("models.webMapTileServiceCatalogItem.getCapabilitiesUrl")]),(0,i.Gn)(this)}get type(){return e.type}async createGetCapabilitiesStratumFromParent(e){const t=await nE.load(this,e);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,t)})}async forceLoadMetadata(){if(void 0!==this.strata.get(ci.A.getCapabilitiesStratumName))return;const e=await nE.load(this);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)})}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"1d"}get imageryProvider(){var e,t,r,i,o;const a=this.strata.get(ci.A.getCapabilitiesStratumName);if(!((0,n.A)(this.layer)&&(0,n.A)(this.url)&&(0,n.A)(a)&&(0,n.A)(this.style)))return;const s=a.capabilitiesLayer,l=null==s?void 0:s.Identifier;if(!(0,n.A)(s)||!(0,n.A)(l))return;let c="image/png";const u=s.Format;u&&-1===(null==u?void 0:u.indexOf("image/png"))&&-1!==(null==u?void 0:u.indexOf("image/jpeg"))&&(c="image/jpeg");const p=s.ResourceURL;let d=new(Ie())(this.url).search("").toString();if(p)if(Array.isArray(p))for(let e=0;e<p.length;e++){const t=p[e];-1===t.format.indexOf(c)&&-1===t.format.indexOf("png")||(d=t.template)}else c!==p.format&&-1===p.format.indexOf("png")||(d=p.template);const h=this.tileMatrixSet;return(0,n.A)(h)?new $C.A({url:(0,ie.A)(this,d),layer:l,style:this.style,tileMatrixSetID:h.id,tileMatrixLabels:h.labels,minimumLevel:null!==(e=this.minimumLevel)&&void 0!==e?e:h.minLevel,maximumLevel:null!==(t=this.maximumLevel)&&void 0!==t?t:h.maxLevel,tileWidth:null!==(r=this.tileWidth)&&void 0!==r?r:h.tileWidth,tileHeight:null!==(i=null!==(o=this.tileHeight)&&void 0!==o?o:this.minimumLevel)&&void 0!==i?i:h.tileHeight,tilingScheme:new Mn.A,format:c,credit:this.attribution}):void 0}get tileMatrixSet(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);if(!this.layer)return;const t=e.capabilitiesLayer;if(!t)return;const r=e.usableTileMatrixSets;let i=[];null!=t&&t.TileMatrixSetLink&&(i=Array.isArray(null==t?void 0:t.TileMatrixSetLink)?[...null==t?void 0:t.TileMatrixSetLink]:[t.TileMatrixSetLink]);let o="urn:ogc:def:wkss:OGC:1.0:GoogleMapsCompatible",n=0,a=0,s=256,l=256,c=[];for(let e=0;e<i.length;e++){const t=i[e].TileMatrixSet;if(r&&r[t]){o=t,c=r[t].identifiers,s=Number(r[t].tileWidth),l=Number(r[t].tileHeight);break}}if(Array.isArray(c)){const e=c.map(e=>{const t=e.lastIndexOf(":");return Math.abs(Number(e.substring(t+1)))});n=e.reduce((e,t)=>t>e?t:e,0),a=e.reduce((e,t)=>t<e?t:e,0)}return{id:o,labels:c,maxLevel:n,minLevel:a,tileWidth:s,tileHeight:l}}forceLoadMapItems(){return Promise.resolve()}get mapItems(){return(0,n.A)(this.imageryProvider)?[{alpha:this.opacity,show:this.show,imageryProvider:this.imageryProvider,clippingRectangle:this.clipToRectangle?this.cesiumRectangle:void 0}]:[]}get defaultGetCapabilitiesUrl(){return this.uri?this.uri.clone().setSearch({service:"WMTS",version:"1.0.0",request:"GetCapabilities"}).toString():void 0}},iE(rE,"abstractsToIgnore",["A compliant implementation of WMTS service.","This is the reference implementation of WMTS 1.0.0"]),iE(rE,"type","wmts"),oE((tE=rE).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(tE.prototype,"cacheDuration"),tE.prototype),oE(tE.prototype,"imageryProvider",[i.EW],Object.getOwnPropertyDescriptor(tE.prototype,"imageryProvider"),tE.prototype),oE(tE.prototype,"tileMatrixSet",[i.EW],Object.getOwnPropertyDescriptor(tE.prototype,"tileMatrixSet"),tE.prototype),oE(tE.prototype,"mapItems",[i.EW],Object.getOwnPropertyDescriptor(tE.prototype,"mapItems"),tE.prototype),tE);function sE(e){let t="";e.ProviderName&&e.ProviderName.length>0&&(t+=e.ProviderName+"<br/>"),e.ProviderSite&&e.ProviderSite["xlink:href"]&&(t+=e.ProviderSite["xlink:href"]+"<br/>");const r=e.ServiceContact;if(r){var i;const e=r.InvidualName;e&&e.length>0&&(t+=e+"<br/>");const o=null===(i=r.ContactInfo)||void 0===i?void 0:i.Address;o&&(0,n.A)(o.ElectronicMailAddress)&&o.ElectronicMailAddress.length>0&&(t+="[".concat(o.ElectronicMailAddress,"](mailto:").concat(o.ElectronicMailAddress,")"))}return t}const lE=aE;var cE;function uE(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let pE=(cE=class e extends((0,pt.Ay)(mC)){static async load(t){if(void 0===t.getCapabilitiesUrl)throw(0,At.mG)({title:Pe.Ay.t("models.webMapTileServiceCatalogGroup.invalidWMTSServerTitle"),message:Pe.Ay.t("models.webMapTileServiceCatalogGroup.invalidWMTSServerMessage",this)});const r=await yC.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration));return new e(t,r)}constructor(e,t){super(),this.catalogGroup=e,this.capabilities=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}get name(){if(this.capabilities&&this.capabilities.ServiceIdentification&&this.capabilities.ServiceIdentification.Title)return ti(this.capabilities.ServiceIdentification.Title)}get info(){const e=[],t=this.capabilities.ServiceIdentification;return(0,n.A)(t)?(t.Abstract&&!(0,Yr.A)(t.Abstract,lE.abstractsToIgnore)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogGroup.abstract"),content:t.Abstract})),t.AccessConstraints&&!/^none$/i.test(t.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogGroup.accessConstraints"),content:t.AccessConstraints})),t.Fees&&!/^none$/i.test(t.Fees)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webMapTileServiceCatalogGroup.fees"),content:t.Fees})),e):e}get members(){return(0,o.A)(this.capabilities.layers.map(e=>this.getLayerId(e)))}createMembersFromLayers(){this.capabilities.layers.forEach(e=>this.createMemberFromLayer(e))}createMemberFromLayer(e){const t=this.getLayerId(e);if(!t)return;const r=this.catalogGroup.terria.getModelById(lE,t);let i;void 0===r?(i=new lE(t,this.catalogGroup.terria),this.catalogGroup.terria.addModel(i)):i=r,i.strata.delete(C.A.definition),i.setTrait(C.A.definition,"name",e.Title),i.setTrait(C.A.definition,"url",this.catalogGroup.url),i.setTrait(C.A.definition,"getCapabilitiesUrl",this.catalogGroup.getCapabilitiesUrl),i.setTrait(C.A.definition,"getCapabilitiesCacheDuration",this.catalogGroup.getCapabilitiesCacheDuration),i.setTrait(C.A.definition,"layer",e.Title),i.setTrait(C.A.definition,"hideSource",this.catalogGroup.hideSource),i.setTrait(C.A.definition,"isOpenInWorkbench",this.catalogGroup.isOpenInWorkbench),i.setTrait(C.A.definition,"isExperiencingIssues",this.catalogGroup.isExperiencingIssues),i.createGetCapabilitiesStratumFromParent(this.capabilities)}getLayerId(e){if((0,n.A)(this.catalogGroup.uniqueId))return"".concat(this.catalogGroup.uniqueId,"/").concat(e.Title||e.Identifier)}},uE(cE.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(cE.prototype,"name"),cE.prototype),uE(cE.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(cE.prototype,"info"),cE.prototype),uE(cE.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(cE.prototype,"members"),cE.prototype),uE(cE.prototype,"createMembersFromLayers",[i.XI],Object.getOwnPropertyDescriptor(cE.prototype,"createMembersFromLayers"),cE.prototype),uE(cE.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(cE.prototype,"createMemberFromLayer"),cE.prototype),cE);class dE extends((0,ci.A)((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(mC)))))){get type(){return dE.type}async forceLoadMetadata(){if(void 0!==this.strata.get(ci.A.getCapabilitiesStratumName))return;const e=await pE.load(this);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)})}async forceLoadMembers(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);e&&await(0,De.A)(()=>e.createMembersFromLayers())}get defaultGetCapabilitiesUrl(){return this.uri?this.uri.clone().setSearch({service:"WMTS",version:"1.0.0",request:"GetCapabilities"}).toString():void 0}}function hE(e){return class extends e{getXml(e,t){return(0,n.A)(t)&&(e=new(Ie())(e).query(t).toString()),(0,ra.A)(e)}postXml(e,t){return(0,$.A)({url:e,method:"POST",data:t,overrideMimeType:"text/xml",responseType:"document"})}}}var mE,fE,gE,yE,bE,vE,wE,AE,SE,xE,OE;function PE(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function TE(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}!function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(dE,"type","wmts-group");let IE=(mE=(0,K.A)({type:"boolean",name:"Execute with HTTP GET",description:"If true, sends a `GET` request to the Execute endpoint instead of the default `POST` request."}),fE=(0,K.A)({type:"boolean",name:"Store supported",description:"Indicates if the output can be stored by the WPS server and be accessed via a URL."}),gE=(0,K.A)({type:"boolean",name:"Status supported",description:"Indicates if Execute operation can return just the status information and perform the actual operation asynchronously."}),yE=(0,K.A)({type:"string",name:"Identifier",description:"The identifier for the process"}),bE=(0,K.A)({type:"boolean",name:"Force convert results to v8",description:"If true, then all results will be converted from v7 to v8. If false, then the `result.version` string will be checked to see if conversion is necessary."}),vE=class extends((0,u.A)(p.A,d.A)){constructor(){super(...arguments),PE(this,"executeWithHttpGet",wE,this),PE(this,"storeSupported",AE,this),PE(this,"statusSupported",SE,this),PE(this,"identifier",xE,this),PE(this,"forceConvertResultsToV8",OE,this)}},wE=TE(vE.prototype,"executeWithHttpGet",[mE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AE=TE(vE.prototype,"storeSupported",[fE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SE=TE(vE.prototype,"statusSupported",[gE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xE=TE(vE.prototype,"identifier",[yE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OE=TE(vE.prototype,"forceConvertResultsToV8",[bE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vE);var DE,CE;function EE(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let _E=(CE=class extends y.A{constructor(e,t){super(e,t),this.catalogFunction=e,EE(this,"type","date"),EE(this,"variant","complex"),EE(this,"clock",void 0),this.clock=t.clock,(0,i.Gn)(this)}get value(){var e;return null!==(e=super.value)&&void 0!==e?e:this.isRequired?this.currentClockDate():void 0}setValue(e,t){super.setValue(e,this.isValidDate(t)?t:void 0)}isValidDate(e){const t=new Date(e);return t instanceof Date&&!isNaN(t.valueOf())}currentClockDate(){const e=this.clock.currentTime,t=new Date(e.toString());return Tw().utc(t.toISOString()).local().format("YYYY-MM-DD")}static formatValueForUrl(e){return JSON.stringify({type:"object",properties:{timestamp:{type:"string",format:"date",date:e}}})}},EE(CE,"type","date"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((DE=CE).prototype,"value",[i.$Z],Object.getOwnPropertyDescriptor(DE.prototype,"value"),DE.prototype),DE);var jE,zE;function NE(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let kE=(zE=class extends y.A{constructor(e,t){super(e,t),this.catalogFunction=e,NE(this,"type","dateTime"),NE(this,"variant","complex"),NE(this,"clock",void 0),this.clock=t.clock,(0,i.Gn)(this)}get value(){var e;return null!==(e=super.value)&&void 0!==e?e:this.isRequired?this.currentClockTime():void 0}setValue(e,t){super.setValue(e,this.isValidDateTime(t)?t:void 0)}isValidDateTime(e){const t=new Date(e);return t instanceof Date&&!isNaN(t.valueOf())}currentClockTime(){const e=this.clock.currentTime,t=new Date(e.toString()),r=Tw().utc(t.toISOString()).local().format("YYYY-MM-DD"),i=Tw().utc(t.toISOString()).local().format("HH:mm");return"".concat(r,"T").concat(i)}static formatValueForUrl(e){return JSON.stringify({type:"object",properties:{timestamp:{type:"string",format:"date-time","date-time":e}}})}},NE(zE,"type","dateTime"),function(e,t,r,i,o){var n={};Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&Object.defineProperty(e,t,n)}((jE=zE).prototype,"value",[i.$Z],Object.getOwnPropertyDescriptor(jE.prototype,"value"),jE.prototype),jE);var RE,ME,FE,LE,GE,UE,WE,qE,BE,VE,HE,$E,JE,XE,KE,ZE,QE=r(96273),YE=r(29655),e_=r(65085),t_=r(17317);function r_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class i_ extends y.A{constructor(e,t){var r;super(e,t),r_(this,"type","rectangle"),r_(this,"crs",void 0),this.crs=null!==(r=t.crs)&&void 0!==r?r:_w.A.TERRIA_CRS}}function o_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r_(i_,"type","rectangle");class n_ extends y.A{constructor(e,t){super(e,t),o_(this,"type","region"),o_(this,"regionProvider",void 0),this.regionProvider=t.regionProvider}}function a_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}o_(n_,"type","region");class s_ extends y.A{constructor(){super(...arguments),a_(this,"type","regionType")}}function l_(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function c_(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}a_(s_,"type","regionType");let u_=(RE=(0,K.A)({type:"string",name:"Input Identifier",description:"WPS input parameter identifier"}),ME=(0,K.A)({type:"string",name:"Input Value",description:"WPS input parameter value"}),FE=(0,K.A)({type:"string",name:"Input Type",description:"WPS input parameter type"}),LE=class extends ze.A{constructor(){super(...arguments),l_(this,"inputIdentifier",GE,this),l_(this,"inputValue",UE,this),l_(this,"inputType",WE,this)}},GE=c_(LE.prototype,"inputIdentifier",[RE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UE=c_(LE.prototype,"inputValue",[ME],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WE=c_(LE.prototype,"inputType",[FE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LE),p_=(qE=(0,Ne.Ay)({type:u_,idProperty:"inputIdentifier",name:"Parameters",description:"Parameter names & values for this result item"}),BE=(0,hr.A)({name:"WPS Response",description:"The WPS response object"}),VE=(0,hr.A)({name:"Geojson features",description:"Geojson feature collection of input features."}),HE=(0,K.A)({type:"string",name:"WPS response URL",description:"WPS response URL"}),$E=class extends((0,u.A)(X.A,IE)){constructor(){super(...arguments),l_(this,"wpsParameters",JE,this),l_(this,"wpsResponse",XE,this),l_(this,"geojsonFeatures",KE,this),l_(this,"wpsResponseUrl",ZE,this)}},JE=c_($E.prototype,"wpsParameters",[qE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XE=c_($E.prototype,"wpsResponse",[BE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KE=c_($E.prototype,"geojsonFeatures",[VE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZE=c_($E.prototype,"wpsResponseUrl",[HE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$E);var d_,h_,m_,f_,g_,y_=r(31479);function b_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function v_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b_(Object(r),!0).forEach(function(t){w_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function w_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A_(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let S_=(h_=class e extends((0,pt.Ay)(p_)){constructor(e){super(),this.item=e,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t)}static async load(t){return new e(t)}get shortReportSections(){return this.item.outputs.map(e=>{let t;return(0,n.A)(e.Data.LiteralData)&&(t=(0,ut.A)(_e.yJ,{name:e.Title,content:O_(e.Title,e.Data.LiteralData)})),t}).filter(n.A)}get featureInfoTemplate(){var e;const t=["#### Inputs\n\n"+(null===(e=this.item.info.find(e=>"Inputs"===e.name))||void 0===e?void 0:e.content),"#### Outputs\n\n"+this.outputsSectionHtml].join("\n\n");return(0,ut.A)(It.e,{template:t})}get outputsSectionHtml(){return'<table class="cesium-infoBox-defaultTable">'+this.item.outputs.reduce((e,t)=>{if(!(0,n.A)(t.Data)||!(0,n.A)(t.Data.LiteralData)&&!(0,n.A)(t.Data.ComplexData))return e;let r="";return(0,n.A)(t.Data.LiteralData)?r=O_(t.Title,t.Data.LiteralData):(0,n.A)(t.Data.ComplexData)&&("text/csv"===t.Data.ComplexData.mimeType?r='<chart can-download="true" hide-buttons="false" title="'+t.Title+"\" data='"+t.Data.ComplexData+'\' styling: "feature-info">':"application/vnd.terriajs.catalog-member+json"===t.Data.ComplexData.mimeType&&(r="Chart "+t.Title+" generated.")),e+'<tr><td style="vertical-align: middle">'+t.Title+"</td><td>"+r+"</td></tr>"},"")+"</table>"}get rectangle(){var e;return null===(e=this.item.geoJsonItem)||void 0===e?void 0:e.rectangle}},w_(h_,"stratumName","wpsLoadable"),A_(d_=h_,"load",[i.XI],Object.getOwnPropertyDescriptor(d_,"load"),d_),A_(d_.prototype,"shortReportSections",[i.EW],Object.getOwnPropertyDescriptor(d_.prototype,"shortReportSections"),d_.prototype),A_(d_.prototype,"featureInfoTemplate",[i.EW],Object.getOwnPropertyDescriptor(d_.prototype,"featureInfoTemplate"),d_.prototype),A_(d_.prototype,"outputsSectionHtml",[i.EW],Object.getOwnPropertyDescriptor(d_.prototype,"outputsSectionHtml"),d_.prototype),A_(d_.prototype,"rectangle",[i.EW],Object.getOwnPropertyDescriptor(d_.prototype,"rectangle"),d_.prototype),d_);dt.A.addLoadStratum(S_.stratumName);let x_=(g_=class e extends(hE((0,J.A)((0,g.A)(p_)))){constructor(){super(...arguments),w_(this,"proxyCacheDuration","1d"),function(e,t,r,i){r&&Object.defineProperty(e,"geoJsonItem",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}(this,0,f_,this),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.webProcessingService.wpsResult")}get executeUrlParameters(){return{service:"WPS",request:"Execute",version:"1.0.0"}}get executeUrl(){if(!(0,n.A)(this.url))return;const e=new(Ie())(this.url).query(this.executeUrlParameters);return(0,ie.A)(this,e.toString(),this.proxyCacheDuration)}async _invoke(){if(!(0,n.A)(this.identifier)||!(0,n.A)(this.executeUrl)||!(0,n.A)(this.wpsParameters))throw"Identifier, executeUrl and wpsParameters must be set";const e=this.identifier,t=this.executeUrl,r=v_(v_({},this.executeUrlParameters),{},{Identifier:(o=e,o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),DataInputs:(0,i.HO)(this.wpsParameters),storeExecuteResponse:(0,i.HO)(this.storeSupported),status:(0,i.HO)(this.statusSupported)});var o;let a;if(this.executeWithHttpGet)a=this.getXml(t,v_(v_({},r),{},{DataInputs:r.DataInputs.map(e=>{let{inputIdentifier:t,inputValue:r}=e;return"".concat(t,"=").concat(r)}).join(";")}));else{const e=gt().render('<?xml version="1.0" encoding="UTF-8"?>\n<wps:Execute version="1.0.0" service="WPS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.opengis.net/wps/1.0.0" xmlns:wfs="http://www.opengis.net/wfs" xmlns:wps="http://www.opengis.net/wps/1.0.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:gml="http://www.opengis.net/gml" xmlns:ogc="http://www.opengis.net/ogc" xmlns:wcs="http://www.opengis.net/wcs/1.1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd">\n  <ows:Identifier>{{Identifier}}</ows:Identifier>\n  <wps:DataInputs>\n{{#DataInputs}}\n    <wps:Input>\n      <ows:Identifier>{{inputIdentifier}}</ows:Identifier>\n      <wps:Data>\n        <wps:{{inputType}}>{{inputValue}}</wps:{{inputType}}>\n      </wps:Data>\n    </wps:Input>\n{{/DataInputs}}\n  </wps:DataInputs>\n  <wps:ResponseForm>\n    <wps:ResponseDocument storeExecuteResponse="{{storeExecuteResponse}}" status="{{status}}"/>\n  </wps:ResponseForm>\n</wps:Execute>\n',r);a=this.postXml(t,e)}const s=await a;if(!s||!s.documentElement||"ExecuteResponse"!==s.documentElement.localName)throw"Invalid XML response for WPS ExecuteResponse";const l=(0,eI.A)(s);return this.checkStatus(l)?((0,i.h5)(()=>this.setTrait(C.A.user,"wpsResponse",l)),!0):((0,i.h5)(()=>this.setTrait(C.A.user,"wpsResponseUrl",l.statusLocation)),!1)}checkStatus(e){const t=e.Status;if(!(0,n.A)(t))throw new At.Ay({sender:this,title:Pe.Ay.t("models.webProcessingService.invalidResponseErrorTitle"),message:Pe.Ay.t("models.webProcessingService.invalidResponseErrorMessage",{name:this.name})});var r;if((0,n.A)(t.ProcessFailed))throw(null===(r=t.ProcessFailed.ExceptionReport)||void 0===r||null===(r=r.Exception)||void 0===r?void 0:r.ExceptionText)||JSON.stringify(t.ProcessFailed);return!!(0,n.A)(t.ProcessSucceeded)}async pollForResults(){if(!(0,n.A)(this.wpsResponseUrl))return!0;const e=this.getXml((0,ie.A)(this,this.wpsResponseUrl,"0d")),t=await e,r=(0,eI.A)(t);return this.checkStatus(r)}async downloadResults(){if((0,n.A)(this.wpsResponseUrl)&&!(0,n.A)(this.wpsResponse)){const e=(0,ie.A)(this,this.wpsResponseUrl,"0d"),t=(0,eI.A)(await this.getXml(e));(0,i.h5)(()=>{this.setTrait(C.A.user,"wpsResponse",t)})}if(!(0,n.A)(this.wpsResponse))return;const e=[],t=(0,i.h5)(()=>this.outputs),r=[];await Promise.all(t.map(async(t,i)=>{if(!t.Data.ComplexData)return;let o=t.Data.ComplexData;if("text/csv"===t.Data.ComplexData.mimeType)o='<collapsible title="'+t.Title+'" open="'+(0===i?"true":"false")+'">',o+='<chart can-download="true" hide-buttons="false" title="'+t.Title+"\" data='"+t.Data.ComplexData.text+'\' styling="histogram"></chart>',o+="</collapsible>";else if("application/vnd.terriajs.catalog-member+json"===t.Data.ComplexData.mimeType){const e=JSON.parse(t.Data.ComplexData.text),i=await this.createCatalogItemFromJson(e);(0,n.A)(i)&&(s.A.isMixedInto(i)&&r.push(i),o="Chart "+t.Title+" generated.")}e.push((0,ut.A)(_e.yJ,{name:t.Title,content:o}))}));const o=(0,i.h5)(()=>this.geojsonFeatures);return(Array.isArray(o)||(0,i.Fq)(o))&&((0,i.h5)(()=>{this.geoJsonItem=new Or.default((0,fl.A)(),this.terria),(0,gi.A)(this.geoJsonItem,C.A.user,{name:"".concat(this.name," Input Features"),forceCesiumPrimitives:!0,geoJsonData:{type:"FeatureCollection",features:o,totalFeatures:this.geojsonFeatures.length}}).logError("Error occurred while updating Input Features GeoJSON model JSON")}),(await this.geoJsonItem.loadMapItems()).throwIfError()),(0,i.h5)(()=>{this.setTrait(C.A.user,"shortReportSections",e)}),r}get mapItems(){return(0,n.A)(this.geoJsonItem)?this.geoJsonItem.mapItems.map(e=>(e.show=this.show,e)):[]}async forceLoadMetadata(){await super.forceLoadMetadata();const e=await S_.load(this);(0,i.h5)(()=>{this.strata.set(S_.stratumName,e)})}async forceLoadMapItems(){if((0,n.A)(this.geoJsonItem)){const e=this.geoJsonItem;(await e.loadMapItems()).throwIfError()}}get outputs(){const e=this.wpsResponse;if(!e||!e.ProcessOutputs||!e.ProcessOutputs.Output)return[];const t=e.ProcessOutputs.Output;return(Array.isArray(t)||(0,i.Fq)(t)?t:[t]).filter(e=>".context"!==e.Identifier&&(0,n.A)(e.Data))}async createCatalogItemFromJson(e){let t=e;return(this.forceConvertResultsToV8||"version"in t&&"string"==typeof t.version&&t.version.startsWith("0"))&&(t=await async function(e){const{convertMember:t,convertCatalog:i}=await r.e(269).then(r.bind(r,269));if("string"==typeof e.type){const{member:r,messages:i}=t(e);if(null===r)throw At.Ay.combine(i.map(e=>At.Ay.from(e.message)),"Error converting v7 item to v8");return r}{const{result:t,messages:r}=i(e);if(null===t)throw At.Ay.combine(r.map(e=>At.Ay.from(e.message)),"Error converting v7 catalog to v8");return t}}(e).catch(e=>{throw e})),(0,y_.A)(Qr.A,this.terria,this.uniqueId||"",C.A.user,v_(v_({},t),{},{id:(0,fl.A)()}),{addModelToTerria:!1}).throwIfError({title:"WPS output error",message:"Failed to create Terria model from WPS output".concat(t.name?": ".concat(t.name):"")})}},w_(g_,"type","wps-result"),f_=A_((m_=g_).prototype,"geoJsonItem",[i.sH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A_(m_.prototype,"executeUrl",[i.EW],Object.getOwnPropertyDescriptor(m_.prototype,"executeUrl"),m_.prototype),A_(m_.prototype,"checkStatus",[i.XI],Object.getOwnPropertyDescriptor(m_.prototype,"checkStatus"),m_.prototype),A_(m_.prototype,"mapItems",[i.$Z],Object.getOwnPropertyDescriptor(m_.prototype,"mapItems"),m_.prototype),A_(m_.prototype,"outputs",[i.EW],Object.getOwnPropertyDescriptor(m_.prototype,"outputs"),m_.prototype),m_);function O_(e,t){return(0,n.A)(t)?t.split(",").reduce(function(r,i){return t.match(/[./](png|jpg|jpeg|gif|svg)/i)?r+'<a href="'+i+'"><img src="'+i+'" alt="'+e+'" /></a>':0===i.indexOf("http:")||0===i.indexOf("https:")?r+'<a href="'+i+'">'+new(Ie())(i).filename()+"</a>":r+i},""):""}var P_,T_;function I_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D_(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let C_=(T_=class extends y.A{get rangeDescription(){return void 0!==this.minimum&&void 0!==this.maximum?": must be between ".concat(this.minimum," to ").concat(this.maximum):void 0!==this.minimum?": at least ".concat(this.minimum):void 0!==this.maximum?": at most ".concat(this.maximum):""}get value(){var e;return null!==(e=super.value)&&void 0!==e?e:this.defaultValue}get isValid(){return void 0===super.value?this.isValidRange:this.isValidRange&&super.isValid}get isValidRange(){let e=void 0!==this.value?this.value:this.defaultValue;return"string"==typeof e&&(e=parseFloat(e)),!(void 0!==this.minimum&&e<this.minimum||void 0!==this.maximum&&e>this.maximum)}constructor(e,t){super(e,t),I_(this,"type","number"),I_(this,"minimum",void 0),I_(this,"maximum",void 0),I_(this,"defaultValue",void 0),(0,i.Gn)(this),this.minimum=t.minimum,this.maximum=t.maximum,this.defaultValue=t.defaultValue}},I_(T_,"type","number"),D_((P_=T_).prototype,"rangeDescription",[i.EW],Object.getOwnPropertyDescriptor(P_.prototype,"rangeDescription"),P_.prototype),D_(P_.prototype,"value",[i.$Z],Object.getOwnPropertyDescriptor(P_.prototype,"value"),P_.prototype),D_(P_.prototype,"isValid",[i.$Z],Object.getOwnPropertyDescriptor(P_.prototype,"isValid"),P_.prototype),P_);var E_,__,j_,z_,N_;function k_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function R_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k_(Object(r),!0).forEach(function(t){M_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function M_(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F_(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let L_=(__=class e extends((0,pt.Ay)(IE)){constructor(e,t){super(),this.item=e,this.processDescription=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.processDescription)}static async load(t){if(!(0,n.A)(t.describeProcessUrl))return;const r=await t.getXml(t.describeProcessUrl);(0,n.A)(r)&&(0,n.A)(r.documentElement)&&"ProcessDescriptions"===r.documentElement.localName||function(e){throw(0,At.mG)({title:Pe.Ay.t("models.webProcessingService.invalidWPSServerTitle"),message:Pe.Ay.t("models.webProcessingService.invalidWPSServerMessage",{name:e.name,endpoint:"DescribeProcess"})})}(t);const i=(0,eI.A)(r);if(!(0,n.A)(i.ProcessDescription))throw(0,At.mG)({sender:this,title:Pe.Ay.t("models.webProcessingService.processDescriptionErrorTitle"),message:Pe.Ay.t("models.webProcessingService.processDescriptionErrorMessage")});return new e(t,i.ProcessDescription)}get inputs(){if(!(0,n.A)(this.processDescription))return[];const e=this.processDescription.DataInputs;if(!(0,n.A)(e)||!(0,n.A)(e.Input))throw(0,At.mG)({sender:this,title:Pe.Ay.t("models.webProcessingService.processInputErrorTitle"),message:Pe.Ay.t("models.webProcessingService.processInputErrorMessage")});return Array.isArray(e.Input)||(0,i.Fq)(e.Input)?e.Input:[e.Input]}get storeSupported(){var e;const t=null===(e=this.processDescription.storeSupported)||void 0===e?void 0:e.toLowerCase();return"true"===t||"false"!==t&&void 0}get statusSupported(){var e;const t=null===(e=this.processDescription.statusSupported)||void 0===e?void 0:e.toLowerCase();return"true"===t||"false"!==t&&void 0}},M_(__,"stratumName","wpsLoadable"),F_(E_=__,"load",[i.XI],Object.getOwnPropertyDescriptor(E_,"load"),E_),F_(E_.prototype,"inputs",[i.EW],Object.getOwnPropertyDescriptor(E_.prototype,"inputs"),E_.prototype),E_);dt.A.addLoadStratum(L_.stratumName);let G_=(j_=(0,i.EW)({keepAlive:!0}),N_=class e extends(hE((0,a.A)((0,g.A)(IE)))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return"Web Processing Service (WPS)"}get cacheDuration(){return(0,n.A)(super.cacheDuration)?super.cacheDuration:"0d"}get describeProcessUrl(){if(!(0,n.A)(this.url)||!(0,n.A)(this.identifier))return;const e=new(Ie())(this.url).query({service:"WPS",request:"DescribeProcess",version:"1.0.0",Identifier:this.identifier});return(0,ie.A)(this,e.toString())}async forceLoadMetadata(){if(!this.strata.has(L_.stratumName)){const e=await L_.load(this);(0,n.A)(e)&&(0,i.h5)(()=>{this.strata.set(L_.stratumName,e)})}}get functionParameters(){const e=this.strata.get(L_.stratumName);return(0,n.A)(e)?e.inputs.map(e=>{const t=this.convertInputToParameter(this,e);if((0,n.A)(t))return t;throw new At.Ay({sender:this,title:"Unsupported parameter type",message:"The parameter '".concat(e.Identifier,"' is not a supported type of parameter.")})}):[]}async createJob(e){const t=new x_(e,this.terria),r=(0,o.A)(await Promise.all(this.functionParameters.filter(e=>(0,n.A)(e.value)&&null!==e.value).map(e=>this.convertParameterToInput(e))));return(0,i.h5)(()=>(0,gi.A)(t,C.A.user,{name:"WPS: ".concat(this.name||this.identifier||this.uniqueId," result ").concat((new Date).toISOString()),geojsonFeatures:(0,YT.A)(this.functionParameters.map(e=>(0,QE.B)(e)?e.geoJsonFeature:void 0).filter(n.A)),url:this.url,identifier:this.identifier,executeWithHttpGet:this.executeWithHttpGet,statusSupported:this.statusSupported,storeSupported:this.storeSupported,wpsParameters:r,forceConvertResultsToV8:this.forceConvertResultsToV8})).raiseError(this.terria,"Error ocurred while updating job model JSON"),t}convertInputToParameter(e,t){if(!(0,n.A)(t.Identifier))return;const r=(0,n.A)(t.minOccurs)&&t.minOccurs>0;for(let i=0;i<K_.length;i++){const o=K_[i].inputToParameter(e,t,{id:t.Identifier,name:t.Title,description:t.Abstract,isRequired:r});if((0,n.A)(o))return o}}async convertParameterToInput(e){const t=function(e){switch(e.type){case v.type:case G.type:case j.type:return U_;case _E.type:return"literal"===e.variant?U_:W_;case kE.type:return"literal"===e.variant?U_:q_;case e_.A.type:return B_;case YE.A.type:return V_;case t_.A.type:return H_;case i_.type:return $_;case QE.A.type:return J_}}(e),r=null==t?void 0:t.parameterToInput(e);if(!(0,n.A)(r))return;const i=await Promise.resolve(r.inputValue);return(0,n.A)(i)?{inputIdentifier:e.id,inputValue:i,inputType:r.inputType}:void 0}},M_(N_,"type","wps"),F_((z_=N_).prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(z_.prototype,"cacheDuration"),z_.prototype),F_(z_.prototype,"describeProcessUrl",[i.EW],Object.getOwnPropertyDescriptor(z_.prototype,"describeProcessUrl"),z_.prototype),F_(z_.prototype,"functionParameters",[j_],Object.getOwnPropertyDescriptor(z_.prototype,"functionParameters"),z_.prototype),z_);const U_={inputToParameter:function(e,t,r){if(!(0,n.A)(t.LiteralData))return;const o=t.LiteralData.AllowedValues||t.LiteralData.AllowedValue;if((0,n.A)(o)&&(0,n.A)(o.Value))return new j(e,R_(R_({},r),{},{options:(Array.isArray(o.Value)||(0,i.Fq)(o.Value)?o.Value:[o.Value]).map(e=>({id:e}))}));if((0,n.A)(o)&&(0,n.A)(o.Range)){const i=new C_(e,R_({},r));return i.minimum=(0,n.A)(o.Range.MinimumValue)?o.Range.MinimumValue:i.minimum,i.maximum=o.Range.MaximumValue,i.defaultValue=(0,n.A)(t.LiteralData.DefaultValue)?t.LiteralData.DefaultValue:i.minimum,i}if((0,n.A)(t.LiteralData.AnyValue)){var a;let i=null;if((0,n.A)(t.LiteralData.dataType)?i=t.LiteralData.dataType:(0,n.A)(t.LiteralData.DataType)&&("string"==typeof t.LiteralData.DataType?i=t.LiteralData.DataType:(0,n.A)(t.LiteralData.DataType["ows:reference"])?i=t.LiteralData.DataType["ows:reference"]:(0,n.A)(t.LiteralData.DataType.text)&&(i=t.LiteralData.DataType.text)),null!==i&&0===i.indexOf("http://www.w3.org/TR/xmlschema-2/#")&&(i=i.substring(i.lastIndexOf("#")+1).toLowerCase()),"string"===i)return new G(e,R_({},r));if("boolean"===i)return new v(e,R_({},r));if("date"===i){const t=new _E(e,R_(R_({},r),{},{clock:e.terria.timelineClock}));return t.variant="literal",t}if("datetime"===(null===(a=i)||void 0===a?void 0:a.toLowerCase())){const t=new kE(e,R_(R_({},r),{},{clock:e.terria.timelineClock}));return t.variant="literal",t}return new G(e,R_({},r))}},parameterToInput:function(e){return{inputValue:e.value,inputType:"LiteralData"}}},W_={inputToParameter:function(e,t,r){if(!((0,n.A)(t.ComplexData)&&(0,n.A)(t.ComplexData.Default)&&(0,n.A)(t.ComplexData.Default.Format)&&(0,n.A)(t.ComplexData.Default.Format.Schema)))return;if("http://www.w3.org/TR/xmlschema-2/#date"!==t.ComplexData.Default.Format.Schema)return;const i=new _E(e,R_(R_({},r),{},{clock:e.terria.timelineClock}));return i.variant="complex",i},parameterToInput:function(e){var t;return{inputType:"ComplexData",inputValue:_E.formatValueForUrl((null==e||null===(t=e.value)||void 0===t?void 0:t.toString())||"")}}},q_={inputToParameter:function(e,t,r){if(!((0,n.A)(t.ComplexData)&&(0,n.A)(t.ComplexData.Default)&&(0,n.A)(t.ComplexData.Default.Format)&&(0,n.A)(t.ComplexData.Default.Format.Schema)))return;if("http://www.w3.org/TR/xmlschema-2/#dateTime"!==t.ComplexData.Default.Format.Schema)return;const i=new kE(e,R_(R_({},r),{},{clock:e.terria.timelineClock}));return i.variant="complex",i},parameterToInput:function(e){var t;return{inputType:"ComplexData",inputValue:kE.formatValueForUrl((null==e||null===(t=e.value)||void 0===t?void 0:t.toString())||"")}}},B_=X_("point",e_.A),V_=X_("linestring",YE.A),H_=X_("polygon",t_.A),$_={inputToParameter:function(e,t,r){if(!(0,n.A)(t.BoundingBoxData)||!(0,n.A)(t.BoundingBoxData.Default)||!(0,n.A)(t.BoundingBoxData.Default.CRS))return;let i=_w.A.crsStringToCode(t.BoundingBoxData.Default.CRS),o=t.BoundingBoxData.Default.CRS;if(i!==_w.A.TERRIA_CRS&&(0,n.A)(t.BoundingBoxData.Supported)&&(0,n.A)(t.BoundingBoxData.Supported.CRS))for(let e=0;e<t.BoundingBoxData.Supported.CRS.length;e++)if(_w.A.crsStringToCode(t.BoundingBoxData.Supported.CRS[e])===_w.A.TERRIA_CRS){i=_w.A.TERRIA_CRS,o=t.BoundingBoxData.Supported.CRS[e];break}return(0,n.A)(i)?new i_(e,R_(R_({},r),{},{crs:o})):void 0},parameterToInput:function(e){const t=e,r=t.value;if(!(0,n.A)(r))return;let i,o,a,s,l;return-1!==t.crs.indexOf("crs84")?(i=r.west,o=r.south,a=r.east,s=r.north,l="urn:ogc:def:crs:OGC:1.3:CRS84"):(i=r.south,o=r.west,a=r.north,s=r.east,l="urn:ogc:def:crs:EPSG:6.6:4326"),{inputType:"BoundingBoxData",inputValue:i+","+o+","+a+","+s+","+l}}},J_={inputToParameter:function(e,t,r){if(!((0,n.A)(t.ComplexData)&&(0,n.A)(t.ComplexData.Default)&&(0,n.A)(t.ComplexData.Default.Format)&&(0,n.A)(t.ComplexData.Default.Format.Schema)))return;if(0!==t.ComplexData.Default.Format.Schema.indexOf("http://geojson.org/geojson-spec.html#"))return;const i=new s_(e,{id:"regionType",name:"Region Type",description:"The type of region to analyze."}),o=new n_(e,{id:"regionParameter",name:"Region Parameter",regionProvider:i});return new QE.A(e,R_(R_({},r),{},{regionParameter:o}))},parameterToInput:function(e){if((0,n.A)(e.value)&&null!==e.value)return e.getProcessedValue(e.value)}};function X_(e,t){return{inputToParameter:function(r,i,o){if(!((0,n.A)(i.ComplexData)&&(0,n.A)(i.ComplexData.Default)&&(0,n.A)(i.ComplexData.Default.Format)&&(0,n.A)(i.ComplexData.Default.Format.Schema)))return;const a=i.ComplexData.Default.Format.Schema;return 0===a.indexOf("http://geojson.org/geojson-spec.html#")&&a.substring(a.lastIndexOf("#")+1)===e?new t(r,o):void 0},parameterToInput:function(e){return{inputType:"ComplexData",inputValue:t.formatValueForUrl(e.value)}}}}const K_=[U_,W_,q_,B_,V_,H_,$_,J_];class Z_ extends((0,u.A)(d.A,je.A,pi.A,_e.Ay,ke.A)){}class Q_{constructor(e,t){this.capabilitiesXml=e,this.capabilities=t}static fromUrl(e){return Promise.resolve((0,ra.A)(e)).then(function(t){const r=function(e){var t;if(!(0,wt.OW)(e))return;const r=function(e){if(!(0,wt.OW)(e))return;const t=(0,wt.Eo)(e.ServiceType)?e.ServiceType:void 0,r=(0,wt.Eo)(e.ServiceTypeVersion)?[e.ServiceTypeVersion]:Array.isArray(e.ServiceTypeVersion)?(0,o.A)(e.ServiceTypeVersion.map(e=>(0,wt.Eo)(e)?e:void 0)):void 0;if(void 0===t||void 0===r||0===r.length)return;const i=(0,wt.Eo)(e.Title)?e.Title:void 0,n=(0,wt.Eo)(e.Abstract)?e.Abstract:void 0,a=(0,wt.Eo)(e.Fees)?e.Fees:void 0,s=(0,wt.Eo)(e.AccessConstraints)?e.AccessConstraints:void 0,l=function(e){if((0,wt.OW)(e))return{type:(0,wt.Eo)(e.type)?e.type:void 0,Keyword:(0,wt.Eo)(e.Keyword)?e.Keyword:Array.isArray(e.Keyword)?(0,o.A)(e.Keyword.map(e=>(0,wt.Eo)(e)?e:void 0)):[]}}(e);return{ServiceType:t,ServiceTypeVersion:r,Title:i,Abstract:n,Fees:a,AccessConstraints:s,Keywords:l}}(e.ServiceIdentification);if(void 0===r)return;const i=function(e){if(!(0,wt.OW)(e))return;const t=(0,wt.Eo)(e.ProviderName)?e.ProviderName:void 0,r=function(e){if(!(0,wt.OW)(e))return;const t=(0,wt.Eo)(e["xlink:href"])?e["xlink:href"]:void 0;return void 0!==t?{"xlink:type":(0,wt.Eo)(e["xlink:type"])?e["xlink:type"]:void 0,"xlink:href":t}:void 0}(e.OnlineResource);return{ProviderName:t,ProviderSite:r}}(e.ServiceProvider),n=null!==(t=function(e){if(!(0,wt.OW)(e))return;const t=Array.isArray(e.Process)?e.Process:(0,wt.OW)(e.Process)?[e.Process]:[];return(0,o.A)(t.map(Y_))}(e.ProcessOfferings))&&void 0!==t?t:[];return{ServiceIdentification:r,ServiceProvider:i,ProcessOfferings:n}}((0,eI.A)(t));if(void 0===t||void 0===r)throw(0,At.mG)({title:Pe.Ay.t("models.webProcessingServiceCatalogGroup.invalidCapabilitiesTitle"),message:Pe.Ay.t("models.webProcessingServiceCatalogGroup.invalidCapabilitiesMessage",{url:e})});return new Q_(t,r)})}get ServiceIdentification(){return this.capabilities.ServiceIdentification}get ServiceProvider(){return this.capabilities.ServiceProvider}get ProcessOfferings(){return this.capabilities.ProcessOfferings}}function Y_(e){if((0,wt.OW)(e)&&(0,wt.Eo)(e.Identifier))return{Identifier:e.Identifier,Title:(0,wt.Eo)(e.Title)?e.Title:void 0,Abstract:(0,wt.Eo)(e.Abstract)?e.Abstract:void 0}}var ej,tj,rj;function ij(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let oj=(ej=class e extends((0,pt.Ay)(Z_)){constructor(e,t){super(),this.model=e,this.capabilities=t,(0,i.Gn)(this)}duplicateLoadableStratum(t){return new e(t,this.capabilities)}static async load(t){if(void 0===t.getCapabilitiesUrl)throw new At.Ay({title:Pe.Ay.t("models.webProcessingServiceCatalogGroup.missingUrlTitle"),message:Pe.Ay.t("models.webProcessingServiceCatalogGroup.missingUrlMessage")});const r=await Q_.fromUrl((0,ie.A)(t,t.getCapabilitiesUrl,t.getCapabilitiesCacheDuration));return new e(t,r)}get name(){const e=this.capabilities.ServiceIdentification.Title;if(void 0!==e)return ti(e)}get info(){const e=[],t=this.capabilities.ServiceIdentification;t.Abstract&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webProcessingServiceCatalogGroup.abstract"),content:t.Abstract})),t.AccessConstraints&&!/^none$/i.test(t.AccessConstraints)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webProcessingServiceCatalogGroup.accessConstraints"),content:t.AccessConstraints})),t.Fees&&!/^none$/i.test(t.Fees)&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webProcessingServiceCatalogGroup.fees"),content:t.Fees}));const r=this.capabilities.ServiceProvider;var i;return r&&(r.ProviderName&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webProcessingServiceCatalogGroup.providerName"),content:r.ProviderName})),null!==(i=r.ProviderSite)&&void 0!==i&&i["xlink:href"]&&e.push((0,ut.A)(_e.rt,{name:Pe.Ay.t("models.webProcessingServiceCatalogGroup.providerSite"),content:r.ProviderSite["xlink:href"]}))),e}get members(){var e,t;return(0,o.A)(null!==(e=null===(t=this.capabilities.ProcessOfferings)||void 0===t?void 0:t.map(e=>this.getProcessId(e)))&&void 0!==e?e:[])}getProcessId(e){if(void 0!==this.model.uniqueId)return"".concat(this.model.uniqueId,"/").concat(e.Identifier)}createMembersForProcesses(){var e;null===(e=this.capabilities.ProcessOfferings)||void 0===e||e.forEach(e=>this.createMemberForProcess(e))}createMemberForProcess(e){const t=this.getProcessId(e);if(void 0===t)return;const r=this.getOrCreateWPSCatalogFunction(t);r.strata.delete(C.A.definition),r.setTrait(C.A.definition,"name",e.Title),r.setTrait(C.A.definition,"url",this.model.url),r.setTrait(C.A.definition,"identifier",e.Identifier),r.setTrait(C.A.definition,"description",e.Abstract)}getOrCreateWPSCatalogFunction(e){const t=this.model.terria,r=t.getModelById(G_,e);if(void 0!==r)return r;const i=new G_(e,t);return t.addModel(i),i}},ij(ej,"load",[i.XI],Object.getOwnPropertyDescriptor(ej,"load"),ej),ij(ej.prototype,"name",[i.EW],Object.getOwnPropertyDescriptor(ej.prototype,"name"),ej.prototype),ij(ej.prototype,"info",[i.EW],Object.getOwnPropertyDescriptor(ej.prototype,"info"),ej.prototype),ij(ej.prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(ej.prototype,"members"),ej.prototype),ij(ej.prototype,"createMemberForProcess",[i.XI],Object.getOwnPropertyDescriptor(ej.prototype,"createMemberForProcess"),ej.prototype),ej),nj=(rj=class e extends((0,Ce.A)((0,ci.A)((0,Ee.A)((0,s.A)((0,g.A)(Z_)))))){constructor(){super(...arguments),(0,i.Gn)(this)}get type(){return e.type}get typeName(){return Pe.Ay.t("models.webProcessingServiceCatalogGroup.typeName")}async forceLoadMetadata(){const e=await oj.load(this);(0,i.h5)(()=>{this.strata.set(ci.A.getCapabilitiesStratumName,e)})}async forceLoadMembers(){const e=this.strata.get(ci.A.getCapabilitiesStratumName);e&&await(0,De.A)(()=>e.createMembersForProcesses())}get defaultGetCapabilitiesUrl(){return void 0===this.url?void 0:new(Ie())(this.url).search({service:"WPS",request:"GetCapabilities",version:"1.0.0"}).toString()}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(rj,"type","wps-getCapabilities"),ij((tj=rj).prototype,"defaultGetCapabilitiesUrl",[i.EW],Object.getOwnPropertyDescriptor(tj.prototype,"defaultGetCapabilitiesUrl"),tj.prototype),tj);var aj,sj,lj,cj,uj,pj,dj,hj,mj,fj,gj,yj,bj,vj,wj,Aj,Sj;function xj(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Oj(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let Pj=(aj=(0,K.A)({type:"string",name:"Find",description:"String to find"}),sj=(0,K.A)({type:"string",name:"Replace",description:"String to replace with"}),lj=class extends ze.A{constructor(){super(...arguments),xj(this,"find",cj,this),xj(this,"replace",uj,this)}},cj=Oj(lj.prototype,"find",[aj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uj=Oj(lj.prototype,"replace",[sj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lj),Tj=(pj=(0,K.A)({type:"string",name:"ID",description:"Concept ID (full URN form - urn:sdmx:org.sdmx.infomodel.conceptscheme.Concept=ABS:CS_C16_COMMON(1.0.0).REGION)"}),dj=(0,K.A)({type:"string",name:"Type",description:"Override concept/dimension type - Possible values are:\n      - 'region': values contain region codes used for region mapping - eg Country code)\n      - 'region-type': values contains region types - eg 'CNT2' which is 2-letter country codes)\n      - 'unit-measure': values should be used to describe primary-measure (eg in chart title)\n      - 'unit-multiplier': multiply primary-measure value by atrtibute values\n      - 'frequency': value used to determine time period frequency (ie. yearly, monthly...)"}),hj=(0,K.A)({type:"string",name:"Region type",description:"If `type` has been specified as 'region', you can also manually specify the region type (eg SA2 for ABS Statistical Area 2)"}),mj=(0,Ne.Ay)({type:Pj,idProperty:"index",name:"Region type",description:"If `type` has been specified as 'region' and this dataflow contains multiple regionTypes - you can add a map to correct automatically detected region types. For example: setting `regionTypeReplacements = [{find: 'SA1_2016', replace: 'SA1_2011'}]` will replace `regionType` with `SA1_2011` if it was `SA1_2016`"}),fj=class extends((0,u.A)(Ot.A)){constructor(){super(...arguments),xj(this,"id",gj,this),xj(this,"type",yj,this),xj(this,"regionType",bj,this),xj(this,"regionTypeReplacements",vj,this)}},gj=Oj(fj.prototype,"id",[pj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),yj=Oj(fj.prototype,"type",[dj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bj=Oj(fj.prototype,"regionType",[hj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vj=Oj(fj.prototype,"regionTypeReplacements",[mj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fj),Ij=(wj=(0,Ne.Ay)({type:Tj,idProperty:"id",name:"Concept overrides",description:"This provides ability to override Dataflow dimensions by concept or codelist ID (full URN). For example, setting a default value for a given concept. Codelist overrides take priority over concept overrides. TODO add example"}),Aj=class extends((0,u.A)(d.A,_e.Ay,ke.A,je.A)){constructor(){super(...arguments),xj(this,"modelOverrides",Sj,this)}},Sj=Oj(Aj.prototype,"modelOverrides",[wj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aj);var Dj;let Cj=(0,Re.b)({description:"Creates one catalog group from url that points to an sdmx service.",example:{id:"some unique id",type:"sdmx-group",name:"sdmx-group example",url:"https://api.data.abs.gov.au",mergeGroupsByName:!0}})(Dj=class extends((0,u.A)(Ij,d.A,_e.Ay,ke.A,je.A)){})||Dj;var Ej,_j,jj,zj,Nj,kj,Rj,Mj,Fj,Lj,Gj,Uj,Wj,qj,Bj=r(92065);function Vj(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function Hj(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let $j=(Ej=(0,K.A)({type:"string",name:"Position",description:"The position attribute specifies the position of the dimension in the data structure definition, starting at 0. This is important for making sdmx-csv requests"}),_j=class extends((0,u.A)(Ot.A)){constructor(){super(...arguments),Vj(this,"position",jj,this)}},jj=Hj(_j.prototype,"position",[Ej],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_j),Jj=(zj=(0,Re.b)({description:"Creates one catalog item from url that points to an sdmx service.",example:{type:"sdmx-json",url:"https://api.data.abs.gov.au",dataflowId:"ABS_REGIONAL_LGA2017",name:"sdmx-json example",agencyId:"ABS",id:"some unique id"}}),Nj=(0,K.A)({type:"string",name:"Dataflow ID",description:"SDMX Dataflow ID"}),kj=(0,K.A)({type:"string",name:"Agency ID",description:"SDMX Agency ID"}),Rj=(0,K.A)({type:"string",name:"Unit Measure",description:"This string is essentially 'units' for the dataset. If a UNIT_MEASURE SDMX attribute exists in this dataflow, the default `unitMeasure` will be determined from it."}),Mj=(0,Ne.Ay)({type:$j,name:"Dimensions",description:"Dimensions",idProperty:"id"}),zj((Lj=class extends((0,u.A)(Ij,d.A,Dt.A,It.A)){constructor(){super(...arguments),Vj(this,"dataflowId",Gj,this),Vj(this,"agencyId",Uj,this),Vj(this,"unitMeasure",Wj,this),Vj(this,"dimensions",qj,this)}},Gj=Hj(Lj.prototype,"dataflowId",[Nj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uj=Hj(Lj.prototype,"agencyId",[kj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wj=Hj(Lj.prototype,"unitMeasure",[Rj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qj=Hj(Lj.prototype,"dimensions",[Mj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fj=Lj))||Fj);var Xj,Kj,Zj=r(166),Qj=r(31092);function Yj(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}let ez=(Kj=class e extends((0,pt.Ay)(Jj)){duplicateLoadableStratum(t){return new e(t,this.sdmxJsonDataflow)}static async load(t){const r=await uz((0,ie.A)(t,"".concat(t.baseUrl,"/dataflow/").concat(t.agencyId,"/").concat(t.dataflowId,"?references=all")),!1);if(!(0,n.A)(r.data))throw(0,At.mG)({title:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorTitle"),message:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorMessage.invalidResponse")});if(!Array.isArray(r.data.dataflows)||0===r.data.dataflows.length)throw(0,At.mG)({title:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorTitle"),message:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorMessage.noDataflow",this)});if(!Array.isArray(r.data.dataStructures)||0===r.data.dataStructures.length)throw(0,At.mG)({title:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorTitle"),message:Pe.Ay.t("models.sdmxJsonDataflowStratum.loadDataErrorMessage.noDatastructure",this)});return new e(t,{dataflow:r.data.dataflows[0],dataStructure:r.data.dataStructures[0],codelists:r.data.codelists,conceptSchemes:r.data.conceptSchemes,contentConstraints:r.data.contentConstraints})}constructor(e,t){super(),this.catalogItem=e,this.sdmxJsonDataflow=t,(0,i.Gn)(this)}get description(){return this.sdmxJsonDataflow.dataflow.description}get metadataUrls(){var e,t;return(0,o.A)(null!==(e=null===(t=this.sdmxJsonDataflow)||void 0===t||null===(t=t.dataflow.annotations)||void 0===t?void 0:t.filter(e=>"EXT_RESOURCE"===e.type&&e.text).map(e=>{var t,r;const i=null!==(t=null===(r=e.texts)||void 0===r?void 0:r[Pe.Ay.language])&&void 0!==t?t:e.text,o=i.includes("|")?i.split("|")[0]:void 0,n=i.includes("|")?i.split("|")[1]:i;return(0,ut.A)(_e.Ku,{title:o,url:n})}))&&void 0!==e?e:[])}get sdmxAttributes(){var e,t;return null!==(e=null===(t=this.sdmxJsonDataflow.dataStructure.dataStructureComponents)||void 0===t||null===(t=t.attributeList)||void 0===t?void 0:t.attributes)&&void 0!==e?e:[]}get sdmxDimensions(){var e,t;return null!==(e=null===(t=this.sdmxJsonDataflow.dataStructure.dataStructureComponents)||void 0===t||null===(t=t.dimensionList)||void 0===t?void 0:t.dimensions)&&void 0!==e?e:[]}get sdmxTimeDimensions(){var e,t;return null!==(e=null===(t=this.sdmxJsonDataflow.dataStructure.dataStructureComponents)||void 0===t?void 0:t.dimensionList.timeDimensions)&&void 0!==e?e:[]}get sdmxPrimaryMeasure(){var e;return null===(e=this.sdmxJsonDataflow.dataStructure.dataStructureComponents)||void 0===e?void 0:e.measureList.primaryMeasure}get shortReportSections(){if(0!==this.catalogItem.mapItems.length||this.catalogItem.isLoading)return;const e=this.catalogItem.tableColumns.find(e=>{var t;return e.name===(null===(t=this.primaryMeasureColumn)||void 0===t?void 0:t.name)});return 1===(null==e?void 0:e.valuesAsNumbers.values.length)&&"number"==typeof(null==e?void 0:e.valuesAsNumbers.values[0])?[(0,ut.A)(_e.yJ,{name:this.chartTitle,content:null==e?void 0:e.valuesAsNumbers.values[0].toLocaleString(void 0,e.traits.format)})]:void 0}getMergedModelOverride(e){const t=this.catalogItem.modelOverrides.find(t=>t.id===e.conceptIdentity),r=this.catalogItem.modelOverrides.find(t=>{var r;return t.id===(null===(r=e.localRepresentation)||void 0===r?void 0:r.enumeration)});let i=t;return i?r&&(i=(0,Qj.Ay)(r,i)):i=r,i}get dimensions(){var e;const t=null===(e=this.sdmxJsonDataflow.contentConstraints)||void 0===e?void 0:e.filter(e=>"Actual"===e.type);return this.sdmxDimensions.filter(e=>{var t;return e.id&&"Dimension"===e.type&&(null===(t=e.localRepresentation)||void 0===t?void 0:t.enumeration)}).map(e=>{var r,i,o,a,s;const l=this.getMergedModelOverride(e),c=this.getConceptByUrn(e.conceptIdentity),u=this.getCodelistByUrn(null===(r=e.localRepresentation)||void 0===r?void 0:r.enumeration),p=Array.isArray(t)?t.reduce((t,r)=>{var i;return null===(i=r.cubeRegions)||void 0===i||i.forEach(r=>{var i;return null===(i=r.keyValues)||void 0===i||null===(i=i.filter(t=>t.id===e.id))||void 0===i?void 0:i.forEach(e=>{var r;return null===(r=e.values)||void 0===r?void 0:r.forEach(e=>t.add(e))})}),t},new Set):new Set,d=null!==(i=p.size>0?null==u||null===(o=u.codes)||void 0===o?void 0:o.filter(e=>p.has(e.id)):null==u?void 0:u.codes)&&void 0!==i?i:[],h=null==l?void 0:l.options,m=(0,n.A)(h)&&h.length>0?h.map(e=>({id:e.id,name:e.name,value:void 0})):d.map(e=>({id:e.id,name:e.name,value:void 0}));let f=null!=l&&l.allowUndefined||null===(a=m[0])||void 0===a?void 0:a.id;const g=null==l?void 0:l.selectedId;return(0,n.A)(g)&&m.find(e=>e.id===g)&&(f=g),{id:e.id,name:null!==(s=null==l?void 0:l.name)&&void 0!==s?s:null==c?void 0:c.name,options:m,position:e.position,disable:null==l?void 0:l.disable,allowUndefined:null==l?void 0:l.allowUndefined,selectedId:f}}).filter(n.A)}get modelOverrides(){return(0,o.A)([...this.sdmxDimensions,...this.sdmxAttributes].map(e=>{var t,r,i;const o=cz(e.conceptIdentity);return"UNIT_MEASURE"===(null==o||null===(t=o.descendantIds)||void 0===t?void 0:t[0])?(0,ut.A)(Tj,{id:e.conceptIdentity,type:"unit-measure"}):"UNIT_MULT"===(null==o||null===(r=o.descendantIds)||void 0===r?void 0:r[0])?(0,ut.A)(Tj,{id:e.conceptIdentity,type:"unit-multiplier"}):"FREQ"===(null==o||null===(i=o.descendantIds)||void 0===i?void 0:i[0])?(0,ut.A)(Tj,{id:e.conceptIdentity,type:"frequency"}):void 0}))}get unitMeasure(){var e,t,r;const i=(0,o.A)(null===(e=this.catalogItem.modelOverrides)||void 0===e?void 0:e.filter(e=>"unit-measure"===e.type&&e.id).map(e=>{var t;const r=null!==(t=this.getAttributionWithConceptOrCodelist(e.id))&&void 0!==t?t:this.getDimensionWithConceptOrCodelist(e.id),i=this.catalogItem.findColumnByName(null==r?void 0:r.id);if(1===(null==i?void 0:i.uniqueValues.values.length)){var o,n,a;const e=this.getCodelistByUrn(null==r||null===(o=r.localRepresentation)||void 0===o?void 0:o.enumeration),t=null==i?void 0:i.uniqueValues.values[0];return null!==(n=null==e||null===(a=e.codes)||void 0===a||null===(a=a.find(e=>e.id===t))||void 0===a?void 0:a.name)&&void 0!==n?n:t}})).join(", "),a=this.getDimensionsWithOverrideType("frequency").find(e=>(0,n.A)(e.selectedId)),s=null!==(t=null==a||null===(r=a.options.find(e=>e.id===a.selectedId))||void 0===r?void 0:r.name)&&void 0!==t?t:null==a?void 0:a.id;return"".concat(i||Pe.Ay.t("models.sdmxJsonDataflowStratum.defaultUnitMeasure")).concat(s?" (".concat(s,")"):"")}get primaryMeasureColumn(){var e,t,r;if(!this.sdmxPrimaryMeasure)return;const i=this.getConceptByUrn(null===(e=this.sdmxPrimaryMeasure)||void 0===e?void 0:e.conceptIdentity),n=(0,o.A)(null===(t=this.catalogItem.modelOverrides)||void 0===t?void 0:t.filter(e=>"unit-multiplier"===e.type&&e.id).map(e=>{var t;const r=null!==(t=this.getAttributionWithConceptOrCodelist(e.id))&&void 0!==t?t:this.getDimensionWithConceptOrCodelist(e.id);return null==r?void 0:r.id}))[0];return(0,ut.A)(Rt.Ay,{name:null===(r=this.sdmxPrimaryMeasure)||void 0===r?void 0:r.id,title:null==i?void 0:i.name,type:"scalar",transformation:n?(0,ut.A)(Rt.hv,{expression:"x*(10^".concat(n,")"),dependencies:[n]}):void 0})}get dimensionColumns(){var e;return null!==(e=this.sdmxDimensions.filter(e=>(0,n.A)(e.id)).map(e=>{var t,r,i,o,a,s,l,c,u,p,d,h;if(null!==(t=this.dimensions)&&void 0!==t&&null!==(t=t.find(t=>t.id===e.id))&&void 0!==t&&t.disable)return(0,ut.A)(Rt.Ay,{name:e.id,type:"hidden"});const m=this.getConceptByUrn(e.conceptIdentity),f=this.getCodelistByUrn(null===(r=e.localRepresentation)||void 0===r?void 0:r.enumeration),g=this.getMergedModelOverride(e);let y;var b,v,w;if(y=null===(i=this.catalogItem.matchRegionProvider(null==g?void 0:g.regionType))||void 0===i?void 0:i.regionType,"region"===(null==g?void 0:g.type)&&(y=null!==(b=null===(v=this.catalogItem.matchRegionProvider(null===(w=this.getDimensionsWithOverrideType("region-type").find(e=>(0,n.A)(e.selectedId)))||void 0===w?void 0:w.selectedId))||void 0===v?void 0:v.regionType)&&void 0!==b?b:y),(0,n.A)(y)||(y=null!==(o=null!==(a=null!==(s=null!==(l=null===(c=this.catalogItem.matchRegionProvider(e.id))||void 0===c?void 0:c.regionType)&&void 0!==l?l:null===(u=this.catalogItem.matchRegionProvider(null==f?void 0:f.name))||void 0===u?void 0:u.regionType)&&void 0!==s?s:null===(p=this.catalogItem.matchRegionProvider(null==f?void 0:f.id))||void 0===p?void 0:p.regionType)&&void 0!==a?a:null===(d=this.catalogItem.matchRegionProvider(null==m?void 0:m.name))||void 0===d?void 0:d.regionType)&&void 0!==o?o:null===(h=this.catalogItem.matchRegionProvider(null==m?void 0:m.id))||void 0===h?void 0:h.regionType),"region"===(null==g?void 0:g.type)){var A;const e=null==g||null===(A=g.regionTypeReplacements)||void 0===A||null===(A=A.find(e=>e.find===y))||void 0===A?void 0:A.replace;(0,n.A)(e)&&(y=e)}return(0,ut.A)(Rt.Ay,{name:e.id,title:null==m?void 0:m.name,type:(0,n.A)(y)?"region":"hidden",regionType:y})}))&&void 0!==e?e:[]}get timeColumns(){var e;return null!==(e=this.sdmxTimeDimensions.map(e=>{var t;const r=this.getConceptByUrn(e.conceptIdentity);return(0,ut.A)(Rt.Ay,{name:e.id,title:null!==(t=null==r?void 0:r.name)&&void 0!==t?t:e.id,type:"time"})}))&&void 0!==e?e:[]}get attributeColumns(){var e;return null!==(e=this.sdmxAttributes.map(e=>(0,ut.A)(Rt.Ay,{name:e.id,type:"hidden"})))&&void 0!==e?e:[]}get columns(){return(0,o.A)([this.primaryMeasureColumn,...this.dimensionColumns,...this.timeColumns,...this.attributeColumns])}get resolvedRegionColumn(){return this.catalogItem.tableColumns.find(e=>{var t;return e.name===(null===(t=this.dimensionColumns.find(e=>"region"===e.type))||void 0===t?void 0:t.name)})}get disableRegion(){var e,t,r;return!this.catalogItem.isLoading&&(null===(e=this.resolvedRegionColumn)||void 0===e?void 0:e.ready)&&(null!==(t=null===(r=this.resolvedRegionColumn)||void 0===r?void 0:r.valuesAsRegions.uniqueRegionIds.length)&&void 0!==t?t:0)<=1}get chartTitle(){if(this.disableRegion){var e;const n=null===(e=this.resolvedRegionColumn)||void 0===e?void 0:e.uniqueValues.values;if(n&&1===n.length){var t;const e=null===(t=this.getDimensionsWithOverrideType("region")[0])||void 0===t?void 0:t.id,a=this.sdmxDimensions.find(t=>t.id===e);if(a){var r,i,o;const e=this.getCodelistByUrn(null===(r=a.localRepresentation)||void 0===r?void 0:r.enumeration),t=null!==(i=null==e||null===(o=e.codes)||void 0===o||null===(o=o.find(e=>e.id===n[0]))||void 0===o?void 0:o.name)&&void 0!==i?i:n[0];return"".concat(t," - ").concat(this.unitMeasure)}}}return this.unitMeasure}get styles(){var e;return this.primaryMeasureColumn?[(0,ut.A)(Mt.A,{id:this.primaryMeasureColumn.name,color:(0,ut.A)(zv.A,{legend:(0,ut.A)(Um.A,{title:this.unitMeasure}),zScoreFilter:4}),time:(0,ut.A)(Ft.A,{timeColumn:this.timeColumns[0].name,spreadStartTime:!0,spreadFinishTime:!0}),chart:this.timeColumns.length>0&&(this.disableRegion||!this.resolvedRegionColumn)?(0,ut.A)(pD.A,{xAxisColumn:this.timeColumns[0].name,lines:[(0,ut.A)(pD.h,{name:this.chartTitle,yAxisColumn:this.primaryMeasureColumn.name})]}):void 0,regionColumn:this.disableRegion?null:null===(e=this.resolvedRegionColumn)||void 0===e?void 0:e.name})]:[]}get activeStyle(){var e;return null===(e=this.primaryMeasureColumn)||void 0===e?void 0:e.name}get initialTimeSource(){return"stop"}get featureInfoTemplate(){var e,t,r,i,o,n,a,s,l;const c=null===(e=this.resolvedRegionColumn)||void 0===e?void 0:e.regionType;if(!c)return;let u='<table class="cesium-infoBox-defaultTable">';const p=(e,t)=>'<tr><td style="vertical-align: middle">'.concat(e,"</td><td>").concat(t,"</td></tr>");u+=null===(t=this.timeColumns)||void 0===t?void 0:t.map(e=>{var t;return p(null!==(t=e.title)&&void 0!==t?t:"Time","{{".concat(e.name,"}}"))}).join(", "),u+=p(null==c?void 0:c.description,"{{".concat(null==c?void 0:c.nameProp,"}}")),u+=null===(r=(0,Zj.pX)(this.catalogItem.sdmxSelectableDimensions))||void 0===r?void 0:r.filter(e=>(e.name||e.id)&&!e.disable&&e.selectedId).map(e=>{var t,r;const i=null===(t=e.options)||void 0===t?void 0:t.find(t=>t.id===e.selectedId);return p(e.name||e.id,null!==(r=null==i?void 0:i.name)&&void 0!==r?r:e.selectedId)}).join("");const d=null!==(i=null!==(o=null!==(n=this.unitMeasure)&&void 0!==n?n:null===(a=this.primaryMeasureColumn)||void 0===a?void 0:a.title)&&void 0!==o?o:null===(s=this.primaryMeasureColumn)||void 0===s?void 0:s.name)&&void 0!==i?i:"Value";if(u+=p("","")+p(d,"{{#terria.formatNumber}}{useGrouping: true}{{".concat(null===(l=this.primaryMeasureColumn)||void 0===l?void 0:l.name,"}}{{/terria.formatNumber}}")),this.catalogItem.discreteTimes&&this.catalogItem.discreteTimes.length>1){var h;const e="".concat(this.catalogItem.name,": {{").concat(c.nameProp,"}}");u+='</table>{{#terria.timeSeries.data}}<chart title="'.concat(e,'" x-column="{{terria.timeSeries.xName}}" y-column="').concat(null===(h=this.primaryMeasureColumn)||void 0===h?void 0:h.title,'" >{{terria.timeSeries.data}}</chart>{{/terria.timeSeries.data}}')}return(0,ut.A)(It.e,{template:u})}getConceptScheme(e){var t;if((0,n.A)(e))return null===(t=this.sdmxJsonDataflow.conceptSchemes)||void 0===t?void 0:t.find(t=>t.id===e)}getConceptByUrn(e){var t,r;if(!e)return;const i=cz(e),o=null==i?void 0:i.resourceId,a=null==i||null===(t=i.descendantIds)||void 0===t?void 0:t[0];if(!(0,n.A)(a))return;const s="string"==typeof o?this.getConceptScheme(o):o;return null==s||null===(r=s.concepts)||void 0===r?void 0:r.find(e=>e.id===a)}getCodelistByUrn(e){var t;if(!e)return;const r=cz(e),i=null==r?void 0:r.resourceId;return(0,n.A)(i)?null===(t=this.sdmxJsonDataflow.codelists)||void 0===t?void 0:t.find(e=>e.id===i):void 0}getDimensionsWithOverrideType(e){var t;return(0,o.A)(null===(t=this.catalogItem.modelOverrides)||void 0===t?void 0:t.filter(t=>t.type===e&&t.id).map(e=>{var t;return null===(t=this.catalogItem.dimensions)||void 0===t?void 0:t.find(t=>{var r;return t.id===(null===(r=this.getDimensionWithConceptOrCodelist(e.id))||void 0===r?void 0:r.id)})}))}getDimensionWithConceptOrCodelist(e){return this.sdmxDimensions.find(t=>{var r;return t.conceptIdentity===e||(null===(r=t.localRepresentation)||void 0===r?void 0:r.enumeration)===e})}getAttributionWithConceptOrCodelist(e){return this.sdmxAttributes.find(t=>{var r;return t.conceptIdentity===e||(null===(r=t.localRepresentation)||void 0===r?void 0:r.enumeration)===e})}},function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Kj,"stratumName","sdmxJsonDataflow"),Yj((Xj=Kj).prototype,"description",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"description"),Xj.prototype),Yj(Xj.prototype,"metadataUrls",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"metadataUrls"),Xj.prototype),Yj(Xj.prototype,"shortReportSections",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"shortReportSections"),Xj.prototype),Yj(Xj.prototype,"dimensions",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"dimensions"),Xj.prototype),Yj(Xj.prototype,"modelOverrides",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"modelOverrides"),Xj.prototype),Yj(Xj.prototype,"unitMeasure",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"unitMeasure"),Xj.prototype),Yj(Xj.prototype,"primaryMeasureColumn",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"primaryMeasureColumn"),Xj.prototype),Yj(Xj.prototype,"dimensionColumns",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"dimensionColumns"),Xj.prototype),Yj(Xj.prototype,"timeColumns",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"timeColumns"),Xj.prototype),Yj(Xj.prototype,"attributeColumns",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"attributeColumns"),Xj.prototype),Yj(Xj.prototype,"columns",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"columns"),Xj.prototype),Yj(Xj.prototype,"resolvedRegionColumn",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"resolvedRegionColumn"),Xj.prototype),Yj(Xj.prototype,"disableRegion",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"disableRegion"),Xj.prototype),Yj(Xj.prototype,"chartTitle",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"chartTitle"),Xj.prototype),Yj(Xj.prototype,"styles",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"styles"),Xj.prototype),Yj(Xj.prototype,"activeStyle",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"activeStyle"),Xj.prototype),Yj(Xj.prototype,"initialTimeSource",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"initialTimeSource"),Xj.prototype),Yj(Xj.prototype,"featureInfoTemplate",[i.EW],Object.getOwnPropertyDescriptor(Xj.prototype,"featureInfoTemplate"),Xj.prototype),Xj);var tz;function rz(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}dt.A.addLoadStratum(ez.stratumName);let iz=(tz=class e extends((0,l.A)((0,Ee.A)((0,g.A)(Jj)))){static get type(){return"sdmx-json"}constructor(e,t,r){super(e,t,r),(0,i.Gn)(this),this.strata.set(xt.A.stratumName,new xt.A(this))}async forceLoadMetadata(){if(!this.strata.has(ez.stratumName)){const e=await ez.load(this);(0,i.h5)(()=>{this.strata.set(ez.stratumName,e)})}await this.loadRegionProviderList()}get type(){return e.type}get cacheDuration(){return super.cacheDuration||"1d"}get sdmxSelectableDimensions(){return this.dimensions.map(e=>{var t;return{id:e.id,name:e.name,options:e.options,selectedId:e.selectedId,allowUndefined:e.allowUndefined,disable:e.disable||"region"===(null===(t=this.columns.find(t=>t.name===e.id))||void 0===t?void 0:t.type),setDimensionValue:async(t,r)=>{var i;let o=null===(i=this.dimensions)||void 0===i?void 0:i.find(t=>t.id===e.id);(0,n.A)(o)||(o=this.addObject(t,"dimensions",e.id)),o.setTrait(t,"selectedId",r),(await this.loadMapItems()).raiseError(this.terria)}}})}get selectableDimensions(){return(0,o.A)([...super.selectableDimensions.filter(e=>{var t;return e.id!==(null===(t=this.styleDimensions)||void 0===t?void 0:t.id)}),...this.sdmxSelectableDimensions])}get baseUrl(){return super.url}get url(){if(!super.url)return;const e=this.dimensions.slice().sort((e,t)=>((0,n.A)(e.position)?e.position:this.dimensions.length)-((0,n.A)(t.position)?t.position:this.dimensions.length)).map(e=>{var t;return e.disable||"region"===(null===(t=this.columns.find(t=>t.name===e.id))||void 0===t?void 0:t.type)?"":e.selectedId}).join(".");return"".concat(super.url,"/data/").concat(this.dataflowId,"/").concat(e)}async forceLoadTableData(){if(this.url)try{const e=await new Vi.A({url:(0,ie.A)(this,this.url),headers:{Accept:"application/vnd.sdmx.data+csv; version=1.0.0"}}).fetch();if(!(0,n.A)(e))throw new At.Ay({title:Pe.Ay.t("models.sdmxCatalogItem.loadDataErrorTitle"),message:Pe.Ay.t("models.sdmxCatalogItem.loadDataErrorMessage",this)});return await Bj.A.parseString(e,!0)}catch(e){if(e instanceof Po.A&&"string"==typeof e.response){if(e.statusCode===pz.NoResults&&this.selectableDimensions.length>0)throw new At.Ay({message:Pe.Ay.t("models.sdmxCatalogItem.noResultsWithDimensions",{dimensions:(0,Zj.pX)(this.selectableDimensions).filter(e=>{var t;return!e.disable&&1!==(null===(t=e.options)||void 0===t?void 0:t.length)}).map(e=>{var t,r;return"- ".concat(e.name," = `").concat(null!==(t=null===(r=e.options)||void 0===r||null===(r=r.find(t=>t.id===e.selectedId))||void 0===r?void 0:r.name)&&void 0!==t?t:e.selectedId,"`")}).join("\n")}),title:Pe.Ay.t("models.sdmxCatalogItem.loadDataErrorTitle",this),severity:At.FK.Warning,importance:1,overrideRaiseToUser:!0});throw new At.Ay({message:dz.has(e.statusCode)?"".concat(dz.get(e.statusCode),": ").concat(e.response):"".concat(e.response),title:Pe.Ay.t("models.sdmxCatalogItem.loadDataErrorTitle",this)})}throw At.Ay.from(e,{message:Pe.Ay.t("models.sdmxCatalogItem.loadDataErrorTitle",this)})}}},rz(tz.prototype,"cacheDuration",[i.$Z],Object.getOwnPropertyDescriptor(tz.prototype,"cacheDuration"),tz.prototype),rz(tz.prototype,"sdmxSelectableDimensions",[i.EW],Object.getOwnPropertyDescriptor(tz.prototype,"sdmxSelectableDimensions"),tz.prototype),rz(tz.prototype,"selectableDimensions",[i.$Z],Object.getOwnPropertyDescriptor(tz.prototype,"selectableDimensions"),tz.prototype),rz(tz.prototype,"baseUrl",[i.EW],Object.getOwnPropertyDescriptor(tz.prototype,"baseUrl"),tz.prototype),rz(tz.prototype,"url",[i.$Z],Object.getOwnPropertyDescriptor(tz.prototype,"url"),tz.prototype),tz);var oz,nz;function az(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sz(e,t,r,i,o){var n={};return Object.keys(i).forEach(function(e){n[e]=i[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(e,t,n),null):n}dt.A.addLoadStratum(xt.A.stratumName);let lz=(nz=class e extends((0,pt.Ay)(Cj)){static async load(t){var r,i,o,a;const s=null===(r=await uz((0,ie.A)(t,"".concat(t.url,"/agencyscheme/")),!0))||void 0===r||null===(r=r.data)||void 0===r?void 0:r.agencySchemes,l=await uz((0,ie.A)(t,"".concat(t.url,"/categoryscheme?references=parentsandsiblings")),!0);let c=null==l||null===(i=l.data)||void 0===i?void 0:i.dataflows;var u;if(!(0,n.A)(c)&&(c=null===(u=await uz((0,ie.A)(t,"".concat(t.url,"/dataflow/")),!0))||void 0===u||null===(u=u.data)||void 0===u?void 0:u.dataflows,!(0,n.A)(c)))throw new At.Ay({title:Pe.Ay.t("models.sdmxServerStratum.loadDataErrorTitle"),message:Pe.Ay.t("models.sdmxServerStratum.loadDataErrorMessage")});return new e(t,{agencySchemes:s,categorySchemes:null==l||null===(o=l.data)||void 0===o?void 0:o.categorySchemes,categorisations:null==l||null===(a=l.data)||void 0===a?void 0:a.categorisations,dataflows:c})}duplicateLoadableStratum(t){return new e(t,this.sdmxServer)}constructor(e,t){super(),this.catalogGroup=e,this.sdmxServer=t,az(this,"dataflowTree",{}),(0,i.Gn)(this),(0,n.A)(this.sdmxServer.categorisations)?this.sdmxServer.categorisations.forEach(e=>{var t;const r=cz(e.target),i=null==r?void 0:r.agencyId,o=null==r?void 0:r.resourceId,a=null==r?void 0:r.descendantIds,s=null===(t=cz(e.source))||void 0===t?void 0:t.resourceId;if(!((0,n.A)(i)&&(0,n.A)(o)&&(0,n.A)(a)&&(0,n.A)(s)))return;let l=this.dataflowTree[i];if(!(0,n.A)(l)){const e=this.getAgency(i);if(!(0,n.A)(e))return;this.dataflowTree[i]={type:"agencyScheme",item:e,members:{}},l=this.dataflowTree[i]}let c=l.members[o];if(!(0,n.A)(c)){const e=this.getCategoryScheme(o);if(!(0,n.A)(e))return;l.members[o]={type:"categoryScheme",item:e,members:{}},c=l.members[o]}let u=c;a.forEach(e=>{if(!(0,n.A)(u.members[e])){let r;if("categoryScheme"===u.type)r=this.getCategoryFromCatagoryScheme(o,e);else if("category"===u.type){var t;r=this.getCategoryFromCategories(null===(t=u.item)||void 0===t?void 0:t.categories,e)}if(!(0,n.A)(r))return;u.members[e]={type:"category",item:r,members:{}}}u=u.members[e]});const p=this.getDataflow(s);(0,n.A)(p)&&(u.members[s]={type:"dataflow",item:p})}):this.dataflowTree=this.sdmxServer.dataflows.reduce((e,t)=>((0,n.A)(t.id)&&(e[t.id]={type:"dataflow",item:t}),e),{})}get members(){const e=t=>{const r=(0,n.A)(null==t?void 0:t.members)?Object.values(t.members):void 0;return(0,n.A)(r)&&1===r.length?e(r[0]):t};let t=Object.values(this.dataflowTree);var r;return 1===t.length&&(0,n.A)(t[0])&&(t=Object.values(null!==(r=e(t[0]).members)&&void 0!==r?r:this.dataflowTree)),t.map(e=>this.getMemberId(e))}createMembers(){Object.values(this.dataflowTree).forEach(e=>this.createMemberFromLayer(e))}createMemberFromLayer(e){const t=this.getMemberId(e);if(!t)return;if(e.members&&Object.keys(e.members).length>0){Object.values(e.members).forEach(e=>this.createMemberFromLayer(e));const r=this.catalogGroup.terria.getModelById(xe.A,t);let i;return void 0===r?(i=new xe.A(t,this.catalogGroup.terria),this.catalogGroup.terria.addModel(i)):i=r,i.setTrait(C.A.definition,"name",e.item.name||e.item.id),i.setTrait(C.A.definition,"members",(0,o.A)(Object.values(e.members).map(e=>this.getMemberId(e)))),void(e.item.description&&i.setTrait(C.A.definition,"description",e.item.description))}if("dataflow"!==e.type||!(0,n.A)(e.item.id)||!(0,n.A)(e.item.agencyID))return;const r=this.catalogGroup.terria.getModelById(iz,t);let i;void 0===r?(i=new iz(t,this.catalogGroup.terria,void 0),this.catalogGroup.terria.addModel(i)):i=r,i.strata.delete(C.A.definition),i.setTrait(C.A.definition,"name",e.item.name||e.item.id),i.setTrait(C.A.definition,"url",this.catalogGroup.url),e.item.description&&i.setTrait(C.A.definition,"description",e.item.description),i.setTrait(C.A.definition,"agencyId",e.item.agencyID),i.setTrait(C.A.definition,"dataflowId",e.item.id),i.setTrait(C.A.definition,"modelOverrides",this.catalogGroup.traits.modelOverrides.toJson(this.catalogGroup.modelOverrides))}getMemberId(e){return"".concat(this.catalogGroup.uniqueId,"/").concat(e.type,"-").concat(e.item.id)}getDataflow(e){if((0,n.A)(e))return this.sdmxServer.dataflows.find(t=>t.id===e)}getCategoryScheme(e){var t;if((0,n.A)(e))return null===(t=this.sdmxServer.categorySchemes)||void 0===t?void 0:t.find(t=>t.id===e)}getCategoryFromCatagoryScheme(e,t){if(!(0,n.A)(t))return;const r="string"==typeof e?this.getCategoryScheme(e):e;return this.getCategoryFromCategories(null==r?void 0:r.categories,t)}getCategoryFromCategories(e,t){return(0,n.A)(t)?null==e?void 0:e.find(e=>e.id===t):void 0}getAgency(e){var t;if(!(0,n.A)(e))return;const r=null===(t=this.sdmxServer.agencySchemes)||void 0===t?void 0:t.map(e=>e.agencies);return(0,n.A)(r)?(0,vt.A)((0,o.A)(r)).find(t=>t.id===e):void 0}},az(nz,"stratumName","sdmxServer"),sz((oz=nz).prototype,"members",[i.EW],Object.getOwnPropertyDescriptor(oz.prototype,"members"),oz.prototype),sz(oz.prototype,"createMemberFromLayer",[i.XI],Object.getOwnPropertyDescriptor(oz.prototype,"createMemberFromLayer"),oz.prototype),oz);function cz(e){if(!(0,n.A)(e))return;const t=function(e,t){const r=[];let i;for(;i=e.exec(t);)i.splice(0,1),r.push(i.map(decodeURIComponent));return r}(/.+=(.+):(.+)\((.+)\)\.*(.*)/g,e);return t.length>=1&&t[0].length>=3&&!(0,n.A)([0,1,2].find(e=>null===t[0][e]))?{agencyId:t[0][0],resourceId:t[0][1],version:t[0][2],descendantIds:null!==t[0][3]?t[0][3].split("."):void 0}:void 0}async function uz(e,t){try{return JSON.parse(await new Vi.A({url:e,headers:{Accept:"application/vnd.sdmx.structure+json; charset=utf-8; version=1.0"}}).fetch())}catch(e){if(e instanceof Po.A&&(0,n.A)(e.response)){if(!t)throw new At.Ay({title:Pe.Ay.t("models.sdmxServerStratum.sdmxStructureLoadErrorTitle"),message:dz.has(e.statusCode)?"".concat(dz.get(e.statusCode),": ").concat(e.response):"".concat(e.response)})}else if(!t)throw new At.Ay({title:Pe.Ay.t("models.sdmxServerStratum.sdmxStructureLoadErrorTitle"),message:"Unkown error occurred".concat((0,n.A)(e)?": ".concat("string"==typeof e?e:JSON.stringify(e)):"")})}}dt.A.addLoadStratum(lz.stratumName);let pz=function(e){return e[e.NoChanges=304]="NoChanges",e[e.NoResults=404]="NoResults",e[e.Unauthorized=401]="Unauthorized",e[e.ReponseTooLarge=413]="ReponseTooLarge",e[e.SyntaxError=400]="SyntaxError",e[e.SemanticError=403]="SemanticError",e[e.UriTooLong=414]="UriTooLong",e[e.ServerError=500]="ServerError",e[e.NotImplemented=501]="NotImplemented",e[e.ServiceUnavailable=503]="ServiceUnavailable",e}({});const dz=new Map;dz.set(pz.NoChanges,"No changes"),dz.set(pz.NoResults,"No results"),dz.set(pz.Unauthorized,"Unauthorised"),dz.set(pz.ReponseTooLarge,"Response too large"),dz.set(pz.SyntaxError,"Syntax error"),dz.set(pz.SemanticError,"Semantic error"),dz.set(pz.UriTooLong,"URI too long"),dz.set(pz.ServerError,"Server error"),dz.set(pz.NotImplemented,"Not implemented"),dz.set(pz.ServiceUnavailable,"Service unavailable");class hz extends((0,Ee.A)((0,Ce.A)((0,s.A)((0,g.A)(Cj))))){get type(){return hz.type}async forceLoadMetadata(){if(!this.strata.has(lz.stratumName)){const e=await lz.load(this);(0,i.h5)(()=>{this.strata.set(lz.stratumName,e)})}}async forceLoadMembers(){const e=this.strata.get(lz.stratumName);e&&await(0,De.A)(()=>e.createMembers())}}function mz(){Qr.A.register(xe.A.type,xe.A),Qr.A.register(dg.A.type,dg.A),Qr.A.register(bi.Ay.type,bi.Ay),Qr.A.register(Oi.type,Oi),Qr.A.register(oC.type,oC),Qr.A.register(lC.type,lC),Qr.A.register(dE.type,dE),Qr.A.register(lE.type,lE),Qr.A.register(EO.type,EO),Qr.A.register(Or.default.type,Or.default),Qr.A.register(is.type,is),Qr.A.register(Ba.type,Ba),Qr.A.register(re.A.type,re.A),Qr.A.register(Yn.A.type,Yn.A),Qr.A.register(ug.type,ug),Qr.A.register(hA.type,hA),Qr.A.register(Vw.type,Vw),Qr.A.register(TS.type,TS),Qr.A.register(oA.type,oA),Qr.A.register($v.type,$v),Qr.A.register(Yv.type,Yv),Qr.A.register(jx.type,jx),Qr.A.register(xx.type,xx),Qr.A.register(Bx.type,Bx),Qr.A.register(rn.type,rn),Qr.A.register(gT.type,gT),Qr.A.register(Bi.A.type,Bi.A),Qr.A.register(mn.type,mn),Qr.A.register(qs.type,qs),Qr.A.register(nl.type,nl),Qr.A.register(mf.type,mf),Qr.A.register(Wg.A.type,Wg.A),Qr.A.register(Xg.type,Xg),Qr.A.register(wh.type,wh),Qr.A.register(Ym.type,Ym),Qr.A.register(no.type,no),Qr.A.register(Go.type,Go),Qr.A.register(py.Ay.type,py.Ay),Qr.A.register(qg.A.type,qg.A),Qr.A.register(ue.type,ue),Qr.A.register(oe.type,oe),Qr.A.register(hz.type,hz),Qr.A.register(iz.type,iz),Qr.A.register(zf.type,zf),Qr.A.register(G_.type,G_),Qr.A.register(nj.type,nj),Qr.A.register(vD.type,vD),Qr.A.register(x_.type,x_),Qr.A.register(Qn.A.type,Qn.A),Qr.A.register(zb.type,zb),Qr.A.register(fb.type,fb),Qr.A.register(ki.type,ki),Qr.A.register(mI.type,mI),Qr.A.register(qi.R.type,qi.R),Qr.A.register(Qt.type,Qt),Qr.A.register(Ht.type,Ht),Qr.A.register(Ur.type,Ur),Qr.A.register(kr.type,kr),Qr.A.register(Fh.type,Fh),Qr.A.register(cm.type,cm),Qr.A.register(Ug.A.type,Ug.A),Qr.A.register(zg.type,zg),Qr.A.register(vg.type,vg),Qr.A.register(PO.type,PO),Qr.A.register(Kn.type,Kn),py.IG.register(gz("csv"),re.A.type),py.IG.register(gz("czm"),Yn.A.type),py.IG.register(gz("czml"),Yn.A.type),py.IG.register(gz("geojson"),Or.default.type),py.IG.register(gz("json"),Or.default.type),py.IG.register(gz("kml"),wh.type),py.IG.register(gz("gpx"),is.type),py.IG.register(gz("kmz"),wh.type),py.IG.register(gz("topojson"),Or.default.type),py.IG.register(gz("georss"),Ba.type),py.IG.register(gz("zip"),ug.type),py.IG.register(gz("tif","tiff","geotiff"),Kn.type),py.IG.register(fz(/\/wms|=wms/i),Oi.type,!0),py.IG.register(fz(/\/wfs|=wfs/i),lC.type,!0),py.IG.register(fz(/\/wmts|=wmts/i),dE.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/MapServer\/\d+\b/i),Vw.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/ImageServer(\/.*)?$/i),TS.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/MapServer(\/.*)?$/i),oA.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/FeatureServer\/\d+\b/i),$v.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/FeatureServer(\/.*)?$/i),Yv.type,!0),py.IG.register(fz(/\/arcgis\/rest\/.*\/\d+\b/i),Vw.type,!0),py.IG.register(fz(/\/arcgis\/rest\//i),hA.type,!0),py.IG.register(fz(/\/rest\/.*\/MapServer\/\d+\b/i),Vw.type,!0),py.IG.register(fz(/\/rest\/.*\/ImageServer(\/.*)?$/i),TS.type,!0),py.IG.register(fz(/\/rest\/.*\/MapServer(\/.*)?$/i),oA.type,!0),py.IG.register(fz(/\/rest\/.*\/FeatureServer\/\d+\b/i),$v.type,!0),py.IG.register(fz(/\/rest\/.*\/FeatureServer(\/.*)?$/i),Yv.type,!0),py.IG.register(fz(/\/rest\/.*\/\d+\b/i),Vw.type,!0),py.IG.register(e=>!0,Oi.type,!0),py.IG.register(e=>!0,lC.type,!0),py.IG.register(e=>!0,Vw.type,!0),py.IG.register(e=>!0,oA.type,!0),py.IG.register(e=>!0,$v.type,!0),py.IG.register(e=>!0,hA.type,!0),py.IG.register(e=>!0,Yv.type,!0)}function fz(e){return/./.test.bind(e)}function gz(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=new RegExp("\\.("+t.join("|")+")$","i");return function(e){return Boolean(e.match(i))}}!function(e,t,r){(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(hz,"type","sdmx-group")}}]);