{"version":3,"file":"560.TerriaJS-specs.js","mappings":"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","sources":["webpack://terriajs/./lib/ReactViews/Tools/DiffTool/DatePicker.tsx","webpack://terriajs/./lib/ReactViews/Tools/DiffTool/LocationPicker.tsx","webpack://terriajs/./lib/ReactViews/Tools/DiffTool/DiffTool.tsx"],"sourcesContent":["import _styled, { default as _styled2, default as _styled3 } from \"styled-components\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport dateFormat from \"dateformat\";\nimport { observer } from \"mobx-react\";\nimport { forwardRef, useCallback, useImperativeHandle, useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\nimport JulianDate from \"terriajs-cesium/Source/Core/JulianDate\";\nimport CommonStrata from \"../../../Models/Definition/CommonStrata\";\nimport Box from \"../../../Styled/Box\";\nimport Button from \"../../../Styled/Button\";\nimport Icon, { StyledIcon } from \"../../../Styled/Icon\";\nimport Spacing from \"../../../Styled/Spacing\";\nimport Text, { TextSpan } from \"../../../Styled/Text\";\nimport { formatDateTime } from \"../../BottomDock/Timeline/DateFormats\";\nimport DateTimePicker from \"../../BottomDock/Timeline/DateTimePicker\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst DatePicker = /*#__PURE__*/forwardRef((props, ref) => {\n  const {\n    heading,\n    item,\n    onDateSet\n  } = props;\n  const {\n    t\n  } = useTranslation();\n  const [isOpen, setIsOpen] = useState(false);\n  const currentDate = useMemo(() => {\n    const date = item.currentDiscreteJulianDate;\n    return date && JulianDate.toDate(date);\n  }, [item.currentDiscreteJulianDate]);\n  const formattedCurrentDate = useMemo(() => {\n    if (currentDate === undefined) {\n      return;\n    }\n    const dateFormatting = undefined; // TODO\n    const formattedDate = dateFormatting !== undefined ? dateFormat(currentDate, dateFormatting) : formatDateTime(currentDate);\n    return formattedDate;\n  }, [currentDate]);\n  const toggleOpen = useCallback(() => {\n    setIsOpen(!isOpen);\n  }, [isOpen]);\n  const changeCurrentDate = useCallback(date => {\n    item.setTrait(CommonStrata.user, \"currentTime\", date.toISOString());\n    onDateSet();\n  }, [item, onDateSet]);\n  const moveToPreviousDate = useCallback(() => {\n    item.moveToPreviousDiscreteTime(CommonStrata.user);\n    onDateSet();\n  }, [item, onDateSet]);\n  const moveToNextDate = useCallback(() => {\n    item.moveToNextDiscreteTime(CommonStrata.user);\n    onDateSet();\n  }, [item, onDateSet]);\n  useImperativeHandle(ref, () => {\n    return {\n      open: () => {\n        setIsOpen(true);\n      },\n      close: () => {\n        setIsOpen(false);\n      }\n    };\n  }, []);\n  return /*#__PURE__*/_jsxs(Box, {\n    column: true,\n    centered: true,\n    flex: 1,\n    children: [/*#__PURE__*/_jsx(Spacing, {\n      bottom: 4\n    }), /*#__PURE__*/_jsxs(Box, {\n      centered: true,\n      children: [/*#__PURE__*/_jsx(_StyledStyledIcon, {\n        light: true,\n        styledWidth: \"21px\",\n        glyph: Icon.GLYPHS.calendar2,\n        $_css: \"margin-top:-2px;\"\n      }), /*#__PURE__*/_jsx(Spacing, {\n        right: 2\n      }), /*#__PURE__*/_jsx(Text, {\n        textLight: true,\n        extraLarge: true,\n        children: heading\n      })]\n    }), /*#__PURE__*/_jsx(Spacing, {\n      bottom: 2\n    }), /*#__PURE__*/_jsxs(Box, {\n      children: [/*#__PURE__*/_jsx(PrevButton, {\n        disabled: item.isPreviousDiscreteTimeAvailable === false,\n        title: t(\"diffTool.datePicker.previousDateTitle\"),\n        onClick: moveToPreviousDate\n      }), /*#__PURE__*/_jsx(DateButton, {\n        primary: true,\n        isOpen: isOpen,\n        onClick: toggleOpen,\n        title: t(\"diffTool.datePicker.dateButtonTitle\"),\n        children: /*#__PURE__*/_jsx(TextSpan, {\n          extraLarge: true,\n          children: formattedCurrentDate || \"-\"\n        })\n      }), /*#__PURE__*/_jsx(NextButton, {\n        disabled: item.isNextDiscreteTimeAvailable === false,\n        title: t(\"diffTool.datePicker.nextDateTitle\"),\n        onClick: moveToNextDate\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      style: {\n        display: isOpen ? \"block\" : \"none\",\n        position: \"absolute\"\n      },\n      children: /*#__PURE__*/_jsx(DateTimePicker, {\n        currentDate: currentDate,\n        dates: item.objectifiedDates,\n        onChange: changeCurrentDate,\n        openDirection: \"up\",\n        isOpen: isOpen,\n        onClose: () => setIsOpen(false)\n      })\n    }), /*#__PURE__*/_jsx(Spacing, {\n      bottom: 4\n    })]\n  });\n});\nDatePicker.displayName = \"DatePicker\";\nconst PagerButton = styled(Button).attrs({\n  iconProps: {\n    css: \"margin-right:0;\"\n  }\n}).withConfig({\n  displayName: \"DatePicker__PagerButton\",\n  componentId: \"sc-11kes1x-0\"\n})([\"cursor:pointer;background-color:\", \";width:40px;border:1px solid transparent;\", \" flex-direction:column;\"], props => props.theme.colorPrimary, _ref => {\n  let {\n    theme\n  } = _ref;\n  return theme.centerWithFlex();\n});\nconst PrevButton = styled(PagerButton).attrs({\n  renderIcon: () => /*#__PURE__*/_jsx(_StyledStyledIcon2, {\n    light: true,\n    styledWidth: \"15px\",\n    glyph: Icon.GLYPHS.arrowDown\n  })\n}).withConfig({\n  displayName: \"DatePicker__PrevButton\",\n  componentId: \"sc-11kes1x-1\"\n})([\"\", \" margin-right:1px;\"], _ref2 => {\n  let {\n    theme\n  } = _ref2;\n  return theme.borderRadiusLeft(theme.radius40Button);\n});\nconst NextButton = styled(PagerButton).attrs({\n  renderIcon: () => /*#__PURE__*/_jsx(_StyledStyledIcon3, {\n    light: true,\n    styledWidth: \"15px\",\n    glyph: Icon.GLYPHS.arrowDown\n  })\n}).withConfig({\n  displayName: \"DatePicker__NextButton\",\n  componentId: \"sc-11kes1x-2\"\n})([\"\", \" margin-left:1px;\"], _ref3 => {\n  let {\n    theme\n  } = _ref3;\n  return theme.borderRadiusRight(theme.radius40Button);\n});\nconst DateButton = styled(Button).withConfig({\n  displayName: \"DatePicker__DateButton\",\n  componentId: \"sc-11kes1x-3\"\n})([\"z-index:0;\", \";border-radius:0px;border:1px solid \", \";min-width:235px;@media (max-width:\", \"px){min-width:150px;}\"], props => props.isOpen && \"z-index: 1000;\", props => props.theme.colorPrimary, props => props.theme.lg);\nexport default observer(DatePicker);\nvar _StyledStyledIcon = styled(StyledIcon).withConfig({\n  displayName: \"DatePicker___StyledStyledIcon\",\n  componentId: \"sc-11kes1x-4\"\n})([\"\", \"\"], p => p.$_css);\nvar _StyledStyledIcon2 = styled(StyledIcon).withConfig({\n  displayName: \"DatePicker___StyledStyledIcon2\",\n  componentId: \"sc-11kes1x-5\"\n})([\"transform:rotate(90deg);\"]);\nvar _StyledStyledIcon3 = styled(StyledIcon).withConfig({\n  displayName: \"DatePicker___StyledStyledIcon3\",\n  componentId: \"sc-11kes1x-6\"\n})([\"transform:rotate(270deg);\"]);","import \"core-js/modules/es.array.reverse.js\";\nvar _class, _class2, _descriptor, _descriptor2, _descriptor3;\nfunction _initializerDefineProperty(e, i, r, l) { r && Object.defineProperty(e, i, { enumerable: r.enumerable, configurable: r.configurable, writable: r.writable, value: r.initializer ? r.initializer.call(l) : void 0 }); }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _applyDecoratedDescriptor(i, e, r, n, l) { var a = {}; return Object.keys(n).forEach(function (i) { a[i] = n[i]; }), a.enumerable = !!a.enumerable, a.configurable = !!a.configurable, (\"value\" in a || a.initializer) && (a.writable = !0), a = r.slice().reverse().reduce(function (r, n) { return n(i, e, r) || r; }, a), l && void 0 !== a.initializer && (a.value = a.initializer ? a.initializer.call(l) : void 0, a.initializer = void 0), void 0 === a.initializer ? (Object.defineProperty(i, e, a), null) : a; }\nfunction _initializerWarningHelper(r, e) { throw Error(\"Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.\"); }\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { action, makeObservable, observable, reaction } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport { Component } from \"react\";\nimport Ellipsoid from \"terriajs-cesium/Source/Core/Ellipsoid\";\nimport CesiumMath from \"terriajs-cesium/Source/Core/Math\";\nimport markerIcon from \"../../../../wwwroot/images/difference-pin.png\";\nimport { addMarker, removeMarker } from \"../../../Models/LocationMarkerUtils\";\nimport MapInteractionMode, { UIMode } from \"../../../Models/MapInteractionMode\";\nimport Loader from \"../../Loader\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nlet LocationPicker = observer(_class = (_class2 = class LocationPicker extends Component {\n  constructor(props) {\n    super(props);\n    _initializerDefineProperty(this, \"pickMode\", _descriptor, this);\n    _initializerDefineProperty(this, \"currentPick\", _descriptor2, this);\n    _initializerDefineProperty(this, \"pickDisposer\", _descriptor3, this);\n    makeObservable(this);\n  }\n  setupPicker() {\n    const {\n      terria,\n      location,\n      onPicking,\n      onPicked\n    } = this.props;\n    this.pickMode = new MapInteractionMode({\n      message: \"\",\n      messageAsNode: /*#__PURE__*/_jsx(\"div\", {}),\n      uiMode: UIMode.Difference\n    });\n    addInteractionModeToMap(terria, this.pickMode);\n    if (location) showMarker(terria, location);\n    this.pickDisposer = reaction(() => this.pickMode.pickedFeatures, action(newPick => {\n      var _newPick$allFeaturesA;\n      if (newPick === undefined || newPick.pickPosition === undefined) {\n        return;\n      }\n      this.pickMode.customUi = () => /*#__PURE__*/_jsx(Loader, {\n        message: \"Querying \".concat(location ? \"new\" : \"\", \" position...\")\n      });\n      const position = cartesianToDegrees(newPick.pickPosition);\n      showMarker(this.props.terria, position);\n      this.currentPick = newPick;\n      onPicking(position);\n      (_newPick$allFeaturesA = newPick.allFeaturesAvailablePromise) === null || _newPick$allFeaturesA === void 0 || _newPick$allFeaturesA.then(() => {\n        if (newPick === this.currentPick) {\n          onPicked(newPick, position);\n        }\n      });\n    }));\n  }\n  destroyPicker() {\n    var _this$pickDisposer;\n    const {\n      terria\n    } = this.props;\n    if (this.pickMode) {\n      removeInteractionModeFromMap(terria, this.pickMode);\n    }\n    removeMarker(terria);\n    this.pickMode = undefined;\n    this.currentPick = undefined;\n    (_this$pickDisposer = this.pickDisposer) === null || _this$pickDisposer === void 0 || _this$pickDisposer.call(this);\n    this.pickDisposer = undefined;\n  }\n  componentDidMount() {\n    this.setupPicker();\n  }\n  componentDidUpdate() {\n    this.destroyPicker();\n    this.setupPicker();\n  }\n  componentWillUnmount() {\n    this.destroyPicker();\n  }\n  render() {\n    return null;\n  }\n}, _descriptor = _applyDecoratedDescriptor(_class2.prototype, \"pickMode\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, \"currentPick\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, \"pickDisposer\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _applyDecoratedDescriptor(_class2.prototype, \"setupPicker\", [action], Object.getOwnPropertyDescriptor(_class2.prototype, \"setupPicker\"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, \"destroyPicker\", [action], Object.getOwnPropertyDescriptor(_class2.prototype, \"destroyPicker\"), _class2.prototype), _class2)) || _class;\nexport { LocationPicker as default };\nfunction addInteractionModeToMap(terria, mode) {\n  terria.mapInteractionModeStack.push(mode);\n}\nfunction removeInteractionModeFromMap(terria, mode) {\n  const [currentMode] = terria.mapInteractionModeStack.slice(-1);\n  if (currentMode === mode) {\n    terria.mapInteractionModeStack.pop();\n  }\n}\nfunction showMarker(terria, location) {\n  addMarker(terria, {\n    name: \"User selection\",\n    location,\n    customMarkerIcon: markerIcon\n  });\n}\nfunction cartesianToDegrees(cartesian) {\n  const carto = Ellipsoid.WGS84.cartesianToCartographic(cartesian);\n  return {\n    longitude: CesiumMath.toDegrees(carto.longitude),\n    latitude: CesiumMath.toDegrees(carto.latitude)\n  };\n}","import _styled, { default as _styled2, default as _styled3, default as _styled4, default as _styled5, default as _styled6, default as _styled7, default as _styled8, default as _styled9 } from \"styled-components\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport dateFormat from \"dateformat\";\nimport { runInAction } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport styled, { useTheme } from \"styled-components\";\nimport Cartographic from \"terriajs-cesium/Source/Core/Cartographic\";\nimport JulianDate from \"terriajs-cesium/Source/Core/JulianDate\";\nimport CesiumMath from \"terriajs-cesium/Source/Core/Math\";\nimport createGuid from \"terriajs-cesium/Source/Core/createGuid\";\nimport SplitDirection from \"terriajs-cesium/Source/Scene/SplitDirection\";\nimport filterOutUndefined from \"../../../Core/filterOutUndefined\";\nimport isDefined from \"../../../Core/isDefined\";\nimport prettifyCoordinates from \"../../../Map/Vector/prettifyCoordinates\";\nimport DiffableMixin from \"../../../ModelMixins/DiffableMixin\";\nimport MappableMixin, { ImageryParts } from \"../../../ModelMixins/MappableMixin\";\nimport SplitItemReference from \"../../../Models/Catalog/CatalogReferences/SplitItemReference\";\nimport CommonStrata from \"../../../Models/Definition/CommonStrata\";\nimport hasTraits from \"../../../Models/Definition/hasTraits\";\nimport updateModelFromJson from \"../../../Models/Definition/updateModelFromJson\";\nimport { getMarkerLocation, removeMarker } from \"../../../Models/LocationMarkerUtils\";\nimport Box, { BoxSpan } from \"../../../Styled/Box\";\nimport Button, { RawButton } from \"../../../Styled/Button\";\nimport { GLYPHS, StyledIcon } from \"../../../Styled/Icon\";\nimport Select from \"../../../Styled/Select\";\nimport Spacing from \"../../../Styled/Spacing\";\nimport Text, { TextSpan } from \"../../../Styled/Text\";\nimport ImageryProviderTraits from \"../../../Traits/TraitsClasses/ImageryProviderTraits\";\nimport { useViewState } from \"../../Context\";\nimport { parseCustomMarkdownToReactWithOptions } from \"../../Custom/parseCustomMarkdownToReact\";\nimport Loader from \"../../Loader\";\nimport WorkflowPanel from \"../../Workflow/WorkflowPanel\";\nimport DatePicker from \"./DatePicker\";\nimport LocationPicker from \"./LocationPicker\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst DiffTool = observer(props => {\n  const [leftItem, setLeftItem] = useState();\n  const [rightItem, setRightItem] = useState();\n  const [userSelectedSourceItem, setUserSelectedSourceItem] = useState();\n  const viewState = useViewState();\n  const changeSourceItem = sourceItem => {\n    setUserSelectedSourceItem(sourceItem);\n  };\n  const sourceItem = useMemo(() => userSelectedSourceItem || props.sourceItem, [props.sourceItem, userSelectedSourceItem]);\n  useEffect(() => {\n    const terria = viewState.terria;\n    const originalSettings = {\n      showSplitter: terria.showSplitter,\n      isMapFullScreen: viewState.isMapFullScreen\n    };\n    runInAction(() => {\n      terria.showSplitter = true;\n      sourceItem.setTrait(CommonStrata.user, \"show\", false);\n      terria.elements.set(\"timeline\", {\n        visible: false\n      });\n    });\n    const itemsPromise = Promise.all([createSplitItem(sourceItem, SplitDirection.LEFT), createSplitItem(sourceItem, SplitDirection.RIGHT)]);\n    itemsPromise.then(_ref => {\n      let [lItem, rItem] = _ref;\n      setLeftItem(lItem);\n      setRightItem(rItem);\n    }).catch();\n    return () => {\n      runInAction(() => {\n        terria.showSplitter = originalSettings.showSplitter;\n        viewState.setIsMapFullScreen(originalSettings.isMapFullScreen);\n        sourceItem.setTrait(CommonStrata.user, \"show\", true);\n        terria.elements.set(\"timeline\", {\n          visible: true\n        });\n      });\n      itemsPromise.then(_ref2 => {\n        let [lItem, rItem] = _ref2;\n        if (lItem) removeSplitItem(lItem);\n        if (rItem) removeSplitItem(rItem);\n      });\n    };\n  }, [sourceItem, viewState]);\n  if (leftItem && rightItem) {\n    return /*#__PURE__*/_jsx(Main, _objectSpread(_objectSpread({}, props), {}, {\n      terria: props.viewState.terria,\n      sourceItem: sourceItem,\n      changeSourceItem: changeSourceItem,\n      leftItem: leftItem,\n      rightItem: rightItem\n    }));\n  }\n  return null;\n});\nDiffTool.displayName = \"DiffTool\";\nconst Main = observer(props => {\n  var _diffItem$styleSelect3;\n  const {\n    terria,\n    viewState,\n    sourceItem,\n    leftItem,\n    rightItem\n  } = props;\n  const {\n    t\n  } = useTranslation();\n  const theme = useTheme();\n  const [location, setLocation] = useState();\n  const [, setLocationPickError] = useState(false);\n  const [isPickingNewLocation, setIsPickingNewLocation] = useState(false);\n  const leftDatePickerHandle = useRef(null);\n  const rightDatePickerHandle = useRef(null);\n  const diffItem = useMemo(() => {\n    return leftItem;\n  }, [leftItem]);\n  const currentLeftDate = useMemo(() => {\n    return leftItem.currentDiscreteJulianDate;\n  }, [leftItem.currentDiscreteJulianDate]);\n  const currentRightDate = useMemo(() => {\n    return rightItem.currentDiscreteJulianDate;\n  }, [rightItem.currentDiscreteJulianDate]);\n  const diffItemName = useMemo(() => {\n    const name = sourceItem.name || \"\";\n    const format = \"yyyy/mm/dd\";\n    if (!currentLeftDate || !currentRightDate) {\n      return name;\n    } else {\n      const d1 = dateFormat(JulianDate.toDate(currentLeftDate), format);\n      const d2 = dateFormat(JulianDate.toDate(currentRightDate), format);\n      return \"\".concat(name, \" - difference for dates \").concat(d1, \", \").concat(d2);\n    }\n  }, [currentLeftDate, currentRightDate, sourceItem.name]);\n  const diffableItemsInWorkbench = useMemo(() => {\n    return terria.workbench.items.filter(item => DiffableMixin.isMixedInto(item) && item.canDiffImages);\n  }, [terria.workbench.items]);\n  const previewStyle = useMemo(() => {\n    var _diffItem$styleSelect;\n    return (_diffItem$styleSelect = diffItem.styleSelectableDimensions) === null || _diffItem$styleSelect === void 0 || (_diffItem$styleSelect = _diffItem$styleSelect[0]) === null || _diffItem$styleSelect === void 0 ? void 0 : _diffItem$styleSelect.selectedId;\n  }, [diffItem.styleSelectableDimensions]);\n  const currentDiffStyle = useMemo(() => {\n    return diffItem.diffStyleId;\n  }, [diffItem.diffStyleId]);\n  const availableDiffStyles = useMemo(() => {\n    return filterOutUndefined(diffItem.availableDiffStyles.map(diffStyleId => {\n      var _diffItem$styleSelect2;\n      return (_diffItem$styleSelect2 = diffItem.styleSelectableDimensions) === null || _diffItem$styleSelect2 === void 0 || (_diffItem$styleSelect2 = _diffItem$styleSelect2[0]) === null || _diffItem$styleSelect2 === void 0 || (_diffItem$styleSelect2 = _diffItem$styleSelect2.options) === null || _diffItem$styleSelect2 === void 0 ? void 0 : _diffItem$styleSelect2.find(style => style.id === diffStyleId);\n    }));\n  }, [diffItem.availableDiffStyles, diffItem.styleSelectableDimensions]);\n  const diffLegendUrl = useMemo(() => {\n    return currentDiffStyle && currentLeftDate && currentRightDate && diffItem.getLegendUrlForStyle(currentDiffStyle, currentLeftDate, currentRightDate);\n  }, [currentDiffStyle, currentLeftDate, currentRightDate, diffItem]);\n  const previewLegendUrl = useMemo(() => {\n    return previewStyle && diffItem.getLegendUrlForStyle(previewStyle);\n  }, [previewStyle, diffItem]);\n  const showItem = useCallback(model => {\n    runInAction(() => {\n      if (hasOpacity(model)) {\n        model.setTrait(CommonStrata.user, \"opacity\", 0.8);\n      }\n    });\n  }, []);\n  const hideItem = useCallback(model => {\n    runInAction(() => {\n      if (hasOpacity(model)) {\n        model.setTrait(CommonStrata.user, \"opacity\", 0);\n      }\n    });\n  }, []);\n  const handleChangeSourceItem = useCallback(e => {\n    const newSourceItem = diffableItemsInWorkbench.find(item => item.uniqueId === e.target.value);\n    if (newSourceItem) props.changeSourceItem(newSourceItem);\n  }, [diffableItemsInWorkbench, props]);\n  const handleChangePreviewStyle = useCallback(e => {\n    const styleId = e.target.value;\n    runInAction(() => {\n      var _leftItem$styleSelect, _rightItem$styleSelec;\n      (_leftItem$styleSelect = leftItem.styleSelectableDimensions) === null || _leftItem$styleSelect === void 0 || (_leftItem$styleSelect = _leftItem$styleSelect[0]) === null || _leftItem$styleSelect === void 0 || _leftItem$styleSelect.setDimensionValue(CommonStrata.user, styleId);\n      (_rightItem$styleSelec = rightItem.styleSelectableDimensions) === null || _rightItem$styleSelec === void 0 || (_rightItem$styleSelec = _rightItem$styleSelec[0]) === null || _rightItem$styleSelec === void 0 || _rightItem$styleSelec.setDimensionValue(CommonStrata.user, styleId);\n    });\n  }, [leftItem.styleSelectableDimensions, rightItem.styleSelectableDimensions]);\n  const handleChangeDiffStyle = useCallback(e => {\n    runInAction(() => {\n      diffItem.setTrait(CommonStrata.user, \"diffStyleId\", e.target.value);\n    });\n  }, [diffItem]);\n  const onUserPickingLocation = useCallback(_pickingLocation => {\n    setIsPickingNewLocation(true);\n  }, []);\n  const onUserPickLocation = useCallback((pickedFeatures, pickedLocationValue) => {\n    const feature = pickedFeatures.features.find(f => doesFeatureBelongToItem(f, leftItem) || doesFeatureBelongToItem(f, rightItem));\n    runInAction(() => {\n      if (feature) {\n        leftItem.setTimeFilterFeature(feature, pickedFeatures.providerCoords);\n        rightItem.setTimeFilterFeature(feature, pickedFeatures.providerCoords);\n        setLocation(pickedLocationValue);\n        setLocationPickError(false);\n      } else {\n        setLocationPickError(true);\n      }\n      setIsPickingNewLocation(false);\n    });\n  }, [leftItem, rightItem]);\n  const unsetDates = useCallback(() => {\n    runInAction(() => {\n      leftItem.setTrait(CommonStrata.user, \"currentTime\", null);\n      rightItem.setTrait(CommonStrata.user, \"currentTime\", null);\n    });\n    hideItem(leftItem);\n    hideItem(rightItem);\n  }, [leftItem, rightItem, hideItem]);\n  const generateDiff = useCallback(() => {\n    if (currentLeftDate === undefined || currentRightDate === undefined || currentDiffStyle === undefined) {\n      return;\n    }\n    runInAction(() => {\n      terria.overlays.remove(leftItem);\n      terria.overlays.remove(rightItem);\n      terria.workbench.add(diffItem);\n      diffItem.setTrait(CommonStrata.user, \"name\", diffItemName);\n      diffItem.showDiffImage(currentLeftDate, currentRightDate, currentDiffStyle);\n      const diffItemProperties = diffItem.diffItemProperties;\n      if (diffItemProperties) {\n        updateModelFromJson(diffItem, CommonStrata.user, diffItemProperties);\n      }\n      terria.showSplitter = false;\n    });\n  }, [currentDiffStyle, currentLeftDate, currentRightDate, diffItem, diffItemName, leftItem, rightItem, terria]);\n  const resetTool = useCallback(() => {\n    runInAction(() => {\n      diffItem.clearDiffImage();\n      setDefaultDiffStyle(diffItem);\n      terria.overlays.add(leftItem);\n      terria.overlays.add(rightItem);\n      terria.workbench.remove(diffItem);\n      terria.showSplitter = true;\n      leftItem.setTrait(CommonStrata.user, \"splitDirection\", SplitDirection.LEFT);\n      rightItem.setTrait(CommonStrata.user, \"splitDirection\", SplitDirection.RIGHT);\n    });\n  }, [diffItem, leftItem, rightItem, terria]);\n  const setLocationFromActiveSearch = useCallback(async () => {\n    const markerLocation = getMarkerLocation(terria);\n    if (markerLocation && MappableMixin.isMixedInto(sourceItem)) {\n      const part = sourceItem.mapItems.find(p => ImageryParts.is(p));\n      const imageryProvider = part && ImageryParts.is(part) && part.imageryProvider;\n      if (imageryProvider) {\n        const promises = [setTimeFilterFromLocation(leftItem, markerLocation, imageryProvider), setTimeFilterFromLocation(rightItem, markerLocation, imageryProvider)];\n        const someSuccessful = (await Promise.all(promises)).some(ok => ok);\n        if (someSuccessful) {\n          runInAction(() => setLocation(markerLocation));\n        } else {\n          // If we cannot resolve imagery at the marker location, remove it\n          runInAction(() => removeMarker(terria));\n        }\n      }\n    }\n  }, [leftItem, rightItem, sourceItem, terria]);\n  useEffect(() => {\n    const {\n      latitude,\n      longitude,\n      height\n    } = diffItem.timeFilterCoordinates;\n    if (latitude !== undefined && longitude !== undefined) {\n      setLocation({\n        latitude,\n        longitude,\n        height\n      });\n      // Assuming removeMarker is an action or handles its own MobX transactions\n      removeMarker(terria);\n    } else {\n      setLocationFromActiveSearch();\n    }\n  }, [diffItem.timeFilterCoordinates, setLocationFromActiveSearch, terria]);\n  const closePanel = useCallback(() => {\n    viewState.closeTool();\n  }, [viewState]);\n  const isShowingDiff = diffItem.isShowingDiff;\n  const datesSelected = currentLeftDate && currentRightDate;\n  const isReadyToGenerateDiff = location && datesSelected && currentDiffStyle !== undefined;\n  return /*#__PURE__*/_jsx(WorkflowPanel, {\n    viewState: viewState,\n    title: t(\"diffTool.title\"),\n    icon: GLYPHS.difference,\n    onClose: () => {\n      resetTool();\n      closePanel();\n    },\n    children: /*#__PURE__*/_jsxs(_StyledDiv, {\n      children: [isShowingDiff && /*#__PURE__*/_jsx(Text, {\n        medium: true,\n        textLight: true,\n        children: t(\"diffTool.differenceResultsTitle\")\n      }), /*#__PURE__*/_jsx(Text, {\n        textLight: true,\n        children: t(\"diffTool.instructions.paneDescription\")\n      }), /*#__PURE__*/_jsx(Group, {\n        children: /*#__PURE__*/_jsxs(LocationAndDatesDisplayBox, {\n          children: [/*#__PURE__*/_jsxs(Box, {\n            children: [/*#__PURE__*/_jsxs(Text, {\n              medium: true,\n              children: [t(\"diffTool.labels.area\"), \":\"]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              children: [/*#__PURE__*/_jsx(Text, {\n                bold: true,\n                textLight: true,\n                children: location ? t(\"diffTool.locationDisplay.locationSelected.title\") : t(\"diffTool.locationDisplay.noLocationSelected.title\")\n              }), /*#__PURE__*/_jsx(Text, {\n                light: true,\n                textLight: true,\n                small: true,\n                children: location ? t(\"diffTool.locationDisplay.locationSelected.description\") : t(\"diffTool.locationDisplay.noLocationSelected.description\")\n              })]\n            })]\n          }), /*#__PURE__*/_jsxs(Box, {\n            children: [/*#__PURE__*/_jsxs(Text, {\n              medium: true,\n              children: [t(\"diffTool.labels.dates\"), \":\"]\n            }), /*#__PURE__*/_jsxs(Box, {\n              column: true,\n              alignItemsFlexStart: true,\n              children: [currentLeftDate && /*#__PURE__*/_jsxs(Text, {\n                large: true,\n                children: [\"(A)\", \" \", dateFormat(JulianDate.toDate(currentLeftDate), \"dd/mm/yyyy\")]\n              }), !currentLeftDate && /*#__PURE__*/_jsx(RawButton, {\n                onClick: () => {\n                  var _leftDatePickerHandle;\n                  return (_leftDatePickerHandle = leftDatePickerHandle.current) === null || _leftDatePickerHandle === void 0 ? void 0 : _leftDatePickerHandle.open();\n                },\n                children: /*#__PURE__*/_jsx(TextSpan, {\n                  isLink: true,\n                  small: true,\n                  bold: true,\n                  children: t(\"diffTool.instructions.setDateA\")\n                })\n              }), currentRightDate && /*#__PURE__*/_jsxs(Text, {\n                large: true,\n                children: [\"(B)\", \" \", dateFormat(JulianDate.toDate(currentRightDate), \"dd/mm/yyyy\")]\n              }), !currentRightDate && /*#__PURE__*/_jsx(RawButton, {\n                onClick: () => {\n                  var _rightDatePickerHandl;\n                  return (_rightDatePickerHandl = rightDatePickerHandle.current) === null || _rightDatePickerHandl === void 0 ? void 0 : _rightDatePickerHandl.open();\n                },\n                children: /*#__PURE__*/_jsx(TextSpan, {\n                  isLink: true,\n                  small: true,\n                  bold: true,\n                  children: t(\"diffTool.instructions.setDateB\")\n                })\n              }), isShowingDiff === false && currentLeftDate && currentRightDate && /*#__PURE__*/_jsx(RawButton, {\n                onClick: unsetDates,\n                children: /*#__PURE__*/_jsx(TextSpan, {\n                  isLink: true,\n                  small: true,\n                  children: t(\"diffTool.instructions.changeDates\")\n                })\n              })]\n            })]\n          })]\n        })\n      }), !isShowingDiff && /*#__PURE__*/_jsx(Group, {\n        children: /*#__PURE__*/_jsxs(Selector, {\n          viewState: viewState,\n          value: sourceItem.uniqueId,\n          onChange: handleChangeSourceItem,\n          label: t(\"diffTool.labels.sourceDataset\"),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            disabled: true,\n            children: \"Select source item\"\n          }), diffableItemsInWorkbench.map(item => /*#__PURE__*/_jsx(\"option\", {\n            value: item.uniqueId,\n            children: item.name\n          }, item.uniqueId))]\n        })\n      }), !isShowingDiff && /*#__PURE__*/_jsxs(Group, {\n        children: [/*#__PURE__*/_jsxs(Selector, {\n          viewState: viewState,\n          spacingBottom: true,\n          value: previewStyle,\n          onChange: handleChangePreviewStyle,\n          label: t(\"diffTool.labels.previewStyle\"),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            disabled: true,\n            value: \"\",\n            children: t(\"diffTool.choosePreview\")\n          }), (_diffItem$styleSelect3 = diffItem.styleSelectableDimensions) === null || _diffItem$styleSelect3 === void 0 || (_diffItem$styleSelect3 = _diffItem$styleSelect3[0]) === null || _diffItem$styleSelect3 === void 0 || (_diffItem$styleSelect3 = _diffItem$styleSelect3.options) === null || _diffItem$styleSelect3 === void 0 ? void 0 : _diffItem$styleSelect3.map(style => /*#__PURE__*/_jsx(\"option\", {\n            value: style.id,\n            children: style.name\n          }, style.id))]\n        }), previewLegendUrl && /*#__PURE__*/_jsx(LegendImage, {\n          width: \"100%\",\n          src: previewLegendUrl\n        })]\n      }), /*#__PURE__*/_jsxs(Group, {\n        children: [/*#__PURE__*/_jsxs(Selector, {\n          viewState: viewState,\n          value: currentDiffStyle || \"\",\n          onChange: handleChangeDiffStyle,\n          label: t(\"diffTool.labels.differenceOutput\"),\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            disabled: true,\n            value: \"\",\n            children: t(\"diffTool.chooseDifference\")\n          }), availableDiffStyles.map(style => /*#__PURE__*/_jsx(\"option\", {\n            value: style.id,\n            children: style.name\n          }, style.id))]\n        }), isShowingDiff && diffLegendUrl && /*#__PURE__*/_jsx(LegendImage, {\n          width: \"100%\",\n          src: diffLegendUrl\n        })]\n      }), !isShowingDiff && /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsx(GenerateButton, {\n          onClick: generateDiff,\n          disabled: !isReadyToGenerateDiff,\n          \"aria-describedby\": \"TJSDifferenceDisabledButtonPrompt\",\n          children: /*#__PURE__*/_jsx(TextSpan, {\n            large: true,\n            children: t(\"diffTool.labels.generateDiffButtonText\")\n          })\n        }), !isReadyToGenerateDiff && /*#__PURE__*/_jsxs(_StyledDiv2, {\n          children: [/*#__PURE__*/_jsx(_StyledDiv3, {\n            children: /*#__PURE__*/_jsx(StyledIcon, {\n              fillColor: \"#ccc\",\n              styledWidth: \"16px\",\n              styledHeight: \"16px\",\n              glyph: GLYPHS.info\n            })\n          }), /*#__PURE__*/_jsx(Text, {\n            small: true,\n            light: true,\n            textLight: true,\n            id: \"TJSDifferenceDisabledButtonPrompt\",\n            children: t(\"diffTool.labels.disabledButtonPrompt\")\n          })]\n        })]\n      }), isShowingDiff && /*#__PURE__*/_jsxs(Box, {\n        centered: true,\n        left: true,\n        children: [/*#__PURE__*/_jsx(_StyledBackButton, {\n          transparentBg: true,\n          onClick: resetTool,\n          $_css: theme.textLight,\n          $_css2: theme.textLight,\n          children: /*#__PURE__*/_jsxs(BoxSpan, {\n            centered: true,\n            children: [/*#__PURE__*/_jsx(_StyledStyledIcon, {\n              light: true,\n              styledWidth: \"16px\",\n              glyph: GLYPHS.arrowDown\n            }), /*#__PURE__*/_jsx(TextSpan, {\n              medium: true,\n              children: t(\"general.back\")\n            })]\n          })\n        }), /*#__PURE__*/_jsx(_StyledButton, {\n          primary: true,\n          onClick: closePanel,\n          children: /*#__PURE__*/_jsx(TextSpan, {\n            medium: true,\n            children: t(\"diffTool.labels.saveToWorkbench\")\n          })\n        })]\n      }), !isShowingDiff && /*#__PURE__*/_jsx(LocationPicker, {\n        terria: terria,\n        location: location,\n        onPicking: onUserPickingLocation,\n        onPicked: onUserPickLocation\n      }), !isShowingDiff && /*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsxs(Box, {\n        centered: true,\n        fullWidth: true,\n        flexWrap: true,\n        backgroundColor: theme.dark,\n        children: [/*#__PURE__*/_jsx(DatePicker, {\n          ref: leftDatePickerHandle,\n          heading: t(\"diffTool.labels.dateComparisonA\"),\n          item: leftItem,\n          onDateSet: () => showItem(leftItem)\n        }), /*#__PURE__*/_jsx(AreaFilterSelection, {\n          location: location,\n          isPickingNewLocation: isPickingNewLocation\n        }), /*#__PURE__*/_jsx(DatePicker, {\n          ref: rightDatePickerHandle,\n          heading: t(\"diffTool.labels.dateComparisonB\"),\n          item: rightItem,\n          onDateSet: () => showItem(rightItem)\n        })]\n      }), document.getElementById(\"TJS-BottomDockLastPortal\"))]\n    })\n  });\n});\nMain.displayName = \"Main\";\nconst BackButton = styled(Button).attrs({\n  secondary: true\n}).withConfig({\n  displayName: \"DiffTool__BackButton\",\n  componentId: \"sc-3vyhxu-0\"\n})([\"\"]);\nvar _StyledBackButton = styled(BackButton).withConfig({\n  displayName: \"DiffTool___StyledBackButton\",\n  componentId: \"sc-3vyhxu-1\"\n})([\"color:\", \";border-color:\", \";\"], p => p.$_css, p => p.$_css2);\nconst GenerateButton = styled(Button).attrs({\n  primary: true,\n  fullWidth: true\n}).withConfig({\n  displayName: \"DiffTool__GenerateButton\",\n  componentId: \"sc-3vyhxu-2\"\n})([\"\"]);\nconst Selector = props => /*#__PURE__*/_jsx(Box, {\n  fullWidth: true,\n  column: true,\n  children: /*#__PURE__*/_jsxs(\"label\", {\n    children: [/*#__PURE__*/_jsx(_StyledText, {\n      textLight: true,\n      $_css3: \"p {margin: 0;}\",\n      children: parseCustomMarkdownToReactWithOptions(\"\".concat(props.label, \":\"), {\n        injectTermsAsTooltips: true,\n        tooltipTerms: props.viewState.terria.configParameters.helpContentTerms\n      })\n    }), /*#__PURE__*/_jsx(Spacing, {\n      bottom: 1\n    }), /*#__PURE__*/_jsx(Select, _objectSpread(_objectSpread({}, props), {}, {\n      children: props.children\n    })), props.spacingBottom && /*#__PURE__*/_jsx(Spacing, {\n      bottom: 2\n    })]\n  })\n});\nconst AreaFilterSelection = props => {\n  const {\n    location,\n    isPickingNewLocation\n  } = props;\n  const {\n    t\n  } = useTranslation();\n  let locationText = \"-\";\n  if (location) {\n    const {\n      longitude,\n      latitude\n    } = prettifyCoordinates(location.longitude, location.latitude, {\n      digits: 2\n    });\n    locationText = \"\".concat(longitude, \" \").concat(latitude);\n  }\n  return /*#__PURE__*/_jsxs(_StyledBox, {\n    column: true,\n    centered: true,\n    styledMinWidth: \"230px\",\n    children: [/*#__PURE__*/_jsxs(Box, {\n      centered: true,\n      children: [/*#__PURE__*/_jsx(StyledIcon, {\n        light: true,\n        styledWidth: \"16px\",\n        glyph: GLYPHS.location2\n      }), /*#__PURE__*/_jsx(Spacing, {\n        right: 2\n      }), /*#__PURE__*/_jsx(Text, {\n        textLight: true,\n        extraLarge: true,\n        children: t(\"diffTool.labels.areaFilterSelection\")\n      })]\n    }), /*#__PURE__*/_jsx(Spacing, {\n      bottom: 3\n    }), /*#__PURE__*/_jsx(Box, {\n      styledMinHeight: \"40px\",\n      children: isPickingNewLocation ? /*#__PURE__*/_jsx(_StyledText2, {\n        textLight: true,\n        extraExtraLarge: true,\n        bold: true\n        // Using legacy Loader.jsx means we override at a higher level to inherit\n        // this fills tyle\n        ,\n        children: /*#__PURE__*/_jsx(Loader, {\n          light: true,\n          message: \"Querying \".concat(location ? \"new\" : \"\", \" position...\")\n        })\n      }) : /*#__PURE__*/_jsx(Text, {\n        textLight: true,\n        bold: true,\n        heading: true,\n        textAlignCenter: true,\n        children: locationText\n      })\n    })]\n  });\n};\nconst Group = styled.div.withConfig({\n  displayName: \"DiffTool__Group\",\n  componentId: \"sc-3vyhxu-3\"\n})([\"background-color:\", \";padding:15px;border-radius:5px;\"], p => p.theme.darkWithOverlay);\nconst LocationAndDatesDisplayBox = styled(Box).attrs({\n  column: true\n}).withConfig({\n  displayName: \"DiffTool__LocationAndDatesDisplayBox\",\n  componentId: \"sc-3vyhxu-4\"\n})([\"color:\", \";padding:15px;> \", \":first-child{margin-bottom:13px;}> div > div:first-child{margin-right:5px;min-width:50px;}\"], p => p.theme.textLight, Box);\nconst LegendImage = function (props) {\n  return /*#__PURE__*/_jsx(\"img\", _objectSpread(_objectSpread({}, props), {}, {\n    // Show the legend only if it loads successfully, so we start out hidden\n    style: {\n      display: \"none\",\n      marginTop: \"10px\"\n    },\n    onLoad: e => e.currentTarget.style.display = \"block\",\n    onError: e => e.currentTarget.style.display = \"none\"\n  }));\n};\nasync function createSplitItem(sourceItem, splitDirection) {\n  const terria = sourceItem.terria;\n  const ref = new SplitItemReference(createGuid(), terria);\n  ref.setTrait(CommonStrata.user, \"splitSourceItemId\", sourceItem.uniqueId);\n  terria.addModel(ref);\n  await ref.loadReference();\n  return runInAction(() => {\n    var _newItem$styleSelecta;\n    if (ref.target === undefined) {\n      throw Error(\"failed to split item\");\n    }\n    const newItem = ref.target;\n    newItem.setTrait(CommonStrata.user, \"show\", true);\n    newItem.setTrait(CommonStrata.user, \"splitDirection\", splitDirection);\n    newItem.setTrait(CommonStrata.user, \"currentTime\", null);\n    newItem.setTrait(CommonStrata.user, \"initialTimeSource\", \"none\");\n    if (hasOpacity(newItem)) {\n      // We want to show the item on the map only after date selection. At the\n      // same time we cannot set `show` to false because if we\n      // do so, date picking which relies on feature picking, will not work. So\n      // we simply set the opacity of the item to 0.\n      newItem.setTrait(CommonStrata.user, \"opacity\", 0);\n    }\n\n    // Override feature info template as the parent featureInfoTemplate might\n    // not be relevant for the difference item. This has to be done in the user\n    // stratum to override template set in definition stratum.\n    updateModelFromJson(newItem, CommonStrata.user, {\n      featureInfoTemplate: {\n        template: \"\"\n      }\n    });\n    setDefaultDiffStyle(newItem);\n\n    // Set the default style to true color style if it exists\n    const trueColor = (_newItem$styleSelecta = newItem.styleSelectableDimensions) === null || _newItem$styleSelecta === void 0 || (_newItem$styleSelecta = _newItem$styleSelecta[0]) === null || _newItem$styleSelecta === void 0 || (_newItem$styleSelecta = _newItem$styleSelecta.options) === null || _newItem$styleSelecta === void 0 ? void 0 : _newItem$styleSelecta.find(style => isDefined(style.name) && style.name.search(/true/i) >= 0);\n    if (trueColor !== null && trueColor !== void 0 && trueColor.id) {\n      var _newItem$styleSelecta2;\n      (_newItem$styleSelecta2 = newItem.styleSelectableDimensions) === null || _newItem$styleSelecta2 === void 0 || (_newItem$styleSelecta2 = _newItem$styleSelecta2[0]) === null || _newItem$styleSelecta2 === void 0 || _newItem$styleSelecta2.setDimensionValue(CommonStrata.user, trueColor.id);\n    }\n    terria.overlays.add(newItem);\n    return newItem;\n  });\n}\n\n/**\n * If the item has only one available diff style, auto-select it\n */\nfunction setDefaultDiffStyle(item) {\n  if (item.diffStyleId !== undefined) {\n    return;\n  }\n  const availableStyles = filterOutUndefined(item.availableDiffStyles.map(diffStyleId => {\n    var _item$styleSelectable;\n    return (_item$styleSelectable = item.styleSelectableDimensions) === null || _item$styleSelectable === void 0 || (_item$styleSelectable = _item$styleSelectable[0]) === null || _item$styleSelectable === void 0 || (_item$styleSelectable = _item$styleSelectable.options) === null || _item$styleSelectable === void 0 ? void 0 : _item$styleSelectable.find(style => style.id === diffStyleId);\n  }));\n  if (availableStyles.length === 1) {\n    item.setTrait(CommonStrata.user, \"diffStyleId\", availableStyles[0].id);\n  }\n}\nfunction removeSplitItem(item) {\n  const terria = item.terria;\n  terria.overlays.remove(item);\n  if (item.sourceReference && terria.workbench.contains(item) === false) {\n    terria.removeModelReferences(item.sourceReference);\n  }\n}\nfunction doesFeatureBelongToItem(feature, item) {\n  var _feature$imageryLayer;\n  if (!MappableMixin.isMixedInto(item)) return false;\n  const imageryProvider = (_feature$imageryLayer = feature.imageryLayer) === null || _feature$imageryLayer === void 0 ? void 0 : _feature$imageryLayer.imageryProvider;\n  if (imageryProvider === undefined) return false;\n  return item.mapItems.find(m => ImageryParts.is(m) && m.imageryProvider === imageryProvider) !== undefined;\n}\nfunction setTimeFilterFromLocation(item, location, im) {\n  const carto = new Cartographic(CesiumMath.toRadians(location.longitude), CesiumMath.toRadians(location.latitude));\n  // We just need to set this to a high enough level supported by the service\n  const level = 30;\n  const tile = im.tilingScheme.positionToTileXY(carto, level);\n  return item.setTimeFilterFromLocation({\n    position: {\n      latitude: location.latitude,\n      longitude: location.longitude,\n      height: location.height\n    },\n    tileCoords: {\n      x: tile.x,\n      y: tile.y,\n      level\n    }\n  });\n}\nfunction hasOpacity(model) {\n  return hasTraits(model, ImageryProviderTraits, \"opacity\");\n}\nexport default DiffTool;\nvar _StyledDiv = styled(\"div\").withConfig({\n  displayName: \"DiffTool___StyledDiv\",\n  componentId: \"sc-3vyhxu-5\"\n})([\"display:flex;flex-direction:column;height:100%;padding:15px;gap:20px;\"]);\nvar _StyledDiv2 = styled(\"div\").withConfig({\n  displayName: \"DiffTool___StyledDiv2\",\n  componentId: \"sc-3vyhxu-6\"\n})([\"display:flex;flex-direction:row;padding:5px;\"]);\nvar _StyledDiv3 = styled(\"div\").withConfig({\n  displayName: \"DiffTool___StyledDiv3\",\n  componentId: \"sc-3vyhxu-7\"\n})([\"margin-right:10px;\"]);\nvar _StyledStyledIcon = styled(StyledIcon).withConfig({\n  displayName: \"DiffTool___StyledStyledIcon\",\n  componentId: \"sc-3vyhxu-8\"\n})([\"transform:rotate(90deg);\"]);\nvar _StyledButton = styled(Button).withConfig({\n  displayName: \"DiffTool___StyledButton\",\n  componentId: \"sc-3vyhxu-9\"\n})([\"flex-grow:1;margin-left:10px;\"]);\nvar _StyledText = styled(Text).withConfig({\n  displayName: \"DiffTool___StyledText\",\n  componentId: \"sc-3vyhxu-10\"\n})([\"\", \"\"], p => p.$_css3);\nvar _StyledBox = styled(Box).withConfig({\n  displayName: \"DiffTool___StyledBox\",\n  componentId: \"sc-3vyhxu-11\"\n})([\"@media (max-width:\", \"px){width:100%;}\"], props => props.theme.md);\nvar _StyledText2 = styled(Text).withConfig({\n  displayName: \"DiffTool___StyledText2\",\n  componentId: \"sc-3vyhxu-12\"\n})([\"fill:\", \";\"], _ref3 => {\n  let {\n    theme\n  } = _ref3;\n  return theme.textLight;\n});"],"names":["DatePicker","forwardRef","props","ref","heading","item","onDateSet","t","useTranslation","isOpen","setIsOpen","useState","currentDate","useMemo","date","currentDiscreteJulianDate","JulianDate","toDate","formattedCurrentDate","undefined","toggleOpen","useCallback","changeCurrentDate","setTrait","CommonStrata","user","toISOString","moveToPreviousDate","moveToPreviousDiscreteTime","moveToNextDate","moveToNextDiscreteTime","useImperativeHandle","open","close","Box","column","centered","flex","children","Spacing","bottom","_StyledStyledIcon","light","styledWidth","glyph","Icon","calendar2","$_css","right","Text","textLight","extraLarge","PrevButton","disabled","isPreviousDiscreteTimeAvailable","title","onClick","DateButton","primary","NextButton","isNextDiscreteTimeAvailable","style","display","position","DateTimePicker","dates","objectifiedDates","onChange","openDirection","onClose","displayName","PagerButton","Button","attrs","iconProps","css","withConfig","componentId","theme","colorPrimary","_ref","centerWithFlex","renderIcon","_StyledStyledIcon2","arrowDown","_ref2","borderRadiusLeft","radius40Button","_StyledStyledIcon3","_ref3","borderRadiusRight","lg","_class","_class2","_descriptor","_descriptor2","_descriptor3","p","_initializerDefineProperty","e","i","r","l","Object","defineProperty","enumerable","configurable","writable","value","initializer","call","_applyDecoratedDescriptor","n","a","keys","forEach","slice","reverse","reduce","LocationPicker","Component","constructor","super","this","setupPicker","terria","location","onPicking","onPicked","pickMode","MapInteractionMode","message","messageAsNode","uiMode","Difference","mode","mapInteractionModeStack","push","addInteractionModeToMap","showMarker","pickDisposer","pickedFeatures","newPick","_newPick$allFeaturesA","pickPosition","customUi","Loader","concat","cartesian","carto","Ellipsoid","WGS84","cartesianToCartographic","longitude","toDegrees","latitude","cartesianToDegrees","currentPick","allFeaturesAvailablePromise","then","destroyPicker","_this$pickDisposer","currentMode","pop","removeInteractionModeFromMap","componentDidMount","componentDidUpdate","componentWillUnmount","render","prototype","getOwnPropertyDescriptor","name","customMarkerIcon","ownKeys","getOwnPropertySymbols","o","filter","apply","_objectSpread","arguments","length","getOwnPropertyDescriptors","defineProperties","Symbol","toPrimitive","TypeError","String","DiffTool","leftItem","setLeftItem","rightItem","setRightItem","userSelectedSourceItem","setUserSelectedSourceItem","viewState","sourceItem","useEffect","originalSettings","showSplitter","isMapFullScreen","elements","set","visible","itemsPromise","Promise","all","createSplitItem","SplitDirection","LEFT","RIGHT","lItem","rItem","catch","setIsMapFullScreen","removeSplitItem","Main","changeSourceItem","_diffItem$styleSelect3","setLocation","setLocationPickError","isPickingNewLocation","setIsPickingNewLocation","leftDatePickerHandle","useRef","rightDatePickerHandle","diffItem","currentLeftDate","currentRightDate","diffItemName","format","d1","d2","diffableItemsInWorkbench","workbench","items","DiffableMixin","isMixedInto","canDiffImages","previewStyle","_diffItem$styleSelect","styleSelectableDimensions","selectedId","currentDiffStyle","diffStyleId","availableDiffStyles","filterOutUndefined","map","_diffItem$styleSelect2","options","find","id","diffLegendUrl","getLegendUrlForStyle","previewLegendUrl","showItem","model","hasOpacity","hideItem","handleChangeSourceItem","newSourceItem","uniqueId","target","handleChangePreviewStyle","styleId","_leftItem$styleSelect","_rightItem$styleSelec","setDimensionValue","handleChangeDiffStyle","onUserPickingLocation","_pickingLocation","onUserPickLocation","pickedLocationValue","feature","features","f","doesFeatureBelongToItem","setTimeFilterFeature","providerCoords","unsetDates","generateDiff","overlays","remove","add","showDiffImage","diffItemProperties","updateModelFromJson","resetTool","clearDiffImage","setDefaultDiffStyle","setLocationFromActiveSearch","async","markerLocation","MappableMixin","part","mapItems","is","imageryProvider","promises","setTimeFilterFromLocation","some","ok","height","timeFilterCoordinates","closePanel","closeTool","isShowingDiff","isReadyToGenerateDiff","WorkflowPanel","icon","difference","_StyledDiv","medium","Group","LocationAndDatesDisplayBox","bold","small","alignItemsFlexStart","large","_leftDatePickerHandle","current","isLink","_rightDatePickerHandl","Selector","label","spacingBottom","LegendImage","width","src","GenerateButton","_StyledDiv2","_StyledDiv3","fillColor","styledHeight","info","left","_StyledBackButton","transparentBg","$_css2","_StyledButton","fullWidth","flexWrap","backgroundColor","dark","AreaFilterSelection","document","getElementById","BackButton","secondary","_StyledText","$_css3","parseCustomMarkdownToReact","injectTermsAsTooltips","tooltipTerms","configParameters","helpContentTerms","Select","locationText","prettifyCoordinates","digits","_StyledBox","styledMinWidth","location2","styledMinHeight","_StyledText2","extraExtraLarge","textAlignCenter","div","darkWithOverlay","marginTop","onLoad","currentTarget","onError","splitDirection","SplitItemReference","createGuid","addModel","loadReference","_newItem$styleSelecta","Error","newItem","featureInfoTemplate","template","trueColor","isDefined","search","_newItem$styleSelecta2","availableStyles","_item$styleSelectable","sourceReference","contains","removeModelReferences","_feature$imageryLayer","imageryLayer","m","im","Cartographic","toRadians","tile","tilingScheme","positionToTileXY","tileCoords","x","y","level","hasTraits","ImageryProviderTraits","md"],"sourceRoot":""}